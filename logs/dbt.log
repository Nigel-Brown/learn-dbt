

============================== 2022-10-13 13:00:47.397897 | 17f90e8b-7659-4d0d-903a-dcd1b7b2ba21 ==============================
[0m13:00:47.397932 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:00:47.398369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:00:47.398483 [debug] [MainThread]: Tracking: tracking
[0m13:00:47.398703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc88b0>]}
[0m13:00:47.405386 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m13:00:47.405596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17f90e8b-7659-4d0d-903a-dcd1b7b2ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc8d30>]}
[0m13:00:47.419889 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:00:47.421245 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:00:47.444321 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m13:00:47.446266 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:00:47.448920 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:00:47.449590 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:00:47.451357 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:00:47.455844 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:00:47.456355 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:00:47.456665 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:00:47.456986 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:00:47.457255 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:00:47.457479 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:00:47.459236 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:00:47.460296 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:00:47.461094 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:00:47.469365 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:00:47.476177 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:00:47.482372 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:00:47.484802 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:00:47.485755 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:00:47.486611 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:00:47.488821 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:00:47.497238 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:00:47.498152 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:00:47.502762 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:00:47.510629 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:00:47.513303 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:00:47.514689 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:00:47.517319 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:00:47.517950 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:00:47.519512 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:00:47.520540 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:00:47.523877 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:00:47.532730 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:00:47.533420 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:00:47.534555 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:00:47.535280 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:00:47.535716 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:00:47.536103 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:00:47.536429 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:00:47.537062 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:00:47.539083 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:00:47.543285 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:00:47.543746 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:00:47.544351 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:00:47.544849 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:00:47.545392 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:00:47.546102 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:00:47.546544 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:00:47.547082 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:00:47.547632 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:00:47.548864 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:00:47.549502 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:00:47.550065 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:00:47.550590 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:00:47.551101 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:00:47.551555 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:00:47.552088 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:00:47.552542 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:00:47.555273 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:00:47.555731 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:00:47.556614 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:00:47.557612 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:00:47.558097 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:00:47.559285 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:00:47.560517 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:00:47.567435 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:00:47.568775 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:00:47.575277 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:00:47.577369 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:00:47.580701 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:00:47.585484 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:00:47.702405 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:00:47.721934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17f90e8b-7659-4d0d-903a-dcd1b7b2ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109088cd0>]}
[0m13:00:47.724713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17f90e8b-7659-4d0d-903a-dcd1b7b2ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc8250>]}
[0m13:00:47.724888 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:00:47.725060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f90e8b-7659-4d0d-903a-dcd1b7b2ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109159b50>]}
[0m13:00:47.725630 [info ] [MainThread]: 
[0m13:00:47.725889 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:00:47.726231 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:00:47.732531 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:00:47.732703 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:00:47.732803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:49.780983 [debug] [ThreadPool]: Snowflake adapter: Got an error when attempting to open a snowflake connection. No retries attempted: '250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting'
[0m13:00:49.781690 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:00:49.781951 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:00:49.782265 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m13:00:49.782506 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:00:49.782971 [debug] [ThreadPool]: On list_airbnb: No close available on handle
[0m13:00:49.783901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:49.784238 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m13:00:49.784620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109088760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109145cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912ea90>]}
[0m13:00:49.784978 [debug] [MainThread]: Flushing usage events
[0m13:00:50.330859 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "airbnb"
  Database Error
    250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting
[0m13:00:50.336913 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/opt/homebrew/Cellar/python@3.9/3.9.14/Frameworks/Python.framework/Versions/3.9/lib/python3.9/socket.py", line 954, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
snowflake.connector.vendored.urllib3.exceptions.NewConnectionError: <snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x1091c8b20>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 815, in urlopen
    return self.urlopen(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
snowflake.connector.vendored.urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='https', port=443): Max retries exceeded with url: //WG66188.eu-west-1.snowflakecomputing.com:443/session/v1/login-request?request_id=a1687470-55a6-488b-963a-e5d3d2b74f82&databaseName=airbnb&schemaName=dev&warehouse=COMPUTE_WH&roleName=transform (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x1091c8b20>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/network.py", line 1018, in _request_exec
    raw_ret = session.request(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/vendored/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
snowflake.connector.vendored.requests.exceptions.ConnectionError: HTTPSConnectionPool(host='https', port=443): Max retries exceeded with url: //WG66188.eu-west-1.snowflakecomputing.com:443/session/v1/login-request?request_id=a1687470-55a6-488b-963a-e5d3d2b74f82&databaseName=airbnb&schemaName=dev&warehouse=COMPUTE_WH&roleName=transform (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x1091c8b20>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/connection.py", line 1064, in __authenticate
    auth.authenticate(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/auth.py", line 257, in authenticate
    ret = self._rest._post_request(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/network.py", line 704, in _post_request
    ret = self.fetch(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/network.py", line 794, in fetch
    ret = self._request_exec_wrapper(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/network.py", line 917, in _request_exec_wrapper
    raise e
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/network.py", line 837, in _request_exec_wrapper
    return_object = self._request_exec(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/network.py", line 1095, in _request_exec
    raise OperationalError(
snowflake.connector.errors.OperationalError: 251011: ConnectionTimeout occurred. Will be handled by authenticator

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/snowflake/connections.py", line 266, in open
    handle = snowflake.connector.connect(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/__init__.py", line 51, in Connect
    return SnowflakeConnection(**kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/connection.py", line 292, in __init__
    self.connect(**kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/connection.py", line 542, in connect
    self.__open_connection()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/connection.py", line 781, in __open_connection
    self._authenticate(auth_instance)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/connection.py", line 1044, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/connection.py", line 1109, in __authenticate
    raise auth_op
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/connection.py", line 1086, in __authenticate
    auth_instance.handle_timeout(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/snowflake/connector/auth_by_plugin.py", line 117, in handle_timeout
    raise OperationalError(
snowflake.connector.errors.OperationalError: 250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/snowflake/impl.py", line 92, in list_schemas
    results = self.execute_macro(LIST_SCHEMAS_MACRO_NAME, kwargs={"database": database})
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 976, in execute_macro
    result = macro_function(**kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 242, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/snowflake/connections.py", line 441, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/snowflake/connections.py", line 492, in add_query
    connection, cursor = super().add_query(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 69, in add_query
    cursor = connection.handle.cursor()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/contracts/connection.py", line 94, in handle
    self._handle.resolve(self)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/contracts/connection.py", line 116, in resolve
    return self.opener(connection)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/snowflake/connections.py", line 319, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 470, in run
    result = self.execute_with_hooks(selected_uids)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 432, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/run.py", line 442, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 555, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/opt/homebrew/Cellar/python@3.9/3.9.14/Frameworks/Python.framework/Versions/3.9/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/opt/homebrew/Cellar/python@3.9/3.9.14/Frameworks/Python.framework/Versions/3.9/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.9/3.9.14/Frameworks/Python.framework/Versions/3.9/lib/python3.9/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/utils.py", line 480, in connected
    return func(*args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 532, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/adapters/snowflake/impl.py", line 95, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "airbnb"
  Database Error
    250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting



============================== 2022-10-13 13:01:48.753229 | 400537f1-1c05-4f50-99c3-5fca6383b87c ==============================
[0m13:01:48.753236 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:01:48.753665 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:01:48.753792 [debug] [MainThread]: Tracking: tracking
[0m13:01:48.769846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108033070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080337c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080332e0>]}
[0m13:01:49.008675 [debug] [MainThread]: Executing "git --help"
[0m13:01:49.032275 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:01:49.032787 [debug] [MainThread]: STDERR: "b''"
[0m13:01:49.037072 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m13:01:49.040945 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:01:49.041254 [debug] [MainThread]: On debug: select 1 as id
[0m13:01:49.041430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:51.078922 [debug] [MainThread]: Snowflake adapter: Got an error when attempting to open a snowflake connection. No retries attempted: '250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting'
[0m13:01:51.079998 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:01:51.080413 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:01:51.080775 [debug] [MainThread]: On debug: No close available on handle
[0m13:01:51.081464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b604f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b60460>]}
[0m13:01:51.081972 [debug] [MainThread]: Flushing usage events
[0m13:01:51.549708 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-13 13:06:02.124210 | 9b1fdeb6-ffc7-4be3-8b04-f90aecdd125a ==============================
[0m13:06:02.124215 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:06:02.124603 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:06:02.124700 [debug] [MainThread]: Tracking: tracking
[0m13:06:02.141640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27400>]}
[0m13:06:02.386547 [debug] [MainThread]: Executing "git --help"
[0m13:06:02.413182 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:06:02.413730 [debug] [MainThread]: STDERR: "b''"
[0m13:06:02.417931 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m13:06:02.419125 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:06:02.419328 [debug] [MainThread]: On debug: select 1 as id
[0m13:06:02.419467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:04.465138 [debug] [MainThread]: Snowflake adapter: Got an error when attempting to open a snowflake connection. No retries attempted: '250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting'
[0m13:06:04.465842 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:06:04.466132 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:06:04.466460 [debug] [MainThread]: On debug: No close available on handle
[0m13:06:04.467051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106870490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106870400>]}
[0m13:06:04.467580 [debug] [MainThread]: Flushing usage events
[0m13:06:04.981618 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-13 13:06:42.841371 | 02bd4d60-e5a3-469f-8956-26ee8a3e25b0 ==============================
[0m13:06:42.841376 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:06:42.841769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:06:42.841861 [debug] [MainThread]: Tracking: tracking
[0m13:06:42.856389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ccd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c4160>]}
[0m13:06:43.086580 [debug] [MainThread]: Executing "git --help"
[0m13:06:43.103795 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:06:43.104343 [debug] [MainThread]: STDERR: "b''"
[0m13:06:43.107994 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m13:06:43.108856 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:06:43.108978 [debug] [MainThread]: On debug: select 1 as id
[0m13:06:43.109083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:43.939707 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.83 seconds
[0m13:06:43.943056 [debug] [MainThread]: On debug: Close
[0m13:06:44.097550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104624550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb4bb0>]}
[0m13:06:44.098131 [debug] [MainThread]: Flushing usage events
[0m13:06:44.556617 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-13 13:06:55.107756 | 0521ed42-3781-425a-8d0b-737ebc3e3ef3 ==============================
[0m13:06:55.107778 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:06:55.108176 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:06:55.108284 [debug] [MainThread]: Tracking: tracking
[0m13:06:55.108499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b48e0>]}
[0m13:06:55.119763 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:06:55.120029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0521ed42-3781-425a-8d0b-737ebc3e3ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddabe0>]}
[0m13:06:55.133675 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:06:55.134912 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:06:55.156641 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m13:06:55.158588 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:06:55.161141 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:06:55.161766 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:06:55.163512 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:06:55.168086 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:06:55.168603 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:06:55.168891 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:06:55.169210 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:06:55.169464 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:06:55.169690 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:06:55.171445 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:06:55.172496 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:06:55.173306 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:06:55.181216 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:06:55.187937 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:06:55.194291 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:06:55.196519 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:06:55.197446 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:06:55.198365 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:06:55.200386 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:06:55.208834 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:06:55.209597 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:06:55.213975 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:06:55.221843 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:06:55.224536 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:06:55.225865 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:06:55.228545 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:06:55.229248 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:06:55.230863 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:06:55.231917 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:06:55.235197 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:06:55.244214 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:06:55.244937 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:06:55.246070 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:06:55.246795 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:06:55.247229 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:06:55.247620 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:06:55.247953 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:06:55.248596 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:06:55.250616 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:06:55.254597 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:06:55.254991 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:06:55.255563 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:06:55.256010 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:06:55.256448 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:06:55.257024 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:06:55.257409 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:06:55.257894 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:06:55.258407 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:06:55.259552 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:06:55.260117 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:06:55.260630 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:06:55.261119 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:06:55.261598 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:06:55.262028 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:06:55.262544 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:06:55.262987 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:06:55.265761 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:06:55.266223 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:06:55.267065 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:06:55.268031 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:06:55.268521 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:06:55.269548 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:06:55.270751 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:06:55.277663 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:06:55.278978 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:06:55.285159 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:06:55.287181 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:06:55.290460 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:06:55.294977 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:06:55.412877 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:06:55.432922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0521ed42-3781-425a-8d0b-737ebc3e3ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ee0a0>]}
[0m13:06:55.435679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0521ed42-3781-425a-8d0b-737ebc3e3ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2be80>]}
[0m13:06:55.435837 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:06:55.436014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0521ed42-3781-425a-8d0b-737ebc3e3ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b4a00>]}
[0m13:06:55.436602 [info ] [MainThread]: 
[0m13:06:55.436854 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:06:55.437210 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:06:55.443224 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:06:55.443354 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:06:55.443442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:56.172925 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.73 seconds
[0m13:06:56.175610 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:06:56.332580 [debug] [ThreadPool]: Acquiring new snowflake connection "create_airbnb_dev"
[0m13:06:56.333148 [debug] [ThreadPool]: Acquiring new snowflake connection "create_airbnb_dev"
[0m13:06:56.333531 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='airbnb', schema='dev', identifier=None)"
[0m13:06:56.339863 [debug] [ThreadPool]: Using snowflake connection "create_airbnb_dev"
[0m13:06:56.340114 [debug] [ThreadPool]: On create_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "create_airbnb_dev"} */
create schema if not exists airbnb.dev
[0m13:06:56.340325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:56.865357 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.52 seconds
[0m13:06:56.868091 [debug] [ThreadPool]: On create_airbnb_dev: Close
[0m13:06:57.021838 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:06:57.030605 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:06:57.030881 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:06:57.031099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:57.682904 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.65 seconds
[0m13:06:57.685820 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:06:57.841139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0521ed42-3781-425a-8d0b-737ebc3e3ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de3eb0>]}
[0m13:06:57.841977 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:06:57.842536 [info ] [MainThread]: 
[0m13:06:57.849716 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_listings
[0m13:06:57.850175 [info ] [Thread-1  ]: 1 of 1 START view model dev.src_listings ....................................... [RUN]
[0m13:06:57.851096 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:06:57.851335 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_listings
[0m13:06:57.851582 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_listings
[0m13:06:57.853625 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:06:57.854462 [debug] [Thread-1  ]: finished collecting timing info
[0m13:06:57.854664 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_listings
[0m13:06:57.878154 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:06:57.879102 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:06:57.879250 [debug] [Thread-1  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as lisiting_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:06:57.879373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:58.462757 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
[0m13:06:58.483715 [debug] [Thread-1  ]: finished collecting timing info
[0m13:06:58.484074 [debug] [Thread-1  ]: On model.learn_dbt.src_listings: Close
[0m13:06:58.686111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0521ed42-3781-425a-8d0b-737ebc3e3ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e43fa0>]}
[0m13:06:58.686715 [info ] [Thread-1  ]: 1 of 1 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.84s]
[0m13:06:58.687216 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_listings
[0m13:06:58.688303 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:06:58.688687 [info ] [MainThread]: 
[0m13:06:58.689005 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m13:06:58.689292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:58.689435 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:06:58.728964 [info ] [MainThread]: 
[0m13:06:58.729251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:06:58.729479 [info ] [MainThread]: 
[0m13:06:58.729668 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:06:58.729909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e49400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108838ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088623d0>]}
[0m13:06:58.730089 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 13:13:43.002346 | 482ae4be-bfb8-4233-a06f-6468dabfbb51 ==============================
[0m13:13:43.002382 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:13:43.003024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:13:43.003148 [debug] [MainThread]: Tracking: tracking
[0m13:13:43.003345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fdb50>]}
[0m13:13:43.027383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:13:43.027616 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/src/src_reviews.sql
[0m13:13:43.035445 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:13:43.046646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '482ae4be-bfb8-4233-a06f-6468dabfbb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567bb50>]}
[0m13:13:43.049633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '482ae4be-bfb8-4233-a06f-6468dabfbb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f5e50>]}
[0m13:13:43.049808 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:13:43.049986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482ae4be-bfb8-4233-a06f-6468dabfbb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f5f40>]}
[0m13:13:43.050626 [info ] [MainThread]: 
[0m13:13:43.050887 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:13:43.051311 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:13:43.057840 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:13:43.058010 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:13:43.058109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:43.825681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m13:13:43.827889 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:13:44.021294 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:13:44.026377 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:13:44.026505 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:13:44.026597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:44.630420 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.6 seconds
[0m13:13:44.633154 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:13:44.783177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482ae4be-bfb8-4233-a06f-6468dabfbb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058699a0>]}
[0m13:13:44.783679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:44.783880 [info ] [MainThread]: 
[0m13:13:44.786564 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_reviews
[0m13:13:44.786414 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_listings
[0m13:13:44.786881 [info ] [Thread-2  ]: 2 of 2 START view model dev.src_reviews ........................................ [RUN]
[0m13:13:44.787029 [info ] [Thread-1  ]: 1 of 2 START view model dev.src_listings ....................................... [RUN]
[0m13:13:44.787313 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m13:13:44.787555 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:13:44.787656 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_reviews
[0m13:13:44.787758 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_listings
[0m13:13:44.787864 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_reviews
[0m13:13:44.787951 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_listings
[0m13:13:44.788780 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m13:13:44.789834 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:13:44.790131 [debug] [Thread-2  ]: finished collecting timing info
[0m13:13:44.790312 [debug] [Thread-1  ]: finished collecting timing info
[0m13:13:44.790547 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_reviews
[0m13:13:44.790775 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_listings
[0m13:13:44.806200 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m13:13:44.807832 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:13:44.808359 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m13:13:44.808693 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:13:44.808791 [debug] [Thread-2  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m13:13:44.808885 [debug] [Thread-1  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as lisiting_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:13:44.808978 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:13:44.809069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:45.406735 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m13:13:45.417038 [debug] [Thread-2  ]: finished collecting timing info
[0m13:13:45.417208 [debug] [Thread-2  ]: On model.learn_dbt.src_reviews: Close
[0m13:13:45.440253 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m13:13:45.443179 [debug] [Thread-1  ]: finished collecting timing info
[0m13:13:45.443309 [debug] [Thread-1  ]: On model.learn_dbt.src_listings: Close
[0m13:13:45.566693 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482ae4be-bfb8-4233-a06f-6468dabfbb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571be20>]}
[0m13:13:45.567445 [info ] [Thread-2  ]: 2 of 2 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.78s]
[0m13:13:45.568210 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_reviews
[0m13:13:45.593698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482ae4be-bfb8-4233-a06f-6468dabfbb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105962490>]}
[0m13:13:45.594012 [info ] [Thread-1  ]: 1 of 2 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.81s]
[0m13:13:45.594276 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_listings
[0m13:13:45.594978 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:13:45.595180 [info ] [MainThread]: 
[0m13:13:45.595371 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m13:13:45.595541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:45.595627 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:13:45.595711 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m13:13:45.599334 [info ] [MainThread]: 
[0m13:13:45.599514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:45.599685 [info ] [MainThread]: 
[0m13:13:45.599837 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:13:45.600032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105655d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056acca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa89a0>]}
[0m13:13:45.600162 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 13:19:13.429575 | 17eeb21f-8100-4a9f-a342-d8db8892ba07 ==============================
[0m13:19:13.429632 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:19:13.430568 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:19:13.430699 [debug] [MainThread]: Tracking: tracking
[0m13:19:13.431062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219ee340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219ee880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219eefa0>]}
[0m13:19:13.456716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:19:13.456949 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/src/src_hosts.sql
[0m13:19:13.463891 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m13:19:13.474727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17eeb21f-8100-4a9f-a342-d8db8892ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cf10d0>]}
[0m13:19:13.478021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17eeb21f-8100-4a9f-a342-d8db8892ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c81e50>]}
[0m13:19:13.478224 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:19:13.478417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17eeb21f-8100-4a9f-a342-d8db8892ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c81b50>]}
[0m13:19:13.479287 [info ] [MainThread]: 
[0m13:19:13.479621 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:13.480109 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:19:13.486650 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:19:13.486823 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:19:13.486920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:14.239474 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.75 seconds
[0m13:19:14.242909 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:19:14.414681 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:19:14.422155 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:19:14.422395 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:19:14.422569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:14.887185 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.46 seconds
[0m13:19:14.889112 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:19:15.041106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17eeb21f-8100-4a9f-a342-d8db8892ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c81d60>]}
[0m13:19:15.042088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:15.042622 [info ] [MainThread]: 
[0m13:19:15.049043 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m13:19:15.049321 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m13:19:15.049523 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m13:19:15.049910 [info ] [Thread-1  ]: 1 of 3 START view model dev.src_hosts .......................................... [RUN]
[0m13:19:15.050214 [info ] [Thread-3  ]: 3 of 3 START view model dev.src_reviews ........................................ [RUN]
[0m13:19:15.050560 [info ] [Thread-2  ]: 2 of 3 START view model dev.src_listings ....................................... [RUN]
[0m13:19:15.051200 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m13:19:15.051738 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m13:19:15.052388 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:19:15.052599 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m13:19:15.052834 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m13:19:15.053064 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m13:19:15.053312 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m13:19:15.053527 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m13:19:15.053735 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m13:19:15.055445 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m13:19:15.057926 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m13:19:15.059500 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:19:15.060518 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:15.060805 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:15.061028 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m13:19:15.061272 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m13:19:15.061451 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:15.084243 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m13:19:15.086498 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m13:19:15.086757 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m13:19:15.088882 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:19:15.089498 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m13:19:15.089887 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m13:19:15.090046 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m13:19:15.090444 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:19:15.090564 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m13:19:15.090693 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:15.090821 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as lisiting_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:19:15.090934 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:19:15.091244 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:19:15.792234 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m13:19:15.816689 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:15.817171 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.73 seconds
[0m13:19:15.817507 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m13:19:15.819627 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:15.820641 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m13:19:15.892363 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.8 seconds
[0m13:19:15.894822 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:15.895065 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m13:19:15.975522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eeb21f-8100-4a9f-a342-d8db8892ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f2c970>]}
[0m13:19:15.976963 [info ] [Thread-2  ]: 2 of 3 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.92s]
[0m13:19:15.977644 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m13:19:15.978263 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eeb21f-8100-4a9f-a342-d8db8892ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f2c160>]}
[0m13:19:15.978641 [info ] [Thread-3  ]: 3 of 3 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.93s]
[0m13:19:15.979127 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m13:19:16.035679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eeb21f-8100-4a9f-a342-d8db8892ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f667f0>]}
[0m13:19:16.036209 [info ] [Thread-1  ]: 1 of 3 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.98s]
[0m13:19:16.036678 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m13:19:16.037735 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:16.038127 [info ] [MainThread]: 
[0m13:19:16.038479 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m13:19:16.038797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:16.038961 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m13:19:16.039121 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m13:19:16.039282 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:19:16.045551 [info ] [MainThread]: 
[0m13:19:16.045906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:16.046207 [info ] [MainThread]: 
[0m13:19:16.046490 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:19:16.046819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219e3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fbb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125069550>]}
[0m13:19:16.047047 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 13:40:19.538308 | 35baca4f-f73a-4e22-82d3-8abb3c0fba06 ==============================
[0m13:40:19.538335 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:40:19.538987 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:40:19.539117 [debug] [MainThread]: Tracking: tracking
[0m13:40:19.539323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b4a00>]}
[0m13:40:19.565471 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 4 files added, 0 files changed.
[0m13:40:19.565725 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/dim/src_listings.sql
[0m13:40:19.565858 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/dim/src_hosts.sql
[0m13:40:19.565976 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/dim_listings_cleansed.sql
[0m13:40:19.566086 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/dim/src_reviews.sql
[0m13:40:19.566173 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://models/src/src_reviews.sql
[0m13:40:19.566254 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://models/src/src_hosts.sql
[0m13:40:19.566331 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://models/src/src_listings.sql
[0m13:40:19.573265 [debug] [MainThread]: 1699: static parser successfully parsed dim/src_listings.sql
[0m13:40:19.579750 [debug] [MainThread]: 1699: static parser successfully parsed dim/src_hosts.sql
[0m13:40:19.581138 [debug] [MainThread]: 1699: static parser successfully parsed dim_listings_cleansed.sql
[0m13:40:19.582351 [debug] [MainThread]: 1699: static parser successfully parsed dim/src_reviews.sql
[0m13:40:19.588681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115850d0>]}
[0m13:40:19.591878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a3a00>]}
[0m13:40:19.592068 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:40:19.592256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fd100>]}
[0m13:40:19.593088 [info ] [MainThread]: 
[0m13:40:19.593412 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:40:19.593885 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:40:19.600127 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:40:19.600244 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:40:19.600338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:20.392106 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.79 seconds
[0m13:40:20.393101 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:40:20.551296 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:40:20.555233 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:40:20.555367 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:40:20.555459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:21.179101 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.62 seconds
[0m13:40:21.182749 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:40:21.358767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a35b0>]}
[0m13:40:21.359668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:21.360255 [info ] [MainThread]: 
[0m13:40:21.366599 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m13:40:21.366875 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m13:40:21.367093 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m13:40:21.367493 [info ] [Thread-2  ]: 2 of 4 START view model dev.src_listings ....................................... [RUN]
[0m13:40:21.367836 [info ] [Thread-1  ]: 1 of 4 START view model dev.src_hosts .......................................... [RUN]
[0m13:40:21.368142 [info ] [Thread-3  ]: 3 of 4 START view model dev.src_reviews ........................................ [RUN]
[0m13:40:21.368806 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:40:21.369370 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m13:40:21.369932 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m13:40:21.370164 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m13:40:21.370387 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m13:40:21.370600 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m13:40:21.370868 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m13:40:21.371073 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m13:40:21.371271 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m13:40:21.373910 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:40:21.375267 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m13:40:21.376575 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m13:40:21.377513 [debug] [Thread-3  ]: finished collecting timing info
[0m13:40:21.377717 [debug] [Thread-2  ]: finished collecting timing info
[0m13:40:21.377878 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:21.378045 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m13:40:21.378238 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m13:40:21.378419 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m13:40:21.400947 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m13:40:21.403070 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:40:21.404976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m13:40:21.405864 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m13:40:21.406213 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m13:40:21.406597 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:40:21.406699 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m13:40:21.406821 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m13:40:21.406947 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as lisiting_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:40:21.407061 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:40:21.407187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:21.407302 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:40:22.095631 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m13:40:22.117472 [debug] [Thread-2  ]: finished collecting timing info
[0m13:40:22.117734 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m13:40:22.264034 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m13:40:22.269196 [debug] [Thread-3  ]: finished collecting timing info
[0m13:40:22.269590 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m13:40:22.271963 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m13:40:22.274879 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:22.275492 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m13:40:22.278923 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bad190>]}
[0m13:40:22.279353 [info ] [Thread-2  ]: 2 of 4 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.91s]
[0m13:40:22.280155 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m13:40:22.280904 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m13:40:22.281353 [info ] [Thread-4  ]: 4 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m13:40:22.281960 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:40:22.282241 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m13:40:22.282445 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m13:40:22.285434 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:40:22.286066 [debug] [Thread-4  ]: finished collecting timing info
[0m13:40:22.286249 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m13:40:22.289060 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:40:22.289957 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:40:22.290129 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m13:40:22.290282 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:40:22.421066 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159c400>]}
[0m13:40:22.421588 [info ] [Thread-3  ]: 3 of 4 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.05s]
[0m13:40:22.422078 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m13:40:22.444350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a3760>]}
[0m13:40:22.444710 [info ] [Thread-1  ]: 1 of 4 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.08s]
[0m13:40:22.445138 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m13:40:22.811087 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a799f4-3201-eb1e-0000-00015aae30c1
[0m13:40:22.811551 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 3
invalid identifier 'LISTING_NAME'
[0m13:40:22.812088 [debug] [Thread-4  ]: finished collecting timing info
[0m13:40:22.812396 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m13:40:23.015391 [debug] [Thread-4  ]: Database Error in model dim_listings_cleansed (models/dim_listings_cleansed.sql)
  000904 (42000): SQL compilation error: error line 9 at position 3
  invalid identifier 'LISTING_NAME'
  compiled SQL at target/run/learn_dbt/models/dim_listings_cleansed.sql
[0m13:40:23.015969 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35baca4f-f73a-4e22-82d3-8abb3c0fba06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f296a0>]}
[0m13:40:23.016586 [error] [Thread-4  ]: 4 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 0.73s]
[0m13:40:23.017310 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m13:40:23.018645 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:40:23.019140 [info ] [MainThread]: 
[0m13:40:23.019562 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m13:40:23.019941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:23.020137 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m13:40:23.020326 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:40:23.020512 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m13:40:23.020699 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m13:40:23.027649 [info ] [MainThread]: 
[0m13:40:23.028006 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:23.028341 [info ] [MainThread]: 
[0m13:40:23.028650 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim_listings_cleansed.sql)[0m
[0m13:40:23.028953 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 9 at position 3
[0m13:40:23.029243 [error] [MainThread]:   invalid identifier 'LISTING_NAME'
[0m13:40:23.029533 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim_listings_cleansed.sql
[0m13:40:23.029833 [info ] [MainThread]: 
[0m13:40:23.030135 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:40:23.030505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a0e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a0b610>]}
[0m13:40:23.030771 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 13:42:39.315566 | 55466761-dd37-443c-9479-d62106fce11d ==============================
[0m13:42:39.315613 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:42:39.316278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:42:39.316400 [debug] [MainThread]: Tracking: tracking
[0m13:42:39.316621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8c8b0>]}
[0m13:42:39.343597 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m13:42:39.343854 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/dim/dim_listings_cleansed.sql
[0m13:42:39.343980 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/src/src_listings.sql
[0m13:42:39.344091 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/src/src_reviews.sql
[0m13:42:39.344198 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/src/src_hosts.sql
[0m13:42:39.344287 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://models/dim/src_hosts.sql
[0m13:42:39.344376 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://models/dim/src_listings.sql
[0m13:42:39.344458 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://models/dim/src_reviews.sql
[0m13:42:39.344535 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://models/dim_listings_cleansed.sql
[0m13:42:39.351339 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:42:39.357648 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:42:39.358894 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:42:39.360041 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m13:42:39.366034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5a0d0>]}
[0m13:42:39.369169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce5bb0>]}
[0m13:42:39.369339 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:42:39.369521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce5b20>]}
[0m13:42:39.370188 [info ] [MainThread]: 
[0m13:42:39.370440 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:42:39.370877 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:42:39.377465 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:42:39.377630 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:42:39.377730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:40.177557 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.8 seconds
[0m13:42:40.180148 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:42:40.355177 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:42:40.364782 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:42:40.365051 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:42:40.365267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:41.026912 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.66 seconds
[0m13:42:41.029382 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:42:41.209376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceb730>]}
[0m13:42:41.210279 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:42:41.210826 [info ] [MainThread]: 
[0m13:42:41.216857 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m13:42:41.217113 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m13:42:41.217414 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m13:42:41.217753 [info ] [Thread-2  ]: 2 of 4 START view model dev.src_listings ....................................... [RUN]
[0m13:42:41.218095 [info ] [Thread-3  ]: 3 of 4 START view model dev.src_reviews ........................................ [RUN]
[0m13:42:41.218397 [info ] [Thread-1  ]: 1 of 4 START view model dev.src_hosts .......................................... [RUN]
[0m13:42:41.219098 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:42:41.219604 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m13:42:41.220180 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m13:42:41.220409 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m13:42:41.220644 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m13:42:41.220865 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m13:42:41.221118 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m13:42:41.221330 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m13:42:41.221538 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m13:42:41.224091 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:42:41.225446 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m13:42:41.226765 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m13:42:41.227682 [debug] [Thread-2  ]: finished collecting timing info
[0m13:42:41.228070 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m13:42:41.228280 [debug] [Thread-1  ]: finished collecting timing info
[0m13:42:41.234745 [debug] [Thread-3  ]: finished collecting timing info
[0m13:42:41.251959 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:42:41.252136 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m13:42:41.252330 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m13:42:41.254412 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m13:42:41.256323 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m13:42:41.256783 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:42:41.257026 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:42:41.257172 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:42:41.257494 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m13:42:41.257826 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m13:42:41.258407 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m13:42:41.258917 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m13:42:41.259066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:41.259189 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:42:41.937978 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m13:42:41.961670 [debug] [Thread-2  ]: finished collecting timing info
[0m13:42:41.962409 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m13:42:41.962729 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m13:42:41.962919 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m13:42:41.964990 [debug] [Thread-1  ]: finished collecting timing info
[0m13:42:41.966685 [debug] [Thread-3  ]: finished collecting timing info
[0m13:42:41.967517 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m13:42:41.967644 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m13:42:42.130055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2f4f0>]}
[0m13:42:42.130665 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0f760>]}
[0m13:42:42.131315 [info ] [Thread-1  ]: 1 of 4 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.91s]
[0m13:42:42.131818 [info ] [Thread-3  ]: 3 of 4 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.91s]
[0m13:42:42.132512 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m13:42:42.133086 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m13:42:42.138036 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba8400>]}
[0m13:42:42.138522 [info ] [Thread-2  ]: 2 of 4 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.92s]
[0m13:42:42.139112 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m13:42:42.139750 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m13:42:42.140052 [info ] [Thread-4  ]: 4 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m13:42:42.140803 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:42:42.141058 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m13:42:42.141295 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m13:42:42.143338 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:42:42.143832 [debug] [Thread-4  ]: finished collecting timing info
[0m13:42:42.143945 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m13:42:42.146014 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:42:42.146977 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:42:42.147167 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m13:42:42.147342 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:42:42.782117 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m13:42:42.786526 [debug] [Thread-4  ]: finished collecting timing info
[0m13:42:42.786943 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m13:42:42.946579 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55466761-dd37-443c-9479-d62106fce11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b02880>]}
[0m13:42:42.947320 [info ] [Thread-4  ]: 4 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.81s]
[0m13:42:42.948076 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m13:42:42.949616 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:42:42.950209 [info ] [MainThread]: 
[0m13:42:42.950724 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m13:42:42.951191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:42.951430 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m13:42:42.951664 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:42:42.951890 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m13:42:42.952091 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m13:42:42.959359 [info ] [MainThread]: 
[0m13:42:42.959722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:42:42.960062 [info ] [MainThread]: 
[0m13:42:42.960370 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:42:42.960753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d69550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5fe50>]}
[0m13:42:42.961006 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 13:49:00.711249 | d82da1bb-f93e-4ecd-8e3c-cca66eff7c75 ==============================
[0m13:49:00.711290 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:49:00.711934 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:49:00.712037 [debug] [MainThread]: Tracking: tracking
[0m13:49:00.712233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123218430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232180d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123218a00>]}
[0m13:49:00.738385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:49:00.738658 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/dim/dim_hosts_cleansed.sql
[0m13:49:00.745804 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:49:00.757097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233e20d0>]}
[0m13:49:00.760539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123376850>]}
[0m13:49:00.760750 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:49:00.760944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123372d00>]}
[0m13:49:00.761680 [info ] [MainThread]: 
[0m13:49:00.761968 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:49:00.762446 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:49:00.768847 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:49:00.769001 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:49:00.769096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:01.550654 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.78 seconds
[0m13:49:01.552096 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:49:01.712249 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:49:01.716182 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:49:01.716330 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:49:01.716425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:02.472217 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.76 seconds
[0m13:49:02.475996 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:49:02.630329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123308d60>]}
[0m13:49:02.630886 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:02.631207 [info ] [MainThread]: 
[0m13:49:02.634732 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m13:49:02.634918 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m13:49:02.635110 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m13:49:02.635415 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m13:49:02.635661 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m13:49:02.635896 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m13:49:02.636394 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:49:02.636832 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m13:49:02.637219 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m13:49:02.637394 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m13:49:02.637562 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m13:49:02.637722 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m13:49:02.637896 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m13:49:02.638025 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m13:49:02.638154 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m13:49:02.639296 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:49:02.640797 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m13:49:02.641730 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m13:49:02.642903 [debug] [Thread-2  ]: finished collecting timing info
[0m13:49:02.643048 [debug] [Thread-3  ]: finished collecting timing info
[0m13:49:02.643162 [debug] [Thread-1  ]: finished collecting timing info
[0m13:49:02.643307 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m13:49:02.643448 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m13:49:02.643584 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m13:49:02.661349 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:49:02.663154 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m13:49:02.664800 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m13:49:02.665447 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:49:02.665617 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:49:02.665718 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:49:02.666015 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m13:49:02.666289 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m13:49:02.666803 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m13:49:02.667236 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m13:49:02.667422 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:49:02.667622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:03.273380 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m13:49:03.294637 [debug] [Thread-1  ]: finished collecting timing info
[0m13:49:03.294972 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m13:49:03.324229 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m13:49:03.326233 [debug] [Thread-3  ]: finished collecting timing info
[0m13:49:03.326419 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m13:49:03.337016 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.67 seconds
[0m13:49:03.339023 [debug] [Thread-2  ]: finished collecting timing info
[0m13:49:03.339212 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m13:49:03.429901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124126c40>]}
[0m13:49:03.430465 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.79s]
[0m13:49:03.431069 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m13:49:03.431549 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m13:49:03.431899 [info ] [Thread-4  ]: 4 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m13:49:03.432492 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m13:49:03.432718 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m13:49:03.432909 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m13:49:03.436020 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m13:49:03.438142 [debug] [Thread-4  ]: finished collecting timing info
[0m13:49:03.438350 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m13:49:03.441244 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m13:49:03.441993 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m13:49:03.442161 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous')
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m13:49:03.442315 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:49:03.468326 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233fb4f0>]}
[0m13:49:03.468821 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.83s]
[0m13:49:03.469294 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m13:49:03.487402 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123308dc0>]}
[0m13:49:03.487826 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.85s]
[0m13:49:03.488210 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m13:49:03.488501 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m13:49:03.488692 [info ] [Thread-1  ]: 5 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m13:49:03.489055 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:49:03.489201 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m13:49:03.489342 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m13:49:03.491228 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:49:03.491677 [debug] [Thread-1  ]: finished collecting timing info
[0m13:49:03.491826 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m13:49:03.494164 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:49:03.495065 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:49:03.495208 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m13:49:03.495334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:03.947162 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a799fd-3201-ec24-0000-00015aae40f5
[0m13:49:03.947515 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m13:49:03.947891 [debug] [Thread-4  ]: finished collecting timing info
[0m13:49:03.948107 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m13:49:04.094933 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m13:49:04.098699 [debug] [Thread-1  ]: finished collecting timing info
[0m13:49:04.099024 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m13:49:04.119126 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m13:49:04.119523 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12364ddf0>]}
[0m13:49:04.119856 [error] [Thread-4  ]: 4 of 5 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.69s]
[0m13:49:04.120245 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m13:49:04.256887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd82da1bb-f93e-4ecd-8e3c-cca66eff7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261a5790>]}
[0m13:49:04.257712 [info ] [Thread-1  ]: 5 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.77s]
[0m13:49:04.258422 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m13:49:04.259840 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:49:04.260397 [info ] [MainThread]: 
[0m13:49:04.260882 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m13:49:04.261343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:04.261588 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m13:49:04.261823 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:49:04.262054 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m13:49:04.262282 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m13:49:04.269057 [info ] [MainThread]: 
[0m13:49:04.269433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:49:04.269774 [info ] [MainThread]: 
[0m13:49:04.270078 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m13:49:04.270379 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m13:49:04.270677 [error] [MainThread]:   Missing column specification
[0m13:49:04.270964 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m13:49:04.271263 [info ] [MainThread]: 
[0m13:49:04.271560 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:49:04.271938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123400250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123376ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123686940>]}
[0m13:49:04.272195 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 13:50:53.120781 | ae1b7639-bdd7-4c8d-9997-3a477b043781 ==============================
[0m13:50:53.120815 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:50:53.121493 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:50:53.121659 [debug] [MainThread]: Tracking: tracking
[0m13:50:53.122104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ba340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ba880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bafa0>]}
[0m13:50:53.147361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:53.147666 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/dim/dim_hosts_cleansed.sql
[0m13:50:53.154147 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:50:53.166202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073710d0>]}
[0m13:50:53.169896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c4100>]}
[0m13:50:53.170117 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:50:53.170313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107304d60>]}
[0m13:50:53.171049 [info ] [MainThread]: 
[0m13:50:53.171344 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:50:53.171813 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:50:53.178377 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:50:53.178546 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:50:53.178648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:53.951074 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m13:50:53.953933 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:50:54.104310 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:50:54.113796 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:50:54.114103 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:50:54.114332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:54.670681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.56 seconds
[0m13:50:54.673726 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:50:54.830906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107309eb0>]}
[0m13:50:54.831571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:54.832007 [info ] [MainThread]: 
[0m13:50:54.837137 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m13:50:54.837392 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m13:50:54.837617 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m13:50:54.837891 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m13:50:54.838176 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m13:50:54.838423 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m13:50:54.838944 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:50:54.839403 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m13:50:54.839838 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m13:50:54.840034 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m13:50:54.840212 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m13:50:54.840385 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m13:50:54.840584 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m13:50:54.840753 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m13:50:54.840918 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m13:50:54.842590 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:50:54.844530 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m13:50:54.845681 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m13:50:54.846267 [debug] [Thread-2  ]: finished collecting timing info
[0m13:50:54.846450 [debug] [Thread-1  ]: finished collecting timing info
[0m13:50:54.846631 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m13:50:54.846824 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m13:50:54.846995 [debug] [Thread-3  ]: finished collecting timing info
[0m13:50:54.871807 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:50:54.872729 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m13:50:54.872884 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m13:50:54.875001 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m13:50:54.875509 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:50:54.875660 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:50:54.875963 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m13:50:54.876272 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m13:50:54.876381 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:50:54.876491 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m13:50:54.876611 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m13:50:54.877150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:54.877639 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:50:55.566488 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m13:50:55.589807 [debug] [Thread-3  ]: finished collecting timing info
[0m13:50:55.590128 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m13:50:55.623841 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m13:50:55.626341 [debug] [Thread-1  ]: finished collecting timing info
[0m13:50:55.626566 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m13:50:55.681404 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m13:50:55.684175 [debug] [Thread-2  ]: finished collecting timing info
[0m13:50:55.684475 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m13:50:55.737093 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e0c070>]}
[0m13:50:55.737671 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.90s]
[0m13:50:55.738385 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m13:50:55.781141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738fa90>]}
[0m13:50:55.781635 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.94s]
[0m13:50:55.782246 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m13:50:55.782809 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m13:50:55.783246 [info ] [Thread-4  ]: 4 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m13:50:55.783997 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m13:50:55.784298 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m13:50:55.784564 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m13:50:55.788343 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m13:50:55.789128 [debug] [Thread-4  ]: finished collecting timing info
[0m13:50:55.789367 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m13:50:55.792753 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m13:50:55.793679 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m13:50:55.793914 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m13:50:55.794087 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:50:55.838003 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110950b80>]}
[0m13:50:55.838456 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.00s]
[0m13:50:55.838899 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m13:50:55.839234 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m13:50:55.839462 [info ] [Thread-1  ]: 5 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m13:50:55.839890 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:50:55.840054 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m13:50:55.840212 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m13:50:55.842450 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:50:55.842903 [debug] [Thread-1  ]: finished collecting timing info
[0m13:50:55.843051 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m13:50:55.845406 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:50:55.846220 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:50:55.846431 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m13:50:55.846586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:56.367192 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m13:50:56.371232 [debug] [Thread-4  ]: finished collecting timing info
[0m13:50:56.371615 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m13:50:56.444130 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m13:50:56.447738 [debug] [Thread-1  ]: finished collecting timing info
[0m13:50:56.448060 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m13:50:56.532725 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109af370>]}
[0m13:50:56.534007 [info ] [Thread-4  ]: 4 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.75s]
[0m13:50:56.534760 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m13:50:56.612877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1b7639-bdd7-4c8d-9997-3a477b043781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738fa60>]}
[0m13:50:56.613457 [info ] [Thread-1  ]: 5 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.77s]
[0m13:50:56.613792 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m13:50:56.614590 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:50:56.614816 [info ] [MainThread]: 
[0m13:50:56.614986 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m13:50:56.615142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:56.615218 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m13:50:56.615292 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:50:56.615369 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m13:50:56.615444 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m13:50:56.620713 [info ] [MainThread]: 
[0m13:50:56.621060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:56.621400 [info ] [MainThread]: 
[0m13:50:56.621697 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:50:56.622059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7a0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107296e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110983430>]}
[0m13:50:56.622306 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 13:55:38.858997 | 9f527d95-8320-4266-b8a4-fa84941e61c4 ==============================
[0m13:55:38.859015 [info ] [MainThread]: Running with dbt=1.2.1
[0m13:55:38.859998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:55:38.860143 [debug] [MainThread]: Tracking: tracking
[0m13:55:38.860373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b369a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b36460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b33c70>]}
[0m13:55:38.874393 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:55:38.874671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb2700>]}
[0m13:55:38.889642 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:55:38.890905 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:55:38.913709 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m13:55:38.915711 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:55:38.918513 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:55:38.919281 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:55:38.921322 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:55:38.925915 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:55:38.926397 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:55:38.926696 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:55:38.927017 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:55:38.927339 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:55:38.927791 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:55:38.929783 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:55:38.931054 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:55:38.931985 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:55:38.940709 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:55:38.948028 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:55:38.954439 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:55:38.956702 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:55:38.957767 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:55:38.958789 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:55:38.960992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:55:38.969813 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:55:38.970629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:55:38.975298 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:55:38.983416 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:55:38.986235 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:55:38.987672 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:55:38.990411 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:55:38.991081 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:55:38.992810 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:55:38.993965 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:55:38.997415 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:55:39.006834 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:55:39.007627 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:55:39.008830 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:55:39.009597 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:55:39.010059 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:55:39.010477 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:55:39.010829 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:55:39.011499 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:55:39.013626 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:55:39.017860 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:55:39.018278 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:55:39.018887 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:55:39.019363 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:55:39.019834 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:55:39.020455 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:55:39.020848 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:55:39.021339 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:55:39.021865 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:55:39.023083 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:55:39.023722 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:55:39.024266 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:55:39.024805 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:55:39.025325 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:55:39.025792 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:55:39.026328 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:55:39.026795 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:55:39.029613 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:55:39.030089 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:55:39.030975 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:55:39.032008 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:55:39.032530 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:55:39.033634 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:55:39.034911 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:55:39.042191 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:55:39.043609 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:55:39.050299 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:55:39.052473 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:55:39.055977 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:55:39.060772 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:55:39.183947 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:55:39.190159 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:55:39.191531 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:55:39.192788 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:55:39.194164 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m13:55:39.211024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc14c0>]}
[0m13:55:39.214595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b74c10>]}
[0m13:55:39.214786 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:55:39.214978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf1d00>]}
[0m13:55:39.215706 [info ] [MainThread]: 
[0m13:55:39.215998 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:55:39.216497 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:55:39.222965 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:55:39.223112 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:55:39.223212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:40.044545 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.82 seconds
[0m13:55:40.045561 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:55:40.197778 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:55:40.204481 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:55:40.204734 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:55:40.204882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:40.728620 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.52 seconds
[0m13:55:40.731789 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:55:40.889188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc1b20>]}
[0m13:55:40.889768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:40.890080 [info ] [MainThread]: 
[0m13:55:40.893717 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m13:55:40.893853 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m13:55:40.893992 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m13:55:40.894221 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m13:55:40.894368 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m13:55:40.894502 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m13:55:40.894806 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m13:55:40.895051 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m13:55:40.895420 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m13:55:40.895542 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m13:55:40.895673 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m13:55:40.895789 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m13:55:40.895904 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m13:55:40.895998 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m13:55:40.896091 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m13:55:40.897073 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m13:55:40.898313 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m13:55:40.899091 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m13:55:40.899864 [debug] [Thread-2  ]: finished collecting timing info
[0m13:55:40.900017 [debug] [Thread-3  ]: finished collecting timing info
[0m13:55:40.900105 [debug] [Thread-1  ]: finished collecting timing info
[0m13:55:40.900195 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m13:55:40.900302 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m13:55:40.900402 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m13:55:40.915986 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m13:55:40.917968 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m13:55:40.919615 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m13:55:40.920364 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m13:55:40.920645 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m13:55:40.920970 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m13:55:40.921105 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m13:55:40.921224 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m13:55:40.921329 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m13:55:40.921451 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:55:40.921570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:40.921768 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:55:41.644313 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.72 seconds
[0m13:55:41.668243 [debug] [Thread-2  ]: finished collecting timing info
[0m13:55:41.669062 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m13:55:41.669479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m13:55:41.672427 [debug] [Thread-1  ]: finished collecting timing info
[0m13:55:41.672631 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m13:55:41.793892 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.87 seconds
[0m13:55:41.799061 [debug] [Thread-3  ]: finished collecting timing info
[0m13:55:41.799474 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m13:55:41.832140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c912e0>]}
[0m13:55:41.833520 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.94s]
[0m13:55:41.834273 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m13:55:41.834886 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e72e0>]}
[0m13:55:41.835678 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.94s]
[0m13:55:41.836060 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m13:55:41.836655 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m13:55:41.837021 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m13:55:41.837809 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m13:55:41.838063 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m13:55:41.838286 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m13:55:41.838609 [info ] [Thread-1  ]: 5 of 5 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m13:55:41.838858 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m13:55:41.839406 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:55:41.842637 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m13:55:41.842863 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m13:55:41.843161 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m13:55:41.846355 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:55:41.846935 [debug] [Thread-4  ]: finished collecting timing info
[0m13:55:41.847160 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m13:55:41.855963 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m13:55:41.856131 [debug] [Thread-1  ]: finished collecting timing info
[0m13:55:41.861018 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m13:55:41.861706 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m13:55:41.862307 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:55:41.863975 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m13:55:41.864186 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:55:41.865695 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:55:41.866686 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:55:41.866821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:41.968596 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfa9a0>]}
[0m13:55:41.969018 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.07s]
[0m13:55:41.969409 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m13:55:42.396591 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m13:55:42.409090 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m13:55:42.410433 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m13:55:42.410640 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m13:55:42.423117 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m13:55:42.424589 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m13:55:42.425458 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m13:55:42.425651 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m13:55:43.768315 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.34 seconds
[0m13:55:43.779147 [debug] [Thread-4  ]: finished collecting timing info
[0m13:55:43.779444 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m13:55:43.941119 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3d400>]}
[0m13:55:43.941934 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 2.10s]
[0m13:55:43.942691 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m13:55:44.030857 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.62 seconds
[0m13:55:44.034059 [debug] [Thread-1  ]: finished collecting timing info
[0m13:55:44.034316 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m13:55:44.222121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f527d95-8320-4266-b8a4-fa84941e61c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f2e80>]}
[0m13:55:44.222751 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 2.38s]
[0m13:55:44.223236 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m13:55:44.224343 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:55:44.224756 [info ] [MainThread]: 
[0m13:55:44.225073 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m13:55:44.225358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:44.225506 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m13:55:44.225649 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m13:55:44.225789 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m13:55:44.225928 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m13:55:44.233711 [info ] [MainThread]: 
[0m13:55:44.234157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:44.234531 [info ] [MainThread]: 
[0m13:55:44.234857 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:55:44.235246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fe610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c935e0>]}
[0m13:55:44.235539 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 14:00:40.344706 | e384bb88-51a7-4259-8f15-62894589c3f8 ==============================
[0m14:00:40.344731 [info ] [MainThread]: Running with dbt=1.2.1
[0m14:00:40.345369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:00:40.345485 [debug] [MainThread]: Tracking: tracking
[0m14:00:40.345700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073edee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073edf10>]}
[0m14:00:40.375535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:40.375726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:40.379142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758d0d0>]}
[0m14:00:40.382926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fbe50>]}
[0m14:00:40.383138 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:00:40.383341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755ce80>]}
[0m14:00:40.384183 [info ] [MainThread]: 
[0m14:00:40.384470 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:00:40.384974 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m14:00:40.391577 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m14:00:40.391760 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m14:00:40.391867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:41.178173 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.79 seconds
[0m14:00:41.179607 [debug] [ThreadPool]: On list_airbnb: Close
[0m14:00:41.353520 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m14:00:41.357691 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m14:00:41.357831 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m14:00:41.357923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:41.857974 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.5 seconds
[0m14:00:41.860854 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m14:00:42.082473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107564d90>]}
[0m14:00:42.083326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:42.083886 [info ] [MainThread]: 
[0m14:00:42.089724 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m14:00:42.090060 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m14:00:42.090316 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m14:00:42.090657 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m14:00:42.091005 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m14:00:42.091302 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m14:00:42.091962 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m14:00:42.092526 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m14:00:42.093051 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m14:00:42.093287 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m14:00:42.093530 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m14:00:42.093762 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m14:00:42.094008 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m14:00:42.094234 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m14:00:42.094444 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m14:00:42.096262 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m14:00:42.097782 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m14:00:42.099232 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m14:00:42.100423 [debug] [Thread-2  ]: finished collecting timing info
[0m14:00:42.100623 [debug] [Thread-3  ]: finished collecting timing info
[0m14:00:42.100809 [debug] [Thread-1  ]: finished collecting timing info
[0m14:00:42.100981 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m14:00:42.101169 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m14:00:42.101333 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m14:00:42.125100 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m14:00:42.125855 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m14:00:42.127702 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m14:00:42.128304 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m14:00:42.128455 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m14:00:42.128860 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m14:00:42.128986 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:00:42.129146 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m14:00:42.129476 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m14:00:42.130136 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:00:42.130652 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m14:00:42.132121 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:00:43.180704 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
[0m14:00:43.181357 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.05 seconds
[0m14:00:43.205174 [debug] [Thread-3  ]: finished collecting timing info
[0m14:00:43.208169 [debug] [Thread-1  ]: finished collecting timing info
[0m14:00:43.208367 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m14:00:43.208650 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m14:00:43.390141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076424f0>]}
[0m14:00:43.390808 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797bd60>]}
[0m14:00:43.391525 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.30s]
[0m14:00:43.392014 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.30s]
[0m14:00:43.392345 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m14:00:43.392552 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m14:00:43.392852 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m14:00:43.393099 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m14:00:43.393389 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:00:43.393488 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m14:00:43.393610 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m14:00:43.395274 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:00:43.395779 [debug] [Thread-4  ]: finished collecting timing info
[0m14:00:43.395880 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m14:00:43.413833 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:00:43.414535 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:00:43.414693 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m14:00:43.414834 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:00:43.435658 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.31 seconds
[0m14:00:43.437665 [debug] [Thread-2  ]: finished collecting timing info
[0m14:00:43.437861 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m14:00:43.621662 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797bee0>]}
[0m14:00:43.628261 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.53s]
[0m14:00:43.634871 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m14:00:43.660667 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m14:00:43.666717 [info ] [Thread-3  ]: 5 of 5 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m14:00:43.667080 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:00:43.673329 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m14:00:43.675366 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m14:00:43.677242 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:00:43.678111 [debug] [Thread-3  ]: finished collecting timing info
[0m14:00:43.678239 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m14:00:43.679592 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:00:43.680265 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:00:43.680407 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m14:00:43.680577 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:00:44.533510 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.12 seconds
[0m14:00:44.544715 [debug] [Thread-4  ]: finished collecting timing info
[0m14:00:44.545096 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m14:00:44.707676 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109789940>]}
[0m14:00:44.708494 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.31s]
[0m14:00:44.709255 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m14:00:44.754158 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.07 seconds
[0m14:00:44.757581 [debug] [Thread-3  ]: finished collecting timing info
[0m14:00:44.757872 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m14:00:44.912677 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e384bb88-51a7-4259-8f15-62894589c3f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109718640>]}
[0m14:00:44.913425 [info ] [Thread-3  ]: 5 of 5 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.25s]
[0m14:00:44.914131 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m14:00:44.915689 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:00:44.916318 [info ] [MainThread]: 
[0m14:00:44.916832 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m14:00:44.917207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:44.917402 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m14:00:44.917593 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m14:00:44.917781 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m14:00:44.917968 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m14:00:44.924351 [info ] [MainThread]: 
[0m14:00:44.924611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:44.924959 [info ] [MainThread]: 
[0m14:00:44.925282 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:00:44.925660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107896880>]}
[0m14:00:44.925937 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 14:11:09.819476 | e9c03e8d-f459-4557-98b6-0da29370a225 ==============================
[0m14:11:09.819516 [info ] [MainThread]: Running with dbt=1.2.1
[0m14:11:09.820301 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:11:09.820427 [debug] [MainThread]: Tracking: tracking
[0m14:11:09.820635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e71a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e719a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e71e80>]}
[0m14:11:09.848914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:11:09.855934 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/fact/fact_reviews.sql
[0m14:11:09.880703 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m14:11:09.895028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f64520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11283fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11283fe20>]}
[0m14:11:09.911894 [debug] [MainThread]: Flushing usage events
[0m14:11:10.389110 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_reviews (models/fact/fact_reviews.sql)
  unexpected char "'" at 130
    line 9
      select * from {{ ref('src_reviews) }}
[0m14:11:10.393164 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 494, in catch_jinja
    yield
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 521, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 9, in template
jinja2.exceptions.TemplateSyntaxError: unexpected char "'" at 130
  line 9
    select * from {{ ref('src_reviews) }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 451, in run
    self._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 349, in load
    self.parse_project(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 473, in parse_project
    parser.parse_file(block)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 392, in parse_file
    self.parse_node(file_block)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 366, in parse_node
    self.render_update(node, config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/models.py", line 147, in render_update
    super().render_update(node, config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 341, in render_update
    context = self.render_with_context(node, config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 238, in render_with_context
    get_rendered(parsed_node.raw_sql, context, parsed_node, capture_macros=True)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 564, in get_rendered
    template = get_template(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 521, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/opt/homebrew/Cellar/python@3.9/3.9.14/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 497, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model fact_reviews (models/fact/fact_reviews.sql)
  unexpected char "'" at 130
    line 9
      select * from {{ ref('src_reviews) }}



============================== 2022-10-13 14:11:43.533328 | 6c109150-ce92-4ce6-a97d-0706671b0ce8 ==============================
[0m14:11:43.533358 [info ] [MainThread]: Running with dbt=1.2.1
[0m14:11:43.534227 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:11:43.534417 [debug] [MainThread]: Tracking: tracking
[0m14:11:43.534847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090499a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090492b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109054c70>]}
[0m14:11:43.563637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:11:43.563891 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/fact/fact_reviews.sql
[0m14:11:43.570427 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m14:11:43.579737 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m14:11:43.584788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927e0d0>]}
[0m14:11:43.588836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109156f40>]}
[0m14:11:43.589064 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:11:43.589251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b0fa0>]}
[0m14:11:43.590002 [info ] [MainThread]: 
[0m14:11:43.590290 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:11:43.590808 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m14:11:43.597467 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m14:11:43.597642 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m14:11:43.597741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:44.369368 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m14:11:44.372049 [debug] [ThreadPool]: On list_airbnb: Close
[0m14:11:44.544079 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m14:11:44.553006 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m14:11:44.553299 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m14:11:44.553524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:45.255819 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.7 seconds
[0m14:11:45.268914 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m14:11:45.428522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b8be0>]}
[0m14:11:45.429414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:45.429981 [info ] [MainThread]: 
[0m14:11:45.436416 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m14:11:45.436765 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m14:11:45.437066 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m14:11:45.437625 [info ] [Thread-2  ]: 2 of 6 START view model dev.src_listings ....................................... [RUN]
[0m14:11:45.438159 [info ] [Thread-1  ]: 1 of 6 START view model dev.src_hosts .......................................... [RUN]
[0m14:11:45.438586 [info ] [Thread-3  ]: 3 of 6 START view model dev.src_reviews ........................................ [RUN]
[0m14:11:45.439285 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m14:11:45.439986 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m14:11:45.440625 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m14:11:45.440927 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m14:11:45.441140 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m14:11:45.441353 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m14:11:45.441583 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m14:11:45.441772 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m14:11:45.441955 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m14:11:45.444683 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m14:11:45.445790 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m14:11:45.447037 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m14:11:45.448138 [debug] [Thread-2  ]: finished collecting timing info
[0m14:11:45.448327 [debug] [Thread-1  ]: finished collecting timing info
[0m14:11:45.448486 [debug] [Thread-3  ]: finished collecting timing info
[0m14:11:45.448691 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m14:11:45.448870 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m14:11:45.449040 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m14:11:45.473680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m14:11:45.474134 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m14:11:45.476092 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m14:11:45.476942 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m14:11:45.477414 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m14:11:45.477554 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m14:11:45.477904 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m14:11:45.478022 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m14:11:45.478126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:45.478233 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m14:11:45.478327 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:11:45.478935 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:11:46.154497 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m14:11:46.176643 [debug] [Thread-2  ]: finished collecting timing info
[0m14:11:46.176995 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m14:11:46.185284 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m14:11:46.186763 [debug] [Thread-3  ]: finished collecting timing info
[0m14:11:46.186909 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m14:11:46.206171 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.73 seconds
[0m14:11:46.208795 [debug] [Thread-1  ]: finished collecting timing info
[0m14:11:46.209014 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m14:11:46.339727 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109505c10>]}
[0m14:11:46.340072 [info ] [Thread-3  ]: 3 of 6 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.90s]
[0m14:11:46.340372 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m14:11:46.340604 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m14:11:46.340751 [info ] [Thread-4  ]: 4 of 6 START incremental model dev.fact_reviews ................................ [RUN]
[0m14:11:46.341032 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m14:11:46.341136 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m14:11:46.341240 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m14:11:46.343283 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m14:11:46.343965 [debug] [Thread-4  ]: finished collecting timing info
[0m14:11:46.344084 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m14:11:46.344316 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109505e80>]}
[0m14:11:46.357563 [info ] [Thread-2  ]: 2 of 6 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.91s]
[0m14:11:46.363308 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m14:11:46.363487 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m14:11:46.363854 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m14:11:46.364016 [info ] [Thread-3  ]: 5 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m14:11:46.364344 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:11:46.364623 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:11:46.364743 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m14:11:46.364845 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

      );
[0m14:11:46.364954 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m14:11:46.365047 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:11:46.366444 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:11:46.367388 [debug] [Thread-3  ]: finished collecting timing info
[0m14:11:46.367543 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m14:11:46.373180 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:11:46.374349 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:11:46.374466 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m14:11:46.374560 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:11:46.549445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b8fa0>]}
[0m14:11:46.549954 [info ] [Thread-1  ]: 1 of 6 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.11s]
[0m14:11:46.550408 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m14:11:46.550802 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m14:11:46.551186 [info ] [Thread-2  ]: 6 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m14:11:46.551761 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:11:46.552016 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m14:11:46.552200 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m14:11:46.554577 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:11:46.556425 [debug] [Thread-2  ]: finished collecting timing info
[0m14:11:46.556612 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m14:11:46.558733 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:11:46.559379 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:11:46.559525 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m14:11:46.559665 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:11:48.454052 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.89 seconds
[0m14:11:48.465817 [debug] [Thread-2  ]: finished collecting timing info
[0m14:11:48.466198 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m14:11:48.587226 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.21 seconds
[0m14:11:48.592290 [debug] [Thread-3  ]: finished collecting timing info
[0m14:11:48.592676 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m14:11:48.625278 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb640a0>]}
[0m14:11:48.625935 [info ] [Thread-2  ]: 6 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 2.07s]
[0m14:11:48.626663 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m14:11:48.746651 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb38fa0>]}
[0m14:11:48.747298 [info ] [Thread-3  ]: 5 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 2.38s]
[0m14:11:48.747787 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m14:11:51.569333 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.2 seconds
[0m14:11:51.574903 [debug] [Thread-4  ]: finished collecting timing info
[0m14:11:51.575350 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m14:11:51.739673 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c109150-ce92-4ce6-a97d-0706671b0ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba92f70>]}
[0m14:11:51.740172 [info ] [Thread-4  ]: 4 of 6 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 1[0m in 5.40s]
[0m14:11:51.740475 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m14:11:51.741277 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:11:51.741532 [info ] [MainThread]: 
[0m14:11:51.741868 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 8.15 seconds (8.15s).
[0m14:11:51.742200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:51.742371 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m14:11:51.742539 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m14:11:51.742700 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m14:11:51.742860 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m14:11:51.749711 [info ] [MainThread]: 
[0m14:11:51.750149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:51.750563 [info ] [MainThread]: 
[0m14:11:51.750942 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:11:51.751362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109156a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109156880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109495130>]}
[0m14:11:51.751672 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 14:15:32.312347 | 2dbc56f7-5490-44a2-8724-ff24f231c486 ==============================
[0m14:15:32.312375 [info ] [MainThread]: Running with dbt=1.2.1
[0m14:15:32.313141 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:15:32.313287 [debug] [MainThread]: Tracking: tracking
[0m14:15:32.313555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105570c70>]}
[0m14:15:32.339767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:32.339964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:32.343655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105706fd0>]}
[0m14:15:32.348974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105664340>]}
[0m14:15:32.349252 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:15:32.349460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056643d0>]}
[0m14:15:32.350447 [info ] [MainThread]: 
[0m14:15:32.350785 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:15:32.353203 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m14:15:32.360785 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m14:15:32.360977 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m14:15:32.361083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:33.135287 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m14:15:33.137921 [debug] [ThreadPool]: On list_airbnb: Close
[0m14:15:33.299669 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m14:15:33.308993 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m14:15:33.309300 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m14:15:33.309523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:33.981801 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.67 seconds
[0m14:15:33.985222 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m14:15:34.139090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d06a0>]}
[0m14:15:34.139596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:34.139808 [info ] [MainThread]: 
[0m14:15:34.144279 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m14:15:34.144613 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m14:15:34.144896 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m14:15:34.145342 [info ] [Thread-2  ]: 2 of 6 START view model dev.src_listings ....................................... [RUN]
[0m14:15:34.145714 [info ] [Thread-1  ]: 1 of 6 START view model dev.src_hosts .......................................... [RUN]
[0m14:15:34.146059 [info ] [Thread-3  ]: 3 of 6 START view model dev.src_reviews ........................................ [RUN]
[0m14:15:34.146711 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m14:15:34.147263 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m14:15:34.147828 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m14:15:34.148064 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m14:15:34.148294 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m14:15:34.148517 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m14:15:34.148767 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m14:15:34.149038 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m14:15:34.149295 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m14:15:34.151135 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m14:15:34.152724 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m14:15:34.154136 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m14:15:34.154827 [debug] [Thread-1  ]: finished collecting timing info
[0m14:15:34.155000 [debug] [Thread-2  ]: finished collecting timing info
[0m14:15:34.155167 [debug] [Thread-3  ]: finished collecting timing info
[0m14:15:34.155373 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m14:15:34.155571 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m14:15:34.155761 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m14:15:34.179072 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m14:15:34.181524 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m14:15:34.183842 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m14:15:34.184977 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m14:15:34.185455 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m14:15:34.185836 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m14:15:34.185960 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m14:15:34.186117 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m14:15:34.186314 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m14:15:34.186471 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:15:34.186630 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:15:34.186766 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:15:34.821199 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m14:15:34.842672 [debug] [Thread-2  ]: finished collecting timing info
[0m14:15:34.843494 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m14:15:34.843779 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m14:15:34.845706 [debug] [Thread-1  ]: finished collecting timing info
[0m14:15:34.846722 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m14:15:34.851438 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m14:15:34.853250 [debug] [Thread-3  ]: finished collecting timing info
[0m14:15:34.853423 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m14:15:35.010818 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622a430>]}
[0m14:15:35.011701 [info ] [Thread-3  ]: 3 of 6 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.86s]
[0m14:15:35.012457 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m14:15:35.013059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d0b50>]}
[0m14:15:35.013718 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m14:15:35.014137 [info ] [Thread-1  ]: 1 of 6 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.87s]
[0m14:15:35.014538 [info ] [Thread-4  ]: 4 of 6 START incremental model dev.fact_reviews ................................ [RUN]
[0m14:15:35.015131 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m14:15:35.015753 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:35.016763 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m14:15:35.016976 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m14:15:35.017322 [info ] [Thread-3  ]: 5 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m14:15:35.017649 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m14:15:35.018193 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:15:35.025356 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m14:15:35.025810 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c1e80>]}
[0m14:15:35.028330 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m14:15:35.028461 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m14:15:35.028734 [info ] [Thread-2  ]: 2 of 6 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.88s]
[0m14:15:35.030729 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:15:35.031219 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m14:15:35.031503 [debug] [Thread-4  ]: finished collecting timing info
[0m14:15:35.031891 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m14:15:35.038374 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m14:15:35.038619 [info ] [Thread-1  ]: 6 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m14:15:35.039032 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:15:35.039190 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m14:15:35.039323 [debug] [Thread-3  ]: finished collecting timing info
[0m14:15:35.045759 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m14:15:35.058574 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:35.058769 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m14:15:35.060661 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:15:35.060823 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m14:15:35.066657 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:15:35.066909 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:15:35.067591 [debug] [Thread-1  ]: finished collecting timing info
[0m14:15:35.068218 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m14:15:35.068596 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:15:35.070265 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:15:35.070537 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m14:15:35.071058 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:15:35.071968 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:15:35.072100 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m14:15:35.072519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:15:36.339557 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.27 seconds
[0m14:15:36.345949 [debug] [Thread-1  ]: finished collecting timing info
[0m14:15:36.346795 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.28 seconds
[0m14:15:36.347092 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m14:15:36.349062 [debug] [Thread-3  ]: finished collecting timing info
[0m14:15:36.350005 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m14:15:36.391483 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.32 seconds
[0m14:15:36.399370 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:36.399593 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m14:15:36.500747 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m14:15:36.508309 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:36.510074 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m14:15:36.511962 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106601c40>]}
[0m14:15:36.512479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066320a0>]}
[0m14:15:36.513116 [info ] [Thread-3  ]: 5 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.49s]
[0m14:15:36.513580 [info ] [Thread-1  ]: 6 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.47s]
[0m14:15:36.514461 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m14:15:36.515102 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m14:15:36.612023 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m14:15:36.624595 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:36.624849 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m14:15:36.723041 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m14:15:36.725239 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:36.725382 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m14:15:36.864217 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.14 seconds
[0m14:15:36.874783 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:15:36.888105 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m14:15:36.889025 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:36.889785 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m14:15:37.015538 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m14:15:37.016031 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:37.016192 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m14:15:37.432803 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.42 seconds
[0m14:15:37.433956 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:15:37.434309 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m14:15:37.687334 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m14:15:37.689769 [debug] [Thread-4  ]: finished collecting timing info
[0m14:15:37.689987 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m14:15:37.858359 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbc56f7-5490-44a2-8724-ff24f231c486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623970>]}
[0m14:15:37.859159 [info ] [Thread-4  ]: 4 of 6 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 1[0m in 2.84s]
[0m14:15:37.859899 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m14:15:37.861472 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:15:37.862145 [info ] [MainThread]: 
[0m14:15:37.862677 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m14:15:37.863073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:37.863273 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m14:15:37.863463 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m14:15:37.863651 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m14:15:37.863839 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m14:15:37.870734 [info ] [MainThread]: 
[0m14:15:37.871113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:37.871473 [info ] [MainThread]: 
[0m14:15:37.871782 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:15:37.872175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066db070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105675e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623df40>]}
[0m14:15:37.872472 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 14:16:15.600178 | 21b2f92c-a4be-4ae0-b8de-588ac7aa773e ==============================
[0m14:16:15.600218 [info ] [MainThread]: Running with dbt=1.2.1
[0m14:16:15.600867 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:16:15.600976 [debug] [MainThread]: Tracking: tracking
[0m14:16:15.601253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ee05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ee0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ee0e80>]}
[0m14:16:15.625141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:15.625325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:15.628813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120850d0>]}
[0m14:16:15.632071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fcc1c0>]}
[0m14:16:15.632240 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:16:15.632413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ff670>]}
[0m14:16:15.633161 [info ] [MainThread]: 
[0m14:16:15.633412 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:16:15.633884 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m14:16:15.640820 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m14:16:15.640963 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m14:16:15.641061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:16.488613 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.85 seconds
[0m14:16:16.492271 [debug] [ThreadPool]: On list_airbnb: Close
[0m14:16:16.642973 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m14:16:16.652284 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m14:16:16.652577 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m14:16:16.652792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:17.319156 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.67 seconds
[0m14:16:17.322894 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m14:16:17.484363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112055fa0>]}
[0m14:16:17.485373 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:17.485937 [info ] [MainThread]: 
[0m14:16:17.491679 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m14:16:17.492041 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m14:16:17.492352 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m14:16:17.492871 [info ] [Thread-2  ]: 2 of 6 START view model dev.src_listings ....................................... [RUN]
[0m14:16:17.493209 [info ] [Thread-3  ]: 3 of 6 START view model dev.src_reviews ........................................ [RUN]
[0m14:16:17.493515 [info ] [Thread-1  ]: 1 of 6 START view model dev.src_hosts .......................................... [RUN]
[0m14:16:17.494183 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m14:16:17.494743 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m14:16:17.495263 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m14:16:17.495556 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m14:16:17.495777 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m14:16:17.496043 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m14:16:17.496266 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m14:16:17.496443 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m14:16:17.496612 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m14:16:17.498617 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m14:16:17.499996 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m14:16:17.501357 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m14:16:17.502067 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:17.502268 [debug] [Thread-3  ]: finished collecting timing info
[0m14:16:17.502459 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:17.502720 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m14:16:17.502929 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m14:16:17.503134 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m14:16:17.526353 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m14:16:17.528490 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m14:16:17.530619 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m14:16:17.531391 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m14:16:17.531770 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m14:16:17.532111 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m14:16:17.532214 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m14:16:17.532335 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m14:16:17.532446 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m14:16:17.532561 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:16:17.532679 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:16:17.532788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:16:18.653339 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.12 seconds
[0m14:16:18.655429 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.12 seconds
[0m14:16:18.662153 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.13 seconds
[0m14:16:18.682816 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:18.683956 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:18.685737 [debug] [Thread-3  ]: finished collecting timing info
[0m14:16:18.685934 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m14:16:18.686091 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m14:16:18.686234 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m14:16:18.847076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11243df10>]}
[0m14:16:18.847797 [info ] [Thread-2  ]: 2 of 6 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.35s]
[0m14:16:18.848528 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m14:16:18.849083 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m14:16:18.849530 [info ] [Thread-4  ]: 4 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m14:16:18.850183 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:16:18.850416 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m14:16:18.850639 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m14:16:18.853607 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:16:18.853987 [debug] [Thread-4  ]: finished collecting timing info
[0m14:16:18.854094 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m14:16:18.869697 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m14:16:18.870792 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m14:16:18.870987 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m14:16:18.871326 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c7790>]}
[0m14:16:18.871640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120559d0>]}
[0m14:16:18.871769 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:16:18.872047 [info ] [Thread-3  ]: 3 of 6 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.38s]
[0m14:16:18.872288 [info ] [Thread-1  ]: 1 of 6 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.38s]
[0m14:16:18.873625 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m14:16:18.873964 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m14:16:18.874331 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m14:16:18.874520 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m14:16:18.874713 [info ] [Thread-2  ]: 5 of 6 START incremental model dev.fact_reviews ................................ [RUN]
[0m14:16:18.874920 [info ] [Thread-1  ]: 6 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m14:16:18.875300 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m14:16:18.875678 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:16:18.875817 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m14:16:18.875961 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m14:16:18.876104 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m14:16:18.876241 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m14:16:18.882375 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m14:16:18.884162 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:16:18.885012 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:18.885160 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:18.885298 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m14:16:18.885438 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m14:16:18.902175 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m14:16:18.903849 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m14:16:18.904500 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:16:18.904853 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m14:16:18.904954 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

      );
[0m14:16:18.905069 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m14:16:18.905179 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:16:18.905290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:16:20.046855 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.18 seconds
[0m14:16:20.057775 [debug] [Thread-4  ]: finished collecting timing info
[0m14:16:20.058200 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m14:16:20.152206 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.25 seconds
[0m14:16:20.157063 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:20.157479 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m14:16:20.253746 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11235b340>]}
[0m14:16:20.254511 [info ] [Thread-4  ]: 4 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.40s]
[0m14:16:20.255255 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m14:16:20.320964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b3310>]}
[0m14:16:20.321692 [info ] [Thread-1  ]: 6 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.45s]
[0m14:16:20.322288 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m14:16:22.824484 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.92 seconds
[0m14:16:22.829135 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:22.829468 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m14:16:22.998189 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b2f92c-a4be-4ae0-b8de-588ac7aa773e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11238b250>]}
[0m14:16:22.998912 [info ] [Thread-2  ]: 5 of 6 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 1[0m in 4.12s]
[0m14:16:22.999376 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m14:16:23.000360 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:16:23.000704 [info ] [MainThread]: 
[0m14:16:23.001006 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m14:16:23.001282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:23.001425 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m14:16:23.001563 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m14:16:23.001700 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m14:16:23.001834 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m14:16:23.009015 [info ] [MainThread]: 
[0m14:16:23.009368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:23.009713 [info ] [MainThread]: 
[0m14:16:23.010019 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:16:23.010392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112354f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112055f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112424ac0>]}
[0m14:16:23.010645 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 18:46:34.132650 | 7abc0c5f-4839-469e-a9ea-7d8162d6fee1 ==============================
[0m18:46:34.132698 [info ] [MainThread]: Running with dbt=1.2.1
[0m18:46:34.133415 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:46:34.133537 [debug] [MainThread]: Tracking: tracking
[0m18:46:34.133777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890cd30>]}
[0m18:46:34.145165 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:46:34.145408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f13dc0>]}
[0m18:46:34.162432 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:46:34.163728 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:46:34.186471 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m18:46:34.188861 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:46:34.191540 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:46:34.192181 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:46:34.193960 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:46:34.198479 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:46:34.199002 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:46:34.199318 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:46:34.199735 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:46:34.200089 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:46:34.200355 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:46:34.202182 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:46:34.203241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:46:34.204007 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:46:34.212007 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:46:34.218873 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:46:34.224975 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:46:34.227066 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:46:34.227895 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:46:34.228720 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:46:34.230802 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:46:34.239351 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:46:34.240131 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:46:34.244504 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:46:34.251988 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:46:34.254544 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:46:34.255831 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:46:34.258370 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:46:34.258970 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:46:34.260510 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:46:34.261531 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:46:34.264759 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:46:34.273464 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:46:34.274152 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:46:34.275277 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:46:34.275994 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:46:34.276415 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:46:34.276798 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:46:34.277119 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:46:34.277758 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:46:34.279801 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:46:34.283733 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:46:34.284117 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:46:34.284706 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:46:34.285150 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:46:34.285590 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:46:34.286159 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:46:34.286533 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:46:34.287013 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:46:34.287523 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:46:34.288674 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:46:34.289244 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:46:34.289744 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:46:34.290233 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:46:34.290720 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:46:34.291151 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:46:34.291657 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:46:34.292084 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:46:34.294714 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:46:34.295158 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:46:34.295991 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:46:34.296938 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:46:34.297425 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:46:34.298516 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:46:34.299750 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:46:34.306705 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:46:34.308028 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:46:34.314274 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:46:34.316285 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:46:34.319552 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:46:34.324259 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:46:34.442645 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m18:46:34.448486 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m18:46:34.449806 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m18:46:34.451055 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m18:46:34.455004 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m18:46:34.455492 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m18:46:34.456675 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m18:46:34.457855 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m18:46:34.473634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b8ca0>]}
[0m18:46:34.477289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108965b20>]}
[0m18:46:34.477474 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:46:34.477661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892aa00>]}
[0m18:46:34.478390 [info ] [MainThread]: 
[0m18:46:34.478676 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:46:34.479220 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m18:46:34.485616 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m18:46:34.485762 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m18:46:34.485859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:35.412627 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.93 seconds
[0m18:46:35.414381 [debug] [ThreadPool]: On list_airbnb: Close
[0m18:46:35.582308 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m18:46:35.591425 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m18:46:35.591710 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m18:46:35.591930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:36.219437 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.63 seconds
[0m18:46:36.221128 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m18:46:36.413093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b8c70>]}
[0m18:46:36.413985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:36.414530 [info ] [MainThread]: 
[0m18:46:36.421243 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m18:46:36.421544 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m18:46:36.421760 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m18:46:36.422167 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m18:46:36.422472 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m18:46:36.422753 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m18:46:36.423358 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m18:46:36.423920 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m18:46:36.424370 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m18:46:36.424582 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m18:46:36.424890 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m18:46:36.425171 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m18:46:36.425395 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m18:46:36.425584 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m18:46:36.425762 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m18:46:36.427650 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m18:46:36.429119 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m18:46:36.430401 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m18:46:36.431948 [debug] [Thread-2  ]: finished collecting timing info
[0m18:46:36.432112 [debug] [Thread-3  ]: finished collecting timing info
[0m18:46:36.432290 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:36.432514 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m18:46:36.432709 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m18:46:36.432903 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m18:46:36.455368 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m18:46:36.457452 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m18:46:36.459332 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m18:46:36.460459 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m18:46:36.460890 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m18:46:36.461034 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m18:46:36.461217 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m18:46:36.461602 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m18:46:36.461799 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:46:36.461929 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:46:36.462047 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m18:46:36.463554 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:37.244023 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m18:46:37.256086 [debug] [Thread-3  ]: finished collecting timing info
[0m18:46:37.256301 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m18:46:37.342717 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.88 seconds
[0m18:46:37.344587 [debug] [Thread-2  ]: finished collecting timing info
[0m18:46:37.344778 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m18:46:37.378578 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.92 seconds
[0m18:46:37.380985 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:37.381178 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m18:46:37.440462 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d317c0>]}
[0m18:46:37.441457 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.02s]
[0m18:46:37.442037 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m18:46:37.442433 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m18:46:37.442697 [info ] [Thread-4  ]: 4 of 7 START incremental model dev.fact_reviews ................................ [RUN]
[0m18:46:37.443172 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:37.443631 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m18:46:37.444013 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m18:46:37.448954 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m18:46:37.451070 [debug] [Thread-4  ]: finished collecting timing info
[0m18:46:37.451257 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m18:46:37.476027 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:37.476200 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m18:46:37.476315 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:46:37.514452 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc2c10>]}
[0m18:46:37.514801 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.09s]
[0m18:46:37.515094 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m18:46:37.515325 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m18:46:37.515484 [info ] [Thread-3  ]: 5 of 7 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m18:46:37.515755 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:46:37.515860 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m18:46:37.515964 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m18:46:37.517586 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:46:37.518331 [debug] [Thread-3  ]: finished collecting timing info
[0m18:46:37.518452 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m18:46:37.524529 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:46:37.525299 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:46:37.525406 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m18:46:37.525503 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:46:37.556456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc2e50>]}
[0m18:46:37.556774 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.13s]
[0m18:46:37.557038 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m18:46:37.557241 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m18:46:37.557367 [info ] [Thread-2  ]: 6 of 7 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m18:46:37.557612 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:46:37.557711 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m18:46:37.557803 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m18:46:37.559651 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:46:37.560450 [debug] [Thread-2  ]: finished collecting timing info
[0m18:46:37.560583 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m18:46:37.561999 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:46:37.562437 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:46:37.562532 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m18:46:37.562620 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:46:39.391021 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.91 seconds
[0m18:46:39.403800 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:39.404055 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:46:39.506846 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m18:46:39.512415 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:39.512685 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m18:46:39.610631 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m18:46:39.629406 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:39.629720 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:46:39.695673 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.17 seconds
[0m18:46:39.705181 [debug] [Thread-3  ]: finished collecting timing info
[0m18:46:39.705449 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m18:46:39.716400 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.15 seconds
[0m18:46:39.719439 [debug] [Thread-2  ]: finished collecting timing info
[0m18:46:39.719656 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m18:46:39.721758 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m18:46:39.724856 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:39.725281 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m18:46:39.828500 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m18:46:39.840094 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:46:39.853528 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m18:46:39.854332 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:39.854496 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m18:46:39.920496 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ec6d0>]}
[0m18:46:39.920958 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bb9a0>]}
[0m18:46:39.921433 [info ] [Thread-3  ]: 5 of 7 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 2.40s]
[0m18:46:39.921775 [info ] [Thread-2  ]: 6 of 7 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 2.36s]
[0m18:46:39.922276 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m18:46:39.922677 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m18:46:39.923122 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m18:46:39.923377 [info ] [Thread-1  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m18:46:39.923854 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m18:46:39.924036 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m18:46:39.924215 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m18:46:39.927079 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m18:46:39.927642 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:39.927836 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m18:46:39.930116 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m18:46:39.931094 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m18:46:39.931257 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(i.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m18:46:39.931406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:40.047698 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m18:46:40.048021 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:40.048157 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m18:46:40.410439 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a79b26-3201-eb1e-0000-00015aae601d
[0m18:46:40.410921 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 11
invalid identifier 'I.UPDATED_AT'
[0m18:46:40.411449 [debug] [Thread-1  ]: finished collecting timing info
[0m18:46:40.411756 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m18:46:40.596239 [debug] [Thread-1  ]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  000904 (42000): SQL compilation error: error line 19 at position 11
  invalid identifier 'I.UPDATED_AT'
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_w_hosts.sql
[0m18:46:40.596708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f81280>]}
[0m18:46:40.597075 [error] [Thread-1  ]: 7 of 7 ERROR creating table model dev.dim_listings_w_hosts ..................... [[31mERROR[0m in 0.67s]
[0m18:46:40.597486 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m18:46:40.718318 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.67 seconds
[0m18:46:40.718636 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:46:40.718762 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m18:46:40.966735 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m18:46:40.969908 [debug] [Thread-4  ]: finished collecting timing info
[0m18:46:40.970126 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m18:46:41.136485 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7abc0c5f-4839-469e-a9ea-7d8162d6fee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e2760>]}
[0m18:46:41.137227 [info ] [Thread-4  ]: 4 of 7 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 3.69s]
[0m18:46:41.137928 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m18:46:41.139362 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:46:41.139926 [info ] [MainThread]: 
[0m18:46:41.140412 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m18:46:41.140856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:41.141089 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m18:46:41.141335 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m18:46:41.141562 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m18:46:41.141785 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m18:46:41.148846 [info ] [MainThread]: 
[0m18:46:41.149261 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:46:41.149607 [info ] [MainThread]: 
[0m18:46:41.149919 [error] [MainThread]: [33mDatabase Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)[0m
[0m18:46:41.150222 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 19 at position 11
[0m18:46:41.150512 [error] [MainThread]:   invalid identifier 'I.UPDATED_AT'
[0m18:46:41.150800 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_w_hosts.sql
[0m18:46:41.151102 [info ] [MainThread]: 
[0m18:46:41.151393 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:46:41.151760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f782b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dabdc0>]}
[0m18:46:41.152024 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 18:47:20.472576 | c201e4e3-455e-49d4-9b90-3420b0e5d5f3 ==============================
[0m18:47:20.472603 [info ] [MainThread]: Running with dbt=1.2.1
[0m18:47:20.473542 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:47:20.473708 [debug] [MainThread]: Tracking: tracking
[0m18:47:20.473970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eee9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eee5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eecc70>]}
[0m18:47:20.498499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:47:20.498808 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/dim/dim_listings_w_hosts.sql
[0m18:47:20.505865 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m18:47:20.517123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e30d0>]}
[0m18:47:20.520375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894ea00>]}
[0m18:47:20.520556 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:47:20.520741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893e760>]}
[0m18:47:20.521553 [info ] [MainThread]: 
[0m18:47:20.521837 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:47:20.522360 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m18:47:20.528866 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m18:47:20.529019 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m18:47:20.529114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:21.298684 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m18:47:21.299782 [debug] [ThreadPool]: On list_airbnb: Close
[0m18:47:21.481784 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m18:47:21.489247 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m18:47:21.489472 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m18:47:21.489636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:22.128738 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.64 seconds
[0m18:47:22.132633 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m18:47:22.342150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef5070>]}
[0m18:47:22.354069 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:22.354746 [info ] [MainThread]: 
[0m18:47:22.359820 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m18:47:22.359951 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m18:47:22.360126 [debug] [Thread-4  ]: Began running node model.learn_dbt.src_reviews
[0m18:47:22.360347 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m18:47:22.360515 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m18:47:22.360919 [info ] [Thread-4  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m18:47:22.361507 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m18:47:22.361812 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m18:47:22.362080 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m18:47:22.362211 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m18:47:22.362346 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m18:47:22.362463 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.src_reviews
[0m18:47:22.362587 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m18:47:22.362682 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m18:47:22.362773 [debug] [Thread-4  ]: Compiling model.learn_dbt.src_reviews
[0m18:47:22.364316 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m18:47:22.365545 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m18:47:22.367739 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m18:47:22.368393 [debug] [Thread-1  ]: finished collecting timing info
[0m18:47:22.368583 [debug] [Thread-2  ]: finished collecting timing info
[0m18:47:22.368722 [debug] [Thread-4  ]: finished collecting timing info
[0m18:47:22.368869 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m18:47:22.369036 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m18:47:22.369192 [debug] [Thread-4  ]: Began executing node model.learn_dbt.src_reviews
[0m18:47:22.392680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m18:47:22.394835 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m18:47:22.396701 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m18:47:22.397369 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m18:47:22.397794 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m18:47:22.398137 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m18:47:22.398237 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m18:47:22.398356 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m18:47:22.398470 [debug] [Thread-4  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m18:47:22.398596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:22.398746 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:47:22.398878 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:47:23.083153 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m18:47:23.097831 [debug] [Thread-4  ]: finished collecting timing info
[0m18:47:23.098622 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m18:47:23.098790 [debug] [Thread-4  ]: On model.learn_dbt.src_reviews: Close
[0m18:47:23.100291 [debug] [Thread-2  ]: finished collecting timing info
[0m18:47:23.101022 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m18:47:23.101550 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m18:47:23.103371 [debug] [Thread-1  ]: finished collecting timing info
[0m18:47:23.103744 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m18:47:23.257057 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96d7c0>]}
[0m18:47:23.257969 [info ] [Thread-4  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.89s]
[0m18:47:23.258420 [debug] [Thread-4  ]: Finished running node model.learn_dbt.src_reviews
[0m18:47:23.258989 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96dd60>]}
[0m18:47:23.259325 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.90s]
[0m18:47:23.260190 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m18:47:23.260525 [debug] [Thread-3  ]: Began running node model.learn_dbt.fact_reviews
[0m18:47:23.260785 [info ] [Thread-3  ]: 4 of 7 START incremental model dev.fact_reviews ................................ [RUN]
[0m18:47:23.260953 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m18:47:23.261329 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:23.261539 [info ] [Thread-4  ]: 5 of 7 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m18:47:23.261850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9370d0>]}
[0m18:47:23.262009 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.fact_reviews
[0m18:47:23.262367 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:47:23.262627 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.90s]
[0m18:47:23.262791 [debug] [Thread-3  ]: Compiling model.learn_dbt.fact_reviews
[0m18:47:23.262929 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m18:47:23.263234 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m18:47:23.269876 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m18:47:23.270034 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m18:47:23.270362 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m18:47:23.272056 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:47:23.272202 [debug] [Thread-3  ]: finished collecting timing info
[0m18:47:23.272406 [info ] [Thread-2  ]: 6 of 7 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m18:47:23.272614 [debug] [Thread-3  ]: Began executing node model.learn_dbt.fact_reviews
[0m18:47:23.272962 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:47:23.294345 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:23.294477 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m18:47:23.294617 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m18:47:23.294733 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m18:47:23.294818 [debug] [Thread-4  ]: finished collecting timing info
[0m18:47:23.294917 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:47:23.296088 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:47:23.296205 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m18:47:23.302406 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:47:23.302526 [debug] [Thread-2  ]: finished collecting timing info
[0m18:47:23.302836 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m18:47:23.304471 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:47:23.305115 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:47:23.305235 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m18:47:23.305347 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:47:23.305642 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:47:23.306027 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m18:47:23.306389 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:47:24.382848 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.09 seconds
[0m18:47:24.395219 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:24.395474 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:47:24.449073 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.14 seconds
[0m18:47:24.459220 [debug] [Thread-4  ]: finished collecting timing info
[0m18:47:24.459534 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m18:47:24.498117 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m18:47:24.503233 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:24.503493 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m18:47:24.586083 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.28 seconds
[0m18:47:24.591294 [debug] [Thread-2  ]: finished collecting timing info
[0m18:47:24.591744 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m18:47:24.594530 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m18:47:24.609933 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:24.610911 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:47:24.612316 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96d220>]}
[0m18:47:24.612734 [info ] [Thread-4  ]: 5 of 7 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.35s]
[0m18:47:24.613169 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m18:47:24.727170 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m18:47:24.729313 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:24.729439 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m18:47:24.771342 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f3a90>]}
[0m18:47:24.771782 [info ] [Thread-2  ]: 6 of 7 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.50s]
[0m18:47:24.772218 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m18:47:24.772581 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m18:47:24.772810 [info ] [Thread-1  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m18:47:24.773233 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m18:47:24.773405 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m18:47:24.773570 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m18:47:24.776039 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m18:47:24.776570 [debug] [Thread-1  ]: finished collecting timing info
[0m18:47:24.776743 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m18:47:24.778783 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m18:47:24.779684 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m18:47:24.779828 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m18:47:24.779963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:24.812325 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m18:47:24.819885 [debug] [Thread-3  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:47:24.829443 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m18:47:24.830192 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:24.830343 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m18:47:25.038170 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m18:47:25.050915 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:25.057363 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m18:47:25.267904 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.2 seconds
[0m18:47:25.268248 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:47:25.268353 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m18:47:25.411296 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m18:47:25.413390 [debug] [Thread-3  ]: finished collecting timing info
[0m18:47:25.413621 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: Close
[0m18:47:25.569178 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f82100>]}
[0m18:47:25.569694 [info ] [Thread-3  ]: 4 of 7 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.31s]
[0m18:47:25.570111 [debug] [Thread-3  ]: Finished running node model.learn_dbt.fact_reviews
[0m18:47:26.222683 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.44 seconds
[0m18:47:26.225430 [debug] [Thread-1  ]: finished collecting timing info
[0m18:47:26.225670 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m18:47:26.400091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c201e4e3-455e-49d4-9b90-3420b0e5d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f6fa0>]}
[0m18:47:26.400721 [info ] [Thread-1  ]: 7 of 7 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.63s]
[0m18:47:26.401127 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m18:47:26.402005 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:47:26.402349 [info ] [MainThread]: 
[0m18:47:26.402615 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m18:47:26.402859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:26.402977 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m18:47:26.403088 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m18:47:26.403198 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m18:47:26.403306 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m18:47:26.408431 [info ] [MainThread]: 
[0m18:47:26.408679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:26.408904 [info ] [MainThread]: 
[0m18:47:26.409094 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:47:26.409327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ca670>]}
[0m18:47:26.409491 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 18:49:12.881415 | 32dad828-0dd8-4e53-8963-4defdb45a944 ==============================
[0m18:49:12.881437 [info ] [MainThread]: Running with dbt=1.2.1
[0m18:49:12.882144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:49:12.882265 [debug] [MainThread]: Tracking: tracking
[0m18:49:12.882476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ff5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ff4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ff970>]}
[0m18:49:12.894357 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:49:12.894630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104811cd0>]}
[0m18:49:12.913766 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:49:12.915037 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:49:12.937836 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m18:49:12.939983 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:49:12.942775 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:49:12.943468 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:49:12.945256 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:49:12.949858 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:49:12.950380 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:49:12.950681 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:49:12.951011 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:49:12.951273 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:49:12.951502 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:49:12.953309 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:49:12.954406 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:49:12.955362 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:49:12.963986 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:49:12.971082 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:49:12.977588 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:49:12.979831 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:49:12.980815 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:49:12.981682 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:49:12.983797 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:49:12.992026 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:49:12.992958 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:49:12.997632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:49:13.005459 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:49:13.008142 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:49:13.009470 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:49:13.012002 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:49:13.012608 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:49:13.014255 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:49:13.015305 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:49:13.018594 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:49:13.027328 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:49:13.028024 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:49:13.029144 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:49:13.029854 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:49:13.030277 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:49:13.030657 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:49:13.030980 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:49:13.031607 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:49:13.033659 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:49:13.037710 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:49:13.038121 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:49:13.038712 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:49:13.039179 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:49:13.039630 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:49:13.040219 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:49:13.040601 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:49:13.041085 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:49:13.041606 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:49:13.042752 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:49:13.043328 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:49:13.043830 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:49:13.044328 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:49:13.044809 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:49:13.045243 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:49:13.045754 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:49:13.046188 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:49:13.048893 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:49:13.049337 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:49:13.050154 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:49:13.051111 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:49:13.051596 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:49:13.052610 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:49:13.053807 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:49:13.060662 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:49:13.061970 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:49:13.068206 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:49:13.070248 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:49:13.073524 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:49:13.078191 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:49:13.196514 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m18:49:13.202295 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m18:49:13.203621 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m18:49:13.204878 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m18:49:13.208894 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m18:49:13.209586 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m18:49:13.210987 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m18:49:13.212244 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m18:49:13.229110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053eef70>]}
[0m18:49:13.232195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d5850>]}
[0m18:49:13.232352 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:49:13.232535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051efc40>]}
[0m18:49:13.233268 [info ] [MainThread]: 
[0m18:49:13.233545 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:49:13.234004 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m18:49:13.240216 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m18:49:13.240428 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m18:49:13.240586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:14.054530 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.81 seconds
[0m18:49:14.056159 [debug] [ThreadPool]: On list_airbnb: Close
[0m18:49:14.247431 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m18:49:14.256493 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m18:49:14.256775 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m18:49:14.256995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:14.972252 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.72 seconds
[0m18:49:14.975545 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m18:49:15.217969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104800f40>]}
[0m18:49:15.218895 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:15.219444 [info ] [MainThread]: 
[0m18:49:15.226533 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m18:49:15.227058 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m18:49:15.227450 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m18:49:15.227646 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m18:49:15.228100 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m18:49:15.228396 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m18:49:15.228783 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m18:49:15.229009 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m18:49:15.229259 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m18:49:15.229468 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m18:49:15.229674 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m18:49:15.231526 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m18:49:15.231732 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m18:49:15.233026 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m18:49:15.234468 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m18:49:15.234905 [debug] [Thread-1  ]: finished collecting timing info
[0m18:49:15.235386 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m18:49:15.235897 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m18:49:15.236107 [debug] [Thread-2  ]: finished collecting timing info
[0m18:49:15.236264 [debug] [Thread-3  ]: finished collecting timing info
[0m18:49:15.236551 [info ] [Thread-4  ]: 1 of 4 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m18:49:15.236987 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m18:49:15.237329 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m18:49:15.237766 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:49:15.238112 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m18:49:15.238342 [debug] [Thread-3  ]: Began running node model.learn_dbt.fact_reviews
[0m18:49:15.238506 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m18:49:15.238738 [info ] [Thread-1  ]: 2 of 4 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m18:49:15.238970 [info ] [Thread-3  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m18:49:15.239144 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m18:49:15.239538 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:49:15.239959 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:15.248536 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:49:15.248829 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m18:49:15.249083 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.fact_reviews
[0m18:49:15.249423 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m18:49:15.249723 [debug] [Thread-3  ]: Compiling model.learn_dbt.fact_reviews
[0m18:49:15.255176 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:49:15.261153 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m18:49:15.261358 [debug] [Thread-4  ]: finished collecting timing info
[0m18:49:15.261679 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m18:49:15.272849 [debug] [Thread-1  ]: finished collecting timing info
[0m18:49:15.278600 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:49:15.278749 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m18:49:15.278858 [debug] [Thread-3  ]: finished collecting timing info
[0m18:49:15.280705 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:49:15.280895 [debug] [Thread-3  ]: Began executing node model.learn_dbt.fact_reviews
[0m18:49:15.312126 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:49:15.323969 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m18:49:15.324279 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:15.324369 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:49:15.324491 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m18:49:15.325567 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:49:15.326006 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:49:15.326193 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m18:49:15.326561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:16.575143 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.25 seconds
[0m18:49:16.601420 [debug] [Thread-4  ]: finished collecting timing info
[0m18:49:16.601688 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m18:49:16.686783 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.36 seconds
[0m18:49:16.697428 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:16.697703 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:49:16.750168 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.42 seconds
[0m18:49:16.753814 [debug] [Thread-1  ]: finished collecting timing info
[0m18:49:16.754117 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m18:49:16.766859 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057eb2e0>]}
[0m18:49:16.767301 [info ] [Thread-4  ]: 1 of 4 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.53s]
[0m18:49:16.767657 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m18:49:16.796075 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m18:49:16.800880 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:16.801136 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m18:49:16.888215 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m18:49:16.899318 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:16.899512 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:49:16.917814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569a640>]}
[0m18:49:16.918188 [info ] [Thread-1  ]: 2 of 4 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.68s]
[0m18:49:16.918548 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m18:49:16.918834 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m18:49:16.919019 [info ] [Thread-2  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m18:49:16.919350 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m18:49:16.919481 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m18:49:16.919610 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m18:49:16.921648 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m18:49:16.922086 [debug] [Thread-2  ]: finished collecting timing info
[0m18:49:16.922232 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m18:49:16.924094 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m18:49:16.924874 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m18:49:16.924991 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m18:49:16.925100 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:49:17.108178 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.21 seconds
[0m18:49:17.112314 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:17.112531 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m18:49:17.393390 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.28 seconds
[0m18:49:17.400371 [debug] [Thread-3  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:49:17.408228 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m18:49:17.408802 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:17.408909 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m18:49:17.628674 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m18:49:17.629050 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:17.629201 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m18:49:17.820997 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.19 seconds
[0m18:49:17.821593 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:49:17.821837 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m18:49:18.011235 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m18:49:18.015913 [debug] [Thread-3  ]: finished collecting timing info
[0m18:49:18.016309 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: Close
[0m18:49:18.268606 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105688a60>]}
[0m18:49:18.269434 [info ] [Thread-3  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 3.03s]
[0m18:49:18.270180 [debug] [Thread-3  ]: Finished running node model.learn_dbt.fact_reviews
[0m18:49:18.589770 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.66 seconds
[0m18:49:18.594311 [debug] [Thread-2  ]: finished collecting timing info
[0m18:49:18.594671 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m18:49:18.918777 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32dad828-0dd8-4e53-8963-4defdb45a944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105312100>]}
[0m18:49:18.919507 [info ] [Thread-2  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 2.00s]
[0m18:49:18.920033 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m18:49:18.921097 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:49:18.921529 [info ] [MainThread]: 
[0m18:49:18.921834 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m18:49:18.922090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:18.922216 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m18:49:18.922337 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m18:49:18.922469 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m18:49:18.922592 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m18:49:18.927961 [info ] [MainThread]: 
[0m18:49:18.928235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:18.928470 [info ] [MainThread]: 
[0m18:49:18.928680 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:49:18.928953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053785b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105378880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105688730>]}
[0m18:49:18.929150 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 18:54:34.145762 | a9be278c-c029-4439-89c4-b9324e4ffc40 ==============================
[0m18:54:34.145786 [info ] [MainThread]: Running with dbt=1.2.1
[0m18:54:34.146528 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:54:34.146648 [debug] [MainThread]: Tracking: tracking
[0m18:54:34.146847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6e9d0>]}
[0m18:54:34.173776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:34.173973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:34.177530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9be278c-c029-4439-89c4-b9324e4ffc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cedfa0>]}
[0m18:54:34.180767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9be278c-c029-4439-89c4-b9324e4ffc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4c400>]}
[0m18:54:34.180931 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:54:34.181115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9be278c-c029-4439-89c4-b9324e4ffc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041830d0>]}
[0m18:54:34.181890 [info ] [MainThread]: 
[0m18:54:34.182170 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:54:34.182641 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m18:54:34.189409 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m18:54:34.189586 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m18:54:34.189729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:35.021585 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.83 seconds
[0m18:54:35.022803 [debug] [ThreadPool]: On list_airbnb: Close
[0m18:54:35.181559 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m18:54:35.190389 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m18:54:35.190650 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m18:54:35.190837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:35.957869 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m18:54:35.961677 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m18:54:36.140187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9be278c-c029-4439-89c4-b9324e4ffc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4b610>]}
[0m18:54:36.141145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:36.141686 [info ] [MainThread]: 
[0m18:54:36.147232 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m18:54:36.147536 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m18:54:36.147817 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m18:54:36.148220 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m18:54:36.148639 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m18:54:36.149019 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m18:54:36.149252 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m18:54:36.149465 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m18:54:36.149705 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m18:54:36.149936 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m18:54:36.150121 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m18:54:36.150293 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m18:54:36.151943 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m18:54:36.153263 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m18:54:36.154536 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m18:54:36.155409 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:36.155631 [debug] [Thread-2  ]: finished collecting timing info
[0m18:54:36.156043 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m18:54:36.156192 [debug] [Thread-3  ]: finished collecting timing info
[0m18:54:36.156539 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m18:54:36.157051 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m18:54:36.157231 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m18:54:36.157546 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m18:54:36.157913 [info ] [Thread-4  ]: 1 of 4 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m18:54:36.158074 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m18:54:36.158289 [info ] [Thread-1  ]: 2 of 4 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m18:54:36.158715 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:54:36.158914 [info ] [Thread-2  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m18:54:36.159304 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:54:36.159464 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m18:54:36.159941 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:36.160110 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m18:54:36.160274 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m18:54:36.160433 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m18:54:36.160588 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m18:54:36.169981 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:54:36.170166 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m18:54:36.175091 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:54:36.183019 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m18:54:36.183365 [debug] [Thread-4  ]: finished collecting timing info
[0m18:54:36.183599 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m18:54:36.183759 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:36.189899 [debug] [Thread-2  ]: finished collecting timing info
[0m18:54:36.201080 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:54:36.201282 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m18:54:36.201433 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m18:54:36.203021 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:54:36.217818 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:36.218286 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:54:36.218435 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m18:54:36.218551 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m18:54:36.219137 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:54:36.219261 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:54:36.219379 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:54:36.219502 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m18:54:36.220757 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:36.876804 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a79b2e-3201-ea44-0000-00015aae2409
[0m18:54:36.877084 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SRC_LISTINGS' does not exist or not authorized.
[0m18:54:36.877384 [debug] [Thread-1  ]: finished collecting timing info
[0m18:54:36.877556 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m18:54:37.199283 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a79b2e-3201-ea44-0000-00015aae2411
[0m18:54:37.199888 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SRC_HOSTS' does not exist or not authorized.
[0m18:54:37.200508 [debug] [Thread-4  ]: finished collecting timing info
[0m18:54:37.200830 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m18:54:37.301241 [debug] [Thread-1  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'SRC_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m18:54:37.301735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9be278c-c029-4439-89c4-b9324e4ffc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a10a0>]}
[0m18:54:37.302131 [error] [Thread-1  ]: 2 of 4 ERROR creating table model dev.dim_listings_cleansed .................... [[31mERROR[0m in 1.14s]
[0m18:54:37.302564 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m18:54:37.366247 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m18:54:37.366652 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9be278c-c029-4439-89c4-b9324e4ffc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501bfa0>]}
[0m18:54:37.366981 [error] [Thread-4  ]: 1 of 4 ERROR creating table model dev.dim_hosts_cleansed ....................... [[31mERROR[0m in 1.21s]
[0m18:54:37.367389 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m18:54:37.367753 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m18:54:37.367933 [info ] [Thread-3  ]: 4 of 4 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m18:54:37.368273 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m18:54:37.680994 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.46 seconds
[0m18:54:37.692418 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:37.692729 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:54:37.807919 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m18:54:37.816995 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:37.817353 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m18:54:37.918649 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m18:54:37.931260 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:37.931559 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:54:38.051268 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m18:54:38.054723 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:38.054904 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m18:54:38.170636 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m18:54:38.179579 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:54:38.190337 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m18:54:38.191125 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:38.191277 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m18:54:38.309272 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m18:54:38.309748 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:38.309981 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m18:54:39.104773 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.79 seconds
[0m18:54:39.106175 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:54:39.106720 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m18:54:39.298132 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m18:54:39.322697 [debug] [Thread-2  ]: finished collecting timing info
[0m18:54:39.323051 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m18:54:39.513027 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9be278c-c029-4439-89c4-b9324e4ffc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff2d30>]}
[0m18:54:39.513809 [info ] [Thread-2  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 3.35s]
[0m18:54:39.514451 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m18:54:39.515577 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:54:39.515961 [info ] [MainThread]: 
[0m18:54:39.516310 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m18:54:39.516690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:39.516890 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m18:54:39.517078 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m18:54:39.517265 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m18:54:39.517450 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m18:54:39.524605 [info ] [MainThread]: 
[0m18:54:39.524873 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:54:39.525069 [info ] [MainThread]: 
[0m18:54:39.525237 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m18:54:39.525412 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m18:54:39.525569 [error] [MainThread]:   Object 'SRC_LISTINGS' does not exist or not authorized.
[0m18:54:39.525741 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m18:54:39.525900 [info ] [MainThread]: 
[0m18:54:39.526057 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m18:54:39.526211 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m18:54:39.526362 [error] [MainThread]:   Object 'SRC_HOSTS' does not exist or not authorized.
[0m18:54:39.526513 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m18:54:39.526671 [info ] [MainThread]: 
[0m18:54:39.526830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m18:54:39.527060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe1760>]}
[0m18:54:39.527236 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 18:59:00.076348 | cc70a681-059c-46d8-ba91-d0ac4f49252d ==============================
[0m18:59:00.076381 [info ] [MainThread]: Running with dbt=1.2.1
[0m18:59:00.077086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:59:00.077213 [debug] [MainThread]: Tracking: tracking
[0m18:59:00.077420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d02e20>]}
[0m18:59:00.103938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:59:00.104152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:59:00.108107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc70a681-059c-46d8-ba91-d0ac4f49252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e800d0>]}
[0m18:59:00.111936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc70a681-059c-46d8-ba91-d0ac4f49252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de5640>]}
[0m18:59:00.112189 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:59:00.112386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc70a681-059c-46d8-ba91-d0ac4f49252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de5760>]}
[0m18:59:00.113260 [info ] [MainThread]: 
[0m18:59:00.113590 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:59:00.114141 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m18:59:00.121345 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m18:59:00.121521 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m18:59:00.121623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:00.868038 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.75 seconds
[0m18:59:00.869416 [debug] [ThreadPool]: On list_airbnb: Close
[0m18:59:01.020264 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m18:59:01.025874 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m18:59:01.026043 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m18:59:01.026171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:01.781951 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.76 seconds
[0m18:59:01.785528 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m18:59:01.971044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc70a681-059c-46d8-ba91-d0ac4f49252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce29d0>]}
[0m18:59:01.972198 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:01.972780 [info ] [MainThread]: 
[0m18:59:01.978173 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m18:59:01.978482 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m18:59:01.978763 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m18:59:01.979281 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m18:59:01.979691 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m18:59:01.980044 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m18:59:01.980262 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m18:59:01.980479 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m18:59:01.980674 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m18:59:01.980920 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m18:59:01.981107 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m18:59:01.981288 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m18:59:01.983083 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m18:59:01.984427 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m18:59:01.985618 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m18:59:01.986765 [debug] [Thread-2  ]: finished collecting timing info
[0m18:59:01.986965 [debug] [Thread-1  ]: finished collecting timing info
[0m18:59:01.987113 [debug] [Thread-3  ]: finished collecting timing info
[0m18:59:01.987583 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m18:59:01.987951 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m18:59:01.988288 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m18:59:01.988619 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m18:59:01.988981 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m18:59:01.989330 [info ] [Thread-4  ]: 1 of 4 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m18:59:01.989450 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m18:59:01.989598 [info ] [Thread-3  ]: 2 of 4 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m18:59:01.989916 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:59:01.990030 [info ] [Thread-2  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m18:59:01.990266 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:59:01.990372 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m18:59:01.990596 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:01.990690 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m18:59:01.990860 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m18:59:01.991049 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m18:59:01.991279 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m18:59:02.002204 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:59:02.002471 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m18:59:02.006341 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:59:02.014360 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m18:59:02.014746 [debug] [Thread-4  ]: finished collecting timing info
[0m18:59:02.014970 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m18:59:02.020834 [debug] [Thread-3  ]: finished collecting timing info
[0m18:59:02.032790 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m18:59:02.032987 [debug] [Thread-2  ]: finished collecting timing info
[0m18:59:02.033105 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m18:59:02.033315 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m18:59:02.034957 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m18:59:02.049011 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m18:59:02.050281 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:02.050511 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
      );
[0m18:59:02.050658 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m18:59:02.050802 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:59:02.051284 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m18:59:02.051375 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:59:02.052464 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
      );
[0m18:59:02.053440 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:59:02.717850 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a79b33-3201-ea44-0000-00015aae2429
[0m18:59:02.718126 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SRC_LISTINGS' does not exist or not authorized.
[0m18:59:02.718394 [debug] [Thread-4  ]: finished collecting timing info
[0m18:59:02.718557 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m18:59:02.721849 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a79b33-3201-ec57-0000-00015aae508d
[0m18:59:02.722018 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SRC_HOSTS' does not exist or not authorized.
[0m18:59:02.722246 [debug] [Thread-3  ]: finished collecting timing info
[0m18:59:02.722570 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m18:59:02.930421 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.88 seconds
[0m18:59:02.942425 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:02.942723 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:59:03.041595 [debug] [Thread-3  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m18:59:03.042393 [debug] [Thread-4  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'SRC_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m18:59:03.042842 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc70a681-059c-46d8-ba91-d0ac4f49252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051afd00>]}
[0m18:59:03.043230 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc70a681-059c-46d8-ba91-d0ac4f49252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051af8e0>]}
[0m18:59:03.043844 [error] [Thread-3  ]: 2 of 4 ERROR creating table model dev.dim_hosts_cleansed ....................... [[31mERROR[0m in 1.05s]
[0m18:59:03.044331 [error] [Thread-4  ]: 1 of 4 ERROR creating table model dev.dim_listings_cleansed .................... [[31mERROR[0m in 1.05s]
[0m18:59:03.045040 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m18:59:03.045608 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m18:59:03.046301 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m18:59:03.046618 [info ] [Thread-1  ]: 4 of 4 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m18:59:03.047140 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m18:59:03.089900 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.15 seconds
[0m18:59:03.093940 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:03.094147 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m18:59:03.276584 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.18 seconds
[0m18:59:03.292855 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:03.293138 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m18:59:03.546879 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.25 seconds
[0m18:59:03.553076 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:03.553469 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m18:59:03.642683 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m18:59:03.654538 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:59:03.667400 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m18:59:03.668552 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:03.668764 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m18:59:03.790272 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m18:59:03.790716 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:03.790893 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m18:59:03.956590 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.17 seconds
[0m18:59:03.957014 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m18:59:03.957127 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m18:59:04.140647 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m18:59:04.166708 [debug] [Thread-2  ]: finished collecting timing info
[0m18:59:04.167103 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m18:59:04.443487 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc70a681-059c-46d8-ba91-d0ac4f49252d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105179490>]}
[0m18:59:04.444305 [info ] [Thread-2  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.45s]
[0m18:59:04.445093 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m18:59:04.446848 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m18:59:04.447541 [info ] [MainThread]: 
[0m18:59:04.448040 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m18:59:04.448423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:04.448629 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m18:59:04.448821 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m18:59:04.449012 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m18:59:04.449195 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m18:59:04.455929 [info ] [MainThread]: 
[0m18:59:04.456316 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:59:04.456672 [info ] [MainThread]: 
[0m18:59:04.456987 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m18:59:04.457290 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m18:59:04.457586 [error] [MainThread]:   Object 'SRC_HOSTS' does not exist or not authorized.
[0m18:59:04.457761 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m18:59:04.457914 [info ] [MainThread]: 
[0m18:59:04.458050 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m18:59:04.458200 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m18:59:04.458334 [error] [MainThread]:   Object 'SRC_LISTINGS' does not exist or not authorized.
[0m18:59:04.458507 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m18:59:04.458699 [info ] [MainThread]: 
[0m18:59:04.493190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m18:59:04.493693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105175760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526a1c0>]}
[0m18:59:04.494034 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:17:58.032324 | 6b5d7758-7c57-4290-9fe6-a73314433ec2 ==============================
[0m19:17:58.032344 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:17:58.033123 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:17:58.033244 [debug] [MainThread]: Tracking: tracking
[0m19:17:58.033464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b56b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b56be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b56ca0>]}
[0m19:17:58.044558 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:17:58.044810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f2700>]}
[0m19:17:58.063871 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:17:58.065615 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:17:58.088598 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m19:17:58.090740 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m19:17:58.093370 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m19:17:58.094070 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m19:17:58.095818 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m19:17:58.100379 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m19:17:58.100990 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:17:58.101332 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:17:58.101688 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:17:58.101960 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:17:58.102201 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m19:17:58.104094 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m19:17:58.105177 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m19:17:58.105956 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m19:17:58.114156 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m19:17:58.120581 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m19:17:58.126419 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m19:17:58.128478 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m19:17:58.129329 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m19:17:58.130142 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m19:17:58.132138 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m19:17:58.140311 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m19:17:58.141018 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m19:17:58.145398 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m19:17:58.152825 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m19:17:58.155373 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m19:17:58.156663 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m19:17:58.159242 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m19:17:58.159840 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m19:17:58.161375 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m19:17:58.162392 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m19:17:58.165616 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m19:17:58.174327 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m19:17:58.175008 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m19:17:58.176121 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m19:17:58.176821 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m19:17:58.177240 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m19:17:58.177618 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m19:17:58.177942 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m19:17:58.178613 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m19:17:58.180670 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m19:17:58.184593 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m19:17:58.184979 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m19:17:58.185549 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m19:17:58.186001 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:17:58.186445 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:17:58.187011 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m19:17:58.187389 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:17:58.187877 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:17:58.188406 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:17:58.189534 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:17:58.190107 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:17:58.190601 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m19:17:58.191094 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:17:58.191577 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:17:58.192025 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m19:17:58.192535 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m19:17:58.192960 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m19:17:58.195586 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:17:58.196030 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:17:58.196848 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:17:58.197799 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m19:17:58.198285 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m19:17:58.199304 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m19:17:58.200495 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m19:17:58.207386 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m19:17:58.208695 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:17:58.214889 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m19:17:58.216915 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m19:17:58.220252 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m19:17:58.224918 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m19:17:58.341069 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m19:17:58.346855 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m19:17:58.348233 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m19:17:58.349562 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m19:17:58.353555 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m19:17:58.354060 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m19:17:58.355224 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m19:17:58.356361 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m19:17:58.369792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtlearn.src
- models.dbtlearn.dim
- models.dbtlearn

[0m19:17:58.372259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c348b0>]}
[0m19:17:58.376015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba85b0>]}
[0m19:17:58.376224 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:17:58.376416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b56b50>]}
[0m19:17:58.377228 [info ] [MainThread]: 
[0m19:17:58.377555 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:17:58.378114 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:17:58.384442 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:17:58.384619 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:17:58.384713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:59.243832 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.86 seconds
[0m19:17:59.245656 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:17:59.422263 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:17:59.430322 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:17:59.430548 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:17:59.430734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:00.088148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.66 seconds
[0m19:18:00.092281 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:18:00.250162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34970>]}
[0m19:18:00.250984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:18:00.251515 [info ] [MainThread]: 
[0m19:18:00.258914 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:18:00.259223 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:18:00.259805 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:18:00.260156 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m19:18:00.260488 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m19:18:00.260775 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m19:18:00.261416 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:18:00.261886 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:18:00.262331 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:18:00.262534 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:18:00.262728 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:18:00.262904 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:18:00.263103 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:18:00.263273 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:18:00.263437 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:18:00.265193 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:18:00.266636 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:18:00.267918 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:18:00.269020 [debug] [Thread-3  ]: finished collecting timing info
[0m19:18:00.269171 [debug] [Thread-1  ]: finished collecting timing info
[0m19:18:00.269332 [debug] [Thread-2  ]: finished collecting timing info
[0m19:18:00.269509 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m19:18:00.269694 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m19:18:00.269862 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m19:18:00.292041 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m19:18:00.294216 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m19:18:00.296064 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m19:18:00.297235 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m19:18:00.297647 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m19:18:00.297991 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m19:18:00.298117 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m19:18:00.298245 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m19:18:00.298355 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m19:18:00.298468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:00.298582 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:18:00.298703 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:18:01.059606 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.76 seconds
[0m19:18:01.059986 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.76 seconds
[0m19:18:01.071701 [debug] [Thread-2  ]: finished collecting timing info
[0m19:18:01.073031 [debug] [Thread-3  ]: finished collecting timing info
[0m19:18:01.073428 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m19:18:01.073648 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m19:18:01.258956 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700be20>]}
[0m19:18:01.260136 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.00s]
[0m19:18:01.260926 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:18:01.262141 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m19:18:01.262638 [info ] [Thread-4  ]: 4 of 7 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:18:01.263483 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:01.264059 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b190>]}
[0m19:18:01.264300 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:18:01.264698 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.00s]
[0m19:18:01.264952 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m19:18:01.265421 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:18:01.272424 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:18:01.272778 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:18:01.273083 [info ] [Thread-3  ]: 5 of 7 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:18:01.273579 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:18:01.273766 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:18:01.273937 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:18:01.275251 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:18:01.275722 [debug] [Thread-4  ]: finished collecting timing info
[0m19:18:01.275858 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:18:01.282240 [debug] [Thread-3  ]: finished collecting timing info
[0m19:18:01.293877 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:18:01.303120 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:01.303453 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:18:01.307062 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m19:18:01.307220 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:18:01.308607 [debug] [Thread-1  ]: finished collecting timing info
[0m19:18:01.311781 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:18:01.311940 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:18:01.312074 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m19:18:01.312179 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m19:18:01.313613 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:18:01.513853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107158e50>]}
[0m19:18:01.520656 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.25s]
[0m19:18:01.527022 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:18:01.564433 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:18:01.596031 [info ] [Thread-2  ]: 6 of 7 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:18:01.608763 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:18:01.642235 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:18:01.655544 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:18:01.657090 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:18:01.657753 [debug] [Thread-2  ]: finished collecting timing info
[0m19:18:01.657940 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:18:01.659453 [debug] [Thread-2  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m19:18:01.660450 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:18:01.660546 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m19:18:01.660713 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:18:01.894441 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.58 seconds
[0m19:18:01.907725 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:18:01.923699 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:18:01.923819 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:18:02.148238 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m19:18:02.152980 [debug] [Thread-3  ]: finished collecting timing info
[0m19:18:02.153444 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:18:02.192726 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m19:18:02.195197 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:18:02.196277 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:18:02.196481 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:18:02.321816 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1ebb0>]}
[0m19:18:02.322351 [info ] [Thread-3  ]: 5 of 7 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m19:18:02.322750 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:18:02.396890 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m19:18:02.398570 [debug] [Thread-2  ]: finished collecting timing info
[0m19:18:02.398767 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:18:02.471918 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.16 seconds
[0m19:18:02.479410 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:02.479592 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:18:02.577624 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:18:02.581919 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:02.582138 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:18:02.637702 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fa6d0>]}
[0m19:18:02.638279 [info ] [Thread-2  ]: 6 of 7 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.03s]
[0m19:18:02.638961 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:18:02.639490 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:18:02.639841 [info ] [Thread-1  ]: 7 of 7 START view model dev.dim_listings_w_hosts ............................... [RUN]
[0m19:18:02.640503 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:18:02.640771 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:18:02.641011 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:18:02.644296 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:18:02.645609 [debug] [Thread-1  ]: finished collecting timing info
[0m19:18:02.645847 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:18:02.649832 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" because it is of type table
[0m19:18:02.651719 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:18:02.651901 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" cascade
[0m19:18:02.652074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:02.746132 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.16 seconds
[0m19:18:02.755993 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:02.756171 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:18:02.843483 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m19:18:02.846534 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:02.846730 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:18:03.023938 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.18 seconds
[0m19:18:03.030504 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:18:03.039248 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:18:03.040546 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:03.040682 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:18:03.142166 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m19:18:03.143603 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:18:03.144490 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:18:03.144631 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace  view airbnb.dev.dim_listings_w_hosts
  
   as (
    with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
  );
[0m19:18:03.148814 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m19:18:03.149092 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:03.149237 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:18:03.431479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m19:18:03.433293 [debug] [Thread-1  ]: finished collecting timing info
[0m19:18:03.433470 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:18:03.588938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107102d00>]}
[0m19:18:03.589574 [info ] [Thread-1  ]: 7 of 7 OK created view model dev.dim_listings_w_hosts .......................... [[32mSUCCESS 1[0m in 0.95s]
[0m19:18:03.590127 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:18:04.229387 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.08 seconds
[0m19:18:04.229859 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:18:04.230005 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:18:04.376851 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m19:18:04.382117 [debug] [Thread-4  ]: finished collecting timing info
[0m19:18:04.382310 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m19:18:04.548958 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5d7758-7c57-4290-9fe6-a73314433ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f08c10>]}
[0m19:18:04.549727 [info ] [Thread-4  ]: 4 of 7 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 3.29s]
[0m19:18:04.550349 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:18:04.551557 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:18:04.552007 [info ] [MainThread]: 
[0m19:18:04.552365 [info ] [MainThread]: Finished running 6 view models, 1 incremental model in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m19:18:04.552686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:04.552856 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:18:04.553017 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:18:04.553177 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:18:04.553333 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:18:04.559379 [info ] [MainThread]: 
[0m19:18:04.559684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:04.559989 [info ] [MainThread]: 
[0m19:18:04.560250 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:18:04.560571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c341c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c347c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107008fd0>]}
[0m19:18:04.560789 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:19:07.726951 | 70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8 ==============================
[0m19:19:07.726988 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:19:07.727938 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:19:07.728081 [debug] [MainThread]: Tracking: tracking
[0m19:19:07.728341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b82490>]}
[0m19:19:07.752882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:07.753060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:07.753340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtlearn.dim
- models.dbtlearn.src
- models.dbtlearn

[0m19:19:07.756724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d010d0>]}
[0m19:19:07.760087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c59610>]}
[0m19:19:07.760260 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:19:07.760439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c59730>]}
[0m19:19:07.762775 [info ] [MainThread]: 
[0m19:19:07.763079 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:19:07.765875 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:19:07.772368 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:19:07.772493 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:19:07.772590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:08.529178 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.76 seconds
[0m19:19:08.533051 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:19:08.735134 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:19:08.744144 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:19:08.744408 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:19:08.744600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:09.600674 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.86 seconds
[0m19:19:09.603302 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:19:09.773713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6a9a0>]}
[0m19:19:09.774653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:19:09.775201 [info ] [MainThread]: 
[0m19:19:09.781513 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:19:09.781804 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:19:09.782082 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:19:09.782419 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m19:19:09.782747 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m19:19:09.783042 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m19:19:09.783711 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:19:09.784233 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:19:09.784762 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:19:09.785004 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:19:09.785245 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:19:09.785466 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:19:09.785707 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:19:09.785922 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:19:09.786129 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:19:09.787979 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:19:09.789325 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:19:09.790725 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:19:09.791356 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:09.791709 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m19:19:09.803988 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:09.804125 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:09.814954 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m19:19:09.815194 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m19:19:09.815369 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m19:19:09.817579 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m19:19:09.819501 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m19:19:09.820039 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m19:19:09.820232 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m19:19:09.820592 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m19:19:09.820708 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:19:09.820842 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m19:19:09.821151 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m19:19:09.821731 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:19:09.822374 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m19:19:09.823402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:19:10.433994 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m19:19:10.457786 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:10.459923 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m19:19:10.660366 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d32e50>]}
[0m19:19:10.661019 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.88s]
[0m19:19:10.661774 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:19:10.662376 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:19:10.662750 [info ] [Thread-4  ]: 4 of 7 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:19:10.663448 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:19:10.663712 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:19:10.663981 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:19:10.667883 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:19:10.670377 [debug] [Thread-4  ]: finished collecting timing info
[0m19:19:10.670636 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:19:10.674257 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:19:10.675310 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:19:10.675510 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:19:10.675692 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:19:10.680195 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m19:19:10.682466 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:10.682702 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m19:19:10.686377 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m19:19:10.688472 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:10.688666 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m19:19:10.841414 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdc4f0>]}
[0m19:19:10.841863 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.06s]
[0m19:19:10.842274 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:19:10.842609 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m19:19:10.842812 [info ] [Thread-2  ]: 5 of 7 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:19:10.843204 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:10.843359 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:19:10.843511 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m19:19:10.851531 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:19:10.852068 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:10.852253 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:19:10.878976 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:10.884527 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:19:10.891040 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:19:10.939682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b82be0>]}
[0m19:19:10.946638 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.15s]
[0m19:19:10.952361 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:19:10.955195 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:19:10.955345 [info ] [Thread-3  ]: 6 of 7 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:19:10.955635 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:19:10.955728 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:19:10.955825 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:19:10.957273 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:19:10.957683 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:10.957789 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:19:10.959382 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:19:10.959902 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:19:10.960050 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:19:10.960214 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:19:11.551218 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.88 seconds
[0m19:19:11.555559 [debug] [Thread-4  ]: finished collecting timing info
[0m19:19:11.555917 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:19:11.671248 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m19:19:11.676301 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:11.676713 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:19:11.755505 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050eda30>]}
[0m19:19:11.756414 [info ] [Thread-4  ]: 4 of 7 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.09s]
[0m19:19:11.757217 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:19:11.821765 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m19:19:11.834067 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:11.834437 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:19:11.863698 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4cd0>]}
[0m19:19:11.864141 [info ] [Thread-3  ]: 6 of 7 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.91s]
[0m19:19:11.864538 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:19:11.864866 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:19:11.865067 [info ] [Thread-1  ]: 7 of 7 START view model dev.dim_listings_w_hosts ............................... [RUN]
[0m19:19:11.865446 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:19:11.865587 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:19:11.865747 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:19:11.868146 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:19:11.868704 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:11.868981 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:19:11.871525 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:19:11.872472 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:19:11.872638 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace  view airbnb.dev.dim_listings_w_hosts
  
   as (
    with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
  );
[0m19:19:11.872782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:19:11.968147 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.13 seconds
[0m19:19:11.970399 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:11.970541 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:19:12.072792 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:19:12.100987 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:12.119983 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:19:12.333916 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.21 seconds
[0m19:19:12.339278 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:12.340127 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:19:12.428849 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m19:19:12.440315 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:19:12.452754 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:19:12.453578 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:12.453762 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:19:12.589571 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m19:19:12.591511 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:12.591798 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:19:12.728647 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m19:19:12.732743 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:12.733119 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:19:12.795920 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.2 seconds
[0m19:19:12.797476 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:19:12.797911 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:19:12.989586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d4520>]}
[0m19:19:12.990410 [info ] [Thread-1  ]: 7 of 7 OK created view model dev.dim_listings_w_hosts .......................... [[32mSUCCESS 1[0m in 1.12s]
[0m19:19:12.991099 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:19:13.045897 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m19:19:13.052401 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:13.052721 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m19:19:13.286922 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ec8bbf-76a3-4eab-b2cb-cde1c3efdbd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051aff40>]}
[0m19:19:13.287732 [info ] [Thread-2  ]: 5 of 7 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.44s]
[0m19:19:13.288487 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:19:13.289985 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:19:13.290602 [info ] [MainThread]: 
[0m19:19:13.291121 [info ] [MainThread]: Finished running 6 view models, 1 incremental model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m19:19:13.291511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:13.291710 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:19:13.291901 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:19:13.292089 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:19:13.292278 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:19:13.300912 [info ] [MainThread]: 
[0m19:19:13.301284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:13.301636 [info ] [MainThread]: 
[0m19:19:13.301948 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:19:13.302322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d32c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051da850>]}
[0m19:19:13.302586 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:20:20.820843 | 52a64b21-de2e-4f8d-905b-bec592beb737 ==============================
[0m19:20:20.820887 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:20:20.823425 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:20:20.823576 [debug] [MainThread]: Tracking: tracking
[0m19:20:20.824219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fb820>]}
[0m19:20:20.837104 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:20:20.837409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d47940>]}
[0m19:20:20.851583 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:20:20.852887 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:20:20.875377 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m19:20:20.877412 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m19:20:20.879988 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m19:20:20.880673 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m19:20:20.882455 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m19:20:20.886871 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m19:20:20.887338 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:20:20.887636 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:20:20.887973 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:20:20.888247 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:20:20.888481 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m19:20:20.890240 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m19:20:20.891288 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m19:20:20.892056 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m19:20:20.900612 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m19:20:20.907356 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m19:20:20.913558 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m19:20:20.915676 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m19:20:20.916514 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m19:20:20.917341 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m19:20:20.919346 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m19:20:20.927657 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m19:20:20.928405 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m19:20:20.932799 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m19:20:20.940294 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m19:20:20.942928 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m19:20:20.944258 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m19:20:20.946808 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m19:20:20.947414 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m19:20:20.948950 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m19:20:20.949977 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m19:20:20.953249 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m19:20:20.961913 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m19:20:20.962592 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m19:20:20.963713 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m19:20:20.964428 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m19:20:20.964887 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m19:20:20.965297 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m19:20:20.965626 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m19:20:20.966252 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m19:20:20.968248 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m19:20:20.972160 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m19:20:20.972559 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m19:20:20.973118 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m19:20:20.973556 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:20:20.973985 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:20:20.974558 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m19:20:20.974929 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:20:20.975463 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:20:20.975980 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:20:20.977132 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:20:20.977714 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:20:20.978213 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m19:20:20.978713 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:20:20.979196 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:20:20.979631 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m19:20:20.980131 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m19:20:20.980560 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m19:20:20.983214 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:20:20.983649 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:20:20.984484 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:20:20.985487 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m19:20:20.985973 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m19:20:20.987002 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m19:20:20.988192 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m19:20:20.994993 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m19:20:20.996298 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:20:21.002469 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m19:20:21.004477 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m19:20:21.007744 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m19:20:21.012448 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m19:20:21.130548 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m19:20:21.136456 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m19:20:21.137925 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m19:20:21.139219 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m19:20:21.143164 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m19:20:21.143676 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m19:20:21.144904 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m19:20:21.146115 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m19:20:21.161738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068346d0>]}
[0m19:20:21.164867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674c5b0>]}
[0m19:20:21.165029 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:20:21.165211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fb0a0>]}
[0m19:20:21.165949 [info ] [MainThread]: 
[0m19:20:21.166207 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:20:21.166637 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:20:21.172707 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:20:21.172835 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:20:21.172930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:21.949107 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.78 seconds
[0m19:20:21.951716 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:20:22.138536 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:20:22.147651 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:20:22.147928 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:20:22.148160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:22.711382 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.56 seconds
[0m19:20:22.715212 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:20:22.880723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c0790>]}
[0m19:20:22.881617 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:22.882146 [info ] [MainThread]: 
[0m19:20:22.888551 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:20:22.889060 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:20:22.889268 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:20:22.889751 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:20:22.890222 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:20:22.890612 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:20:22.890891 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:20:22.891130 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:20:22.891350 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:20:22.891629 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:20:22.891980 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:20:22.892260 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:20:22.894050 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:20:22.895440 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:20:22.896728 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:20:22.897475 [debug] [Thread-1  ]: finished collecting timing info
[0m19:20:22.897684 [debug] [Thread-2  ]: finished collecting timing info
[0m19:20:22.897862 [debug] [Thread-3  ]: finished collecting timing info
[0m19:20:22.898301 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:20:22.898661 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:20:22.898987 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:20:22.899500 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:20:22.900054 [info ] [Thread-2  ]: 1 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:20:22.900285 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:20:22.900447 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m19:20:22.900844 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:20:22.901066 [info ] [Thread-1  ]: 2 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:20:22.901324 [info ] [Thread-4  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:20:22.901496 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:20:22.901900 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:20:22.902369 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:22.902556 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:20:22.902798 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:20:22.902974 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:20:22.911361 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:20:22.911576 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:20:22.911722 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m19:20:22.917011 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:20:22.923171 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:20:22.923376 [debug] [Thread-2  ]: finished collecting timing info
[0m19:20:22.923666 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:20:22.929963 [debug] [Thread-4  ]: finished collecting timing info
[0m19:20:22.930099 [debug] [Thread-1  ]: finished collecting timing info
[0m19:20:22.941525 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:20:22.941775 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:20:22.941917 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:20:22.988817 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:22.989311 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:20:22.990913 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:20:22.991036 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:20:22.991140 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:20:22.991279 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:20:22.991393 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:20:22.992133 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:20:22.993418 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:20:22.993565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:23.863461 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.87 seconds
[0m19:20:23.886224 [debug] [Thread-1  ]: finished collecting timing info
[0m19:20:23.886904 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:20:24.139136 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.15 seconds
[0m19:20:24.144514 [debug] [Thread-2  ]: finished collecting timing info
[0m19:20:24.144905 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:20:24.272881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690ad90>]}
[0m19:20:24.273328 [info ] [Thread-1  ]: 2 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.37s]
[0m19:20:24.273724 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:20:24.325872 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d27190>]}
[0m19:20:24.326300 [info ] [Thread-2  ]: 1 of 4 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.43s]
[0m19:20:24.326696 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:20:24.327028 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:20:24.327232 [info ] [Thread-3  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m19:20:24.327605 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:20:24.327752 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:20:24.327894 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:20:24.330219 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:20:24.330708 [debug] [Thread-3  ]: finished collecting timing info
[0m19:20:24.330859 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:20:24.338152 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" because it is of type view
[0m19:20:24.342153 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:20:24.342307 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" cascade
[0m19:20:24.342423 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:20:24.395408 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.4 seconds
[0m19:20:24.401387 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:24.401622 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:20:24.583379 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.18 seconds
[0m19:20:24.588767 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:24.589091 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:20:24.771387 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.18 seconds
[0m19:20:24.782229 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:24.782544 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:20:24.873761 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m19:20:24.877223 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:24.877457 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:20:24.899267 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m19:20:24.900993 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:20:24.902317 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:20:24.902521 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m19:20:25.066632 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m19:20:25.080583 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:20:25.092971 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:20:25.093970 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:25.094158 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:20:25.376959 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m19:20:25.377766 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:25.378249 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:20:25.777171 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.4 seconds
[0m19:20:25.778294 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:20:25.778682 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:20:25.923574 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.02 seconds
[0m19:20:25.931290 [debug] [Thread-3  ]: finished collecting timing info
[0m19:20:25.931468 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:20:25.938965 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m19:20:25.940247 [debug] [Thread-4  ]: finished collecting timing info
[0m19:20:25.940364 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m19:20:26.103313 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc2880>]}
[0m19:20:26.104040 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a64b21-de2e-4f8d-905b-bec592beb737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0ddf0>]}
[0m19:20:26.104749 [info ] [Thread-3  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.78s]
[0m19:20:26.105236 [info ] [Thread-4  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 3.20s]
[0m19:20:26.105956 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:20:26.106544 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:20:26.108107 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:20:26.108602 [info ] [MainThread]: 
[0m19:20:26.109009 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m19:20:26.109374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:26.109570 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:20:26.109757 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:20:26.109942 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:20:26.110126 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:20:26.118492 [info ] [MainThread]: 
[0m19:20:26.118879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:26.119232 [info ] [MainThread]: 
[0m19:20:26.119516 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:20:26.119845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d27190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b0c70>]}
[0m19:20:26.120070 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:20:59.245841 | f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41 ==============================
[0m19:20:59.245881 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:20:59.246487 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:20:59.246604 [debug] [MainThread]: Tracking: tracking
[0m19:20:59.246807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129eba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ebeb0>]}
[0m19:20:59.271527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:59.271706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:59.275229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b550d0>]}
[0m19:20:59.278897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa2220>]}
[0m19:20:59.279109 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:20:59.279287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fe670>]}
[0m19:20:59.280028 [info ] [MainThread]: 
[0m19:20:59.280302 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:20:59.280770 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:20:59.287479 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:20:59.287639 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:20:59.287732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:59.994998 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.71 seconds
[0m19:20:59.997804 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:21:00.236254 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:21:00.245365 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:21:00.245646 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:21:00.245865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:00.982536 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.74 seconds
[0m19:21:00.985375 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:21:01.283150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b55070>]}
[0m19:21:01.283803 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:21:01.284352 [info ] [MainThread]: 
[0m19:21:01.290429 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:21:01.290748 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:21:01.291021 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:21:01.291429 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:21:01.291824 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:21:01.292244 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:21:01.292493 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:21:01.292738 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:21:01.292964 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:21:01.293209 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:21:01.293424 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:21:01.293636 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:21:01.295603 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:21:01.297018 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:21:01.298320 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:21:01.298995 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:01.299195 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:01.299358 [debug] [Thread-3  ]: finished collecting timing info
[0m19:21:01.299798 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:21:01.300224 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:21:01.300599 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:21:01.300982 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:21:01.301538 [info ] [Thread-2  ]: 1 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:21:01.301754 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:21:01.302054 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m19:21:01.302374 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:01.302608 [info ] [Thread-1  ]: 2 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:21:01.302837 [info ] [Thread-4  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:21:01.303006 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:21:01.303431 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:21:01.303818 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:01.303980 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:21:01.304138 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:21:01.304296 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:21:01.314266 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:01.314445 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:21:01.314592 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m19:21:01.319796 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:21:01.327035 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:21:01.327407 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:01.327616 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:21:01.327782 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:01.339855 [debug] [Thread-4  ]: finished collecting timing info
[0m19:21:01.346019 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:01.346204 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:21:01.346342 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:21:01.348113 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:21:01.366590 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:21:01.367124 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:01.367342 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:21:01.367910 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:21:01.368015 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:21:01.368131 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:21:01.368539 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:01.369362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:21:01.369466 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

      );
[0m19:21:01.369820 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:21:02.232498 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m19:21:02.240782 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.87 seconds
[0m19:21:02.255157 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:02.256983 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:02.257208 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:21:02.257371 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:21:02.488921 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb9550>]}
[0m19:21:02.489585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f695e0>]}
[0m19:21:02.490307 [info ] [Thread-2  ]: 1 of 4 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.19s]
[0m19:21:02.490797 [info ] [Thread-1  ]: 2 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.19s]
[0m19:21:02.491503 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:21:02.492010 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:21:02.492580 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:21:02.492910 [info ] [Thread-3  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m19:21:02.493489 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:21:02.493722 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:21:02.493950 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:21:02.498394 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:21:02.499160 [debug] [Thread-3  ]: finished collecting timing info
[0m19:21:02.499398 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:21:02.509143 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:21:02.510179 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:21:02.510352 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m19:21:02.510507 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:21:04.039427 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.53 seconds
[0m19:21:04.051719 [debug] [Thread-3  ]: finished collecting timing info
[0m19:21:04.052102 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:21:04.237804 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa2370>]}
[0m19:21:04.238722 [info ] [Thread-3  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.74s]
[0m19:21:04.239502 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:21:05.776043 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.41 seconds
[0m19:21:05.781911 [debug] [Thread-4  ]: finished collecting timing info
[0m19:21:05.782355 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m19:21:05.949688 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7fc2b94-8a25-45cc-8def-b4aa7cd4ca41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113079610>]}
[0m19:21:05.950816 [info ] [Thread-4  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 1[0m in 4.65s]
[0m19:21:05.951623 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:21:05.953223 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:21:05.953789 [info ] [MainThread]: 
[0m19:21:05.954234 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m19:21:05.954621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:05.954822 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:21:05.955011 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:21:05.955204 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:21:05.955392 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:21:05.962574 [info ] [MainThread]: 
[0m19:21:05.962961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:21:05.963316 [info ] [MainThread]: 
[0m19:21:05.963621 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:21:05.964006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b22eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fe670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133678e0>]}
[0m19:21:05.964288 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:21:51.968386 | dfb74581-fff6-4d85-81a4-999d98cf59a7 ==============================
[0m19:21:51.968408 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:21:51.969243 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:21:51.969384 [debug] [MainThread]: Tracking: tracking
[0m19:21:51.969607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055419d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105562e20>]}
[0m19:21:51.995432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:51.995616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:51.999139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfb74581-fff6-4d85-81a4-999d98cf59a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e10d0>]}
[0m19:21:52.002883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfb74581-fff6-4d85-81a4-999d98cf59a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105630640>]}
[0m19:21:52.003111 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:21:52.003304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb74581-fff6-4d85-81a4-999d98cf59a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105630760>]}
[0m19:21:52.004061 [info ] [MainThread]: 
[0m19:21:52.004357 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:21:52.004871 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:21:52.011562 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:21:52.011731 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:21:52.011832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:52.820855 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.81 seconds
[0m19:21:52.824062 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:21:53.027109 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:21:53.035759 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:21:53.036037 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:21:53.036247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:53.567744 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
[0m19:21:53.571109 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:21:53.810451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb74581-fff6-4d85-81a4-999d98cf59a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055419d0>]}
[0m19:21:53.811377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:21:53.811964 [info ] [MainThread]: 
[0m19:21:53.818052 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:21:53.818424 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:21:53.818675 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:21:53.819129 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:21:53.819560 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:21:53.819957 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:21:53.820214 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:21:53.820449 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:21:53.820675 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:21:53.820936 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:21:53.821156 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:21:53.821369 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:21:53.823385 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:21:53.824776 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:21:53.826099 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:21:53.826728 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:53.826955 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:53.827448 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:21:53.827670 [debug] [Thread-3  ]: finished collecting timing info
[0m19:21:53.828046 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:21:53.828474 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:21:53.828868 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:21:53.829301 [info ] [Thread-4  ]: 1 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:21:53.829548 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:21:53.830186 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:21:53.830359 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m19:21:53.830586 [info ] [Thread-2  ]: 2 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:21:53.830792 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:21:53.831012 [info ] [Thread-1  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:21:53.831452 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:53.831766 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:21:53.832327 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:53.832540 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:21:53.843803 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:21:53.844044 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:21:53.844202 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:21:53.844410 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m19:21:53.848164 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:53.854680 [debug] [Thread-4  ]: finished collecting timing info
[0m19:21:53.856507 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:21:53.856793 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:21:53.869428 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:53.875714 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:21:53.875916 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:21:53.876032 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:53.877963 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:53.878139 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:21:53.878809 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:21:53.897663 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:21:53.898120 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:53.898263 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:21:53.898386 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:21:53.898515 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:21:53.898638 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:21:53.898748 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:21:53.898852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:21:54.543584 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a79b49-3201-ec57-0000-00015aae5105
[0m19:21:54.544828 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:21:54.545391 [debug] [Thread-4  ]: finished collecting timing info
[0m19:21:54.545670 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:21:54.660542 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79b49-3201-ec57-0000-00015aae510d
[0m19:21:54.661256 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:21:54.661963 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:54.662356 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:21:54.758889 [debug] [Thread-4  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:21:54.759547 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb74581-fff6-4d85-81a4-999d98cf59a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7b4c0>]}
[0m19:21:54.760161 [error] [Thread-4  ]: 1 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 0.93s]
[0m19:21:54.760968 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:21:54.863520 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.96 seconds
[0m19:21:54.874231 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:54.874466 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:21:54.899540 [debug] [Thread-2  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:21:54.899941 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb74581-fff6-4d85-81a4-999d98cf59a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcb070>]}
[0m19:21:54.900353 [error] [Thread-2  ]: 2 of 4 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 1.07s]
[0m19:21:54.900857 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:21:54.901304 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:21:54.901584 [info ] [Thread-3  ]: 4 of 4 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m19:21:54.901969 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:21:54.973120 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:21:54.977198 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:54.977386 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:21:55.078201 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:21:55.086107 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:55.086250 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:21:55.176960 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m19:21:55.179696 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:55.179871 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:21:55.280865 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:21:55.291490 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:21:55.303184 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:21:55.303977 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:55.304153 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:21:55.442091 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m19:21:55.443167 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:55.443612 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:21:55.603987 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.16 seconds
[0m19:21:55.604440 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:21:55.604594 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:21:55.804771 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m19:21:55.832380 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:55.832820 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: Close
[0m19:21:55.996938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb74581-fff6-4d85-81a4-999d98cf59a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc6cd0>]}
[0m19:21:55.997793 [info ] [Thread-1  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.16s]
[0m19:21:55.998534 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:21:56.000229 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:21:56.000904 [info ] [MainThread]: 
[0m19:21:56.001479 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m19:21:56.002013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:56.002300 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:21:56.002564 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:21:56.002821 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m19:21:56.003086 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:21:56.010090 [info ] [MainThread]: 
[0m19:21:56.010545 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:21:56.010912 [info ] [MainThread]: 
[0m19:21:56.011246 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m19:21:56.011575 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:21:56.011896 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:21:56.012213 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:21:56.012534 [info ] [MainThread]: 
[0m19:21:56.012854 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m19:21:56.013174 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:21:56.013490 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:21:56.013805 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:21:56.040672 [info ] [MainThread]: 
[0m19:21:56.041267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m19:21:56.041800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ae4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059beca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb9f70>]}
[0m19:21:56.042253 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:27:54.659572 | f6eba65d-4f82-42c4-804e-969697a293d3 ==============================
[0m19:27:54.659609 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:27:54.660782 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:27:54.660933 [debug] [MainThread]: Tracking: tracking
[0m19:27:54.661447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864aeb0>]}
[0m19:27:54.694464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:27:54.694853 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/schema.yml
[0m19:27:54.701929 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_reviews' in the 'models' section of file 'models/schema.yml'
[0m19:27:54.756471 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' (models/schema.yml) depends on a source named 'airbnb.listings' which was not found
[0m19:27:54.756761 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.learn_dbt.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' (models/schema.yml) depends on a node named 'fct_reviews' which was not found
[0m19:27:54.756930 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.learn_dbt.not_null_fct_reviews_reviewer_name.8204e43c88' (models/schema.yml) depends on a node named 'fct_reviews' which was not found
[0m19:27:54.757084 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.learn_dbt.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef' (models/schema.yml) depends on a node named 'fct_reviews' which was not found
[0m19:27:54.761529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cb8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cbd90>]}
[0m19:27:54.761712 [debug] [MainThread]: Flushing usage events
[0m19:27:55.308082 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  Documentation for 'model.learn_dbt.dim_listings_cleansed' depends on doc 'dim_listing_cleansed__minimum_nights'  which was not found
[0m19:27:55.311765 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 451, in run
    self._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 392, in load
    self.process_docs(self.root_project)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 869, in process_docs
    _process_docs_for_node(ctx, node)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 1037, in _process_docs_for_node
    column.description = get_rendered(column.description, context)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 571, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/jinja.py", line 526, in render_template
    return template.render(ctx)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/context/docs.py", line 72, in doc
    doc_target_not_found(self.node, doc_name, doc_package_name)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/exceptions.py", line 570, in doc_target_not_found
    raise_compiler_error(msg, model)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  Documentation for 'model.learn_dbt.dim_listings_cleansed' depends on doc 'dim_listing_cleansed__minimum_nights'  which was not found



============================== 2022-10-13 19:29:29.610689 | 4dbb4057-fd48-408c-becf-12c12e7f542b ==============================
[0m19:29:29.610707 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:29:29.611333 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:29:29.611445 [debug] [MainThread]: Tracking: tracking
[0m19:29:29.611655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676aeb0>]}
[0m19:29:29.639728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:29:29.640004 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/schema.yml
[0m19:29:29.650064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dbb4057-fd48-408c-becf-12c12e7f542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068df0d0>]}
[0m19:29:29.653673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dbb4057-fd48-408c-becf-12c12e7f542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688eee0>]}
[0m19:29:29.653870 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:29:29.654056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dbb4057-fd48-408c-becf-12c12e7f542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525ba60>]}
[0m19:29:29.654853 [info ] [MainThread]: 
[0m19:29:29.655149 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:29:29.655621 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:29:29.662003 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:29:29.662166 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:29:29.662257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:30.598170 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.94 seconds
[0m19:29:30.600848 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:29:30.767732 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:29:30.776741 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:29:30.776993 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:29:30.777179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:31.586764 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.81 seconds
[0m19:29:31.590937 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:29:31.788366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dbb4057-fd48-408c-becf-12c12e7f542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688ed60>]}
[0m19:29:31.789203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:29:31.789770 [info ] [MainThread]: 
[0m19:29:31.795684 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:29:31.796000 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:29:31.796282 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:29:31.796675 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:29:31.797065 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:29:31.797437 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:29:31.797680 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:29:31.797912 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:29:31.798121 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:29:31.798354 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:29:31.798558 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:29:31.798755 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:29:31.800466 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:29:31.801777 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:29:31.803053 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:29:31.804136 [debug] [Thread-2  ]: finished collecting timing info
[0m19:29:31.804327 [debug] [Thread-3  ]: finished collecting timing info
[0m19:29:31.804509 [debug] [Thread-1  ]: finished collecting timing info
[0m19:29:31.804954 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:29:31.805344 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:29:31.805715 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:29:31.806223 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:29:31.806452 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m19:29:31.806880 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:29:31.807140 [info ] [Thread-4  ]: 1 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:29:31.807383 [info ] [Thread-2  ]: 2 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:29:31.807613 [info ] [Thread-1  ]: 3 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:29:31.808066 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:29:31.808530 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:31.808920 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:29:31.809086 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:29:31.809249 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:29:31.809406 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:29:31.809569 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:29:31.809719 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m19:29:31.809869 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:29:31.822557 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:29:31.830985 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:29:31.834382 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:29:31.835187 [debug] [Thread-2  ]: finished collecting timing info
[0m19:29:31.835315 [debug] [Thread-1  ]: finished collecting timing info
[0m19:29:31.835415 [debug] [Thread-4  ]: finished collecting timing info
[0m19:29:31.835532 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:29:31.835653 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:29:31.835765 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:29:31.866428 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:31.871768 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:29:31.873485 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:29:31.873600 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:29:31.873828 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:29:31.875149 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:29:31.875729 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:29:31.875812 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:29:31.875996 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:29:31.876084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:31.876175 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:29:32.612170 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a79b51-3201-ec57-0000-00015aae5121
[0m19:29:32.612584 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:29:32.613104 [debug] [Thread-1  ]: finished collecting timing info
[0m19:29:32.613360 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:29:32.722996 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a79b51-3201-eb1e-0000-00015aae6101
[0m19:29:32.723418 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:29:32.723908 [debug] [Thread-4  ]: finished collecting timing info
[0m19:29:32.724188 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:29:32.772447 [debug] [Thread-1  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:29:32.772981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dbb4057-fd48-408c-becf-12c12e7f542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0c5e0>]}
[0m19:29:32.773537 [error] [Thread-1  ]: 3 of 4 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.96s]
[0m19:29:32.774257 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:29:33.009811 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.14 seconds
[0m19:29:33.010934 [debug] [Thread-4  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:29:33.023205 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dbb4057-fd48-408c-becf-12c12e7f542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de8e20>]}
[0m19:29:33.023843 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:33.024302 [error] [Thread-4  ]: 1 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 1.22s]
[0m19:29:33.024534 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:29:33.025015 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:29:33.026455 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:29:33.026774 [info ] [Thread-3  ]: 4 of 4 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m19:29:33.027226 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:29:33.168042 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.14 seconds
[0m19:29:33.174034 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:33.174313 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:29:33.300524 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.13 seconds
[0m19:29:33.319022 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:33.319311 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:29:33.458198 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.14 seconds
[0m19:29:33.463827 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:33.464197 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:29:33.570719 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m19:29:33.583169 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:29:33.595608 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:29:33.596463 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:33.596633 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:29:33.733483 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m19:29:33.734486 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:33.734755 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:29:33.882537 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.15 seconds
[0m19:29:33.883693 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:29:33.884009 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:29:34.080232 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m19:29:34.107618 [debug] [Thread-2  ]: finished collecting timing info
[0m19:29:34.107936 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m19:29:34.302306 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dbb4057-fd48-408c-becf-12c12e7f542b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc8b20>]}
[0m19:29:34.302945 [info ] [Thread-2  ]: 2 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.49s]
[0m19:29:34.303672 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:29:34.305170 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:29:34.305698 [info ] [MainThread]: 
[0m19:29:34.306150 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m19:29:34.306541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:34.306754 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:29:34.306946 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:29:34.307137 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m19:29:34.307323 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:29:34.314633 [info ] [MainThread]: 
[0m19:29:34.315088 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:29:34.315453 [info ] [MainThread]: 
[0m19:29:34.315769 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m19:29:34.316088 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:29:34.316379 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:29:34.316667 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:29:34.316957 [info ] [MainThread]: 
[0m19:29:34.317249 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m19:29:34.317539 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:29:34.317829 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:29:34.318116 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:29:34.318415 [info ] [MainThread]: 
[0m19:29:34.318684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m19:29:34.319050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f062b0>]}
[0m19:29:34.319319 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:33:19.568202 | 516cee38-2867-4141-9ea1-8454eb28834d ==============================
[0m19:33:19.568219 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:33:19.569210 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:33:19.569323 [debug] [MainThread]: Tracking: tracking
[0m19:33:19.569522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743eeb0>]}
[0m19:33:19.586947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075163a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107516310>]}
[0m19:33:19.587165 [debug] [MainThread]: Flushing usage events
[0m19:33:20.087813 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading learn_dbt: sources.yml - Runtime Error
    Syntax error near line 27
    ------------------------------
    24 |         freshness:
    25 |           warn_after: {count: 1, period: hour}
    26 |           error_after: {count: 24, period: hour}
    27 | Footer
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 27, column 1:
        Footer
        ^
    could not find expected ':'
      in "<unicode string>", line 27, column 7:
        Footer
              ^
[0m19:33:20.091505 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 56, in load_yaml_text
    return safe_load(contents)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 51, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/__init__.py", line 81, in load
    return loader.get_single_data()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/composer.py", line 127, in compose_mapping_node
    while not self.check_event(MappingEndEvent):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/parser.py", line 428, in parse_block_mapping_key
    if self.check_token(KeyToken):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/scanner.py", line 116, in check_token
    self.fetch_more_tokens()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/scanner.py", line 173, in fetch_more_tokens
    return self.fetch_stream_end()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/scanner.py", line 377, in fetch_stream_end
    self.remove_possible_simple_key()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/yaml/scanner.py", line 318, in remove_possible_simple_key
    raise ScannerError("while scanning a simple key", key.mark,
yaml.scanner.ScannerError: while scanning a simple key
  in "<unicode string>", line 27, column 1:
    Footer
    ^
could not find expected ':'
  in "<unicode string>", line 27, column 7:
    Footer
          ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/schemas.py", line 118, in yaml_from_file
    return load_yaml_text(source_file.contents, source_file.path)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 63, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 27
  ------------------------------
  24 |         freshness:
  25 |           warn_after: {count: 1, period: hour}
  26 |           error_after: {count: 24, period: hour}
  27 | Footer
  
  Raw Error:
  ------------------------------
  while scanning a simple key
    in "<unicode string>", line 27, column 1:
      Footer
      ^
  could not find expected ':'
    in "<unicode string>", line 27, column 7:
      Footer
            ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 451, in run
    self._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 245, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/read_files.py", line 182, in read_files
    project_files["SchemaParser"] = read_files_for_parser(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/read_files.py", line 134, in read_files_for_parser
    source_files = get_source_files(project, dirs, extension, parse_ft, saved_files)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/read_files.py", line 125, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/read_files.py", line 55, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/schemas.py", line 121, in yaml_from_file
    raise ParsingException(
dbt.exceptions.ParsingException: Parsing Error
  Error reading learn_dbt: sources.yml - Runtime Error
    Syntax error near line 27
    ------------------------------
    24 |         freshness:
    25 |           warn_after: {count: 1, period: hour}
    26 |           error_after: {count: 24, period: hour}
    27 | Footer
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 27, column 1:
        Footer
        ^
    could not find expected ':'
      in "<unicode string>", line 27, column 7:
        Footer
              ^



============================== 2022-10-13 19:33:47.207030 | 15316af2-5937-4876-afa2-c6bad9d61583 ==============================
[0m19:33:47.207072 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:33:47.208608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:33:47.208828 [debug] [MainThread]: Tracking: tracking
[0m19:33:47.209505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb82880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb82c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb82f70>]}
[0m19:33:47.240256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:33:47.240547 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/sources.yml
[0m19:33:47.240727 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m19:33:47.276745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15316af2-5937-4876-afa2-c6bad9d61583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bded0d0>]}
[0m19:33:47.281034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15316af2-5937-4876-afa2-c6bad9d61583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdab910>]}
[0m19:33:47.281241 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:33:47.281428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15316af2-5937-4876-afa2-c6bad9d61583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb940d0>]}
[0m19:33:47.282203 [info ] [MainThread]: 
[0m19:33:47.282470 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:33:47.282956 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:33:47.289428 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:33:47.289622 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:33:47.289732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:48.041855 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.75 seconds
[0m19:33:48.044760 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:33:48.252112 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:33:48.262480 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:33:48.262750 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:33:48.262937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:48.927643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.66 seconds
[0m19:33:48.930867 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:33:49.189985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15316af2-5937-4876-afa2-c6bad9d61583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd87430>]}
[0m19:33:49.190944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:49.191497 [info ] [MainThread]: 
[0m19:33:49.197704 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:33:49.198047 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:33:49.198279 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:33:49.198677 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:33:49.199089 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:33:49.199513 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:33:49.199761 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:33:49.200000 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:33:49.200235 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:33:49.200489 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:33:49.200707 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:33:49.200922 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:33:49.202848 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:33:49.204222 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:33:49.205710 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:33:49.206943 [debug] [Thread-3  ]: finished collecting timing info
[0m19:33:49.207128 [debug] [Thread-2  ]: finished collecting timing info
[0m19:33:49.207296 [debug] [Thread-1  ]: finished collecting timing info
[0m19:33:49.207793 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:33:49.208200 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:33:49.208685 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:33:49.209087 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m19:33:49.209395 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:33:49.209640 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:33:49.209898 [info ] [Thread-4  ]: 1 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:33:49.210126 [info ] [Thread-3  ]: 2 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:33:49.210356 [info ] [Thread-1  ]: 3 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:33:49.210799 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:49.211205 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:33:49.211608 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:33:49.211760 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:33:49.211921 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:33:49.212079 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:33:49.212235 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m19:33:49.212388 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:33:49.212541 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:33:49.228637 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:33:49.233571 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:33:49.237596 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:33:49.238344 [debug] [Thread-3  ]: finished collecting timing info
[0m19:33:49.238502 [debug] [Thread-4  ]: finished collecting timing info
[0m19:33:49.238629 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:33:49.238748 [debug] [Thread-1  ]: finished collecting timing info
[0m19:33:49.238900 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:33:49.251652 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:33:49.255932 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:33:49.262844 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:33:49.276979 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:49.277310 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:33:49.277423 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:33:49.278362 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:33:49.278466 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:33:49.279016 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:33:49.279517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:33:49.279663 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:33:49.280064 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:33:49.876928 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a79b55-3201-eb1e-0000-00015aae6119
[0m19:33:49.877388 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:33:49.877931 [debug] [Thread-1  ]: finished collecting timing info
[0m19:33:49.878248 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:33:50.135513 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m19:33:50.150680 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:50.151612 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:33:50.243506 [debug] [Thread-1  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:33:50.244472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15316af2-5937-4876-afa2-c6bad9d61583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0832e0>]}
[0m19:33:50.245135 [error] [Thread-1  ]: 3 of 4 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 1.03s]
[0m19:33:50.245912 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:33:50.248990 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:33:50.254138 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:50.254394 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:33:50.280505 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a79b55-3201-ea44-0000-00015aae24cd
[0m19:33:50.280917 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:33:50.281540 [debug] [Thread-3  ]: finished collecting timing info
[0m19:33:50.281899 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:33:50.361338 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m19:33:50.375461 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:50.375650 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:33:50.449930 [debug] [Thread-3  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:33:50.450351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15316af2-5937-4876-afa2-c6bad9d61583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c088640>]}
[0m19:33:50.450775 [error] [Thread-3  ]: 2 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 1.24s]
[0m19:33:50.451312 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:33:50.451781 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:33:50.452077 [info ] [Thread-2  ]: 4 of 4 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m19:33:50.452584 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:33:50.523000 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.15 seconds
[0m19:33:50.527715 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:50.527974 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:33:50.609637 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m19:33:50.619423 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:33:50.630891 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:33:50.631741 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:50.631923 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:33:50.859247 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m19:33:50.860181 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:50.860524 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:33:51.611119 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.75 seconds
[0m19:33:51.612368 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:33:51.612740 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:33:51.792207 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m19:33:51.818151 [debug] [Thread-4  ]: finished collecting timing info
[0m19:33:51.818481 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m19:33:51.989006 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15316af2-5937-4876-afa2-c6bad9d61583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c12e0>]}
[0m19:33:51.989708 [info ] [Thread-4  ]: 1 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.78s]
[0m19:33:51.990441 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:33:51.991922 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:33:51.992537 [info ] [MainThread]: 
[0m19:33:51.993055 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m19:33:51.993513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:51.993705 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:33:51.993893 [debug] [MainThread]: Connection 'model.learn_dbt.src_listings' was properly closed.
[0m19:33:51.994081 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:33:51.994263 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:33:51.999837 [info ] [MainThread]: 
[0m19:33:52.000041 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:33:52.000214 [info ] [MainThread]: 
[0m19:33:52.000371 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m19:33:52.000527 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:33:52.000674 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:33:52.000818 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:33:52.000963 [info ] [MainThread]: 
[0m19:33:52.001110 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m19:33:52.001256 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:33:52.001400 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:33:52.001687 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:33:52.004275 [info ] [MainThread]: 
[0m19:33:52.004600 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m19:33:52.004976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd87190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd87700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a7730>]}
[0m19:33:52.005240 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:41:51.487394 | 7747954f-cc73-4fa9-871c-6e2c6ecbda28 ==============================
[0m19:41:51.487449 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:41:51.488300 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:41:51.488467 [debug] [MainThread]: Tracking: tracking
[0m19:41:51.488752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9b160>]}
[0m19:41:51.501137 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:41:51.501464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045aa250>]}
[0m19:41:51.520015 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:41:51.521351 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:41:51.543529 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m19:41:51.545432 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m19:41:51.548097 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m19:41:51.548813 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m19:41:51.550615 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m19:41:51.555248 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m19:41:51.555793 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:41:51.556084 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:41:51.556407 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:41:51.556657 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:41:51.556878 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m19:41:51.558617 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m19:41:51.559658 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m19:41:51.560424 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m19:41:51.568337 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m19:41:51.574918 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m19:41:51.580946 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m19:41:51.583085 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m19:41:51.583909 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m19:41:51.584729 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m19:41:51.586743 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m19:41:51.595275 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m19:41:51.596074 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m19:41:51.600432 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m19:41:51.607886 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m19:41:51.610421 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m19:41:51.611703 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m19:41:51.614304 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m19:41:51.614927 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m19:41:51.616486 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m19:41:51.617511 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m19:41:51.620740 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m19:41:51.629498 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m19:41:51.630195 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m19:41:51.631306 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m19:41:51.632005 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m19:41:51.632428 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m19:41:51.632806 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m19:41:51.633132 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m19:41:51.633762 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m19:41:51.635763 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m19:41:51.639697 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m19:41:51.640084 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m19:41:51.640645 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m19:41:51.641090 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:41:51.641530 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:41:51.642103 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m19:41:51.642475 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:41:51.642957 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:41:51.643460 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:41:51.644590 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:41:51.645150 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:41:51.645647 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m19:41:51.646151 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:41:51.646640 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:41:51.647120 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m19:41:51.647622 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m19:41:51.648049 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m19:41:51.650700 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:41:51.651131 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:41:51.651949 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:41:51.652897 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m19:41:51.653377 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m19:41:51.654399 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m19:41:51.655595 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m19:41:51.662447 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m19:41:51.663749 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:41:51.669858 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m19:41:51.671843 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m19:41:51.675053 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m19:41:51.679625 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m19:41:51.796597 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m19:41:51.802431 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m19:41:51.803886 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m19:41:51.805241 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m19:41:51.809183 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m19:41:51.809694 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m19:41:51.810896 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m19:41:51.812074 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m19:41:51.851851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514d0d0>]}
[0m19:41:51.855692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517e280>]}
[0m19:41:51.855891 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:41:51.856084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa4910>]}
[0m19:41:51.856899 [info ] [MainThread]: 
[0m19:41:51.857172 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:41:51.857694 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:41:51.863725 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:41:51.863856 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:41:51.863950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:52.631574 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m19:41:52.634027 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:41:52.806235 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:41:52.815290 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:41:52.815605 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:41:52.815832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:53.378650 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.56 seconds
[0m19:41:53.382425 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:41:53.573799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105146d00>]}
[0m19:41:53.574609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:41:53.575143 [info ] [MainThread]: 
[0m19:41:53.581229 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:41:53.581518 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:41:53.581857 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m19:41:53.582076 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:41:53.582399 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m19:41:53.582997 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:41:53.583290 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m19:41:53.583834 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:41:53.584056 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:41:53.584570 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:41:53.584785 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:41:53.585014 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:41:53.585220 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:41:53.585421 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:41:53.587196 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:41:53.587399 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:41:53.588727 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:41:53.591554 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:41:53.592005 [debug] [Thread-1  ]: finished collecting timing info
[0m19:41:53.592221 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m19:41:53.597843 [debug] [Thread-2  ]: finished collecting timing info
[0m19:41:53.604344 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m19:41:53.609735 [debug] [Thread-3  ]: finished collecting timing info
[0m19:41:53.615240 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m19:41:53.617299 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m19:41:53.617453 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m19:41:53.619438 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m19:41:53.620044 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m19:41:53.620457 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m19:41:53.620782 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m19:41:53.620886 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m19:41:53.621007 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m19:41:53.621116 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m19:41:53.621228 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:41:53.621341 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:41:53.621445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:41:54.323951 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m19:41:54.345265 [debug] [Thread-3  ]: finished collecting timing info
[0m19:41:54.345584 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m19:41:54.469524 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.85 seconds
[0m19:41:54.473895 [debug] [Thread-1  ]: finished collecting timing info
[0m19:41:54.474318 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m19:41:54.476314 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.85 seconds
[0m19:41:54.479716 [debug] [Thread-2  ]: finished collecting timing info
[0m19:41:54.480882 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m19:41:54.664499 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e3f70>]}
[0m19:41:54.666656 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.08s]
[0m19:41:54.667527 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:41:54.668190 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m19:41:54.668549 [info ] [Thread-4  ]: 4 of 7 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:41:54.669144 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:54.669368 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:41:54.669590 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m19:41:54.675842 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:41:54.677933 [debug] [Thread-4  ]: finished collecting timing info
[0m19:41:54.678170 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:41:54.705718 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:54.705942 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:41:54.706063 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:41:54.759967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e2d00>]}
[0m19:41:54.760352 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e23d0>]}
[0m19:41:54.760683 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.18s]
[0m19:41:54.760927 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.18s]
[0m19:41:54.761252 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:41:54.761535 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:41:54.761805 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:41:54.762025 [info ] [Thread-3  ]: 5 of 7 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:41:54.762440 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:41:54.762573 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:41:54.762705 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:41:54.762873 [info ] [Thread-2  ]: 6 of 7 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:41:54.763014 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:41:54.763349 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:41:54.765418 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:41:54.765646 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:41:54.765866 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:41:54.767572 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:41:54.767892 [debug] [Thread-3  ]: finished collecting timing info
[0m19:41:54.768044 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:41:54.768166 [debug] [Thread-2  ]: finished collecting timing info
[0m19:41:54.770054 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:41:54.770190 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:41:54.772195 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:41:54.772816 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:41:54.772942 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:41:54.773286 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:41:54.773399 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:41:54.773517 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:41:54.774045 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:41:55.515337 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.74 seconds
[0m19:41:55.522987 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m19:41:55.523700 [debug] [Thread-2  ]: finished collecting timing info
[0m19:41:55.526109 [debug] [Thread-3  ]: finished collecting timing info
[0m19:41:55.526390 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:41:55.526632 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:41:55.583133 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.88 seconds
[0m19:41:55.594462 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:55.597105 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:41:55.690853 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105765bb0>]}
[0m19:41:55.691574 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e2fd0>]}
[0m19:41:55.692275 [info ] [Thread-2  ]: 6 of 7 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.93s]
[0m19:41:55.692776 [info ] [Thread-3  ]: 5 of 7 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.93s]
[0m19:41:55.693493 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:41:55.694210 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:41:55.695705 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:41:55.700558 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:55.700800 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:41:55.702201 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:41:55.702559 [info ] [Thread-1  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m19:41:55.703075 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:41:55.703260 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:41:55.703449 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:41:55.706278 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:41:55.707613 [debug] [Thread-1  ]: finished collecting timing info
[0m19:41:55.707851 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:41:55.717123 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:41:55.718284 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:41:55.718491 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m19:41:55.718634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:41:55.794501 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m19:41:55.805487 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:55.805690 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:41:55.909356 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:41:55.911512 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:55.911663 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:41:56.096655 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.18 seconds
[0m19:41:56.104303 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:41:56.113580 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:41:56.114649 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:56.114790 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:41:56.234099 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m19:41:56.234445 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:56.234658 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:41:56.403859 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.17 seconds
[0m19:41:56.405192 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:41:56.405516 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:41:56.563483 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m19:41:56.576907 [debug] [Thread-4  ]: finished collecting timing info
[0m19:41:56.577339 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m19:41:56.814348 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573b2e0>]}
[0m19:41:56.815759 [info ] [Thread-4  ]: 4 of 7 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.15s]
[0m19:41:56.816683 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:41:56.948213 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.23 seconds
[0m19:41:56.951984 [debug] [Thread-1  ]: finished collecting timing info
[0m19:41:56.952285 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:41:57.148922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747954f-cc73-4fa9-871c-6e2c6ecbda28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105771fd0>]}
[0m19:41:57.149698 [info ] [Thread-1  ]: 7 of 7 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.45s]
[0m19:41:57.150432 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:41:57.152027 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:41:57.152621 [info ] [MainThread]: 
[0m19:41:57.153104 [info ] [MainThread]: Finished running 5 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m19:41:57.153559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:57.153791 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:41:57.154019 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:41:57.154223 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:41:57.154403 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:41:57.162040 [info ] [MainThread]: 
[0m19:41:57.162383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:57.162724 [info ] [MainThread]: 
[0m19:41:57.163021 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:41:57.163388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105227ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c72b0>]}
[0m19:41:57.163638 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:42:19.395120 | 7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91 ==============================
[0m19:42:19.395149 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:42:19.395558 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:42:19.395667 [debug] [MainThread]: Tracking: tracking
[0m19:42:19.395883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107273b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107273970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107273eb0>]}
[0m19:42:19.406759 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:42:19.406998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689cd90>]}
[0m19:42:19.419873 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:42:19.421096 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:42:19.442437 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m19:42:19.444230 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m19:42:19.446949 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m19:42:19.447684 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m19:42:19.449465 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m19:42:19.453729 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m19:42:19.454173 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:42:19.454451 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:42:19.454764 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:42:19.455015 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:42:19.455242 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m19:42:19.457210 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m19:42:19.458409 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m19:42:19.459217 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m19:42:19.467082 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m19:42:19.473659 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m19:42:19.479420 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m19:42:19.481709 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m19:42:19.482724 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m19:42:19.483595 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m19:42:19.485699 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m19:42:19.494369 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m19:42:19.495158 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m19:42:19.499539 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m19:42:19.507008 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m19:42:19.509563 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m19:42:19.510846 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m19:42:19.513457 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m19:42:19.514100 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m19:42:19.515662 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m19:42:19.516689 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m19:42:19.519917 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m19:42:19.528654 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m19:42:19.529333 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m19:42:19.530437 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m19:42:19.531148 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m19:42:19.531570 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m19:42:19.531956 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m19:42:19.532281 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m19:42:19.532909 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m19:42:19.534902 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m19:42:19.538831 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m19:42:19.539219 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m19:42:19.539784 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m19:42:19.540228 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:42:19.540659 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:42:19.541221 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m19:42:19.541598 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:42:19.542071 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:42:19.542578 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:42:19.543713 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:42:19.544274 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:42:19.544772 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m19:42:19.545263 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:42:19.545746 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:42:19.546172 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m19:42:19.546676 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m19:42:19.547108 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m19:42:19.549772 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:42:19.550204 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:42:19.551023 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:42:19.551967 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m19:42:19.552450 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m19:42:19.553482 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m19:42:19.554674 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m19:42:19.561527 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m19:42:19.562855 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:42:19.569004 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m19:42:19.571000 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m19:42:19.574254 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m19:42:19.578840 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m19:42:19.692812 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m19:42:19.698640 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m19:42:19.700160 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m19:42:19.701453 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m19:42:19.705380 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m19:42:19.705894 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m19:42:19.707138 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m19:42:19.708357 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m19:42:19.747128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740b0d0>]}
[0m19:42:19.750427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107265220>]}
[0m19:42:19.750593 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:42:19.750785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724f580>]}
[0m19:42:19.751565 [info ] [MainThread]: 
[0m19:42:19.751832 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:42:19.752256 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:42:19.758286 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:42:19.758394 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:42:19.758482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:20.468185 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.71 seconds
[0m19:42:20.471053 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:42:20.620422 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:42:20.625085 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:42:20.625232 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:42:20.625349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:21.391550 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.77 seconds
[0m19:42:21.395136 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:42:21.583023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107409dc0>]}
[0m19:42:21.583919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:42:21.584479 [info ] [MainThread]: 
[0m19:42:21.589240 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:42:21.589488 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:42:21.589710 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:42:21.590175 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:42:21.590608 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:42:21.590994 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:42:21.591234 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:42:21.591463 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:42:21.591691 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:42:21.591926 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:42:21.592131 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:42:21.592331 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:42:21.594168 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:42:21.595619 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:42:21.598933 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:42:21.600000 [debug] [Thread-1  ]: finished collecting timing info
[0m19:42:21.600226 [debug] [Thread-2  ]: finished collecting timing info
[0m19:42:21.600416 [debug] [Thread-3  ]: finished collecting timing info
[0m19:42:21.600853 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:42:21.601208 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:42:21.601757 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:42:21.602281 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:42:21.602745 [info ] [Thread-2  ]: 1 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:42:21.603059 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:42:21.603536 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:42:21.603700 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m19:42:21.603962 [info ] [Thread-1  ]: 2 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:42:21.604175 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:42:21.604407 [info ] [Thread-4  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:42:21.604839 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:42:21.605010 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:42:21.605405 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:21.605568 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:42:21.614005 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:42:21.614197 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:42:21.614344 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:42:21.614574 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m19:42:21.619683 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:42:21.625777 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:42:21.625958 [debug] [Thread-2  ]: finished collecting timing info
[0m19:42:21.626265 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:42:21.632265 [debug] [Thread-1  ]: finished collecting timing info
[0m19:42:21.637964 [debug] [Thread-4  ]: finished collecting timing info
[0m19:42:21.643669 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:42:21.643852 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:42:21.643975 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:42:21.645886 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:42:21.657630 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:42:21.666373 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:21.666567 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:42:21.666670 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:42:21.666803 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:42:21.667364 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:42:21.667464 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:42:21.667957 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:42:21.668676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:42:22.521462 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.85 seconds
[0m19:42:22.522246 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m19:42:22.544688 [debug] [Thread-1  ]: finished collecting timing info
[0m19:42:22.546804 [debug] [Thread-2  ]: finished collecting timing info
[0m19:42:22.547053 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:42:22.547245 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:42:22.702642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789b490>]}
[0m19:42:22.703125 [info ] [Thread-1  ]: 2 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.10s]
[0m19:42:22.704109 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:42:22.706076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c3370>]}
[0m19:42:22.706360 [info ] [Thread-2  ]: 1 of 4 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.10s]
[0m19:42:22.706623 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:42:22.706874 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:42:22.707034 [info ] [Thread-3  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m19:42:22.707391 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:42:22.707551 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:42:22.707669 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:42:22.709843 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:42:22.710242 [debug] [Thread-3  ]: finished collecting timing info
[0m19:42:22.710353 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:42:22.716088 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:42:22.716950 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:42:22.717168 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m19:42:22.717308 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:42:22.758142 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.09 seconds
[0m19:42:22.764374 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:22.764560 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:42:22.859264 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m19:42:22.861890 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:22.862071 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:42:22.968197 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m19:42:22.981407 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:22.989431 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:42:23.124060 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.13 seconds
[0m19:42:23.126704 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:23.127212 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:42:23.389282 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.26 seconds
[0m19:42:23.397079 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:42:23.404067 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:42:23.404794 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:23.404939 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:42:23.599655 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m19:42:23.600822 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:23.601284 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:42:23.775192 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.17 seconds
[0m19:42:23.776249 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:42:23.776555 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:42:23.881323 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.16 seconds
[0m19:42:23.892647 [debug] [Thread-3  ]: finished collecting timing info
[0m19:42:23.893080 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:42:23.927681 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m19:42:23.930659 [debug] [Thread-4  ]: finished collecting timing info
[0m19:42:23.930794 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m19:42:24.058676 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747f400>]}
[0m19:42:24.059623 [info ] [Thread-3  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.35s]
[0m19:42:24.060447 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:42:24.094463 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa530d4-8a16-4ee4-92fd-82fb4a8f5d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776f610>]}
[0m19:42:24.095016 [info ] [Thread-4  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.49s]
[0m19:42:24.095661 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:42:24.097256 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:42:24.097898 [info ] [MainThread]: 
[0m19:42:24.098348 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m19:42:24.098728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:24.098926 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:42:24.099118 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:42:24.099308 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:42:24.099497 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:42:24.107692 [info ] [MainThread]: 
[0m19:42:24.108116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:42:24.108481 [info ] [MainThread]: 
[0m19:42:24.108789 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:42:24.109196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748a1c0>]}
[0m19:42:24.109489 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:47:05.636666 | e45761fc-17f7-4189-b091-b82397bf508b ==============================
[0m19:47:05.636714 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:47:05.637562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:47:05.637684 [debug] [MainThread]: Tracking: tracking
[0m19:47:05.637913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6df10>]}
[0m19:47:05.654313 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:47:05.654578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709b4f0>]}
[0m19:47:05.674994 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:47:05.676340 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:47:05.699101 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m19:47:05.701051 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m19:47:05.703474 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m19:47:05.704093 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m19:47:05.706183 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m19:47:05.710931 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m19:47:05.711513 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:47:05.711836 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:47:05.712160 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:47:05.712424 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:47:05.712756 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m19:47:05.714722 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m19:47:05.715824 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m19:47:05.716646 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m19:47:05.724784 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m19:47:05.731514 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m19:47:05.737383 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m19:47:05.739468 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m19:47:05.740316 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m19:47:05.741135 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m19:47:05.743163 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m19:47:05.751457 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m19:47:05.752173 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m19:47:05.756560 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m19:47:05.764310 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m19:47:05.766982 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m19:47:05.768339 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m19:47:05.770969 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m19:47:05.771586 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m19:47:05.773178 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m19:47:05.774234 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m19:47:05.777557 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m19:47:05.786829 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m19:47:05.787625 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m19:47:05.788793 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m19:47:05.789529 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m19:47:05.789968 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m19:47:05.790363 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m19:47:05.790700 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m19:47:05.791352 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m19:47:05.793423 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m19:47:05.797504 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m19:47:05.797913 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m19:47:05.798499 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m19:47:05.798965 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:47:05.799414 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:47:05.800000 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m19:47:05.800383 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:47:05.800885 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:47:05.801403 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:47:05.802588 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:47:05.803208 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:47:05.803733 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m19:47:05.804240 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:47:05.804734 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:47:05.805176 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m19:47:05.805684 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m19:47:05.806115 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m19:47:05.808847 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:47:05.809294 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:47:05.810142 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:47:05.811121 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m19:47:05.811614 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m19:47:05.812685 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m19:47:05.813917 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m19:47:05.820978 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m19:47:05.822335 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:47:05.828682 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m19:47:05.830747 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m19:47:05.834098 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m19:47:05.838914 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m19:47:05.958023 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m19:47:05.964128 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m19:47:05.965622 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m19:47:05.967144 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m19:47:05.971262 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m19:47:05.971782 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m19:47:05.973002 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m19:47:05.974205 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m19:47:06.015839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d290d0>]}
[0m19:47:06.019870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d54100>]}
[0m19:47:06.020062 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:47:06.020261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2bd90>]}
[0m19:47:06.021086 [info ] [MainThread]: 
[0m19:47:06.021373 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:47:06.021821 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:47:06.028380 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:47:06.028529 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:47:06.028619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:06.847054 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.82 seconds
[0m19:47:06.850063 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:47:07.183028 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:47:07.191878 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:47:07.192130 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:47:07.192321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:07.724752 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
[0m19:47:07.728535 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:47:07.914557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1abe0>]}
[0m19:47:07.915757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:07.916148 [info ] [MainThread]: 
[0m19:47:07.920902 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:47:07.921175 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:47:07.921480 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:47:07.935231 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:47:07.935661 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:47:07.936002 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:47:07.936246 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:47:07.936484 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:47:07.936887 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:47:07.937184 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:47:07.937413 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:47:07.937661 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:47:07.940655 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:47:07.942789 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:47:07.946244 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:47:07.947428 [debug] [Thread-3  ]: finished collecting timing info
[0m19:47:07.947596 [debug] [Thread-1  ]: finished collecting timing info
[0m19:47:07.947753 [debug] [Thread-2  ]: finished collecting timing info
[0m19:47:07.948198 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:47:07.948544 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:47:07.948865 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:47:07.949256 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m19:47:07.949550 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:47:07.949914 [info ] [Thread-4  ]: 1 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:47:07.950092 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:47:07.950328 [info ] [Thread-3  ]: 2 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:47:07.950785 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:07.951005 [info ] [Thread-2  ]: 3 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:47:07.951406 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:47:07.951572 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:47:07.951952 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:47:07.952114 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:47:07.952291 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m19:47:07.952479 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:47:07.952663 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:47:07.963975 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:47:07.964278 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:47:07.968239 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:47:07.973914 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:47:07.974405 [debug] [Thread-4  ]: finished collecting timing info
[0m19:47:07.974671 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:47:07.974848 [debug] [Thread-2  ]: finished collecting timing info
[0m19:47:07.974979 [debug] [Thread-3  ]: finished collecting timing info
[0m19:47:07.998363 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:47:08.002428 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:08.002631 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:47:08.012969 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:47:08.013162 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (


with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:47:08.014856 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:47:08.015088 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:47:08.017339 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:47:08.017522 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (


with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:47:08.017664 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:47:08.018279 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:47:08.019602 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (


with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:47:08.019721 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:47:08.726888 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79b63-3201-ea44-0000-00015aae251d
[0m19:47:08.727402 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a79b63-3201-ec57-0000-00015aae5189
[0m19:47:08.727733 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:47:08.727964 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:47:08.728419 [debug] [Thread-2  ]: finished collecting timing info
[0m19:47:08.728807 [debug] [Thread-3  ]: finished collecting timing info
[0m19:47:08.729076 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:47:08.729305 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:47:09.077797 [debug] [Thread-3  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:47:09.078653 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.06 seconds
[0m19:47:09.079192 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf0790>]}
[0m19:47:09.083966 [debug] [Thread-2  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:47:09.091258 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:09.091726 [error] [Thread-3  ]: 2 of 4 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 1.13s]
[0m19:47:09.092023 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dea430>]}
[0m19:47:09.092219 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:47:09.092702 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:47:09.093014 [error] [Thread-2  ]: 3 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 1.14s]
[0m19:47:09.094655 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:47:09.095092 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:47:09.095336 [info ] [Thread-1  ]: 4 of 4 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m19:47:09.095717 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:47:09.289958 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.2 seconds
[0m19:47:09.295771 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:09.296113 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:47:09.416378 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m19:47:09.435392 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:09.435641 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:47:09.518588 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m19:47:09.524498 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:09.524869 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:47:09.706410 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.18 seconds
[0m19:47:09.717374 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:47:09.730390 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:47:09.731411 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:09.731611 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:47:09.861114 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m19:47:09.862165 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:09.862480 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:47:10.012491 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.15 seconds
[0m19:47:10.014592 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:47:10.014992 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:47:10.160608 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m19:47:10.184998 [debug] [Thread-4  ]: finished collecting timing info
[0m19:47:10.185299 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m19:47:10.351188 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e45761fc-17f7-4189-b091-b82397bf508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dbfee0>]}
[0m19:47:10.351992 [info ] [Thread-4  ]: 1 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.40s]
[0m19:47:10.352734 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:47:10.354305 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:47:10.354963 [info ] [MainThread]: 
[0m19:47:10.355490 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m19:47:10.355957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:10.356200 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m19:47:10.356415 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:47:10.356607 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:47:10.356793 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:47:10.364495 [info ] [MainThread]: 
[0m19:47:10.364930 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:47:10.365280 [info ] [MainThread]: 
[0m19:47:10.365594 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m19:47:10.365894 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:47:10.366187 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:47:10.366476 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:47:10.366764 [info ] [MainThread]: 
[0m19:47:10.367052 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m19:47:10.367341 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:47:10.367629 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:47:10.367917 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:47:10.383620 [info ] [MainThread]: 
[0m19:47:10.384109 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m19:47:10.384550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d29f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d74df0>]}
[0m19:47:10.384855 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:54:37.810660 | 757a1e0f-1738-40d6-8d4e-69068e52f9a5 ==============================
[0m19:54:37.810749 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:54:37.814318 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:54:37.814631 [debug] [MainThread]: Tracking: tracking
[0m19:54:37.815145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f15070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f15850>]}
[0m19:54:37.844563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:37.844747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:37.848428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '757a1e0f-1738-40d6-8d4e-69068e52f9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e0f40>]}
[0m19:54:37.853278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '757a1e0f-1738-40d6-8d4e-69068e52f9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068aa370>]}
[0m19:54:37.853486 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:54:37.853678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '757a1e0f-1738-40d6-8d4e-69068e52f9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936490>]}
[0m19:54:37.854637 [info ] [MainThread]: 
[0m19:54:37.854932 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:54:37.855467 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:54:37.864284 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:54:37.864449 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:54:37.864540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:38.635669 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m19:54:38.639050 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:54:39.141507 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:54:39.150681 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:54:39.150960 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:54:39.151178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:54:39.811583 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.66 seconds
[0m19:54:39.814130 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:54:40.038318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '757a1e0f-1738-40d6-8d4e-69068e52f9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7cd0>]}
[0m19:54:40.039295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:54:40.039845 [info ] [MainThread]: 
[0m19:54:40.046145 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:54:40.046495 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:54:40.046708 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:54:40.047104 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:54:40.047506 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:54:40.047864 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:54:40.048099 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:54:40.048344 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:54:40.048585 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:54:40.048835 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:54:40.049048 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:54:40.049259 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:54:40.052190 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:54:40.054312 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:54:40.056411 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:54:40.057847 [debug] [Thread-1  ]: finished collecting timing info
[0m19:54:40.058012 [debug] [Thread-2  ]: finished collecting timing info
[0m19:54:40.058170 [debug] [Thread-3  ]: finished collecting timing info
[0m19:54:40.058546 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:54:40.058878 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:54:40.059194 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:54:40.059549 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:54:40.059993 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:54:40.060238 [info ] [Thread-4  ]: 1 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:54:40.060411 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m19:54:40.060635 [info ] [Thread-2  ]: 2 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:54:40.061090 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:54:40.061320 [info ] [Thread-1  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:54:40.061764 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:54:40.061912 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:54:40.062327 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:54:40.062459 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:54:40.062618 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:54:40.062772 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:54:40.062923 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:54:40.072212 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:54:40.072402 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m19:54:40.077332 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:54:40.084510 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:54:40.084908 [debug] [Thread-4  ]: finished collecting timing info
[0m19:54:40.085077 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:54:40.085224 [debug] [Thread-2  ]: finished collecting timing info
[0m19:54:40.091616 [debug] [Thread-1  ]: finished collecting timing info
[0m19:54:40.102692 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:54:40.102881 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:54:40.102997 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:54:40.104766 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:54:40.118050 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:54:40.124516 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:54:40.124698 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (


with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:54:40.124912 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:54:40.125654 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:54:40.125772 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (


with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:54:40.126167 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:54:40.127331 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:54:40.127776 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
      (

with  __dbt__cte__src_reviews as (


with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

      );
[0m19:54:40.127896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:54:40.715555 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79b6a-3201-ec57-0000-00015aae51a1
[0m19:54:40.715988 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:54:40.716481 [debug] [Thread-2  ]: finished collecting timing info
[0m19:54:40.716772 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:54:40.881425 [debug] [Thread-2  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:54:40.881776 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '757a1e0f-1738-40d6-8d4e-69068e52f9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110871190>]}
[0m19:54:40.882054 [error] [Thread-2  ]: 2 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 0.82s]
[0m19:54:40.882386 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:54:40.910572 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a79b6a-3201-ea44-0000-00015aae2535
[0m19:54:40.913150 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:54:40.913444 [debug] [Thread-4  ]: finished collecting timing info
[0m19:54:40.913568 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:54:41.090284 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:54:41.092014 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '757a1e0f-1738-40d6-8d4e-69068e52f9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110871e20>]}
[0m19:54:41.092774 [error] [Thread-4  ]: 1 of 4 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 1.03s]
[0m19:54:41.093536 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:54:41.094186 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:54:41.094489 [info ] [Thread-3  ]: 4 of 4 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m19:54:41.095088 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:54:44.135433 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.01 seconds
[0m19:54:44.163167 [debug] [Thread-1  ]: finished collecting timing info
[0m19:54:44.163492 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: Close
[0m19:54:44.341621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '757a1e0f-1738-40d6-8d4e-69068e52f9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc5430>]}
[0m19:54:44.342353 [info ] [Thread-1  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 1[0m in 4.28s]
[0m19:54:44.343066 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:54:44.344536 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:54:44.345171 [info ] [MainThread]: 
[0m19:54:44.345687 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m19:54:44.346154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:44.346401 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:54:44.346633 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:54:44.346856 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m19:54:44.347040 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:54:44.354863 [info ] [MainThread]: 
[0m19:54:44.355239 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:54:44.355584 [info ] [MainThread]: 
[0m19:54:44.355892 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m19:54:44.356193 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:54:44.356484 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m19:54:44.356771 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m19:54:44.357059 [info ] [MainThread]: 
[0m19:54:44.357352 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m19:54:44.357645 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m19:54:44.357930 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m19:54:44.358215 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m19:54:44.385466 [info ] [MainThread]: 
[0m19:54:44.385923 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 TOTAL=4
[0m19:54:44.386404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106829af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc5b80>]}
[0m19:54:44.386726 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:58:05.876040 | 3dbcd6c5-243b-458f-96b3-f81a56c2190d ==============================
[0m19:58:05.876074 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:58:05.876877 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:58:05.877029 [debug] [MainThread]: Tracking: tracking
[0m19:58:05.877295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0d160>]}
[0m19:58:05.904459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m19:58:05.904765 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/src/src_listings.sql
[0m19:58:05.904920 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/src/src_hosts.sql
[0m19:58:05.905061 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/src/src_reviews.sql
[0m19:58:05.912956 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m19:58:05.919907 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m19:58:05.921245 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m19:58:05.927238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3b0d0>]}
[0m19:58:05.933638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6e6d0>]}
[0m19:58:05.933865 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:58:05.934052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6e730>]}
[0m19:58:05.934911 [info ] [MainThread]: 
[0m19:58:05.935230 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:58:05.935882 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:58:05.942324 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:58:05.942483 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:58:05.942581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:06.757079 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.81 seconds
[0m19:58:06.759341 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:58:06.954122 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:58:06.963063 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:58:06.963358 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:58:06.963562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:07.729929 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m19:58:07.731415 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:58:07.941589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e82be0>]}
[0m19:58:07.942508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:58:07.943052 [info ] [MainThread]: 
[0m19:58:07.949073 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:58:07.949343 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:58:07.949575 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:58:07.949975 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m19:58:07.950303 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m19:58:07.950632 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m19:58:07.951264 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:58:07.951810 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:58:07.952323 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:58:07.952561 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:58:07.952788 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:58:07.953001 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:58:07.953242 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:58:07.953452 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:58:07.953657 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:58:07.955362 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:58:07.957808 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:58:07.959138 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:58:07.960286 [debug] [Thread-3  ]: finished collecting timing info
[0m19:58:07.960443 [debug] [Thread-2  ]: finished collecting timing info
[0m19:58:07.960581 [debug] [Thread-1  ]: finished collecting timing info
[0m19:58:07.960751 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m19:58:07.960940 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m19:58:07.961119 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m19:58:07.983455 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m19:58:07.985515 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m19:58:07.987338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m19:58:07.988140 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m19:58:07.988546 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m19:58:07.988873 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m19:58:07.989012 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m19:58:07.989146 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m19:58:07.989268 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m19:58:07.989380 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:58:07.989494 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:58:07.989601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:08.649850 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m19:58:08.665523 [debug] [Thread-1  ]: finished collecting timing info
[0m19:58:08.665771 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m19:58:08.763081 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.77 seconds
[0m19:58:08.765987 [debug] [Thread-3  ]: finished collecting timing info
[0m19:58:08.766263 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m19:58:08.767174 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m19:58:08.770361 [debug] [Thread-2  ]: finished collecting timing info
[0m19:58:08.770704 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m19:58:08.811204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1d340>]}
[0m19:58:08.811875 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.86s]
[0m19:58:08.812648 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:58:08.813264 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:58:08.813719 [info ] [Thread-4  ]: 4 of 7 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:58:08.814504 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:58:08.814791 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:58:08.815037 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:58:08.818734 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:58:08.820573 [debug] [Thread-4  ]: finished collecting timing info
[0m19:58:08.820806 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:58:08.823950 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:58:08.824796 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:58:08.824999 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:58:08.825175 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:58:08.965116 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720b310>]}
[0m19:58:08.965754 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.01s]
[0m19:58:08.966297 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:58:08.966731 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:58:08.967010 [info ] [Thread-1  ]: 5 of 7 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:58:08.967998 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:58:08.968231 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:58:08.968444 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:58:08.971550 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:58:08.971980 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f3eb0>]}
[0m19:58:08.972474 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.02s]
[0m19:58:08.973671 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:58:08.974022 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m19:58:08.974191 [debug] [Thread-1  ]: finished collecting timing info
[0m19:58:08.974406 [info ] [Thread-2  ]: 6 of 7 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:58:08.974585 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:58:08.974988 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:58:08.977756 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:58:08.977957 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:58:08.978213 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m19:58:08.985219 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:58:08.986060 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:58:08.986246 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:58:08.986495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:08.987732 [debug] [Thread-2  ]: finished collecting timing info
[0m19:58:08.987954 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:58:09.011659 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:58:09.036618 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:58:09.049357 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

      );
[0m19:58:09.055826 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:58:09.486145 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m19:58:09.489391 [debug] [Thread-4  ]: finished collecting timing info
[0m19:58:09.489541 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:58:09.642403 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073aebb0>]}
[0m19:58:09.643017 [info ] [Thread-4  ]: 4 of 7 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.83s]
[0m19:58:09.643587 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:58:09.674224 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m19:58:09.676885 [debug] [Thread-1  ]: finished collecting timing info
[0m19:58:09.677159 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:58:09.829860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737e8b0>]}
[0m19:58:09.830664 [info ] [Thread-1  ]: 5 of 7 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.86s]
[0m19:58:09.831412 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:58:09.831982 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:58:09.832346 [info ] [Thread-3  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m19:58:09.833045 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:58:09.833336 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:58:09.833624 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:58:09.837793 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:58:09.839600 [debug] [Thread-3  ]: finished collecting timing info
[0m19:58:09.839849 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:58:09.850407 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:58:09.851705 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:58:09.851892 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m19:58:09.852049 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:58:11.043546 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.19 seconds
[0m19:58:11.055129 [debug] [Thread-3  ]: finished collecting timing info
[0m19:58:11.055569 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:58:11.244025 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733efd0>]}
[0m19:58:11.244799 [info ] [Thread-3  ]: 7 of 7 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.41s]
[0m19:58:11.245537 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:58:12.921580 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.87 seconds
[0m19:58:12.924232 [debug] [Thread-2  ]: finished collecting timing info
[0m19:58:12.924415 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m19:58:13.099107 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dbcd6c5-243b-458f-96b3-f81a56c2190d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107340100>]}
[0m19:58:13.099901 [info ] [Thread-2  ]: 6 of 7 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 1[0m in 4.12s]
[0m19:58:13.100661 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:58:13.102161 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:58:13.102727 [info ] [MainThread]: 
[0m19:58:13.103196 [info ] [MainThread]: Finished running 5 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m19:58:13.103609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:13.103821 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:58:13.104027 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:58:13.104218 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:58:13.104406 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:58:13.112186 [info ] [MainThread]: 
[0m19:58:13.112639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:58:13.113001 [info ] [MainThread]: 
[0m19:58:13.113316 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:58:13.113708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f1700>]}
[0m19:58:13.113997 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 19:59:46.855711 | 1e438617-dfd9-4303-b641-729e4c59980a ==============================
[0m19:59:46.855730 [info ] [MainThread]: Running with dbt=1.2.1
[0m19:59:46.856609 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:59:46.856737 [debug] [MainThread]: Tracking: tracking
[0m19:59:46.856959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105422760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105422520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054229d0>]}
[0m19:59:46.867892 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:59:46.868131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a59c10>]}
[0m19:59:46.883619 [debug] [MainThread]: Parsing macros/catalog.sql
[0m19:59:46.884905 [debug] [MainThread]: Parsing macros/adapters.sql
[0m19:59:46.906710 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m19:59:46.908601 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m19:59:46.911378 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m19:59:46.912139 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m19:59:46.913964 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m19:59:46.918278 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m19:59:46.918723 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:59:46.918999 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:59:46.919317 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:59:46.919575 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:59:46.919796 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m19:59:46.921690 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m19:59:46.922852 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m19:59:46.923680 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m19:59:46.932135 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m19:59:46.938812 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m19:59:46.944973 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m19:59:46.947350 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m19:59:46.948235 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m19:59:46.949059 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m19:59:46.951085 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m19:59:46.959350 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m19:59:46.960086 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m19:59:46.964493 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m19:59:46.971991 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m19:59:46.974533 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m19:59:46.975840 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m19:59:46.978369 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m19:59:46.978960 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m19:59:46.980497 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m19:59:46.981517 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m19:59:46.984734 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m19:59:46.993479 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m19:59:46.994186 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m19:59:46.995290 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m19:59:46.995999 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m19:59:46.996425 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m19:59:46.996816 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m19:59:46.997141 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m19:59:46.997765 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m19:59:46.999759 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m19:59:47.003673 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m19:59:47.004063 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m19:59:47.004626 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m19:59:47.005108 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m19:59:47.005630 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m19:59:47.006245 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m19:59:47.006639 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m19:59:47.007135 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m19:59:47.007637 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m19:59:47.008781 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m19:59:47.009357 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m19:59:47.009857 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m19:59:47.010346 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m19:59:47.010832 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m19:59:47.011274 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m19:59:47.011784 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m19:59:47.012203 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m19:59:47.014864 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m19:59:47.015298 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m19:59:47.016114 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m19:59:47.017059 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m19:59:47.017539 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m19:59:47.018559 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m19:59:47.019756 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m19:59:47.026642 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m19:59:47.027958 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m19:59:47.034144 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m19:59:47.036173 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m19:59:47.039452 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m19:59:47.044093 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m19:59:47.160776 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m19:59:47.166588 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m19:59:47.168037 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m19:59:47.169389 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m19:59:47.173384 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m19:59:47.173886 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m19:59:47.175144 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m19:59:47.176433 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m19:59:47.215910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cb0d0>]}
[0m19:59:47.219383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ef1c0>]}
[0m19:59:47.219550 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:59:47.219737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054229d0>]}
[0m19:59:47.220503 [info ] [MainThread]: 
[0m19:59:47.220767 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:59:47.221207 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m19:59:47.227272 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m19:59:47.227405 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m19:59:47.227506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:47.956560 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.73 seconds
[0m19:59:47.959025 [debug] [ThreadPool]: On list_airbnb: Close
[0m19:59:48.120236 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m19:59:48.129452 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m19:59:48.129738 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m19:59:48.129961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:48.900521 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.77 seconds
[0m19:59:48.904222 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m19:59:49.101009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b8df0>]}
[0m19:59:49.102000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:59:49.102559 [info ] [MainThread]: 
[0m19:59:49.109004 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m19:59:49.109307 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m19:59:49.109715 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m19:59:49.109922 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m19:59:49.110317 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m19:59:49.110549 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m19:59:49.110916 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m19:59:49.111131 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m19:59:49.111362 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m19:59:49.111570 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m19:59:49.111797 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m19:59:49.113766 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m19:59:49.114004 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m19:59:49.115300 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m19:59:49.118137 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m19:59:49.118620 [debug] [Thread-1  ]: finished collecting timing info
[0m19:59:49.119296 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m19:59:49.119537 [debug] [Thread-2  ]: finished collecting timing info
[0m19:59:49.119932 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m19:59:49.120136 [debug] [Thread-3  ]: finished collecting timing info
[0m19:59:49.120468 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m19:59:49.120755 [info ] [Thread-4  ]: 1 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m19:59:49.121146 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m19:59:49.121472 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m19:59:49.121904 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:59:49.122398 [info ] [Thread-1  ]: 2 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m19:59:49.122687 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m19:59:49.122850 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m19:59:49.123353 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:59:49.123513 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m19:59:49.123737 [info ] [Thread-2  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m19:59:49.123907 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m19:59:49.131669 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:59:49.132164 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:49.132332 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m19:59:49.132551 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m19:59:49.137957 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:59:49.138155 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m19:59:49.138301 [debug] [Thread-4  ]: finished collecting timing info
[0m19:59:49.144090 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m19:59:49.144300 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m19:59:49.144521 [debug] [Thread-1  ]: finished collecting timing info
[0m19:59:49.162241 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m19:59:49.162437 [debug] [Thread-2  ]: finished collecting timing info
[0m19:59:49.162607 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m19:59:49.162806 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m19:59:49.164979 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m19:59:49.172866 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m19:59:49.185330 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:49.185579 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m19:59:49.185704 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m19:59:49.185819 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:59:49.186368 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m19:59:49.186471 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:59:49.187349 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m19:59:49.187737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:49.868644 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m19:59:49.893120 [debug] [Thread-4  ]: finished collecting timing info
[0m19:59:49.894027 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m19:59:49.894243 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m19:59:49.896314 [debug] [Thread-1  ]: finished collecting timing info
[0m19:59:49.897335 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m19:59:50.029018 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.84 seconds
[0m19:59:50.042194 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:50.042473 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:59:50.060992 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105699e80>]}
[0m19:59:50.061499 [info ] [Thread-4  ]: 1 of 4 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.94s]
[0m19:59:50.062045 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m19:59:50.064009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105651220>]}
[0m19:59:50.064344 [info ] [Thread-1  ]: 2 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.94s]
[0m19:59:50.064772 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m19:59:50.065165 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m19:59:50.065472 [info ] [Thread-3  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m19:59:50.065983 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:59:50.066181 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m19:59:50.066377 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m19:59:50.068920 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:59:50.070911 [debug] [Thread-3  ]: finished collecting timing info
[0m19:59:50.071097 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m19:59:50.079338 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m19:59:50.080236 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m19:59:50.080387 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m19:59:50.080522 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:59:50.146132 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:59:50.148872 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:50.149075 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m19:59:50.250151 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:59:50.277822 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:50.284236 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m19:59:50.400824 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m19:59:50.403300 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:50.403442 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m19:59:50.509704 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m19:59:50.518626 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:59:50.529125 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m19:59:50.529847 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:50.530011 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m19:59:50.618897 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.09 seconds
[0m19:59:50.619246 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:50.619461 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m19:59:50.849316 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.23 seconds
[0m19:59:50.849668 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m19:59:50.849810 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m19:59:51.008437 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m19:59:51.016923 [debug] [Thread-2  ]: finished collecting timing info
[0m19:59:51.017209 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m19:59:51.199673 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595aee0>]}
[0m19:59:51.200322 [info ] [Thread-2  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.07s]
[0m19:59:51.201059 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m19:59:51.210347 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.13 seconds
[0m19:59:51.214292 [debug] [Thread-3  ]: finished collecting timing info
[0m19:59:51.214599 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m19:59:51.381973 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e438617-dfd9-4303-b641-729e4c59980a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a150d0>]}
[0m19:59:51.382715 [info ] [Thread-3  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.32s]
[0m19:59:51.383341 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m19:59:51.384689 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m19:59:51.385181 [info ] [MainThread]: 
[0m19:59:51.385578 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m19:59:51.385956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:51.386149 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m19:59:51.386334 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m19:59:51.386522 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m19:59:51.386705 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m19:59:51.393819 [info ] [MainThread]: 
[0m19:59:51.394136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:51.394453 [info ] [MainThread]: 
[0m19:59:51.394724 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:59:51.395054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562aca0>]}
[0m19:59:51.395279 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:09:00.422335 | e18ff2ef-dc3b-4baa-88b7-8c4f457f7683 ==============================
[0m20:09:00.422353 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:09:00.422904 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['scr_hosts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:09:00.423042 [debug] [MainThread]: Tracking: tracking
[0m20:09:00.423250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117cb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117cb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117cb9d0>]}
[0m20:09:00.452225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:00.452536 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/src/src_hosts.sql
[0m20:09:00.459616 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m20:09:00.471644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e18ff2ef-dc3b-4baa-88b7-8c4f457f7683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1a0d0>]}
[0m20:09:00.477374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e18ff2ef-dc3b-4baa-88b7-8c4f457f7683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b2d00>]}
[0m20:09:00.477564 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:09:00.477750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e18ff2ef-dc3b-4baa-88b7-8c4f457f7683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119186a0>]}
[0m20:09:00.478002 [warn ] [MainThread]: The selection criterion 'scr_hosts' does not match any nodes
[0m20:09:00.478500 [info ] [MainThread]: 
[0m20:09:00.478669 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:09:00.481521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b25e0>]}
[0m20:09:00.481652 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:09:22.097914 | ec0304d1-1703-4e69-a9da-92493ab889b1 ==============================
[0m20:09:22.097941 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:09:22.098381 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['src_hosts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:09:22.098499 [debug] [MainThread]: Tracking: tracking
[0m20:09:22.098724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ef520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ef9d0>]}
[0m20:09:22.119163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:09:22.119332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:09:22.122853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec0304d1-1703-4e69-a9da-92493ab889b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba0f10>]}
[0m20:09:22.126568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec0304d1-1703-4e69-a9da-92493ab889b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6a400>]}
[0m20:09:22.126769 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:09:22.126962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0304d1-1703-4e69-a9da-92493ab889b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6a460>]}
[0m20:09:22.127679 [info ] [MainThread]: 
[0m20:09:22.127958 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:09:22.128468 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:09:22.135461 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:09:22.135663 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:09:22.135756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:22.971994 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.84 seconds
[0m20:09:22.974033 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:09:23.126706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0304d1-1703-4e69-a9da-92493ab889b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c5250>]}
[0m20:09:23.127588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:23.128161 [info ] [MainThread]: 
[0m20:09:23.134009 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m20:09:23.134527 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m20:09:23.134781 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m20:09:23.135020 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:09:23.138160 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:09:23.138760 [debug] [Thread-1  ]: finished collecting timing info
[0m20:09:23.139207 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m20:09:23.140111 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:09:23.140491 [info ] [MainThread]: 
[0m20:09:23.140844 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m20:09:23.141163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:23.141335 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m20:09:23.148179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107154400>]}
[0m20:09:23.148480 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:11:01.013523 | 1cd8c554-292f-4557-94a0-5ba179e7afde ==============================
[0m20:11:01.013550 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:11:01.014166 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['src_hosts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:11:01.014277 [debug] [MainThread]: Tracking: tracking
[0m20:11:01.014574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756edf0>]}
[0m20:11:01.021040 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m20:11:01.021249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cd8c554-292f-4557-94a0-5ba179e7afde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107556520>]}
[0m20:11:01.040066 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:11:01.041468 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:11:01.064895 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m20:11:01.066797 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m20:11:01.069524 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m20:11:01.070279 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m20:11:01.072059 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m20:11:01.076654 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m20:11:01.077187 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:11:01.077562 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:11:01.078000 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:11:01.078271 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:11:01.078499 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:11:01.080308 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:11:01.081387 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:11:01.082177 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:11:01.090445 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:11:01.097189 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:11:01.103410 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:11:01.105536 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:11:01.106424 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:11:01.107327 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:11:01.109350 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:11:01.118014 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:11:01.118856 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:11:01.123453 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:11:01.131013 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:11:01.133571 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:11:01.134866 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:11:01.137381 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:11:01.137976 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:11:01.139535 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:11:01.140556 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:11:01.143857 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:11:01.152693 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:11:01.153375 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:11:01.154494 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:11:01.155204 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:11:01.155627 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:11:01.156013 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:11:01.156348 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:11:01.156980 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:11:01.158968 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:11:01.162880 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:11:01.163271 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:11:01.163833 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:11:01.164280 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:11:01.164712 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:11:01.165291 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:11:01.165699 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:11:01.166173 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:11:01.166674 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:11:01.167805 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:11:01.168384 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:11:01.168885 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:11:01.169371 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:11:01.169846 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:11:01.170272 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:11:01.170770 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:11:01.171203 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:11:01.173968 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:11:01.174402 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:11:01.175213 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:11:01.176161 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:11:01.176672 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:11:01.177731 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:11:01.178926 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:11:01.185721 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:11:01.187038 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:11:01.193219 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:11:01.195209 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:11:01.198465 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:11:01.202935 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:11:01.320984 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m20:11:01.326947 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m20:11:01.328398 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m20:11:01.329679 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m20:11:01.333709 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m20:11:01.334227 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m20:11:01.335458 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m20:11:01.336688 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m20:11:01.375608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cd8c554-292f-4557-94a0-5ba179e7afde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a6f70>]}
[0m20:11:01.378820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cd8c554-292f-4557-94a0-5ba179e7afde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107942040>]}
[0m20:11:01.378988 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:11:01.379171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cd8c554-292f-4557-94a0-5ba179e7afde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107799af0>]}
[0m20:11:01.379787 [info ] [MainThread]: 
[0m20:11:01.380044 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:11:01.380499 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:11:01.386472 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:11:01.386602 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:11:01.386699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:02.169948 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.78 seconds
[0m20:11:02.171188 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:11:02.315383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cd8c554-292f-4557-94a0-5ba179e7afde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799c490>]}
[0m20:11:02.315950 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:02.316272 [info ] [MainThread]: 
[0m20:11:02.320710 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m20:11:02.321096 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m20:11:02.321273 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m20:11:02.321425 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:11:02.323452 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:11:02.324097 [debug] [Thread-1  ]: finished collecting timing info
[0m20:11:02.324445 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m20:11:02.325120 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:11:02.325414 [info ] [MainThread]: 
[0m20:11:02.325694 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m20:11:02.325946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:02.326078 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m20:11:02.358219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aab160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f92b0>]}
[0m20:11:02.358433 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:12:14.103927 | acd9972a-97da-49d5-8d6e-f56b057da982 ==============================
[0m20:12:14.103954 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:12:14.104589 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['dim_hosts_cleansed'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:12:14.104700 [debug] [MainThread]: Tracking: tracking
[0m20:12:14.104902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774a970>]}
[0m20:12:14.129742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:14.129912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:14.134965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acd9972a-97da-49d5-8d6e-f56b057da982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108220f40>]}
[0m20:12:14.138841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acd9972a-97da-49d5-8d6e-f56b057da982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ea3d0>]}
[0m20:12:14.139054 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:12:14.139253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd9972a-97da-49d5-8d6e-f56b057da982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ea430>]}
[0m20:12:14.140205 [info ] [MainThread]: 
[0m20:12:14.140519 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:12:14.140941 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:12:14.147730 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:12:14.147847 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:12:14.147952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:14.970260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.82 seconds
[0m20:12:14.971913 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:12:15.135144 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:12:15.144359 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:12:15.144637 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:12:15.144855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:15.723471 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.58 seconds
[0m20:12:15.727390 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:12:15.933816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd9972a-97da-49d5-8d6e-f56b057da982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e3d00>]}
[0m20:12:15.934565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:15.935093 [info ] [MainThread]: 
[0m20:12:15.940864 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m20:12:15.941597 [info ] [Thread-1  ]: 1 of 1 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m20:12:15.942219 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:12:15.942459 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m20:12:15.942700 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m20:12:15.946207 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:12:15.948283 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:12:15.957418 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:12:15.958049 [debug] [Thread-1  ]: finished collecting timing info
[0m20:12:15.958250 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m20:12:15.979088 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:12:15.980187 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:12:15.980322 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (

with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m20:12:15.980435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:16.697729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.72 seconds
[0m20:12:16.713948 [debug] [Thread-1  ]: finished collecting timing info
[0m20:12:16.714228 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m20:12:16.877273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acd9972a-97da-49d5-8d6e-f56b057da982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e3d00>]}
[0m20:12:16.878091 [info ] [Thread-1  ]: 1 of 1 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.94s]
[0m20:12:16.878850 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m20:12:16.880324 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:12:16.880857 [info ] [MainThread]: 
[0m20:12:16.881263 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m20:12:16.881637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:16.881835 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m20:12:16.890323 [info ] [MainThread]: 
[0m20:12:16.890688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:16.891036 [info ] [MainThread]: 
[0m20:12:16.891342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:12:16.891716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e4d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e4ca0>]}
[0m20:12:16.891970 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:13:11.505396 | 462e494b-b407-416a-9e4e-0753af14e999 ==============================
[0m20:13:11.505458 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:13:11.506409 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['src_hosts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:13:11.506555 [debug] [MainThread]: Tracking: tracking
[0m20:13:11.506871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1adf0>]}
[0m20:13:11.534951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:11.535151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:11.539044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '462e494b-b407-416a-9e4e-0753af14e999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db8ee0>]}
[0m20:13:11.542950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '462e494b-b407-416a-9e4e-0753af14e999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d82280>]}
[0m20:13:11.543131 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:13:11.543316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '462e494b-b407-416a-9e4e-0753af14e999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d77f10>]}
[0m20:13:11.544008 [info ] [MainThread]: 
[0m20:13:11.544276 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:13:11.544827 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:13:11.551486 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:13:11.551644 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:13:11.551748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:12.363797 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.81 seconds
[0m20:13:12.365722 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:13:12.518096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '462e494b-b407-416a-9e4e-0753af14e999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7dc40>]}
[0m20:13:12.519001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:12.519579 [info ] [MainThread]: 
[0m20:13:12.525577 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m20:13:12.526098 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m20:13:12.526354 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m20:13:12.526596 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:13:12.529694 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:13:12.530544 [debug] [Thread-1  ]: finished collecting timing info
[0m20:13:12.531005 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m20:13:12.531946 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:13:12.532349 [info ] [MainThread]: 
[0m20:13:12.532726 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m20:13:12.533059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:12.533242 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m20:13:12.540122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105957ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105957100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059575b0>]}
[0m20:13:12.540387 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:14:09.494039 | 4fe7b5f4-3dba-4353-86ab-23bd4be3f7f8 ==============================
[0m20:14:09.494057 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:14:09.494664 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['dim_hosts_cleansed'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:14:09.494779 [debug] [MainThread]: Tracking: tracking
[0m20:14:09.495007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f13f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f13a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f13790>]}
[0m20:14:09.523488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:09.523664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:09.527523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe7b5f4-3dba-4353-86ab-23bd4be3f7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d1a90>]}
[0m20:14:09.531052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe7b5f4-3dba-4353-86ab-23bd4be3f7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffb550>]}
[0m20:14:09.531216 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:14:09.531399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe7b5f4-3dba-4353-86ab-23bd4be3f7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffb5b0>]}
[0m20:14:09.532071 [info ] [MainThread]: 
[0m20:14:09.532341 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:14:09.532804 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:14:09.540003 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:14:09.540204 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:14:09.540309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:10.271268 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.73 seconds
[0m20:14:10.272649 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:14:10.433593 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:14:10.440191 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:14:10.440403 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:14:10.440577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:11.197412 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.76 seconds
[0m20:14:11.200770 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:14:11.421172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe7b5f4-3dba-4353-86ab-23bd4be3f7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f13f10>]}
[0m20:14:11.422103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:11.422583 [info ] [MainThread]: 
[0m20:14:11.426956 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m20:14:11.427705 [info ] [Thread-1  ]: 1 of 1 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m20:14:11.428324 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:14:11.428563 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m20:14:11.428804 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m20:14:11.432071 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:14:11.434168 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:14:11.441598 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:14:11.441915 [debug] [Thread-1  ]: finished collecting timing info
[0m20:14:11.442093 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m20:14:11.462035 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:14:11.462785 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:14:11.462909 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (

with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m20:14:11.463022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:14:11.970881 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a79b7e-3201-ea44-0000-00015aae25a1
[0m20:14:11.971210 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m20:14:11.971518 [debug] [Thread-1  ]: finished collecting timing info
[0m20:14:11.971699 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m20:14:12.132744 [debug] [Thread-1  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m20:14:12.133271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7b5f4-3dba-4353-86ab-23bd4be3f7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105636220>]}
[0m20:14:12.133704 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.71s]
[0m20:14:12.134227 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m20:14:12.135320 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:14:12.135849 [info ] [MainThread]: 
[0m20:14:12.136192 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m20:14:12.136587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:12.136762 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m20:14:12.142914 [info ] [MainThread]: 
[0m20:14:12.143233 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:14:12.143497 [info ] [MainThread]: 
[0m20:14:12.143743 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m20:14:12.143983 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m20:14:12.144216 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m20:14:12.144446 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m20:14:12.144681 [info ] [MainThread]: 
[0m20:14:12.144912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:14:12.145205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c01f0>]}
[0m20:14:12.145414 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:15:59.815228 | 758fd81f-6afb-48dc-b7f1-6a1a7df2bb32 ==============================
[0m20:15:59.815270 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:15:59.817960 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['dim_hosts_cleansed'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:15:59.818146 [debug] [MainThread]: Tracking: tracking
[0m20:15:59.818790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b197c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b19dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b19f10>]}
[0m20:15:59.848630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:59.848928 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m20:15:59.858886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '758fd81f-6afb-48dc-b7f1-6a1a7df2bb32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c9f0d0>]}
[0m20:15:59.862218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '758fd81f-6afb-48dc-b7f1-6a1a7df2bb32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119befeb0>]}
[0m20:15:59.862400 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:15:59.862591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '758fd81f-6afb-48dc-b7f1-6a1a7df2bb32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c73e50>]}
[0m20:15:59.863297 [info ] [MainThread]: 
[0m20:15:59.863584 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:15:59.863997 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:15:59.870468 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:15:59.870649 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:15:59.870739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:00.610423 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.74 seconds
[0m20:16:00.612134 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:16:00.780894 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:16:00.789967 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:16:00.790259 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:16:00.790488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:01.472820 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.68 seconds
[0m20:16:01.475462 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:16:01.665852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '758fd81f-6afb-48dc-b7f1-6a1a7df2bb32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186ec460>]}
[0m20:16:01.666607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:16:01.667141 [info ] [MainThread]: 
[0m20:16:01.672700 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m20:16:01.673473 [info ] [Thread-1  ]: 1 of 1 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m20:16:01.674116 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:16:01.674369 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m20:16:01.674604 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m20:16:01.677797 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:16:01.679877 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:16:01.689433 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:16:01.689854 [debug] [Thread-1  ]: finished collecting timing info
[0m20:16:01.690043 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m20:16:01.710929 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:16:01.711816 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:16:01.711951 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (

with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m20:16:01.712066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:16:02.296696 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a79b80-3201-ec57-0000-00015aae5239
[0m20:16:02.297085 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m20:16:02.297310 [debug] [Thread-1  ]: finished collecting timing info
[0m20:16:02.297441 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m20:16:02.490029 [debug] [Thread-1  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m20:16:02.490568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '758fd81f-6afb-48dc-b7f1-6a1a7df2bb32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f46e20>]}
[0m20:16:02.490988 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.82s]
[0m20:16:02.491467 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m20:16:02.492476 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:16:02.492770 [info ] [MainThread]: 
[0m20:16:02.493034 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m20:16:02.493281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:02.493410 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m20:16:02.498840 [info ] [MainThread]: 
[0m20:16:02.499092 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:16:02.499298 [info ] [MainThread]: 
[0m20:16:02.499487 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m20:16:02.499669 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m20:16:02.499843 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m20:16:02.500017 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m20:16:02.500193 [info ] [MainThread]: 
[0m20:16:02.500394 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:16:02.500663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119befca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d6e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f935e0>]}
[0m20:16:02.500859 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:20:25.552827 | 0d733861-f97f-455b-9f51-403749aef99c ==============================
[0m20:20:25.552846 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:20:25.553575 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:20:25.553719 [debug] [MainThread]: Tracking: tracking
[0m20:20:25.553941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c6850>]}
[0m20:20:25.560201 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m20:20:25.560393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a59a0>]}
[0m20:20:25.579151 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:20:25.580489 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:20:25.603193 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m20:20:25.605208 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m20:20:25.607820 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m20:20:25.608466 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m20:20:25.610183 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m20:20:25.614906 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m20:20:25.615487 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:20:25.615790 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:20:25.616118 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:20:25.616372 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:20:25.616593 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:20:25.618363 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:20:25.619410 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:20:25.620183 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:20:25.628726 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:20:25.635426 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:20:25.641547 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:20:25.643831 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:20:25.644716 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:20:25.645566 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:20:25.647645 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:20:25.655913 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:20:25.656639 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:20:25.661003 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:20:25.668883 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:20:25.671530 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:20:25.672854 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:20:25.675431 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:20:25.676058 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:20:25.677601 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:20:25.678635 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:20:25.681883 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:20:25.690757 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:20:25.691472 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:20:25.692602 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:20:25.693322 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:20:25.693745 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:20:25.694134 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:20:25.694467 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:20:25.695104 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:20:25.697105 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:20:25.701093 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:20:25.701482 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:20:25.702051 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:20:25.702502 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:20:25.702947 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:20:25.703515 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:20:25.703897 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:20:25.704379 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:20:25.704883 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:20:25.706018 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:20:25.706591 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:20:25.707092 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:20:25.707589 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:20:25.708074 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:20:25.708507 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:20:25.709008 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:20:25.709427 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:20:25.712198 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:20:25.712635 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:20:25.713464 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:20:25.714415 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:20:25.714905 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:20:25.715933 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:20:25.717150 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:20:25.724017 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:20:25.725336 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:20:25.731507 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:20:25.733518 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:20:25.736873 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:20:25.741467 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:20:25.861055 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m20:20:25.867289 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m20:20:25.869628 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m20:20:25.871160 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m20:20:25.875562 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m20:20:25.876116 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m20:20:25.877443 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m20:20:25.878737 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m20:20:25.919766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c7ac0>]}
[0m20:20:25.923602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a57f0>]}
[0m20:20:25.923799 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:20:25.923996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565b1c0>]}
[0m20:20:25.925031 [info ] [MainThread]: 
[0m20:20:25.925329 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:20:25.925881 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:20:25.932556 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:20:25.932719 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:20:25.932817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:26.751144 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.82 seconds
[0m20:20:26.752485 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:20:26.911714 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:20:26.918836 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:20:26.919042 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:20:26.919205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:27.512043 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.59 seconds
[0m20:20:27.515727 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:20:27.664996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4b50>]}
[0m20:20:27.665777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:27.666225 [info ] [MainThread]: 
[0m20:20:27.672227 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m20:20:27.672487 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m20:20:27.672696 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m20:20:27.673059 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m20:20:27.673361 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m20:20:27.673639 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m20:20:27.674227 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m20:20:27.674769 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m20:20:27.675276 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m20:20:27.675494 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m20:20:27.675734 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m20:20:27.675960 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m20:20:27.676193 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:20:27.676406 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m20:20:27.676610 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m20:20:27.678528 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:20:27.679917 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m20:20:27.681264 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m20:20:27.682175 [debug] [Thread-3  ]: finished collecting timing info
[0m20:20:27.682366 [debug] [Thread-2  ]: finished collecting timing info
[0m20:20:27.682559 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m20:20:27.682746 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:27.682899 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m20:20:27.706293 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.src_reviews"
[0m20:20:27.706558 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m20:20:27.708883 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.src_listings"
[0m20:20:27.711224 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.src_hosts"
[0m20:20:27.712066 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m20:20:27.712459 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m20:20:27.712590 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m20:20:27.712909 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m20:20:27.713031 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m20:20:27.713153 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:20:27.713279 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m20:20:27.713387 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:20:27.714035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:28.416148 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m20:20:28.428985 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:28.429761 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m20:20:29.206560 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.49 seconds
[0m20:20:29.207525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0a700>]}
[0m20:20:29.209017 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.5 seconds
[0m20:20:29.211398 [debug] [Thread-3  ]: finished collecting timing info
[0m20:20:29.211898 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.53s]
[0m20:20:29.213776 [debug] [Thread-2  ]: finished collecting timing info
[0m20:20:29.214013 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m20:20:29.214526 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m20:20:29.214717 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m20:20:29.216432 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m20:20:29.217240 [info ] [Thread-4  ]: 4 of 7 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m20:20:29.217871 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:29.218071 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m20:20:29.218543 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m20:20:29.221899 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:29.223847 [debug] [Thread-4  ]: finished collecting timing info
[0m20:20:29.224073 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m20:20:29.227066 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:29.227904 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:29.228072 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m20:20:29.228224 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:20:29.579212 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be1850>]}
[0m20:20:29.579773 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c8790>]}
[0m20:20:29.620401 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.90s]
[0m20:20:29.641282 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.90s]
[0m20:20:29.648820 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m20:20:29.649069 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m20:20:29.661164 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m20:20:29.661304 [info ] [Thread-1  ]: 5 of 7 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m20:20:29.661572 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:20:29.661667 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m20:20:29.661758 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m20:20:29.663161 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:20:29.663299 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m20:20:29.663449 [info ] [Thread-2  ]: 6 of 7 START incremental model dev.fact_reviews ................................ [RUN]
[0m20:20:29.663696 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:29.663787 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m20:20:29.663875 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m20:20:29.666889 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m20:20:29.668818 [debug] [Thread-2  ]: finished collecting timing info
[0m20:20:29.668934 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m20:20:29.686268 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:29.686520 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m20:20:29.686751 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:29.686852 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:20:29.687130 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m20:20:29.689888 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:20:29.690551 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:20:29.690652 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m20:20:29.690740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:30.115834 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m20:20:30.118731 [debug] [Thread-4  ]: finished collecting timing info
[0m20:20:30.118858 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m20:20:30.386198 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c71c0>]}
[0m20:20:30.386722 [info ] [Thread-4  ]: 4 of 7 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.17s]
[0m20:20:30.387118 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m20:20:30.494326 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.8 seconds
[0m20:20:30.496751 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:30.496970 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m20:20:30.648230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107949220>]}
[0m20:20:30.648830 [info ] [Thread-1  ]: 5 of 7 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.99s]
[0m20:20:30.649293 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m20:20:30.649702 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m20:20:30.649930 [info ] [Thread-3  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m20:20:30.650377 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:30.650544 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m20:20:30.650707 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m20:20:30.653582 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:30.654226 [debug] [Thread-3  ]: finished collecting timing info
[0m20:20:30.654391 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m20:20:30.662081 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:30.663053 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:30.663204 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m20:20:30.663326 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:20:32.538195 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.85 seconds
[0m20:20:32.551913 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:32.552163 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:20:32.666637 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m20:20:32.673674 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:32.674030 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m20:20:32.765795 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m20:20:32.781832 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:32.782204 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:20:32.878679 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m20:20:32.884012 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:32.884320 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m20:20:32.990166 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m20:20:33.002578 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:20:33.014555 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m20:20:33.015645 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:33.015814 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m20:20:33.169181 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m20:20:33.170504 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:33.170805 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m20:20:33.406500 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.24 seconds
[0m20:20:33.407306 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:33.407585 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m20:20:33.625859 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:20:33.627671 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.96 seconds
[0m20:20:33.637369 [debug] [Thread-2  ]: finished collecting timing info
[0m20:20:33.640111 [debug] [Thread-3  ]: finished collecting timing info
[0m20:20:33.640318 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m20:20:33.640471 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m20:20:33.813036 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556dee0>]}
[0m20:20:33.813781 [info ] [Thread-3  ]: 7 of 7 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 3.16s]
[0m20:20:33.814354 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d733861-f97f-455b-9f51-403749aef99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107917190>]}
[0m20:20:33.814994 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m20:20:33.815399 [info ] [Thread-2  ]: 6 of 7 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 4.15s]
[0m20:20:33.816097 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m20:20:33.817586 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:20:33.818289 [info ] [MainThread]: 
[0m20:20:33.818767 [info ] [MainThread]: Finished running 5 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m20:20:33.819149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:33.819347 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m20:20:33.819543 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m20:20:33.819731 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m20:20:33.819919 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m20:20:33.827731 [info ] [MainThread]: 
[0m20:20:33.827979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:33.828168 [info ] [MainThread]: 
[0m20:20:33.828318 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:20:33.828550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079623d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107904df0>]}
[0m20:20:33.828740 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:20:49.915963 | d96f12ca-dfda-44b5-93f3-b5a54e5ba97c ==============================
[0m20:20:49.916039 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:20:49.916799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:20:49.916931 [debug] [MainThread]: Tracking: tracking
[0m20:20:49.917303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11128a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11128a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11128a9d0>]}
[0m20:20:49.930506 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:20:49.930804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb5b80>]}
[0m20:20:49.947616 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:20:49.948922 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:20:49.971160 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m20:20:49.973066 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m20:20:49.975631 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m20:20:49.976428 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m20:20:49.978221 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m20:20:49.982567 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m20:20:49.983033 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:20:49.983313 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:20:49.983635 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:20:49.983908 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:20:49.984147 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:20:49.985948 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:20:49.987020 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:20:49.987851 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:20:49.996276 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:20:50.003141 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:20:50.009293 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:20:50.011415 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:20:50.012251 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:20:50.013082 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:20:50.015078 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:20:50.023559 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:20:50.024329 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:20:50.028773 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:20:50.036402 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:20:50.038984 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:20:50.040300 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:20:50.042832 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:20:50.043435 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:20:50.044975 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:20:50.045999 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:20:50.049264 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:20:50.058133 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:20:50.058856 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:20:50.060001 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:20:50.060734 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:20:50.061168 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:20:50.061561 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:20:50.061894 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:20:50.062533 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:20:50.064551 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:20:50.068490 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:20:50.068882 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:20:50.069453 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:20:50.069904 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:20:50.070343 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:20:50.070919 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:20:50.071298 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:20:50.071773 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:20:50.072281 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:20:50.073423 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:20:50.074000 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:20:50.074503 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:20:50.075006 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:20:50.075490 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:20:50.075927 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:20:50.076431 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:20:50.076851 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:20:50.079649 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:20:50.080131 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:20:50.080979 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:20:50.081947 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:20:50.082440 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:20:50.083467 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:20:50.084667 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:20:50.091470 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:20:50.092838 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:20:50.099010 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:20:50.101022 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:20:50.104316 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:20:50.108944 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:20:50.223895 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m20:20:50.229742 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m20:20:50.231287 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m20:20:50.232639 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m20:20:50.236610 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m20:20:50.237116 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m20:20:50.238345 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m20:20:50.239561 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m20:20:50.279797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115400d0>]}
[0m20:20:50.283448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115632b0>]}
[0m20:20:50.283624 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:20:50.283814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111270e20>]}
[0m20:20:50.284576 [info ] [MainThread]: 
[0m20:20:50.284832 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:20:50.285250 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:20:50.291366 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:20:50.291504 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:20:50.291598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:50.998260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.71 seconds
[0m20:20:50.999665 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:20:51.218432 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:20:51.224666 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:20:51.224809 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:20:51.224902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:51.874394 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.65 seconds
[0m20:20:51.880010 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:20:52.049278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11151ecd0>]}
[0m20:20:52.050167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:52.050723 [info ] [MainThread]: 
[0m20:20:52.056563 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m20:20:52.056867 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m20:20:52.057276 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m20:20:52.057487 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m20:20:52.057888 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m20:20:52.058130 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m20:20:52.058539 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m20:20:52.058778 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m20:20:52.059031 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:20:52.059251 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m20:20:52.059467 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m20:20:52.061383 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:20:52.061627 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m20:20:52.063036 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m20:20:52.065904 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m20:20:52.066400 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:52.066946 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m20:20:52.067273 [debug] [Thread-2  ]: finished collecting timing info
[0m20:20:52.067565 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m20:20:52.067726 [debug] [Thread-3  ]: finished collecting timing info
[0m20:20:52.068056 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m20:20:52.068318 [info ] [Thread-4  ]: 1 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m20:20:52.068659 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m20:20:52.069194 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:52.069411 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m20:20:52.069674 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m20:20:52.069841 [debug] [Thread-3  ]: Began running node model.learn_dbt.fact_reviews
[0m20:20:52.070082 [info ] [Thread-1  ]: 2 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m20:20:52.070253 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m20:20:52.070467 [info ] [Thread-3  ]: 3 of 4 START incremental model dev.fact_reviews ................................ [RUN]
[0m20:20:52.070919 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:20:52.079553 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:52.079992 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:52.080155 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m20:20:52.080371 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.fact_reviews
[0m20:20:52.080515 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m20:20:52.080692 [debug] [Thread-3  ]: Compiling model.learn_dbt.fact_reviews
[0m20:20:52.080851 [debug] [Thread-4  ]: finished collecting timing info
[0m20:20:52.086103 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:20:52.091451 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m20:20:52.091634 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m20:20:52.104446 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:52.109652 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:52.109864 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m20:20:52.110142 [debug] [Thread-3  ]: finished collecting timing info
[0m20:20:52.112186 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:20:52.112357 [debug] [Thread-3  ]: Began executing node model.learn_dbt.fact_reviews
[0m20:20:52.112874 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:20:52.124329 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m20:20:52.124521 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:20:52.132279 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:20:52.135068 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:52.135173 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m20:20:52.135446 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m20:20:52.135893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:52.136014 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:20:52.873302 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.74 seconds
[0m20:20:52.885938 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:52.886163 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m20:20:52.913598 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m20:20:52.915178 [debug] [Thread-4  ]: finished collecting timing info
[0m20:20:52.915327 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m20:20:53.029591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11199c9a0>]}
[0m20:20:53.030118 [info ] [Thread-1  ]: 2 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.96s]
[0m20:20:53.030626 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m20:20:53.046206 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.91 seconds
[0m20:20:53.055376 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:53.055696 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:20:53.058094 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111540af0>]}
[0m20:20:53.058433 [info ] [Thread-4  ]: 1 of 4 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.99s]
[0m20:20:53.058828 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m20:20:53.059495 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m20:20:53.059724 [info ] [Thread-2  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m20:20:53.060133 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:53.060291 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m20:20:53.060729 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m20:20:53.063281 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:53.063886 [debug] [Thread-2  ]: finished collecting timing info
[0m20:20:53.064050 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m20:20:53.071409 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:53.072341 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:20:53.072484 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m20:20:53.072609 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:20:53.151642 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m20:20:53.154412 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:53.154563 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m20:20:53.316074 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.16 seconds
[0m20:20:53.335049 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:53.335297 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:20:53.434145 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m20:20:53.442158 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:53.442268 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m20:20:53.528829 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m20:20:53.535089 [debug] [Thread-3  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:20:53.543077 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m20:20:53.544403 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:53.544552 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m20:20:53.651072 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:20:53.651396 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:53.651562 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m20:20:53.798178 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.15 seconds
[0m20:20:53.798556 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:20:53.798713 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m20:20:53.945659 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m20:20:53.952407 [debug] [Thread-3  ]: finished collecting timing info
[0m20:20:53.952624 [debug] [Thread-3  ]: On model.learn_dbt.fact_reviews: Close
[0m20:20:54.151620 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11199c340>]}
[0m20:20:54.152389 [info ] [Thread-3  ]: 3 of 4 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.07s]
[0m20:20:54.152841 [debug] [Thread-3  ]: Finished running node model.learn_dbt.fact_reviews
[0m20:20:54.366310 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.29 seconds
[0m20:20:54.370771 [debug] [Thread-2  ]: finished collecting timing info
[0m20:20:54.371086 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m20:20:54.528063 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96f12ca-dfda-44b5-93f3-b5a54e5ba97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ca340>]}
[0m20:20:54.528819 [info ] [Thread-2  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.47s]
[0m20:20:54.529554 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m20:20:54.531043 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:20:54.531610 [info ] [MainThread]: 
[0m20:20:54.532099 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m20:20:54.532555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:54.532792 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m20:20:54.533026 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m20:20:54.533254 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m20:20:54.533464 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m20:20:54.541015 [info ] [MainThread]: 
[0m20:20:54.541379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:54.541726 [info ] [MainThread]: 
[0m20:20:54.542033 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:20:54.542402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111946fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111946bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111540100>]}
[0m20:20:54.542657 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:29:19.055259 | 735737f8-4d1e-4a96-b7da-08af8f93fa05 ==============================
[0m20:29:19.055304 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:29:19.056429 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m20:29:19.056654 [debug] [MainThread]: Tracking: tracking
[0m20:29:19.057288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052119d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052112e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105232e20>]}
[0m20:29:19.086991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:19.087176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:19.091124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '735737f8-4d1e-4a96-b7da-08af8f93fa05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ca0d0>]}
[0m20:29:19.095166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '735737f8-4d1e-4a96-b7da-08af8f93fa05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105397490>]}
[0m20:29:19.095368 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:29:19.095557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735737f8-4d1e-4a96-b7da-08af8f93fa05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053974f0>]}
[0m20:29:19.096434 [info ] [MainThread]: 
[0m20:29:19.096677 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:29:19.100059 [info ] [MainThread]: 
[0m20:29:19.100261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:19.100437 [info ] [MainThread]: 
[0m20:29:19.100597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m20:29:19.100782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105217d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053971c0>]}
[0m20:29:19.100907 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:31:00.689411 | 0552046d-0380-4c37-ac07-6446a24d2e54 ==============================
[0m20:31:00.689450 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:31:00.690051 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m20:31:00.690155 [debug] [MainThread]: Tracking: tracking
[0m20:31:00.690391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090de490>]}
[0m20:31:00.721332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:31:00.721571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:31:00.725537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0552046d-0380-4c37-ac07-6446a24d2e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092760d0>]}
[0m20:31:00.729715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0552046d-0380-4c37-ac07-6446a24d2e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109244460>]}
[0m20:31:00.729954 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:31:00.730149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0552046d-0380-4c37-ac07-6446a24d2e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092444c0>]}
[0m20:31:00.730992 [info ] [MainThread]: 
[0m20:31:00.731174 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:31:00.734814 [info ] [MainThread]: 
[0m20:31:00.735019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:00.735183 [info ] [MainThread]: 
[0m20:31:00.735335 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m20:31:00.735526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109244220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092442b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b5af0>]}
[0m20:31:00.735654 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:34:23.287697 | 71ca342e-15a5-4d79-a0be-bcbf088635ba ==============================
[0m20:34:23.287716 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:34:23.288492 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m20:34:23.288604 [debug] [MainThread]: Tracking: tracking
[0m20:34:23.288832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba165b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba164c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba16970>]}
[0m20:34:23.301188 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:34:23.301464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '71ca342e-15a5-4d79-a0be-bcbf088635ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a61a760>]}
[0m20:34:23.326077 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:34:23.327448 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:34:23.349960 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m20:34:23.351926 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m20:34:23.354782 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m20:34:23.355541 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m20:34:23.357378 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m20:34:23.361991 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m20:34:23.362558 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:34:23.362857 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:34:23.363181 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:34:23.363500 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:34:23.363815 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:34:23.365666 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:34:23.366768 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:34:23.367583 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:34:23.375913 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:34:23.382698 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:34:23.388828 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:34:23.391079 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:34:23.391991 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:34:23.392833 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:34:23.394924 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:34:23.403377 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:34:23.404157 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:34:23.408608 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:34:23.416335 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:34:23.418912 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:34:23.420209 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:34:23.422755 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:34:23.423347 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:34:23.424885 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:34:23.425934 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:34:23.429164 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:34:23.438040 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:34:23.438769 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:34:23.439899 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:34:23.440612 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:34:23.441033 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:34:23.441431 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:34:23.441763 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:34:23.442393 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:34:23.444404 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:34:23.448369 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:34:23.448761 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:34:23.449370 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:34:23.449822 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:34:23.450258 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:34:23.450819 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:34:23.451192 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:34:23.451679 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:34:23.452175 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:34:23.453316 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:34:23.453891 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:34:23.454408 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:34:23.454917 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:34:23.455411 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:34:23.455845 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:34:23.456352 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:34:23.456767 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:34:23.459409 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:34:23.459842 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:34:23.460664 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:34:23.461625 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:34:23.462103 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:34:23.463123 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:34:23.464313 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:34:23.471321 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:34:23.472676 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:34:23.478877 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:34:23.480886 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:34:23.484166 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:34:23.488880 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:34:23.607167 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m20:34:23.613266 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m20:34:23.614775 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m20:34:23.616120 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m20:34:23.620151 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m20:34:23.620671 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m20:34:23.621925 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m20:34:23.623142 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m20:34:23.664175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71ca342e-15a5-4d79-a0be-bcbf088635ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bce20d0>]}
[0m20:34:23.668417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71ca342e-15a5-4d79-a0be-bcbf088635ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9ed670>]}
[0m20:34:23.668596 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:34:23.668784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71ca342e-15a5-4d79-a0be-bcbf088635ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba16970>]}
[0m20:34:23.669443 [info ] [MainThread]: 
[0m20:34:23.669623 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:34:23.672809 [info ] [MainThread]: 
[0m20:34:23.673019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:23.673192 [info ] [MainThread]: 
[0m20:34:23.673346 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m20:34:23.673536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bce2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bce23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bce2dc0>]}
[0m20:34:23.673676 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:38:30.319314 | 6aedb355-f9bb-491c-90f6-52c4f0769f9c ==============================
[0m20:38:30.319339 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:38:30.319988 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m20:38:30.320162 [debug] [MainThread]: Tracking: tracking
[0m20:38:30.320400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db2eb0>]}
[0m20:38:30.332588 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:38:30.332858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6aedb355-f9bb-491c-90f6-52c4f0769f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ebf40>]}
[0m20:38:30.351459 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:38:30.352698 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:38:30.375274 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m20:38:30.377125 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m20:38:30.380223 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m20:38:30.381013 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m20:38:30.382878 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m20:38:30.387395 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m20:38:30.387916 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:38:30.388238 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:38:30.388585 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:38:30.388862 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:38:30.389105 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:38:30.391120 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:38:30.392330 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:38:30.393159 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:38:30.401740 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:38:30.408494 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:38:30.414563 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:38:30.416749 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:38:30.417610 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:38:30.418465 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:38:30.420541 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:38:30.429183 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:38:30.430039 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:38:30.434564 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:38:30.442329 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:38:30.445026 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:38:30.446382 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:38:30.448992 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:38:30.449617 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:38:30.451223 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:38:30.452303 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:38:30.455671 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:38:30.464768 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:38:30.465530 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:38:30.466694 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:38:30.467444 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:38:30.467885 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:38:30.468285 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:38:30.468623 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:38:30.469274 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:38:30.471392 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:38:30.475530 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:38:30.475966 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:38:30.476560 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:38:30.477026 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:38:30.477481 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:38:30.478080 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:38:30.478477 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:38:30.478983 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:38:30.479504 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:38:30.480702 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:38:30.481294 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:38:30.481815 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:38:30.482327 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:38:30.482834 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:38:30.483278 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:38:30.483806 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:38:30.484244 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:38:30.487038 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:38:30.487507 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:38:30.488366 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:38:30.489360 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:38:30.489869 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:38:30.490949 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:38:30.492201 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:38:30.499371 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:38:30.500788 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:38:30.507260 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:38:30.509390 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:38:30.512882 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:38:30.517800 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:38:30.640616 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m20:38:30.646913 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m20:38:30.648495 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m20:38:30.649867 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m20:38:30.654210 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m20:38:30.654805 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m20:38:30.656099 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m20:38:30.657372 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m20:38:30.706819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6aedb355-f9bb-491c-90f6-52c4f0769f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f893d0>]}
[0m20:38:30.711935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6aedb355-f9bb-491c-90f6-52c4f0769f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db24c0>]}
[0m20:38:30.712193 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m20:38:30.712398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6aedb355-f9bb-491c-90f6-52c4f0769f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d90e80>]}
[0m20:38:30.718656 [info ] [MainThread]: 
[0m20:38:30.719155 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:38:30.719699 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:38:30.728156 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:38:30.728342 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:38:30.728439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:31.670268 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.94 seconds
[0m20:38:31.671307 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:38:31.849293 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:38:31.853221 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:38:31.853372 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:38:31.853466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:32.524213 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.67 seconds
[0m20:38:32.528541 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:38:32.700971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6aedb355-f9bb-491c-90f6-52c4f0769f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f896d0>]}
[0m20:38:32.701643 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:32.701910 [info ] [MainThread]: 
[0m20:38:32.705960 [debug] [Thread-1  ]: Began running node seed.learn_dbt.test_data
[0m20:38:32.743777 [info ] [Thread-1  ]: 1 of 1 START seed file dev.test_data ........................................... [RUN]
[0m20:38:32.744152 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.learn_dbt.test_data"
[0m20:38:32.744394 [debug] [Thread-1  ]: Began compiling node seed.learn_dbt.test_data
[0m20:38:32.744579 [debug] [Thread-1  ]: finished collecting timing info
[0m20:38:32.744709 [debug] [Thread-1  ]: Began executing node seed.learn_dbt.test_data
[0m20:38:37.675537 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:37.675704 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
create table airbnb.dev.test_data (productname text,orderid text,skucode text)
[0m20:38:37.675794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:38:38.236147 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m20:38:38.327398 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:38.327611 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:38.449524 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:38:38.823467 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:38.823676 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:40.823490 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 2.0 seconds
[0m20:38:40.824945 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:40.825561 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:41.045695 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:38:41.129772 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:41.129999 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:41.249198 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:38:41.618954 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:41.619162 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:43.386061 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.77 seconds
[0m20:38:43.387241 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:43.387833 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:43.626644 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:38:43.717588 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:43.717798 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:43.830113 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:38:44.198321 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:44.198536 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:45.743443 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.54 seconds
[0m20:38:45.745216 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:45.745758 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:45.986988 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:38:46.094779 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:46.094997 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:46.217008 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:38:46.596384 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:46.596569 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:48.183996 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.59 seconds
[0m20:38:48.185104 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:48.185284 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:48.395641 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:38:48.500574 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:48.500763 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:48.609110 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:38:48.988566 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:48.988800 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:50.483542 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.49 seconds
[0m20:38:50.488348 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:50.488471 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:50.720773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:38:50.865142 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:50.865359 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:50.981534 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:38:51.362482 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:51.362800 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:52.693891 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.33 seconds
[0m20:38:52.695121 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:52.695642 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:52.903711 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:38:53.008112 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:53.008370 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:53.105047 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:38:53.479678 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:53.479892 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:54.837191 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.36 seconds
[0m20:38:54.838117 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:54.838639 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:55.116756 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:38:55.276336 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:55.276607 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:55.480282 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m20:38:55.888544 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:55.888777 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:57.295009 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.41 seconds
[0m20:38:57.297304 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:57.298048 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:57.526666 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:38:57.625110 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:57.625341 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:38:57.748071 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:38:58.139398 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:58.139619 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:38:59.623670 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.48 seconds
[0m20:38:59.625408 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:59.626107 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:38:59.851990 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:38:59.964309 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:38:59.964537 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:00.097559 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m20:39:00.500099 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:00.500390 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:02.284301 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.78 seconds
[0m20:39:02.285991 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:02.286461 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:02.543141 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m20:39:02.694705 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:02.694943 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:02.805627 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:03.180872 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:03.181091 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:04.542299 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.36 seconds
[0m20:39:04.543888 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:04.544100 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:04.797996 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:39:04.931051 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:04.931297 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:05.124684 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m20:39:05.518609 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:05.520881 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:07.102259 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.58 seconds
[0m20:39:07.103462 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:07.103869 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:07.326576 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:39:07.489562 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:07.489788 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:07.598235 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:07.984175 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:07.984387 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:09.303806 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.32 seconds
[0m20:39:09.305524 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:09.305936 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:09.528403 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:39:09.660649 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:09.661003 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:09.757779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:39:10.144730 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:10.146325 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:11.600420 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.45 seconds
[0m20:39:11.602122 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:11.602823 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:11.826076 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:39:11.944234 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:11.944615 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:12.138884 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m20:39:12.561226 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:12.561628 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:14.323518 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.76 seconds
[0m20:39:14.325267 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:14.325379 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:14.542871 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:39:14.661048 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:14.661336 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:14.764423 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:39:15.162062 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:15.162316 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:17.010164 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.85 seconds
[0m20:39:17.012079 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:17.012546 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:17.227098 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:39:17.353169 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:17.353404 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:17.558920 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:39:17.988923 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:18.006413 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:19.389377 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.38 seconds
[0m20:39:19.389923 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:19.390032 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:19.688931 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.3 seconds
[0m20:39:19.782032 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:19.782329 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:19.886567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:39:20.288760 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:20.289076 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:22.064497 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.78 seconds
[0m20:39:22.066837 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:22.067258 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:22.316995 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:39:22.444513 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:22.444737 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:22.623141 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m20:39:23.013060 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:23.013272 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:24.607910 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.59 seconds
[0m20:39:24.609745 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:24.610483 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:24.836856 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:39:24.963542 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:24.963853 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:25.082529 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:39:25.456640 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:25.456834 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:26.911981 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.45 seconds
[0m20:39:26.914318 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:26.915769 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:27.134900 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:39:27.261493 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:27.261701 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:27.374016 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:27.743512 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:27.743655 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:29.221155 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.48 seconds
[0m20:39:29.223112 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:29.223857 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:29.449057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:39:29.572591 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:29.572834 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:29.683648 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:30.056231 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:30.056447 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:31.478840 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.42 seconds
[0m20:39:31.480452 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:31.481179 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:31.710027 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:39:31.832703 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:31.832911 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:31.930436 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:39:32.304191 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:32.304396 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:33.744219 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.44 seconds
[0m20:39:33.747483 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:33.748367 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:34.157277 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.41 seconds
[0m20:39:34.280372 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:34.280579 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:34.427821 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m20:39:34.810442 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:34.810691 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:36.138563 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.33 seconds
[0m20:39:36.140666 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:36.141712 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:36.376881 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:39:36.502394 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:36.502722 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:36.605109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:39:36.979540 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:36.979754 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:38.423607 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.44 seconds
[0m20:39:38.425186 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:38.425775 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:38.652180 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:39:38.755919 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:38.756137 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:38.865241 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:39.242065 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:39.242257 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:40.654340 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.41 seconds
[0m20:39:40.656565 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:40.657266 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:40.864052 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:39:40.990079 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:40.990326 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:41.103116 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:41.480452 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:41.480688 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:42.941538 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.46 seconds
[0m20:39:42.944546 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:42.944978 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:43.195357 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:39:43.328455 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:43.328667 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:43.446608 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:39:43.844693 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:43.844948 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:45.254591 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.41 seconds
[0m20:39:45.256948 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:45.257515 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:45.487378 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:39:45.614481 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:45.614793 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:45.792588 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m20:39:46.180404 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:46.180608 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:47.789998 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.61 seconds
[0m20:39:47.792872 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:47.793751 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:48.012956 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:39:48.136810 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:48.137107 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:48.286327 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m20:39:48.667574 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:48.667778 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:50.208357 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.54 seconds
[0m20:39:50.210873 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:50.211686 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:50.505142 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m20:39:50.632766 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:50.633014 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:50.737010 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:39:51.113995 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:51.114255 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:52.556843 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.44 seconds
[0m20:39:52.559039 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:52.559805 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:52.791959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:39:52.913261 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:52.913559 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:53.039639 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m20:39:53.415943 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:53.416152 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:54.815699 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.4 seconds
[0m20:39:54.817909 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:54.818633 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:55.128221 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m20:39:55.251882 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:55.252104 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:55.358668 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:55.732469 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:55.732643 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:57.524831 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.79 seconds
[0m20:39:57.526876 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:57.527538 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:39:57.860841 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.33 seconds
[0m20:39:57.989729 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:57.989949 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:39:58.096143 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:39:58.470879 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:58.471030 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:39:59.878566 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.41 seconds
[0m20:39:59.881003 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:39:59.881862 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:00.106912 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:40:00.234321 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:00.234525 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:00.369250 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m20:40:00.744628 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:00.744825 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:02.473349 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.73 seconds
[0m20:40:02.475504 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:02.476210 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:02.735864 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m20:40:02.856437 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:02.856763 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:02.964974 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:03.335695 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:03.335903 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:04.920264 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.58 seconds
[0m20:40:04.922654 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:04.923887 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:05.139493 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:40:05.258126 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:05.258343 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:05.364617 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:05.738725 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:05.738949 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:07.223560 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.48 seconds
[0m20:40:07.226130 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:07.226932 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:07.481500 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:40:07.608294 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:07.608510 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:07.841742 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:40:08.244347 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:08.244558 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:09.944988 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.7 seconds
[0m20:40:09.947210 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:09.947852 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:10.190233 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:40:10.317698 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:10.318061 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:10.430902 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:10.809761 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:10.809960 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:12.430899 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.62 seconds
[0m20:40:12.432981 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:12.433798 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:12.709739 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:40:12.835018 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:12.835371 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:13.085622 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:40:13.488718 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:13.488938 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:15.239339 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.75 seconds
[0m20:40:15.240956 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:15.241775 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:15.470394 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:40:15.595881 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:15.596153 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:15.703275 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:16.076763 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:16.076957 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:17.756119 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.68 seconds
[0m20:40:17.758445 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:17.759070 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:17.974137 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:40:18.101620 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:18.101817 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:18.433576 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.33 seconds
[0m20:40:18.835948 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:18.836161 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:20.621789 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.79 seconds
[0m20:40:20.624620 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:20.625353 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:20.892811 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:40:21.016298 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:21.016605 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:21.122679 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:21.497715 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:21.497915 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:23.284747 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.79 seconds
[0m20:40:23.287490 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:23.288107 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:23.570934 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:40:23.697980 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:23.698277 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:23.814481 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:40:24.202021 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:24.202267 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:25.684983 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.48 seconds
[0m20:40:25.687308 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:25.688086 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:25.903177 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:40:25.996293 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:25.996510 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:26.157100 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m20:40:26.541810 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:26.542009 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:28.535182 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.99 seconds
[0m20:40:28.536325 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:28.536770 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:28.813891 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:40:28.941145 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:28.941445 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:29.055464 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:29.430098 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:29.430321 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:31.119339 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.69 seconds
[0m20:40:31.121615 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:31.124998 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:31.394541 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:40:31.521894 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:31.522094 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:31.700331 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m20:40:32.086884 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:32.087089 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:33.403004 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.32 seconds
[0m20:40:33.405975 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:33.406810 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:33.656648 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:40:33.785688 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:33.786028 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:34.055911 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:40:34.453582 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:34.453775 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:35.919140 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.47 seconds
[0m20:40:35.921037 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:35.921830 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:36.392496 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m20:40:36.515568 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:36.515855 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:36.643173 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m20:40:37.019379 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:37.019591 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:38.833325 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.81 seconds
[0m20:40:38.835088 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:38.835909 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:39.046109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:40:39.177256 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:39.177470 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:39.399227 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:40:39.795753 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:39.795993 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:41.103250 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.31 seconds
[0m20:40:41.105392 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:41.106256 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:41.396843 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m20:40:41.526165 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:41.526467 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:41.633878 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:42.019839 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:42.020118 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:43.193690 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.17 seconds
[0m20:40:43.195592 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:43.196361 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:43.493782 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.3 seconds
[0m20:40:43.619379 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:43.619613 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:43.731246 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:40:44.104718 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:44.104881 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:45.592643 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.49 seconds
[0m20:40:45.595045 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:45.595981 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:45.835130 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:40:45.962740 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:45.962968 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:46.087099 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:40:46.460809 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:46.460986 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:48.082553 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.62 seconds
[0m20:40:48.084486 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:48.085762 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:48.317075 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:40:48.440132 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:48.440339 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:48.735195 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m20:40:49.127829 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:49.128011 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:51.136496 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 2.01 seconds
[0m20:40:51.139068 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:51.139912 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:51.423856 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:40:51.551064 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:51.551361 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:51.884065 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.33 seconds
[0m20:40:52.285779 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:52.285986 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:54.205673 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.92 seconds
[0m20:40:54.207604 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:54.208765 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:54.435323 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:40:54.557953 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:54.558255 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:54.660879 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:40:55.036463 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:55.036658 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:56.624410 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.59 seconds
[0m20:40:56.626492 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:56.627220 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:56.848894 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:40:56.966542 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:56.966757 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:57.234209 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:40:57.642933 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:57.643146 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:40:59.224105 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.58 seconds
[0m20:40:59.225749 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:59.226320 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:40:59.473023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:40:59.596216 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:40:59.596540 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:40:59.716988 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:41:00.090897 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:00.091116 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:01.604445 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.51 seconds
[0m20:41:01.606409 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:01.607103 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:01.924561 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.32 seconds
[0m20:41:02.053030 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:02.053345 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:02.371469 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.32 seconds
[0m20:41:02.773326 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:02.773551 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:04.551392 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.78 seconds
[0m20:41:04.553440 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:04.554234 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:04.858704 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.3 seconds
[0m20:41:04.985337 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:04.985552 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:05.126880 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m20:41:05.503660 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:05.503841 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:07.214626 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.71 seconds
[0m20:41:07.216718 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:07.217719 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:07.610673 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.39 seconds
[0m20:41:07.739379 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:07.739589 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:07.869655 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m20:41:08.246719 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:08.246935 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:09.772813 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.53 seconds
[0m20:41:09.775043 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:09.776324 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:10.098314 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.32 seconds
[0m20:41:10.230139 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:10.230370 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:10.336862 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:41:10.709294 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:10.709505 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:12.198001 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.49 seconds
[0m20:41:12.199873 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:12.200568 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:12.456308 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m20:41:12.582132 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:12.582435 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:12.849796 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:41:13.249476 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:13.249697 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:14.953289 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.7 seconds
[0m20:41:14.956122 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:14.957320 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:15.607973 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
[0m20:41:15.735942 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:15.736275 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:15.995793 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m20:41:16.394131 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:16.394366 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:18.248307 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.85 seconds
[0m20:41:18.251558 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:18.252424 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:18.487678 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:41:18.614710 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:18.615048 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:18.718960 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:41:19.090563 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:19.090743 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:20.434611 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.34 seconds
[0m20:41:20.436400 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:20.437479 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:20.654463 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:41:20.781262 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:20.781469 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:20.877872 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:41:21.252025 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:21.252193 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:22.584871 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.33 seconds
[0m20:41:22.587472 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:22.588181 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:23.111216 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m20:41:23.226401 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:23.226595 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:23.540215 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m20:41:23.942192 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:23.942399 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:26.186541 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 2.24 seconds
[0m20:41:26.189160 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:26.190008 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:26.480354 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m20:41:26.604760 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:26.605072 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:26.708288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:41:27.081969 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:27.082175 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:28.791836 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.71 seconds
[0m20:41:28.794243 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:28.795190 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:29.021402 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:41:29.149585 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:29.149803 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:29.250690 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:41:29.621247 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:29.621393 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:30.955565 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.33 seconds
[0m20:41:30.958515 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:30.959409 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:31.199864 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:41:31.329758 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:31.330052 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:31.442540 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:41:31.814881 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:31.815084 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:33.169328 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.35 seconds
[0m20:41:33.171012 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:33.171761 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:33.398994 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:41:33.525495 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:33.525746 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:33.824891 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.3 seconds
[0m20:41:34.226846 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:34.227052 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:35.927278 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.7 seconds
[0m20:41:35.930166 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:35.931019 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:36.208699 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:41:36.335956 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:36.336183 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:36.449404 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:41:36.820628 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:36.820799 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:38.411400 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.59 seconds
[0m20:41:38.414542 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:38.415416 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:38.668667 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:41:38.798776 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:38.798990 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:39.065398 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:41:39.464728 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:39.464900 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:40.884718 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.42 seconds
[0m20:41:40.885926 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:40.886337 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:41.164790 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:41:41.288635 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:41.288866 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:41.412173 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:41:41.787488 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:41.787704 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:42.972253 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.18 seconds
[0m20:41:42.974434 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:42.975165 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:43.256550 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:41:43.387092 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:43.387387 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:43.802758 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.42 seconds
[0m20:41:44.207730 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:44.207947 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:45.836491 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.63 seconds
[0m20:41:45.838627 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:45.839477 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:46.094089 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:41:46.222421 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:46.222660 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:46.523704 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.3 seconds
[0m20:41:46.917597 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:46.917758 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:48.899593 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.98 seconds
[0m20:41:48.902417 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:48.903187 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:49.170983 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:41:49.302291 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:49.302527 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:49.551059 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m20:41:49.937935 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:49.938136 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:51.755427 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.82 seconds
[0m20:41:51.757419 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:51.758113 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:52.041546 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:41:52.169768 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:52.169985 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:52.285814 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:41:52.660814 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:52.661042 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:54.420416 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.76 seconds
[0m20:41:54.422409 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:54.423257 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:54.790408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.37 seconds
[0m20:41:54.918549 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:54.918758 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:55.027566 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:41:55.398888 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:55.399055 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:56.980690 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.58 seconds
[0m20:41:56.984088 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:56.984947 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:57.285656 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.3 seconds
[0m20:41:57.410112 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:57.410323 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:41:57.572516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m20:41:57.957162 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:57.957352 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:41:59.507680 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.55 seconds
[0m20:41:59.509399 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:59.509948 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:41:59.752657 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:41:59.877336 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:41:59.877545 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:00.140314 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m20:42:00.544215 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:00.544435 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:02.158826 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.61 seconds
[0m20:42:02.161053 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:02.161782 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:02.526384 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.36 seconds
[0m20:42:02.651404 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:02.651604 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:02.783894 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m20:42:03.159149 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:03.159312 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:04.626087 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.47 seconds
[0m20:42:04.628191 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:04.628840 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:04.858268 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:42:04.983807 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:04.984080 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:05.276000 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m20:42:05.678726 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:05.678944 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:07.032300 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.35 seconds
[0m20:42:07.033971 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:07.034510 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:07.375184 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.34 seconds
[0m20:42:07.501755 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:07.502101 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:07.619573 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:42:07.992083 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:07.992246 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:09.677071 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.68 seconds
[0m20:42:09.679265 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:09.679955 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:09.893183 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:42:10.018760 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:10.018973 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:10.186461 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m20:42:10.572770 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:10.572996 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:11.968399 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.4 seconds
[0m20:42:11.969926 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:11.970750 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:12.201152 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:42:12.322259 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:12.322499 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:12.615857 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m20:42:13.023759 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:13.023990 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:14.470556 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.45 seconds
[0m20:42:14.472730 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:14.473415 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:14.714594 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:42:14.839518 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:14.839816 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:14.947618 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:42:15.319022 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:15.319256 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:16.813707 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.49 seconds
[0m20:42:16.816007 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:16.816879 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:17.055942 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m20:42:17.182603 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:17.182810 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:17.307745 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:42:17.682990 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:17.683175 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:19.404740 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.72 seconds
[0m20:42:19.406845 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:19.408039 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:19.637896 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:42:19.764323 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:19.764535 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:20.057457 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
[0m20:42:20.463706 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:20.463907 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:22.067105 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.6 seconds
[0m20:42:22.069079 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:22.069982 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:22.475161 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.4 seconds
[0m20:42:22.601051 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:22.601260 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:22.769782 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m20:42:23.154485 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:23.154699 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:24.831070 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.68 seconds
[0m20:42:24.833134 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:24.833739 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:25.199238 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.37 seconds
[0m20:42:25.327055 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:25.327383 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:25.443117 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:42:25.819340 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:25.819539 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:27.334546 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.51 seconds
[0m20:42:27.335461 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:27.335814 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:27.555900 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:42:27.681793 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:27.682070 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:27.777604 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:42:28.147863 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:28.148053 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:29.677864 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.53 seconds
[0m20:42:29.680350 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:29.681594 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:29.983127 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.3 seconds
[0m20:42:30.105866 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:30.106116 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:30.445249 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.34 seconds
[0m20:42:30.840969 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:30.841180 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:32.616094 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.77 seconds
[0m20:42:32.617758 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:32.618360 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:32.932105 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m20:42:33.058512 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:33.058847 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:33.177959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:42:33.550987 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:33.551178 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:35.030177 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.48 seconds
[0m20:42:35.031961 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:35.032671 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:35.252547 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:42:35.379504 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:35.379842 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:35.687871 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m20:42:36.088359 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:36.088556 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:37.450844 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.36 seconds
[0m20:42:37.452323 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:37.453261 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:37.782307 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.33 seconds
[0m20:42:37.907881 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:37.908200 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:38.020390 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:42:38.397088 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:38.397280 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:39.879686 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.48 seconds
[0m20:42:39.882156 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:39.882920 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:40.141855 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m20:42:40.266422 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:40.266629 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:40.412645 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m20:42:40.801777 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:40.802010 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:42.240978 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.44 seconds
[0m20:42:42.243507 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:42.244102 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:42.467884 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:42:42.600519 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:42.600871 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:42.746728 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m20:42:43.125600 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:43.125802 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:44.470610 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.34 seconds
[0m20:42:44.473018 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:44.473763 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:44.685927 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:42:44.813029 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:44.813261 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:45.122486 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m20:42:45.526597 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:45.526790 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:46.952832 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.43 seconds
[0m20:42:46.955247 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:46.956130 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:47.218615 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.26 seconds
[0m20:42:47.343532 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:47.343770 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:47.451625 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:42:47.825183 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:47.825382 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:49.709462 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.88 seconds
[0m20:42:49.711711 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:49.712573 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:49.929340 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m20:42:50.056064 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:50.056357 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:50.369564 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m20:42:50.783181 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:50.783401 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:52.521665 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.74 seconds
[0m20:42:52.523587 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:52.524168 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:52.853747 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.33 seconds
[0m20:42:52.979705 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:52.980020 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:53.104054 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:42:53.479355 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:53.479554 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:54.777039 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.3 seconds
[0m20:42:54.779199 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:54.779934 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:54.993629 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m20:42:55.120417 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:55.120732 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:55.224440 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:42:55.598341 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:55.598526 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:57.069624 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.47 seconds
[0m20:42:57.073581 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:57.074292 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:57.304581 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:42:57.433122 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:57.433341 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:42:57.707029 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:42:58.108629 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:58.108842 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:42:59.515619 [debug] [Thread-1  ]: SQL status: SUCCESS 10000 in 1.41 seconds
[0m20:42:59.519502 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:59.520388 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:42:59.800928 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
[0m20:42:59.915664 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:42:59.915955 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
BEGIN
[0m20:43:00.031812 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m20:43:00.315468 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:43:00.315693 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
insert into airbnb.dev.test_data (productname, orderid, skucode) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,...
[0m20:43:01.664309 [debug] [Thread-1  ]: SQL status: SUCCESS 8575 in 1.35 seconds
[0m20:43:01.666264 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.test_data"
[0m20:43:01.666907 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.test_data"} */
COMMIT
[0m20:43:02.328482 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m20:43:02.368958 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.learn_dbt.test_data"
[0m20:43:02.395528 [debug] [Thread-1  ]: finished collecting timing info
[0m20:43:02.395782 [debug] [Thread-1  ]: On seed.learn_dbt.test_data: Close
[0m20:43:02.592580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6aedb355-f9bb-491c-90f6-52c4f0769f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1e790>]}
[0m20:43:02.594056 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file dev.test_data ....................................... [[32mINSERT 1048575[0m in 269.85s]
[0m20:43:02.596196 [debug] [Thread-1  ]: Finished running node seed.learn_dbt.test_data
[0m20:43:02.599462 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:43:02.600544 [info ] [MainThread]: 
[0m20:43:02.601117 [info ] [MainThread]: Finished running 1 seed in 0 hours 4 minutes and 31.88 seconds (271.88s).
[0m20:43:02.601666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:02.601952 [debug] [MainThread]: Connection 'seed.learn_dbt.test_data' was properly closed.
[0m20:43:02.612825 [info ] [MainThread]: 
[0m20:43:02.613426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:02.613931 [info ] [MainThread]: 
[0m20:43:02.614377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:43:02.615098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f57c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f64fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11e2b0>]}
[0m20:43:02.615480 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:44:44.955096 | 66614daf-164b-49e3-a08e-cf7750c26df8 ==============================
[0m20:44:44.955135 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:44:44.955690 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m20:44:44.955803 [debug] [MainThread]: Tracking: tracking
[0m20:44:44.956045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590aeb0>]}
[0m20:44:44.981132 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:44:44.981412 [debug] [MainThread]: Partial parsing: added file: learn_dbt://seeds/seed_full_moon_dates.csv
[0m20:44:44.981518 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://seeds/test_data.csv
[0m20:44:44.998928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66614daf-164b-49e3-a08e-cf7750c26df8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c250d0>]}
[0m20:44:45.002656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66614daf-164b-49e3-a08e-cf7750c26df8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba5fa0>]}
[0m20:44:45.002890 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m20:44:45.003098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66614daf-164b-49e3-a08e-cf7750c26df8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ff610>]}
[0m20:44:45.003936 [info ] [MainThread]: 
[0m20:44:45.004221 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:44:45.004683 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:44:45.011328 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:44:45.011490 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:44:45.011593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:45.799113 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.79 seconds
[0m20:44:45.800636 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:44:45.955455 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:44:45.963503 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:44:45.963742 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:44:45.963933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:46.876102 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.91 seconds
[0m20:44:46.878828 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:44:47.038671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66614daf-164b-49e3-a08e-cf7750c26df8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590aeb0>]}
[0m20:44:47.039606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:44:47.040147 [info ] [MainThread]: 
[0m20:44:47.045915 [debug] [Thread-1  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m20:44:47.046355 [info ] [Thread-1  ]: 1 of 1 START seed file dev.seed_full_moon_dates ................................ [RUN]
[0m20:44:47.046985 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m20:44:47.047229 [debug] [Thread-1  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m20:44:47.047478 [debug] [Thread-1  ]: finished collecting timing info
[0m20:44:47.047694 [debug] [Thread-1  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m20:44:47.079924 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m20:44:47.080100 [debug] [Thread-1  ]: On seed.learn_dbt.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.seed_full_moon_dates"} */
create table airbnb.dev.seed_full_moon_dates (full_moon_date date)
[0m20:44:47.080226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:47.795093 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m20:44:47.807906 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m20:44:47.808149 [debug] [Thread-1  ]: On seed.learn_dbt.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.seed_full_moon_dates"} */
BEGIN
[0m20:44:47.906775 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m20:44:47.908890 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m20:44:47.909049 [debug] [Thread-1  ]: On seed.learn_dbt.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.seed_full_moon_dates"} */
insert into airbnb.dev.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(...
[0m20:44:48.343004 [debug] [Thread-1  ]: SQL status: SUCCESS 272 in 0.43 seconds
[0m20:44:48.343868 [debug] [Thread-1  ]: Using snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m20:44:48.344183 [debug] [Thread-1  ]: On seed.learn_dbt.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "seed.learn_dbt.seed_full_moon_dates"} */
COMMIT
[0m20:44:48.609941 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m20:44:48.619778 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m20:44:48.642716 [debug] [Thread-1  ]: finished collecting timing info
[0m20:44:48.643000 [debug] [Thread-1  ]: On seed.learn_dbt.seed_full_moon_dates: Close
[0m20:44:49.011630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66614daf-164b-49e3-a08e-cf7750c26df8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590ab20>]}
[0m20:44:49.012325 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file dev.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 1.96s]
[0m20:44:49.013058 [debug] [Thread-1  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m20:44:49.014582 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:44:49.015166 [info ] [MainThread]: 
[0m20:44:49.015684 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m20:44:49.016168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:49.016425 [debug] [MainThread]: Connection 'seed.learn_dbt.seed_full_moon_dates' was properly closed.
[0m20:44:49.023773 [info ] [MainThread]: 
[0m20:44:49.024166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:49.024519 [info ] [MainThread]: 
[0m20:44:49.024833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:44:49.025224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed8f40>]}
[0m20:44:49.025495 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:56:59.523769 | 45c74f95-7216-4dcb-8982-f2e287ee7fe7 ==============================
[0m20:56:59.523812 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:56:59.524235 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:56:59.524336 [debug] [MainThread]: Tracking: tracking
[0m20:56:59.524569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c9820>]}
[0m20:56:59.546578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:56:59.546822 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/mart/mart_fullmoon_reviews.sql
[0m20:56:59.557570 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m20:56:59.568819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c70d0>]}
[0m20:56:59.572786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107545eb0>]}
[0m20:56:59.573004 [info ] [MainThread]: Found 8 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m20:56:59.573187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ea940>]}
[0m20:56:59.574023 [info ] [MainThread]: 
[0m20:56:59.574328 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:56:59.574829 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:56:59.581592 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:56:59.581802 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:56:59.581913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:00.317019 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.74 seconds
[0m20:57:00.317977 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:57:00.483325 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:57:00.492497 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:57:00.492748 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:57:00.492941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:01.082285 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.59 seconds
[0m20:57:01.085744 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:57:01.252384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107545880>]}
[0m20:57:01.253212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:01.253746 [info ] [MainThread]: 
[0m20:57:01.258172 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m20:57:01.258538 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m20:57:01.258927 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m20:57:01.259127 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m20:57:01.259550 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m20:57:01.259836 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m20:57:01.260317 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m20:57:01.260565 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m20:57:01.260820 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:57:01.261048 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m20:57:01.261255 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m20:57:01.263110 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:57:01.263328 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m20:57:01.264641 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m20:57:01.267284 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m20:57:01.267793 [debug] [Thread-1  ]: finished collecting timing info
[0m20:57:01.268010 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:01.268436 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m20:57:01.268869 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m20:57:01.269028 [debug] [Thread-3  ]: finished collecting timing info
[0m20:57:01.269400 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m20:57:01.269632 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m20:57:01.269988 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m20:57:01.270267 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m20:57:01.270487 [info ] [Thread-2  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m20:57:01.270748 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m20:57:01.271166 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:01.271614 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:57:01.271798 [info ] [Thread-1  ]: 3 of 5 START incremental model dev.fact_reviews ................................ [RUN]
[0m20:57:01.271972 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m20:57:01.272132 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m20:57:01.272542 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:01.272681 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m20:57:01.272842 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m20:57:01.273001 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m20:57:01.281503 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:01.286840 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:57:01.287056 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m20:57:01.295928 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m20:57:01.296358 [debug] [Thread-4  ]: finished collecting timing info
[0m20:57:01.296561 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:01.296762 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m20:57:01.296960 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m20:57:01.297101 [debug] [Thread-1  ]: finished collecting timing info
[0m20:57:01.314947 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:01.317030 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:57:01.317203 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m20:57:01.336585 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:01.337077 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:01.337195 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m20:57:01.337749 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:57:01.337835 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m20:57:01.337936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:57:01.338033 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m20:57:01.338122 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:57:01.338612 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:57:02.075977 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.74 seconds
[0m20:57:02.088389 [debug] [Thread-4  ]: finished collecting timing info
[0m20:57:02.088556 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m20:57:02.154666 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m20:57:02.156571 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:02.156752 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m20:57:02.262701 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e44d90>]}
[0m20:57:02.263260 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.99s]
[0m20:57:02.263848 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m20:57:02.324692 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e29c10>]}
[0m20:57:02.325322 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m20:57:02.325913 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m20:57:02.326418 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m20:57:02.326798 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m20:57:02.327429 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:02.327672 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m20:57:02.327905 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m20:57:02.331361 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:02.331989 [debug] [Thread-3  ]: finished collecting timing info
[0m20:57:02.332188 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m20:57:02.339421 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:02.340627 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:02.340809 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m20:57:02.340962 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:57:02.795825 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.46 seconds
[0m20:57:02.805029 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:02.806140 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:57:02.902858 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m20:57:02.908449 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:02.908702 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m20:57:03.025030 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m20:57:03.035999 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:03.036215 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:57:03.130859 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m20:57:03.133572 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:03.133761 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m20:57:03.260218 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.13 seconds
[0m20:57:03.270441 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:57:03.281623 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m20:57:03.282445 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:03.282611 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m20:57:03.396052 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m20:57:03.397646 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:03.398269 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m20:57:03.646262 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.25 seconds
[0m20:57:03.646853 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:03.647159 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m20:57:03.876376 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m20:57:03.886976 [debug] [Thread-1  ]: finished collecting timing info
[0m20:57:03.887306 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: Close
[0m20:57:04.062995 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.72 seconds
[0m20:57:04.068248 [debug] [Thread-3  ]: finished collecting timing info
[0m20:57:04.068629 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m20:57:04.090645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e772b0>]}
[0m20:57:04.091293 [info ] [Thread-1  ]: 3 of 5 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.82s]
[0m20:57:04.092024 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m20:57:04.092611 [debug] [Thread-2  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:04.093054 [info ] [Thread-2  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m20:57:04.093739 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:04.094034 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:04.094302 [debug] [Thread-2  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m20:57:04.098549 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:04.099387 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:04.099643 [debug] [Thread-2  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:04.102729 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:04.104006 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:04.104196 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as f
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
      );
[0m20:57:04.104373 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:57:04.218781 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f9640>]}
[0m20:57:04.219227 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.89s]
[0m20:57:04.219650 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m20:57:04.622816 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79ba9-3201-ea44-0000-00015aae290d
[0m20:57:04.623342 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002001 (02000): SQL compilation error:
Object 'R' does not exist or not authorized.
[0m20:57:04.623874 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:04.624184 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m20:57:04.804180 [debug] [Thread-2  ]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  002001 (02000): SQL compilation error:
  Object 'R' does not exist or not authorized.
  compiled SQL at target/run/learn_dbt/models/mart/mart_fullmoon_reviews.sql
[0m20:57:04.804785 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c74f95-7216-4dcb-8982-f2e287ee7fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee4820>]}
[0m20:57:04.805351 [error] [Thread-2  ]: 5 of 5 ERROR creating table model dev.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.71s]
[0m20:57:04.806067 [debug] [Thread-2  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:04.807767 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:57:04.808447 [info ] [MainThread]: 
[0m20:57:04.808972 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m20:57:04.809367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:04.809573 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m20:57:04.809765 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m20:57:04.809954 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m20:57:04.810139 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m20:57:04.817791 [info ] [MainThread]: 
[0m20:57:04.818239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:57:04.818580 [info ] [MainThread]: 
[0m20:57:04.818881 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)[0m
[0m20:57:04.819187 [error] [MainThread]:   002001 (02000): SQL compilation error:
[0m20:57:04.819477 [error] [MainThread]:   Object 'R' does not exist or not authorized.
[0m20:57:04.819766 [error] [MainThread]:   compiled SQL at target/run/learn_dbt/models/mart/mart_fullmoon_reviews.sql
[0m20:57:04.820073 [info ] [MainThread]: 
[0m20:57:04.820371 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:57:04.820770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079afe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e27a00>]}
[0m20:57:04.821027 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 20:57:47.678342 | 886577d3-0988-4e4b-bb42-b15ba2f97b21 ==============================
[0m20:57:47.678364 [info ] [MainThread]: Running with dbt=1.2.1
[0m20:57:47.678764 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:57:47.678888 [debug] [MainThread]: Tracking: tracking
[0m20:57:47.679103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7aeb0>]}
[0m20:57:47.699610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:47.699973 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/mart/mart_fullmoon_reviews.sql
[0m20:57:47.706874 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m20:57:47.718097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200670d0>]}
[0m20:57:47.722330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcc400>]}
[0m20:57:47.722561 [info ] [MainThread]: Found 8 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m20:57:47.722755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737edf0>]}
[0m20:57:47.723707 [info ] [MainThread]: 
[0m20:57:47.724022 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:57:47.724523 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m20:57:47.731196 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m20:57:47.731376 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m20:57:47.731472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:48.438594 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.71 seconds
[0m20:57:48.440042 [debug] [ThreadPool]: On list_airbnb: Close
[0m20:57:48.683698 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m20:57:48.692626 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m20:57:48.692865 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m20:57:48.693055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:49.437621 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.74 seconds
[0m20:57:49.441008 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m20:57:49.654992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcc970>]}
[0m20:57:49.655925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:49.656464 [info ] [MainThread]: 
[0m20:57:49.661070 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m20:57:49.661333 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m20:57:49.661611 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m20:57:49.662009 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m20:57:49.662405 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m20:57:49.662763 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m20:57:49.662997 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m20:57:49.663274 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m20:57:49.663550 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m20:57:49.663812 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m20:57:49.664028 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m20:57:49.664237 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m20:57:49.666091 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m20:57:49.668640 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m20:57:49.669963 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m20:57:49.670647 [debug] [Thread-1  ]: finished collecting timing info
[0m20:57:49.670830 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:49.671021 [debug] [Thread-3  ]: finished collecting timing info
[0m20:57:49.671421 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m20:57:49.671779 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m20:57:49.672104 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m20:57:49.672600 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m20:57:49.672825 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m20:57:49.673096 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m20:57:49.673275 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m20:57:49.673503 [info ] [Thread-1  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m20:57:49.673937 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:49.674154 [info ] [Thread-2  ]: 3 of 5 START incremental model dev.fact_reviews ................................ [RUN]
[0m20:57:49.674551 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:57:49.674716 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m20:57:49.675088 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:49.675246 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m20:57:49.675397 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m20:57:49.675547 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m20:57:49.675703 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m20:57:49.684350 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:49.684583 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m20:57:49.690113 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:57:49.698399 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m20:57:49.698751 [debug] [Thread-4  ]: finished collecting timing info
[0m20:57:49.698899 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m20:57:49.715604 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:49.715862 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:49.715994 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m20:57:49.716103 [debug] [Thread-1  ]: finished collecting timing info
[0m20:57:49.722237 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m20:57:49.733798 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m20:57:49.736310 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:49.736464 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m20:57:49.738789 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m20:57:49.738912 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m20:57:49.739023 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:57:49.739191 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:57:49.741230 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m20:57:49.741335 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m20:57:49.741421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:57:50.521435 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m20:57:50.537849 [debug] [Thread-1  ]: finished collecting timing info
[0m20:57:50.538071 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m20:57:50.609390 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.87 seconds
[0m20:57:50.612059 [debug] [Thread-4  ]: finished collecting timing info
[0m20:57:50.612323 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m20:57:50.634377 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.9 seconds
[0m20:57:50.643081 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:50.643287 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:57:50.719882 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12054afa0>]}
[0m20:57:50.720513 [info ] [Thread-1  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m20:57:50.721166 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m20:57:50.772731 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206c09d0>]}
[0m20:57:50.773263 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.10s]
[0m20:57:50.773729 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m20:57:50.774107 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m20:57:50.774345 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m20:57:50.774780 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:50.774956 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m20:57:50.775128 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m20:57:50.777869 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:50.778424 [debug] [Thread-3  ]: finished collecting timing info
[0m20:57:50.778603 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m20:57:50.786806 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:50.787855 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m20:57:50.788002 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m20:57:50.788126 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:57:50.794535 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.15 seconds
[0m20:57:50.797724 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:50.812367 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m20:57:51.148478 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.34 seconds
[0m20:57:51.167762 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:51.167909 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m20:57:51.262495 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m20:57:51.265214 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:51.265380 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m20:57:51.354016 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m20:57:51.362741 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:57:51.372736 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m20:57:51.373514 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:51.373694 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m20:57:51.499279 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m20:57:51.499619 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:51.499753 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m20:57:51.722284 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.22 seconds
[0m20:57:51.723003 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m20:57:51.723295 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m20:57:51.870578 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m20:57:51.879981 [debug] [Thread-2  ]: finished collecting timing info
[0m20:57:51.880436 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m20:57:52.086952 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12051d880>]}
[0m20:57:52.087907 [info ] [Thread-2  ]: 3 of 5 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.41s]
[0m20:57:52.088692 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m20:57:52.089329 [debug] [Thread-4  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:52.089725 [info ] [Thread-4  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m20:57:52.090480 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:52.090781 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:52.091051 [debug] [Thread-4  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m20:57:52.094967 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:52.095716 [debug] [Thread-4  ]: finished collecting timing info
[0m20:57:52.095952 [debug] [Thread-4  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:52.099157 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:52.100409 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m20:57:52.100601 [debug] [Thread-4  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
      );
[0m20:57:52.100779 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:57:52.202493 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.41 seconds
[0m20:57:52.204585 [debug] [Thread-3  ]: finished collecting timing info
[0m20:57:52.204806 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m20:57:52.353021 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206a8eb0>]}
[0m20:57:52.353328 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.58s]
[0m20:57:52.353585 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m20:57:55.991127 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.89 seconds
[0m20:57:55.995952 [debug] [Thread-4  ]: finished collecting timing info
[0m20:57:55.996403 [debug] [Thread-4  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m20:57:56.181763 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886577d3-0988-4e4b-bb42-b15ba2f97b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12062a6d0>]}
[0m20:57:56.182473 [info ] [Thread-4  ]: 5 of 5 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 4.09s]
[0m20:57:56.183205 [debug] [Thread-4  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m20:57:56.184581 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m20:57:56.185077 [info ] [MainThread]: 
[0m20:57:56.185485 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m20:57:56.185867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:56.186069 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m20:57:56.186256 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m20:57:56.186448 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m20:57:56.186630 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m20:57:56.195430 [info ] [MainThread]: 
[0m20:57:56.195786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:56.196134 [info ] [MainThread]: 
[0m20:57:56.196435 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:57:56.196804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120088d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f376a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219570d0>]}
[0m20:57:56.197056 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 21:32:39.608815 | c81104e9-b55f-4010-be14-dc01ca2b9d38 ==============================
[0m21:32:39.608858 [info ] [MainThread]: Running with dbt=1.2.1
[0m21:32:39.609317 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:32:39.609440 [debug] [MainThread]: Tracking: tracking
[0m21:32:39.609656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ea490>]}
[0m21:32:39.630623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:32:39.630920 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/src/src_reviews.sql
[0m21:32:39.631080 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/src/src_hosts.sql
[0m21:32:39.631225 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/src/src_listings.sql
[0m21:32:39.637800 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m21:32:39.644325 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m21:32:39.645707 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m21:32:39.656282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b310d0>]}
[0m21:32:39.660257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a29a60>]}
[0m21:32:39.660470 [info ] [MainThread]: Found 8 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m21:32:39.660654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a29ac0>]}
[0m21:32:39.661527 [info ] [MainThread]: 
[0m21:32:39.661815 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:32:39.662306 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m21:32:39.669283 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m21:32:39.669438 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m21:32:39.669538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:40.435123 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.77 seconds
[0m21:32:40.436624 [debug] [ThreadPool]: On list_airbnb: Close
[0m21:32:40.653706 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m21:32:40.662869 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m21:32:40.663144 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m21:32:40.663365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:41.157714 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.49 seconds
[0m21:32:41.162443 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m21:32:41.334952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3cb80>]}
[0m21:32:41.335804 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:41.336353 [info ] [MainThread]: 
[0m21:32:41.340660 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m21:32:41.340913 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m21:32:41.341190 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m21:32:41.341585 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m21:32:41.341986 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m21:32:41.342348 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m21:32:41.342582 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m21:32:41.342804 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m21:32:41.343011 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m21:32:41.343248 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m21:32:41.343464 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m21:32:41.343660 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m21:32:41.346658 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m21:32:41.348985 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m21:32:41.351210 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m21:32:41.351976 [debug] [Thread-3  ]: finished collecting timing info
[0m21:32:41.352196 [debug] [Thread-2  ]: finished collecting timing info
[0m21:32:41.352366 [debug] [Thread-1  ]: finished collecting timing info
[0m21:32:41.352808 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m21:32:41.353201 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m21:32:41.353516 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m21:32:41.353838 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m21:32:41.354170 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m21:32:41.354521 [info ] [Thread-4  ]: 1 of 5 START incremental model dev.fact_reviews ................................ [RUN]
[0m21:32:41.354682 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m21:32:41.354899 [info ] [Thread-1  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m21:32:41.355322 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:41.355531 [info ] [Thread-2  ]: 3 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m21:32:41.355920 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m21:32:41.356078 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m21:32:41.356446 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m21:32:41.356607 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m21:32:41.356762 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m21:32:41.356919 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m21:32:41.357072 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m21:32:41.369749 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m21:32:41.370084 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m21:32:41.374908 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m21:32:41.378253 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m21:32:41.378633 [debug] [Thread-4  ]: finished collecting timing info
[0m21:32:41.378753 [debug] [Thread-1  ]: finished collecting timing info
[0m21:32:41.378877 [debug] [Thread-2  ]: finished collecting timing info
[0m21:32:41.378984 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m21:32:41.379104 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m21:32:41.379230 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m21:32:41.405319 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:41.415413 [debug] [Thread-1  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m21:32:41.416947 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m21:32:41.417064 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace temporary table airbnb.dev.fact_reviews__dbt_tmp  as
      (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

      );
[0m21:32:41.417365 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:32:41.418867 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m21:32:41.419392 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m21:32:41.419562 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m21:32:41.419718 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m21:32:41.419832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:32:41.419936 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:32:42.217349 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.8 seconds
[0m21:32:42.231282 [debug] [Thread-1  ]: finished collecting timing info
[0m21:32:42.231469 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m21:32:42.368709 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m21:32:42.371841 [debug] [Thread-2  ]: finished collecting timing info
[0m21:32:42.372136 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m21:32:42.376242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb10d0>]}
[0m21:32:42.376724 [info ] [Thread-1  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.02s]
[0m21:32:42.377318 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m21:32:42.524612 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc9910>]}
[0m21:32:42.525131 [info ] [Thread-2  ]: 3 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.17s]
[0m21:32:42.525706 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m21:32:42.526163 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m21:32:42.526549 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m21:32:42.527131 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m21:32:42.527356 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m21:32:42.527574 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m21:32:42.531469 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m21:32:42.532140 [debug] [Thread-3  ]: finished collecting timing info
[0m21:32:42.532350 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m21:32:42.541514 [debug] [Thread-3  ]: Writing runtime SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m21:32:42.542596 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m21:32:42.542752 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
      );
[0m21:32:42.542888 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:32:42.789726 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.37 seconds
[0m21:32:42.813240 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:42.819529 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m21:32:42.939177 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m21:32:42.942071 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:42.942542 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m21:32:43.043000 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m21:32:43.057497 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:43.057731 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m21:32:43.158631 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m21:32:43.161515 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:43.161683 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m21:32:43.250185 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m21:32:43.256996 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:32:43.265293 [debug] [Thread-4  ]: Writing runtime SQL for node "model.learn_dbt.fact_reviews"
[0m21:32:43.265992 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:43.266135 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m21:32:43.363919 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m21:32:43.364300 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:43.364453 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m21:32:43.600723 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.24 seconds
[0m21:32:43.601829 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m21:32:43.602200 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m21:32:43.823687 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m21:32:43.834587 [debug] [Thread-4  ]: finished collecting timing info
[0m21:32:43.834989 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m21:32:44.027420 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc9eb0>]}
[0m21:32:44.028175 [info ] [Thread-4  ]: 1 of 5 OK created incremental model dev.fact_reviews ........................... [[32mSUCCESS 0[0m in 2.67s]
[0m21:32:44.028940 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m21:32:44.029565 [debug] [Thread-2  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m21:32:44.030021 [info ] [Thread-2  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m21:32:44.030743 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m21:32:44.030995 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m21:32:44.031229 [debug] [Thread-2  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m21:32:44.035106 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m21:32:44.035848 [debug] [Thread-2  ]: finished collecting timing info
[0m21:32:44.036086 [debug] [Thread-2  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m21:32:44.040400 [debug] [Thread-2  ]: Writing runtime SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m21:32:44.041554 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m21:32:44.041746 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
      );
[0m21:32:44.041921 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:32:44.238487 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.7 seconds
[0m21:32:44.252848 [debug] [Thread-3  ]: finished collecting timing info
[0m21:32:44.259278 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m21:32:44.446805 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1b940>]}
[0m21:32:44.447374 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.92s]
[0m21:32:44.447855 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m21:32:48.083269 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.04 seconds
[0m21:32:48.089042 [debug] [Thread-2  ]: finished collecting timing info
[0m21:32:48.089514 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m21:32:48.267965 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81104e9-b55f-4010-be14-dc01ca2b9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec8490>]}
[0m21:32:48.269015 [info ] [Thread-2  ]: 5 of 5 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 4.24s]
[0m21:32:48.269762 [debug] [Thread-2  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m21:32:48.271066 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:32:48.271587 [info ] [MainThread]: 
[0m21:32:48.272019 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m21:32:48.272412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:48.272619 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m21:32:48.272813 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m21:32:48.273000 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m21:32:48.273184 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m21:32:48.279875 [info ] [MainThread]: 
[0m21:32:48.280236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:48.280605 [info ] [MainThread]: 
[0m21:32:48.280918 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:32:48.281282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a29820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daffa0>]}
[0m21:32:48.281539 [debug] [MainThread]: Flushing usage events


============================== 2022-10-13 21:37:39.971386 | 23eb4211-bb94-4917-8387-ab3d3e596e80 ==============================
[0m21:37:39.971421 [info ] [MainThread]: Running with dbt=1.2.1
[0m21:37:39.971901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m21:37:39.972024 [debug] [MainThread]: Tracking: tracking
[0m21:37:39.972245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9e970>]}
[0m21:37:39.993510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:39.993698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:39.997172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23eb4211-bb94-4917-8387-ab3d3e596e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913f0d0>]}
[0m21:37:40.001625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23eb4211-bb94-4917-8387-ab3d3e596e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109075a90>]}
[0m21:37:40.001885 [info ] [MainThread]: Found 8 models, 2 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m21:37:40.002089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23eb4211-bb94-4917-8387-ab3d3e596e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109075af0>]}
[0m21:37:40.002986 [info ] [MainThread]: 
[0m21:37:40.003301 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m21:37:40.003785 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m21:37:40.010318 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m21:37:40.010510 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m21:37:40.010605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:40.727780 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.72 seconds
[0m21:37:40.729468 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m21:37:40.875970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23eb4211-bb94-4917-8387-ab3d3e596e80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109104df0>]}
[0m21:37:40.876298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:40.876480 [info ] [MainThread]: 
[0m21:37:40.878589 [debug] [Thread-1  ]: Began running node source.learn_dbt.airbnb.reviews
[0m21:37:40.878753 [info ] [Thread-1  ]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m21:37:40.879032 [debug] [Thread-1  ]: Acquiring new snowflake connection "source.learn_dbt.airbnb.reviews"
[0m21:37:40.879175 [debug] [Thread-1  ]: Began compiling node source.learn_dbt.airbnb.reviews
[0m21:37:40.879296 [debug] [Thread-1  ]: finished collecting timing info
[0m21:37:40.879396 [debug] [Thread-1  ]: Began executing node source.learn_dbt.airbnb.reviews
[0m21:37:40.879588 [debug] [Thread-1  ]: Acquiring new snowflake connection "source.learn_dbt.airbnb.reviews"
[0m21:37:40.884066 [debug] [Thread-1  ]: Using snowflake connection "source.learn_dbt.airbnb.reviews"
[0m21:37:40.884200 [debug] [Thread-1  ]: On source.learn_dbt.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "source.learn_dbt.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from airbnb.raw.raw_reviews
[0m21:37:40.884293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:37:41.383409 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.5 seconds
[0m21:37:41.385571 [debug] [Thread-1  ]: On source.learn_dbt.airbnb.reviews: Close
[0m21:37:41.576569 [debug] [Thread-1  ]: finished collecting timing info
[0m21:37:41.577052 [warn ] [Thread-1  ]: 1 of 1 WARN freshness of airbnb.reviews ........................................ [[33mWARN[0m in 0.70s]
[0m21:37:41.577501 [debug] [Thread-1  ]: Finished running node source.learn_dbt.airbnb.reviews
[0m21:37:41.578224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:41.578371 [debug] [MainThread]: Connection 'source.learn_dbt.airbnb.reviews' was properly closed.
[0m21:37:41.582842 [info ] [MainThread]: Done.
[0m21:37:41.583179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109075af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109320160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109397250>]}
[0m21:37:41.583377 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 06:55:27.315924 | b8d77fe6-e433-4bf7-b950-5e0cc3bf6696 ==============================
[0m06:55:27.315947 [info ] [MainThread]: Running with dbt=1.2.1
[0m06:55:27.316544 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m06:55:27.316668 [debug] [MainThread]: Tracking: tracking
[0m06:55:27.316900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0beb0>]}
[0m06:55:27.349193 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:55:27.349497 [debug] [MainThread]: Partial parsing: added file: learn_dbt://snapshots/scd_raw_listings.sql
[0m06:55:27.357703 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m06:55:27.364536 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m06:55:27.366876 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m06:55:27.368233 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m06:55:27.372591 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m06:55:27.373182 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m06:55:27.374495 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m06:55:27.375772 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m06:55:27.384706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e26dc0>]}
[0m06:55:27.384895 [debug] [MainThread]: Flushing usage events
[0m06:55:27.942698 [error] [MainThread]: Encountered an error:
Parsing Error in snapshot scd_raw_listings (snapshots/scd_raw_listings.sql)
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m06:55:27.945463 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 342, in render_update
    self.update_parsed_node_config(node, config, context=context)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 276, in update_parsed_node_config
    config_dict = config.build_config_dict(patch_config_dict=patch_config_dict)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/context/context_config.py", line 323, in build_config_dict
    return src.calculate_node_config_dict(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/context/context_config.py", line 206, in calculate_node_config_dict
    finalized = config.finalize_and_validate()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/contracts/graph/model_config.py", line 591, in finalize_and_validate
    self.validate(data)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/contracts/graph/model_config.py", line 562, in validate
    raise ValidationError(
hologram.ValidationError: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 451, in run
    self._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 349, in load
    self.parse_project(
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/manifest.py", line 473, in parse_project
    parser.parse_file(block)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/snapshots.py", line 78, in parse_file
    self.parse_node(block)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 366, in parse_node
    self.render_update(node, config)
  File "/opt/homebrew/Cellar/dbt-snowflake/1.2.0/libexec/lib/python3.9/site-packages/dbt/parser/base.py", line 346, in render_update
    raise ParsingException(msg, node=node) from exc
dbt.exceptions.ParsingException: Parsing Error in snapshot scd_raw_listings (snapshots/scd_raw_listings.sql)
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.



============================== 2022-10-14 06:56:19.844005 | 3e01c8fc-78df-4f8d-83fd-70a39c93531c ==============================
[0m06:56:19.844029 [info ] [MainThread]: Running with dbt=1.2.1
[0m06:56:19.860039 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m06:56:19.860202 [debug] [MainThread]: Tracking: tracking
[0m06:56:19.860453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12193a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12193a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12193a9d0>]}
[0m06:56:19.888884 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:56:19.889171 [debug] [MainThread]: Partial parsing: added file: learn_dbt://snapshots/scd_raw_listings.sql
[0m06:56:19.897746 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m06:56:19.907769 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m06:56:19.916940 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m06:56:19.918633 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m06:56:19.920481 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m06:56:19.921963 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m06:56:19.926738 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m06:56:19.928048 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m06:56:19.944696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e01c8fc-78df-4f8d-83fd-70a39c93531c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d790a0>]}
[0m06:56:19.948719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e01c8fc-78df-4f8d-83fd-70a39c93531c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ba9f40>]}
[0m06:56:19.948916 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m06:56:19.949105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e01c8fc-78df-4f8d-83fd-70a39c93531c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12053dbb0>]}
[0m06:56:19.949855 [info ] [MainThread]: 
[0m06:56:19.950137 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m06:56:19.950514 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m06:56:19.956767 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m06:56:19.956916 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m06:56:19.957027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:56:20.876944 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.92 seconds
[0m06:56:20.880066 [debug] [ThreadPool]: On list_airbnb: Close
[0m06:56:21.073343 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m06:56:21.083066 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m06:56:21.083390 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m06:56:21.083584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:56:21.837035 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.75 seconds
[0m06:56:21.841007 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m06:56:22.031432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e01c8fc-78df-4f8d-83fd-70a39c93531c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12192d1c0>]}
[0m06:56:22.032707 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:56:22.033286 [info ] [MainThread]: 
[0m06:56:22.040519 [debug] [Thread-1  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m06:56:22.040995 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m06:56:22.041611 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m06:56:22.041828 [debug] [Thread-1  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m06:56:22.042052 [debug] [Thread-1  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m06:56:22.045982 [debug] [Thread-1  ]: finished collecting timing info
[0m06:56:22.046226 [debug] [Thread-1  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m06:56:22.090098 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.learn_dbt.scd_raw_listings"
[0m06:56:22.091038 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m06:56:22.091168 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.1", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
create or replace transient table airbnb.dev.scd_raw_listings  as
      (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select * from airbnb.raw.raw_listings

    ) sbq



      );
[0m06:56:22.091274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:56:23.874030 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.78 seconds
[0m06:56:23.903433 [debug] [Thread-1  ]: finished collecting timing info
[0m06:56:23.903814 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: Close
[0m06:56:24.064802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e01c8fc-78df-4f8d-83fd-70a39c93531c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ba9eb0>]}
[0m06:56:24.065839 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 2.02s]
[0m06:56:24.066770 [debug] [Thread-1  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m06:56:24.068468 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m06:56:24.069129 [info ] [MainThread]: 
[0m06:56:24.069578 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m06:56:24.069963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:56:24.070164 [debug] [MainThread]: Connection 'snapshot.learn_dbt.scd_raw_listings' was properly closed.
[0m06:56:24.078303 [info ] [MainThread]: 
[0m06:56:24.078754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:56:24.079128 [info ] [MainThread]: 
[0m06:56:24.079439 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:56:24.079853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123257700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12335a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12335ad60>]}
[0m06:56:24.080154 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 07:34:13.288114 | c5159938-40d2-4bc6-aea9-8d0221ab8942 ==============================
[0m07:34:13.288202 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:34:13.290828 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m07:34:13.291189 [debug] [MainThread]: Tracking: tracking
[0m07:34:13.291700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc4b50>]}
[0m07:34:13.318066 [debug] [MainThread]: Failed to load parsed file from disk at /Users/nigelbrown/learn-dbt/target/partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[CompiledAnalysisNode, CompiledSingularTestNode, CompiledModelNode, CompiledHookNode, CompiledRPCNode, CompiledSqlNode, CompiledGenericTestNode, CompiledSeedNode, CompiledSnapshotNode, ParsedAnalysisNode, ParsedSingularTestNode, ParsedHookNode, ParsedModelNode, ParsedRPCNode, ParsedSqlNode, ParsedGenericTestNode, ParsedSeedNode, ParsedSnapshotNode]] in Manifest has invalid value {'test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65': {'raw_sql': '{{ dbt_expectations.test_expect_column_distinct_count_to_equal(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_expectations_source_expect_d9770018e28873e7be74335902d9e4e5") }}', 'test_metadata': {'name': 'expect_column_distinct_count_to_equal', 'kwargs': {'value': 4, 'column_name': 'room_type', 'model': "{{ get_where_subquery(source('airbnb', 'listings')) }}"}, 'namespace': 'dbt_expectations'}, 'resource_type': 'test', 'depends_on': {'macros': [None, 'macro.dbt.get_where_subquery'], 'nodes': ['source.learn_dbt.airbnb.listings']}, 'config': {'enabled': True, 'alias': 'dbt_expectations_source_expect_d9770018e28873e7be74335902d9e4e5', 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'airbnb', 'schema': 'dev_dbt_test__audit', 'fqn': ['learn_dbt', 'dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4'], 'unique_id': 'test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'dbt_expectations_source_expect_d9770018e28873e7be74335902d9e4e5.sql', 'original_file_path': 'models/sources.yml', 'name': 'dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4', 'alias': 'dbt_expectations_source_expect_d9770018e28873e7be74335902d9e4e5', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [], 'sources': [['airbnb', 'listings']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'alias': 'dbt_expectations_source_expect_d9770018e28873e7be74335902d9e4e5'}, 'created_at': 1665693510.687236, 'config_call_dict': {'alias': 'dbt_expectations_source_expect_d9770018e28873e7be74335902d9e4e5'}, 'column_name': 'room_type', 'file_key_name': 'sources.airbnb'}, 'test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9': {'raw_sql': '{{ dbt_expectations.test_expect_column_values_to_match_regex(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb") }}', 'test_metadata': {'name': 'expect_column_values_to_match_regex', 'kwargs': {'regex': '^\\\\$[0-9][0-9\\\\.]+$', 'column_name': 'price', 'model': "{{ get_where_subquery(source('airbnb', 'listings')) }}"}, 'namespace': 'dbt_expectations'}, 'resource_type': 'test', 'depends_on': {'macros': [None, 'macro.dbt.get_where_subquery'], 'nodes': ['source.learn_dbt.airbnb.listings']}, 'config': {'enabled': True, 'alias': 'dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb', 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'airbnb', 'schema': 'dev_dbt_test__audit', 'fqn': ['learn_dbt', 'dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_'], 'unique_id': 'test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql', 'original_file_path': 'models/sources.yml', 'name': 'dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_', 'alias': 'dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [], 'sources': [['airbnb', 'listings']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'alias': 'dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb'}, 'created_at': 1665693510.692728, 'config_call_dict': {'alias': 'dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb'}, 'column_name': 'price', 'file_key_name': 'sources.airbnb'}, 'seed.learn_dbt.seed_full_moon_dates': {'raw_sql': '', 'resource_type': 'seed', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'seed', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'quote_columns': None, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'seed_full_moon_dates'], 'unique_id': 'seed.learn_dbt.seed_full_moon_dates', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'seed_full_moon_dates.csv', 'original_file_path': 'seeds/seed_full_moon_dates.csv', 'name': 'seed_full_moon_dates', 'alias': 'seed_full_moon_dates', 'checksum': {'name': 'sha256', 'checksum': '5fbd1d724cc09a6773333ce1024dcea9bfd78b809ba258210d244fc4455a4209'}, 'tags': [], 'refs': [], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1665693884.987585, 'config_call_dict': {}}, 'model.learn_dbt.mart_fullmoon_reviews': {'raw_sql': "{{ config (\n  materialized = 'table' )\n}}\n\nwith fact_reviews as (\n  select * from {{ ref('fact_reviews')}}\n),\nfull_moon_dates as (\n  select * from {{ ref('seed_full_moon_dates')}}\n)\n\nselect r.*\n       ,case when fm.full_moon_date is null then 'not full moon'\n        else 'full moon'\n        end as is_full_moon\nfrom fact_reviews as r\nleft join full_moon_dates fm\non to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.learn_dbt.fact_reviews', 'seed.learn_dbt.seed_full_moon_dates']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'mart', 'mart_fullmoon_reviews'], 'unique_id': 'model.learn_dbt.mart_fullmoon_reviews', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'mart/mart_fullmoon_reviews.sql', 'original_file_path': 'models/mart/mart_fullmoon_reviews.sql', 'name': 'mart_fullmoon_reviews', 'alias': 'mart_fullmoon_reviews', 'checksum': {'name': 'sha256', 'checksum': 'ee6bdaddc7741b591f6eb768e94b5dbcd5963c32b76ca35bc53f306fc45b00ff'}, 'tags': [], 'refs': [['fact_reviews'], ['seed_full_moon_dates']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1665694667.706471, 'config_call_dict': {'materialized': 'table'}}, 'model.learn_dbt.src_reviews': {'raw_sql': "with raw_reviews as (\n    select * from {{source('airbnb', 'reviews')}}\n)\nselect \n listing_id\n ,date as review_date\n ,reviewer_name\n ,comments as review_text\n ,sentiment as review_sentiment\nfrom raw_reviews", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.learn_dbt.airbnb.reviews']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'ephemeral', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'src', 'src_reviews'], 'unique_id': 'model.learn_dbt.src_reviews', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'src/src_reviews.sql', 'original_file_path': 'models/src/src_reviews.sql', 'name': 'src_reviews', 'alias': 'src_reviews', 'checksum': {'name': 'sha256', 'checksum': '6fd1f744067361a72da190f58146d07fbabc4d8a922ef4075c13b1786fb9d3e2'}, 'tags': [], 'refs': [], 'sources': [['airbnb', 'reviews']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'ephemeral'}, 'created_at': 1665730579.8957472, 'config_call_dict': {}}, 'model.learn_dbt.dim_hosts_cleansed': {'raw_sql': "{{\n  config(\n  materialized = 'view'\n  )\n}}\nwith src_host as (\n  select * from {{ ref('src_hosts') }}\n)\nselect \n host_id\n ,nvl(host_name,'Anonymous') as host_name\n ,is_superhost\n ,created_at\n ,updated_at\nfrom src_hosts", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.learn_dbt.src_hosts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'dim', 'dim_hosts_cleansed'], 'unique_id': 'model.learn_dbt.dim_hosts_cleansed', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'dim/dim_hosts_cleansed.sql', 'original_file_path': 'models/dim/dim_hosts_cleansed.sql', 'name': 'dim_hosts_cleansed', 'alias': 'dim_hosts_cleansed', 'checksum': {'name': 'sha256', 'checksum': '8aa9b9fb8221f0a9ee1ec9f30233108ee287ce3f82095cfe8de82b166eb66926'}, 'tags': [], 'refs': [['src_hosts']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'view'}, 'created_at': 1665730579.904574, 'config_call_dict': {'materialized': 'view'}}, 'model.learn_dbt.dim_listings_w_hosts': {'raw_sql': "with l as (\n  select * from {{ ref('dim_listings_cleansed')}}\n),\nh as (\n  select * from {{ ref('dim_hosts_cleansed')}}\n)\n\nselect \n  l.listing_id,\n  l.listing_name,\n  l.room_type,\n  l.minimum_nights,\n  l.price,\n  l.host_id,\n  h.host_name,\n  h.is_superhost as host_is_superhost,\n  l.created_at,\n  greatest(l.updated_at, h.updated_at) as updated_at\nfrom l\nleft join h\non h.host_id = l.host_id", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.learn_dbt.dim_listings_cleansed', 'model.learn_dbt.dim_hosts_cleansed']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'dim', 'dim_listings_w_hosts'], 'unique_id': 'model.learn_dbt.dim_listings_w_hosts', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'dim/dim_listings_w_hosts.sql', 'original_file_path': 'models/dim/dim_listings_w_hosts.sql', 'name': 'dim_listings_w_hosts', 'alias': 'dim_listings_w_hosts', 'checksum': {'name': 'sha256', 'checksum': '6c74e56704e8d56461c5b8bbb05f4fc9a2735cb681a4c2a547ab6ef8c4f2c91a'}, 'tags': [], 'refs': [['dim_listings_cleansed'], ['dim_hosts_cleansed']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1665730579.909471, 'config_call_dict': {}}, 'model.learn_dbt.src_listings': {'raw_sql': "with raw_listings as (\n    select * from {{source('airbnb', 'listings')}}\n)\nselect \n id as listing_id\n ,name as listing_name\n ,listing_url\n ,room_type\n ,minimum_nights\n ,host_id\n ,price as price_str\n ,created_at\n ,updated_at\nfrom raw_listings", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.learn_dbt.airbnb.listings']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'ephemeral', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'src', 'src_listings'], 'unique_id': 'model.learn_dbt.src_listings', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'src/src_listings.sql', 'original_file_path': 'models/src/src_listings.sql', 'name': 'src_listings', 'alias': 'src_listings', 'checksum': {'name': 'sha256', 'checksum': '18ff00d884884ab5bc36714b47fe383c40e3d1c00ea61ae9d568ac731857e51a'}, 'tags': [], 'refs': [], 'sources': [['airbnb', 'listings']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'ephemeral'}, 'created_at': 1665730579.91859, 'config_call_dict': {}}, 'model.learn_dbt.src_hosts': {'raw_sql': "with raw_hosts as (\n    select * from {{source('airbnb', 'hosts')}}\n)\nselect \n id as host_id\n ,name as host_name\n ,is_superhost\n ,created_at\n ,updated_at\nfrom raw_hosts", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.learn_dbt.airbnb.hosts']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'ephemeral', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'src', 'src_hosts'], 'unique_id': 'model.learn_dbt.src_hosts', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'src/src_hosts.sql', 'original_file_path': 'models/src/src_hosts.sql', 'name': 'src_hosts', 'alias': 'src_hosts', 'checksum': {'name': 'sha256', 'checksum': 'ee7344eaf975464fdfa43a9bf705a496e35e70dd9c38895cb740b8a955c71413'}, 'tags': [], 'refs': [], 'sources': [['airbnb', 'hosts']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'ephemeral'}, 'created_at': 1665730579.920427, 'config_call_dict': {}}, 'model.learn_dbt.fact_reviews': {'raw_sql': "{{\n  config(\n    materialized = 'incremental',\n    on_schema_change = 'fail'\n  )\n}}\n\nwith src_reviews as (\n  select * from {{ ref('src_reviews') }}\n)\nselect * from src_reviews\nwhere review_text is not null\n{% if is_incremental() %}\n  and review_date > (select max(review_date) from {{ this }})\n{% endif %}", 'resource_type': 'model', 'depends_on': {'macros': ['macro.dbt.is_incremental'], 'nodes': ['model.learn_dbt.src_reviews']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'incremental', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'fail', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'fact', 'fact_reviews'], 'unique_id': 'model.learn_dbt.fact_reviews', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'fact/fact_reviews.sql', 'original_file_path': 'models/fact/fact_reviews.sql', 'name': 'fact_reviews', 'alias': 'fact_reviews', 'checksum': {'name': 'sha256', 'checksum': '91dade285512addecdbceae43198b6852c22632ca30cb42aea81d61e16c06cfe'}, 'tags': [], 'refs': [['src_reviews']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'incremental', 'on_schema_change': 'fail'}, 'created_at': 1665730579.921921, 'config_call_dict': {'materialized': 'incremental', 'on_schema_change': 'fail'}}, 'model.learn_dbt.dim_listings_cleansed': {'raw_sql': "{{\n  config(\n  materialized = 'view'\n  )\n}}\n\nwith scr_listings as (\n  select * from {{ ref('src_listings') }}\n)\nselect \n  listing_id\n  ,listing_name\n  ,room_type\n  ,case when minimum_nights = 0 then 1\n        else minimum_nights\n   end as minimum_nights\n  ,host_id\n  ,replace(price_str, '$') :: number(10,2) as price\n  ,created_at\n  ,updated_at\nfrom src_listings", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.learn_dbt.src_listings']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'dim', 'dim_listings_cleansed'], 'unique_id': 'model.learn_dbt.dim_listings_cleansed', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'dim/dim_listings_cleansed.sql', 'original_file_path': 'models/dim/dim_listings_cleansed.sql', 'name': 'dim_listings_cleansed', 'alias': 'dim_listings_cleansed', 'checksum': {'name': 'sha256', 'checksum': '8c125280354eb1949c34f7064dade82eb9287216bb0593f3c241fc745d0d1a22'}, 'tags': [], 'refs': [['src_listings']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'view'}, 'created_at': 1665730579.927486, 'config_call_dict': {'materialized': 'view'}}, 'snapshot.learn_dbt.scd_raw_listings': {'raw_sql': "\n\n{{\n  config(\n    target_schema='dev',\n    unique_key='id',\n    strategy='timestamp',\n    updated_at='updated_at',\n    invalidate_hard_deletes=True\n  )\n}}\n\nselect * from {{source('airbnb', 'listings')}}\n\n", 'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['source.learn_dbt.airbnb.listings']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'id', 'on_schema_change': 'ignore', 'grants': {}, 'strategy': 'timestamp', 'target_schema': 'dev', 'target_database': None, 'updated_at': 'updated_at', 'check_cols': None, 'invalidate_hard_deletes': True, 'post-hook': [], 'pre-hook': []}, 'database': 'airbnb', 'schema': 'dev', 'fqn': ['learn_dbt', 'scd_raw_listings', 'scd_raw_listings'], 'unique_id': 'snapshot.learn_dbt.scd_raw_listings', 'package_name': 'learn_dbt', 'root_path': '/Users/nigelbrown/learn-dbt', 'path': 'scd_raw_listings.sql', 'original_file_path': 'snapshots/scd_raw_listings.sql', 'name': 'scd_raw_listings', 'alias': 'scd_raw_listings', 'checksum': {'name': 'sha256', 'checksum': 'aed035889d63b1c9ad34b2648de32fd6a0bd37b16a7e29254fee461f89d851da'}, 'tags': [], 'refs': [], 'sources': [['airbnb', 'listings']], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'dev', 'unique_key': 'id', 'strategy': 'timestamp', 'updated_at': 'updated_at', 'invalidate_hard_deletes': True}, 'created_at': 1665730579.934686, 'config_call_dict': {'target_schema': 'dev', 'unique_key': 'id', 'strategy': 'timestamp', 'updated_at': 'updated_at', 'invalidate_hard_deletes': True}}}
[0m07:34:13.318567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5159938-40d2-4bc6-aea9-8d0221ab8942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114baf4f0>]}
[0m07:34:13.340907 [debug] [MainThread]: Parsing macros/catalog.sql
[0m07:34:13.342496 [debug] [MainThread]: Parsing macros/adapters.sql
[0m07:34:13.365793 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m07:34:13.366344 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m07:34:13.366790 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m07:34:13.368574 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m07:34:13.370975 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m07:34:13.371590 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m07:34:13.374255 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m07:34:13.379069 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m07:34:13.379519 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m07:34:13.380379 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:34:13.380651 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:34:13.380959 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:34:13.381206 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:34:13.381423 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m07:34:13.381681 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:34:13.383390 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:34:13.384485 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:34:13.385244 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:34:13.392612 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:34:13.399101 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:34:13.404932 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:34:13.407018 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:34:13.407842 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:34:13.408713 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:34:13.412389 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:34:13.420098 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:34:13.420823 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m07:34:13.423868 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:34:13.428664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:34:13.436802 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:34:13.439332 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:34:13.440924 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:34:13.443447 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:34:13.444034 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:34:13.445566 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:34:13.446594 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:34:13.449817 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:34:13.458678 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:34:13.459396 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:34:13.460516 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:34:13.461234 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:34:13.461652 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:34:13.462027 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:34:13.462371 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:34:13.462992 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:34:13.465414 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:34:13.469287 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:34:13.469671 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:34:13.470233 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:34:13.470685 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:34:13.471120 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:34:13.471695 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:34:13.472097 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:34:13.472601 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:34:13.473160 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:34:13.474245 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:34:13.474810 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:34:13.475311 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:34:13.475798 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:34:13.476275 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:34:13.476700 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:34:13.477196 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:34:13.477628 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:34:13.480800 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m07:34:13.481287 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:34:13.481712 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:34:13.482531 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:34:13.483551 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:34:13.484036 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m07:34:13.484720 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m07:34:13.485207 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:34:13.486186 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m07:34:13.487752 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:34:13.489063 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:34:13.495966 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:34:13.496879 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:34:13.503081 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:34:13.505111 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:34:13.508396 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:34:13.512888 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m07:34:13.515708 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:34:13.643088 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m07:34:13.649159 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:34:13.650770 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m07:34:13.652294 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m07:34:13.656598 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m07:34:13.657746 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m07:34:13.659255 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m07:34:13.660691 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m07:34:13.662208 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m07:34:13.723017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5159938-40d2-4bc6-aea9-8d0221ab8942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dff0d0>]}
[0m07:34:13.726982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5159938-40d2-4bc6-aea9-8d0221ab8942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc1490>]}
[0m07:34:13.727154 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:34:13.727320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5159938-40d2-4bc6-aea9-8d0221ab8942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114da8f70>]}
[0m07:34:13.728161 [info ] [MainThread]: 
[0m07:34:13.728540 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:34:13.729146 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:34:13.736215 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:34:13.736365 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:34:13.736455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:15.710171 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.97 seconds
[0m07:34:15.713397 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:34:15.901147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5159938-40d2-4bc6-aea9-8d0221ab8942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c28a00>]}
[0m07:34:15.902586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:34:15.903180 [info ] [MainThread]: 
[0m07:34:15.924320 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m07:34:15.924506 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m07:34:15.924688 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m07:34:15.924900 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m07:34:15.925523 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m07:34:15.926004 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m07:34:15.926453 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m07:34:15.926859 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m07:34:15.927034 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m07:34:15.927185 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m07:34:15.927330 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m07:34:15.927470 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m07:34:15.927644 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m07:34:15.927785 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m07:34:15.927928 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m07:34:15.928058 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m07:34:15.930931 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m07:34:15.933007 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m07:34:15.934849 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m07:34:15.935973 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m07:34:15.936320 [debug] [Thread-4  ]: finished collecting timing info
[0m07:34:15.936584 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m07:34:15.936724 [debug] [Thread-2  ]: finished collecting timing info
[0m07:34:15.936858 [debug] [Thread-1  ]: finished collecting timing info
[0m07:34:15.936991 [debug] [Thread-4  ]: finished collecting timing info
[0m07:34:15.937459 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m07:34:15.937571 [debug] [Thread-3  ]: finished collecting timing info
[0m07:34:15.937949 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m07:34:15.938317 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m07:34:15.938469 [debug] [Thread-2  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m07:34:15.938932 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m07:34:15.939086 [debug] [Thread-1  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m07:34:15.939271 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m07:34:15.939695 [debug] [Thread-2  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m07:34:15.939848 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m07:34:15.940228 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m07:34:15.940590 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m07:34:15.940721 [debug] [Thread-2  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m07:34:15.941039 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m07:34:15.941170 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m07:34:15.941296 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m07:34:15.941421 [debug] [Thread-2  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m07:34:15.941540 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m07:34:15.941658 [debug] [Thread-1  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m07:34:15.941777 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m07:34:15.944655 [debug] [Thread-2  ]: finished collecting timing info
[0m07:34:15.944804 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m07:34:15.950559 [debug] [Thread-2  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m07:34:15.958512 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m07:34:15.958780 [debug] [Thread-2  ]: finished collecting timing info
[0m07:34:15.959178 [debug] [Thread-1  ]: finished collecting timing info
[0m07:34:15.959414 [debug] [Thread-4  ]: finished collecting timing info
[0m07:34:15.959863 [debug] [Thread-2  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m07:34:15.960187 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:34:15.960493 [debug] [Thread-4  ]: Compilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:34:15.960651 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m07:34:15.960802 [debug] [Thread-3  ]: finished collecting timing info
[0m07:34:15.961024 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m07:34:15.961204 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m07:34:15.961555 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m07:34:15.961691 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m07:34:15.961915 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m07:34:15.962195 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m07:34:15.962314 [debug] [Thread-3  ]: finished collecting timing info
[0m07:34:15.962653 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m07:34:15.962779 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m07:34:15.963130 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m07:34:15.963314 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m07:34:15.966826 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m07:34:15.967033 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m07:34:15.971809 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m07:34:15.972065 [debug] [Thread-2  ]: finished collecting timing info
[0m07:34:15.972190 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m07:34:15.972282 [debug] [Thread-1  ]: finished collecting timing info
[0m07:34:15.972396 [debug] [Thread-2  ]: finished collecting timing info
[0m07:34:15.972505 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m07:34:15.972848 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m07:34:15.972955 [debug] [Thread-1  ]: finished collecting timing info
[0m07:34:15.973120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:15.973237 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m07:34:15.973320 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m07:34:15.973401 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m07:34:15.973480 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9' was properly closed.
[0m07:34:15.973612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11528bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11528b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115288ca0>]}
[0m07:34:15.973871 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m07:34:15.974031 [debug] [MainThread]: Flushing usage events
[0m07:34:16.587476 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)
    'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".


============================== 2022-10-14 07:35:19.694551 | 60986408-b9b8-4797-bc08-42da721fdc5b ==============================
[0m07:35:19.694557 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:35:19.694802 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m07:35:19.694894 [debug] [MainThread]: Tracking: tracking
[0m07:35:19.709320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108914490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108914580>]}
[0m07:35:19.710058 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m07:35:19.710345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108914430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108914af0>]}
[0m07:35:19.710476 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 07:35:32.953532 | de8409b2-34d3-404b-949a-877a2912440c ==============================
[0m07:35:32.953538 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:35:32.953941 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:35:32.954038 [debug] [MainThread]: Tracking: tracking
[0m07:35:32.966846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084679a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108467a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108467b50>]}
[0m07:35:33.188388 [debug] [MainThread]: Executing "git --help"
[0m07:35:33.208835 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:35:33.209304 [debug] [MainThread]: STDERR: "b''"
[0m07:35:33.213104 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m07:35:33.214340 [debug] [MainThread]: Using snowflake connection "debug"
[0m07:35:33.214538 [debug] [MainThread]: On debug: select 1 as id
[0m07:35:33.214662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:35:34.811850 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.6 seconds
[0m07:35:34.814262 [debug] [MainThread]: On debug: Close
[0m07:35:35.158999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090383a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109038ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090458e0>]}
[0m07:35:35.159696 [debug] [MainThread]: Flushing usage events
[0m07:35:35.745597 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-14 07:38:38.010335 | e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e ==============================
[0m07:38:38.010372 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:38:38.010955 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:38:38.011080 [debug] [MainThread]: Tracking: tracking
[0m07:38:38.011319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc18b0>]}
[0m07:38:38.045611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:38.045815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:38.049661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f840d0>]}
[0m07:38:38.054068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f44fa0>]}
[0m07:38:38.054276 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:38:38.054458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dff5b0>]}
[0m07:38:38.055287 [info ] [MainThread]: 
[0m07:38:38.055652 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:38:38.056251 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m07:38:38.064144 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m07:38:38.064338 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m07:38:38.064432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:38.815064 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.75 seconds
[0m07:38:38.818536 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:38:38.982430 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:38:38.991890 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:38:38.992161 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:38:38.992352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:39.507177 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.51 seconds
[0m07:38:39.510293 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:38:39.703727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f44880>]}
[0m07:38:39.704934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:38:39.705482 [info ] [MainThread]: 
[0m07:38:39.712314 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m07:38:39.712608 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m07:38:39.712856 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m07:38:39.713528 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m07:38:39.714116 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m07:38:39.714709 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m07:38:39.714974 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m07:38:39.715192 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m07:38:39.715370 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m07:38:39.715577 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m07:38:39.715765 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m07:38:39.715933 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m07:38:39.719604 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m07:38:39.722120 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m07:38:39.724402 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m07:38:39.725111 [debug] [Thread-2  ]: finished collecting timing info
[0m07:38:39.725287 [debug] [Thread-3  ]: finished collecting timing info
[0m07:38:39.725453 [debug] [Thread-1  ]: finished collecting timing info
[0m07:38:39.726012 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m07:38:39.726494 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m07:38:39.726974 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m07:38:39.727321 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m07:38:39.727684 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m07:38:39.727860 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m07:38:39.728092 [info ] [Thread-3  ]: 1 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m07:38:39.728310 [info ] [Thread-2  ]: 2 of 5 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m07:38:39.728540 [info ] [Thread-4  ]: 3 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m07:38:39.729104 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m07:38:39.729572 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:39.730105 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m07:38:39.730250 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m07:38:39.730398 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m07:38:39.730540 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m07:38:39.730679 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m07:38:39.730815 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m07:38:39.730948 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m07:38:39.741556 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m07:38:39.749472 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m07:38:39.753652 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m07:38:39.754008 [debug] [Thread-3  ]: finished collecting timing info
[0m07:38:39.754151 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m07:38:39.754264 [debug] [Thread-2  ]: finished collecting timing info
[0m07:38:39.754388 [debug] [Thread-4  ]: finished collecting timing info
[0m07:38:39.771050 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_cleansed"
[0m07:38:39.771293 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m07:38:39.771427 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m07:38:39.789518 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:39.791518 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.dim_hosts_cleansed"
[0m07:38:39.791690 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace  view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m07:38:39.792271 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m07:38:39.792474 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:38:39.792647 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m07:38:39.793556 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m07:38:39.793988 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:38:39.794088 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m07:38:39.794481 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:38:40.563835 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a79e2a-3201-ec73-0000-00015aae707d
[0m07:38:40.564384 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a79e2a-3201-eb1e-0000-00015aae8065
[0m07:38:40.564734 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m07:38:40.564957 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m07:38:40.565436 [debug] [Thread-3  ]: finished collecting timing info
[0m07:38:40.565828 [debug] [Thread-4  ]: finished collecting timing info
[0m07:38:40.566101 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m07:38:40.566323 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m07:38:40.625021 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.83 seconds
[0m07:38:40.639531 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:40.639857 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m07:38:40.748781 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m07:38:40.751956 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:40.752581 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m07:38:40.753807 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled Code at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m07:38:40.754048 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109273b20>]}
[0m07:38:40.754308 [error] [Thread-4  ]: 3 of 5 ERROR creating sql view model dev.dim_hosts_cleansed .................... [[31mERROR[0m in 1.02s]
[0m07:38:40.754685 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m07:38:40.769449 [debug] [Thread-3  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled Code at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m07:38:40.770267 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f44dc0>]}
[0m07:38:40.770905 [error] [Thread-3  ]: 1 of 5 ERROR creating sql view model dev.dim_listings_cleansed ................. [[31mERROR[0m in 1.04s]
[0m07:38:40.771461 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m07:38:40.771780 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m07:38:40.771952 [info ] [Thread-1  ]: 4 of 5 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:38:40.772226 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m07:38:40.854262 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m07:38:40.862406 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:40.862550 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m07:38:40.954932 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m07:38:40.959662 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:40.959836 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m07:38:41.049670 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m07:38:41.057315 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:38:41.066213 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m07:38:41.067158 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:41.067330 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m07:38:41.202377 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m07:38:41.203122 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:41.203392 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m07:38:43.592376 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 2.39 seconds
[0m07:38:43.594128 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:43.594646 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m07:38:43.781564 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m07:38:43.793737 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:38:43.794051 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m07:38:43.901008 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m07:38:43.926053 [debug] [Thread-2  ]: finished collecting timing info
[0m07:38:43.926377 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m07:38:44.085257 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109273cd0>]}
[0m07:38:44.086195 [info ] [Thread-2  ]: 2 of 5 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 4.36s]
[0m07:38:44.087009 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m07:38:44.087682 [debug] [Thread-3  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m07:38:44.088142 [info ] [Thread-3  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m07:38:44.088774 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m07:38:44.088946 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m07:38:44.089139 [debug] [Thread-3  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m07:38:44.093169 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m07:38:44.094368 [debug] [Thread-3  ]: finished collecting timing info
[0m07:38:44.094604 [debug] [Thread-3  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m07:38:44.117247 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.mart_fullmoon_reviews"
[0m07:38:44.118353 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m07:38:44.118528 [debug] [Thread-3  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m07:38:44.118659 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m07:38:48.145215 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.03 seconds
[0m07:38:48.155496 [debug] [Thread-3  ]: finished collecting timing info
[0m07:38:48.155901 [debug] [Thread-3  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m07:38:48.321939 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7b18a18-4faa-42b8-92e7-0ac39c4c0b3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109665970>]}
[0m07:38:48.322927 [info ] [Thread-3  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 4.23s]
[0m07:38:48.323714 [debug] [Thread-3  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m07:38:48.325383 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:38:48.326110 [info ] [MainThread]: 
[0m07:38:48.326529 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m07:38:48.326911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:48.327103 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m07:38:48.327290 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m07:38:48.327471 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m07:38:48.327657 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m07:38:48.337867 [info ] [MainThread]: 
[0m07:38:48.338314 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:38:48.338676 [info ] [MainThread]: 
[0m07:38:48.338995 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m07:38:48.339300 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m07:38:48.339569 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m07:38:48.339817 [error] [MainThread]:   compiled Code at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m07:38:48.340070 [info ] [MainThread]: 
[0m07:38:48.340320 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m07:38:48.340574 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m07:38:48.340821 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m07:38:48.341070 [error] [MainThread]:   compiled Code at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m07:38:48.356904 [info ] [MainThread]: 
[0m07:38:48.357452 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m07:38:48.357918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109267df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096619a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109661bb0>]}
[0m07:38:48.358274 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 07:56:47.677199 | b60a6053-d47d-4566-afa8-8de34c8a9872 ==============================
[0m07:56:47.677205 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:56:47.677799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:56:47.677897 [debug] [MainThread]: Tracking: tracking
[0m07:56:47.693066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e0760>]}
[0m07:56:47.923014 [debug] [MainThread]: Executing "git --help"
[0m07:56:47.940510 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:56:47.941010 [debug] [MainThread]: STDERR: "b''"
[0m07:56:47.944712 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m07:56:47.945590 [debug] [MainThread]: Using snowflake connection "debug"
[0m07:56:47.945712 [debug] [MainThread]: On debug: select 1 as id
[0m07:56:47.945838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:56:48.710404 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.76 seconds
[0m07:56:48.711755 [debug] [MainThread]: On debug: Close
[0m07:56:48.863878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c99760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c99340>]}
[0m07:56:48.864338 [debug] [MainThread]: Flushing usage events
[0m07:56:49.381218 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-14 07:56:57.120413 | 4afe8c1d-ba74-471a-96fc-75f61b540084 ==============================
[0m07:56:57.120454 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:56:57.120932 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:56:57.121049 [debug] [MainThread]: Tracking: tracking
[0m07:56:57.121316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998ebe0>]}
[0m07:56:57.157200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:56:57.157388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:56:57.161610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8b0d0>]}
[0m07:56:57.166233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7e400>]}
[0m07:56:57.166441 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:56:57.166628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b7460>]}
[0m07:56:57.167488 [info ] [MainThread]: 
[0m07:56:57.167868 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:56:57.168471 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m07:56:57.176333 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m07:56:57.176527 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m07:56:57.176635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:57.850474 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.67 seconds
[0m07:56:57.852287 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:56:58.012878 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:56:58.018191 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:56:58.018379 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:56:58.018500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:58.517381 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.5 seconds
[0m07:56:58.521077 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:56:58.684954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4c8e0>]}
[0m07:56:58.685974 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:56:58.686520 [info ] [MainThread]: 
[0m07:56:58.692394 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m07:56:58.692692 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m07:56:58.693031 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m07:56:58.693686 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m07:56:58.694270 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m07:56:58.694845 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m07:56:58.695083 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m07:56:58.695276 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m07:56:58.695453 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m07:56:58.695655 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m07:56:58.695840 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m07:56:58.696008 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m07:56:58.699356 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m07:56:58.701862 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m07:56:58.704108 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m07:56:58.704776 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:58.704970 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:58.705112 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:58.705664 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m07:56:58.706166 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m07:56:58.706773 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m07:56:58.707170 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m07:56:58.707546 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m07:56:58.707790 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m07:56:58.708012 [info ] [Thread-4  ]: 1 of 5 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m07:56:58.708238 [info ] [Thread-3  ]: 2 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m07:56:58.708479 [info ] [Thread-2  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m07:56:58.709103 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:58.709609 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m07:56:58.710068 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m07:56:58.710222 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m07:56:58.710377 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m07:56:58.710533 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m07:56:58.710680 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m07:56:58.710818 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m07:56:58.710956 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m07:56:58.725234 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m07:56:58.729138 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m07:56:58.734675 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m07:56:58.735163 [debug] [Thread-4  ]: finished collecting timing info
[0m07:56:58.735277 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:58.735387 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:58.735492 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m07:56:58.735609 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m07:56:58.735718 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m07:56:58.766585 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:58.769358 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.dim_hosts_cleansed"
[0m07:56:58.771139 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_cleansed"
[0m07:56:58.771255 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace  view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m07:56:58.771569 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:56:58.773101 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m07:56:58.773675 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m07:56:58.773766 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m07:56:58.773897 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m07:56:58.773998 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:56:58.774102 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:56:59.350314 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.58 seconds
[0m07:56:59.357290 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:59.357830 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m07:56:59.453536 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m07:56:59.456417 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:59.456570 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m07:56:59.478594 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a79e3c-3201-ebe6-0000-00015aae9065
[0m07:56:59.478780 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m07:56:59.479001 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:59.479123 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m07:56:59.505667 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79e3c-3201-ec57-0000-00015aae568d
[0m07:56:59.505874 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m07:56:59.506105 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:59.506241 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m07:56:59.581323 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m07:56:59.592834 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:59.593003 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m07:56:59.680330 [debug] [Thread-3  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled Code at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m07:56:59.680713 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4c610>]}
[0m07:56:59.681118 [error] [Thread-3  ]: 2 of 5 ERROR creating sql view model dev.dim_hosts_cleansed .................... [[31mERROR[0m in 0.97s]
[0m07:56:59.681614 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m07:56:59.685208 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m07:56:59.688980 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:59.689184 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m07:56:59.744902 [debug] [Thread-2  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled Code at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m07:56:59.745402 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f3ed00>]}
[0m07:56:59.745814 [error] [Thread-2  ]: 3 of 5 ERROR creating sql view model dev.dim_listings_cleansed ................. [[31mERROR[0m in 1.04s]
[0m07:56:59.746310 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m07:56:59.746760 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m07:56:59.746965 [info ] [Thread-1  ]: 4 of 5 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:56:59.747379 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m07:56:59.780313 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m07:56:59.787667 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:56:59.798871 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m07:56:59.799633 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:59.799778 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m07:56:59.909488 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m07:56:59.909855 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:56:59.910008 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m07:57:00.895811 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.99 seconds
[0m07:57:00.897738 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:57:00.898182 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m07:57:01.099466 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m07:57:01.113456 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m07:57:01.113880 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m07:57:01.331192 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m07:57:01.355731 [debug] [Thread-4  ]: finished collecting timing info
[0m07:57:01.356041 [debug] [Thread-4  ]: On model.learn_dbt.fact_reviews: Close
[0m07:57:01.737428 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0c00d0>]}
[0m07:57:01.738243 [info ] [Thread-4  ]: 1 of 5 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.03s]
[0m07:57:01.739003 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m07:57:01.739645 [debug] [Thread-2  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m07:57:01.740253 [info ] [Thread-2  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m07:57:01.741338 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m07:57:01.741666 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m07:57:01.741968 [debug] [Thread-2  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m07:57:01.746440 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m07:57:01.748521 [debug] [Thread-2  ]: finished collecting timing info
[0m07:57:01.748766 [debug] [Thread-2  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m07:57:01.769595 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.mart_fullmoon_reviews"
[0m07:57:01.770453 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m07:57:01.770590 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m07:57:01.770705 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m07:57:07.494336 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.72 seconds
[0m07:57:07.504291 [debug] [Thread-2  ]: finished collecting timing info
[0m07:57:07.504637 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m07:57:07.652816 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afe8c1d-ba74-471a-96fc-75f61b540084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61c400>]}
[0m07:57:07.653658 [info ] [Thread-2  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 5.91s]
[0m07:57:07.654439 [debug] [Thread-2  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m07:57:07.656236 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:57:07.657022 [info ] [MainThread]: 
[0m07:57:07.657458 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m07:57:07.657857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:07.658059 [debug] [MainThread]: Connection 'model.learn_dbt.src_hosts' was properly closed.
[0m07:57:07.658253 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m07:57:07.658443 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m07:57:07.658632 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m07:57:07.667507 [info ] [MainThread]: 
[0m07:57:07.667931 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:57:07.668280 [info ] [MainThread]: 
[0m07:57:07.668592 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m07:57:07.668896 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m07:57:07.669184 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m07:57:07.669471 [error] [MainThread]:   compiled Code at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m07:57:07.669764 [info ] [MainThread]: 
[0m07:57:07.670053 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m07:57:07.670307 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m07:57:07.670555 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m07:57:07.670802 [error] [MainThread]:   compiled Code at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m07:57:07.671059 [info ] [MainThread]: 
[0m07:57:07.671319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m07:57:07.671641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f47af0>]}
[0m07:57:07.671877 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 08:06:31.917872 | 19506f9f-b604-4242-98c6-f26c8110c49c ==============================
[0m08:06:31.917895 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:06:31.918613 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:06:31.918759 [debug] [MainThread]: Tracking: tracking
[0m08:06:31.919055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c28d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c28d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c28dc0>]}
[0m08:06:31.955586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:06:31.955816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:06:31.960017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df2f10>]}
[0m08:06:31.964274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d11610>]}
[0m08:06:31.964459 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:06:31.964662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c18fa0>]}
[0m08:06:31.965515 [info ] [MainThread]: 
[0m08:06:31.965876 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:06:31.966469 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:06:31.974450 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:06:31.974656 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:06:31.974765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:32.689817 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.72 seconds
[0m08:06:32.692447 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:06:32.852935 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:06:32.861544 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:06:32.861809 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:06:32.862015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:33.511557 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.65 seconds
[0m08:06:33.515469 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:06:33.692942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cbe50>]}
[0m08:06:33.694064 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:06:33.694658 [info ] [MainThread]: 
[0m08:06:33.700449 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m08:06:33.700783 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m08:06:33.701047 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m08:06:33.701744 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m08:06:33.702289 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m08:06:33.702810 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m08:06:33.703036 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m08:06:33.703244 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m08:06:33.703480 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m08:06:33.703731 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m08:06:33.703943 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m08:06:33.704141 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m08:06:33.707395 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m08:06:33.709793 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m08:06:33.712440 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m08:06:33.713186 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:33.713855 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m08:06:33.714061 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:33.714220 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:33.714557 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m08:06:33.715082 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m08:06:33.715520 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m08:06:33.715755 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m08:06:33.716062 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m08:06:33.716318 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m08:06:33.716913 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:06:33.717103 [info ] [Thread-1  ]: 2 of 5 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m08:06:33.717321 [info ] [Thread-2  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m08:06:33.717494 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m08:06:33.718019 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:33.718606 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:06:33.718789 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m08:06:33.719038 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m08:06:33.719233 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m08:06:33.728825 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:06:33.729091 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m08:06:33.729248 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m08:06:33.737839 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m08:06:33.743555 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m08:06:33.743892 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:33.744200 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m08:06:33.744386 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:33.761185 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:06:33.761367 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:33.761625 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m08:06:33.761896 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m08:06:33.773942 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:06:33.781336 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_cleansed"
[0m08:06:33.781763 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:33.781912 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m08:06:33.782076 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace  view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m08:06:33.782193 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:06:33.782328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:33.783664 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:06:33.784400 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m08:06:33.784743 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:06:34.273376 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a79e46-3201-ec57-0000-00015aae569d
[0m08:06:34.273676 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m08:06:34.274012 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:34.274206 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m08:06:34.718974 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.94 seconds
[0m08:06:34.725962 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:34.726727 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:06:34.728651 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79e46-3201-ec57-0000-00015aae56a1
[0m08:06:34.728933 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m08:06:34.729379 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:34.729991 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m08:06:34.829767 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
  compiled Code at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m08:06:34.830766 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2d6a0>]}
[0m08:06:34.831510 [error] [Thread-4  ]: 1 of 5 ERROR creating sql view model dev.dim_hosts_cleansed .................... [[31mERROR[0m in 1.11s]
[0m08:06:34.832407 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m08:06:35.038233 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.31 seconds
[0m08:06:35.047899 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:35.048363 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m08:06:35.049905 [debug] [Thread-2  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
  compiled Code at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m08:06:35.050305 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129fdaf0>]}
[0m08:06:35.050730 [error] [Thread-2  ]: 3 of 5 ERROR creating sql view model dev.dim_listings_cleansed ................. [[31mERROR[0m in 1.33s]
[0m08:06:35.051334 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m08:06:35.052225 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m08:06:35.052791 [info ] [Thread-3  ]: 4 of 5 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m08:06:35.053612 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m08:06:35.161190 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m08:06:35.172878 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:35.173109 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:06:35.299565 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.13 seconds
[0m08:06:35.304463 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:35.304743 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m08:06:35.435836 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.13 seconds
[0m08:06:35.450029 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:06:35.464609 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m08:06:35.465837 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:35.466031 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m08:06:35.603334 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m08:06:35.604577 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:35.605040 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m08:06:35.921246 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.32 seconds
[0m08:06:35.922011 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:35.922291 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m08:06:36.086878 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m08:06:36.097673 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:06:36.097986 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m08:06:36.208308 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m08:06:36.233409 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:36.233835 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: Close
[0m08:06:36.389492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d07490>]}
[0m08:06:36.389998 [info ] [Thread-1  ]: 2 of 5 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 2.67s]
[0m08:06:36.390382 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m08:06:36.391235 [debug] [Thread-2  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m08:06:36.391773 [info ] [Thread-2  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m08:06:36.392881 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:06:36.393204 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m08:06:36.393511 [debug] [Thread-2  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m08:06:36.398225 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:06:36.400016 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:36.400313 [debug] [Thread-2  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m08:06:36.422777 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:06:36.424175 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:06:36.424349 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m08:06:36.424501 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:06:39.996396 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.57 seconds
[0m08:06:40.004557 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:40.005031 [debug] [Thread-2  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m08:06:40.165859 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19506f9f-b604-4242-98c6-f26c8110c49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112effa60>]}
[0m08:06:40.166801 [info ] [Thread-2  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 3.77s]
[0m08:06:40.167627 [debug] [Thread-2  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m08:06:40.169612 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:06:40.170557 [info ] [MainThread]: 
[0m08:06:40.171049 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 8.20 seconds (8.20s).
[0m08:06:40.171479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:40.171716 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m08:06:40.171926 [debug] [MainThread]: Connection 'model.learn_dbt.src_reviews' was properly closed.
[0m08:06:40.172139 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m08:06:40.172350 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m08:06:40.181070 [info ] [MainThread]: 
[0m08:06:40.181479 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:06:40.181860 [info ] [MainThread]: 
[0m08:06:40.182207 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m08:06:40.182559 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m08:06:40.182884 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_HOSTS' does not exist or not authorized.
[0m08:06:40.183207 [error] [MainThread]:   compiled Code at target/run/learn_dbt/models/dim/dim_hosts_cleansed.sql
[0m08:06:40.183536 [info ] [MainThread]: 
[0m08:06:40.183862 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m08:06:40.184188 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m08:06:40.184485 [error] [MainThread]:   Object 'AIRBNB.DEV.SRC_LISTINGS' does not exist or not authorized.
[0m08:06:40.184762 [error] [MainThread]:   compiled Code at target/run/learn_dbt/models/dim/dim_listings_cleansed.sql
[0m08:06:40.216059 [info ] [MainThread]: 
[0m08:06:40.216448 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m08:06:40.216885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112efc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112effeb0>]}
[0m08:06:40.217182 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 08:11:40.111207 | cc11ce24-7dc4-4358-87d5-fe0001a1a748 ==============================
[0m08:11:40.111246 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:11:40.111990 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:11:40.112122 [debug] [MainThread]: Tracking: tracking
[0m08:11:40.112374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740fa60>]}
[0m08:11:40.131283 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:11:40.131551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741d4f0>]}
[0m08:11:40.149027 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:11:40.150250 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:11:40.171405 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m08:11:40.172047 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m08:11:40.172520 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:11:40.174282 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:11:40.176993 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:11:40.177784 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:11:40.180547 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:11:40.185383 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:11:40.185878 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m08:11:40.186821 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:11:40.187129 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:11:40.187466 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:11:40.187737 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:11:40.187970 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m08:11:40.188251 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:11:40.190113 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:11:40.191472 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:11:40.192389 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:11:40.200621 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:11:40.207413 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:11:40.213617 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:11:40.215702 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:11:40.216533 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:11:40.217354 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:11:40.221109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:11:40.228799 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:11:40.229521 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m08:11:40.232598 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:11:40.237503 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:11:40.245641 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:11:40.248186 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:11:40.249760 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:11:40.252282 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:11:40.252877 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:11:40.254397 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:11:40.255421 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:11:40.258725 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:11:40.267511 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:11:40.268225 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:11:40.269352 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:11:40.270070 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:11:40.270543 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:11:40.270933 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:11:40.271267 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:11:40.271900 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:11:40.274303 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:11:40.278163 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:11:40.278558 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:11:40.279130 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:11:40.279583 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:11:40.280024 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:11:40.280606 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:11:40.280993 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:11:40.281479 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:11:40.282049 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:11:40.283145 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:11:40.283772 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:11:40.284282 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:11:40.284794 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:11:40.285281 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:11:40.285715 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:11:40.286213 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:11:40.286643 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:11:40.289654 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m08:11:40.290149 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:11:40.290584 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:11:40.291414 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:11:40.292433 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:11:40.292913 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m08:11:40.293592 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m08:11:40.294086 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:11:40.295050 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m08:11:40.296605 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:11:40.297888 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:11:40.304717 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:11:40.305621 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:11:40.311744 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:11:40.313740 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:11:40.317096 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:11:40.321722 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m08:11:40.324543 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:11:40.455384 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:11:40.461857 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:11:40.463596 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:11:40.465190 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m08:11:40.469532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m08:11:40.472391 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:11:40.473857 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:11:40.475304 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:11:40.476854 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:11:40.538264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a00d0>]}
[0m08:11:40.542327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107640850>]}
[0m08:11:40.542501 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:11:40.542702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d7ee0>]}
[0m08:11:40.543495 [info ] [MainThread]: 
[0m08:11:40.543889 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:11:40.544554 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:11:40.551657 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:11:40.551813 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:11:40.551926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:41.346575 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.79 seconds
[0m08:11:41.349218 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:11:41.510588 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:11:41.519873 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:11:41.520179 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:11:41.520385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:42.072355 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.55 seconds
[0m08:11:42.076220 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:11:42.236684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741d670>]}
[0m08:11:42.237797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:11:42.238391 [info ] [MainThread]: 
[0m08:11:42.244277 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m08:11:42.244765 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m08:11:42.245160 [info ] [Thread-1  ]: 1 of 8 START sql view model dev.src_hosts ...................................... [RUN]
[0m08:11:42.245447 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m08:11:42.245817 [info ] [Thread-2  ]: 2 of 8 START sql view model dev.src_listings ................................... [RUN]
[0m08:11:42.246709 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m08:11:42.247042 [info ] [Thread-3  ]: 3 of 8 START sql view model dev.src_reviews .................................... [RUN]
[0m08:11:42.247837 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m08:11:42.248087 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m08:11:42.248743 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m08:11:42.248941 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m08:11:42.249151 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m08:11:42.249345 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m08:11:42.249535 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m08:11:42.252899 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m08:11:42.253139 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m08:11:42.255561 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m08:11:42.258043 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m08:11:42.258542 [debug] [Thread-1  ]: finished collecting timing info
[0m08:11:42.258764 [debug] [Thread-1  ]: Began executing node model.learn_dbt.src_hosts
[0m08:11:42.279239 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.src_hosts"
[0m08:11:42.279417 [debug] [Thread-2  ]: finished collecting timing info
[0m08:11:42.279546 [debug] [Thread-3  ]: finished collecting timing info
[0m08:11:42.279773 [debug] [Thread-2  ]: Began executing node model.learn_dbt.src_listings
[0m08:11:42.279911 [debug] [Thread-3  ]: Began executing node model.learn_dbt.src_reviews
[0m08:11:42.282212 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.src_listings"
[0m08:11:42.284492 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.src_reviews"
[0m08:11:42.285057 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.src_hosts"
[0m08:11:42.285421 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
  );
[0m08:11:42.285619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:11:42.286094 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.src_listings"
[0m08:11:42.286472 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.src_reviews"
[0m08:11:42.287049 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
  );
[0m08:11:42.287583 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
  );
[0m08:11:42.287741 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:11:42.287863 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:11:43.077602 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m08:11:43.097914 [debug] [Thread-2  ]: finished collecting timing info
[0m08:11:43.098233 [debug] [Thread-2  ]: On model.learn_dbt.src_listings: Close
[0m08:11:43.116017 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.83 seconds
[0m08:11:43.116455 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.83 seconds
[0m08:11:43.118620 [debug] [Thread-1  ]: finished collecting timing info
[0m08:11:43.120403 [debug] [Thread-3  ]: finished collecting timing info
[0m08:11:43.120624 [debug] [Thread-1  ]: On model.learn_dbt.src_hosts: Close
[0m08:11:43.120813 [debug] [Thread-3  ]: On model.learn_dbt.src_reviews: Close
[0m08:11:43.873325 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d3670>]}
[0m08:11:43.874279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d3160>]}
[0m08:11:43.875030 [info ] [Thread-2  ]: 2 of 8 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.63s]
[0m08:11:43.875562 [info ] [Thread-1  ]: 1 of 8 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.63s]
[0m08:11:43.876364 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a22820>]}
[0m08:11:43.877209 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m08:11:43.877834 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m08:11:43.878241 [info ] [Thread-3  ]: 3 of 8 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.63s]
[0m08:11:43.878841 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m08:11:43.879595 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m08:11:43.879837 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m08:11:43.880163 [info ] [Thread-4  ]: 4 of 8 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m08:11:43.880565 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m08:11:43.880889 [info ] [Thread-1  ]: 5 of 8 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m08:11:43.881714 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:11:43.882026 [info ] [Thread-2  ]: 6 of 8 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m08:11:43.882788 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:11:43.883040 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m08:11:43.883737 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:43.883943 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m08:11:43.884150 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m08:11:43.884338 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m08:11:43.884526 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m08:11:43.888496 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m08:11:43.888700 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m08:11:43.891251 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:11:43.897423 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m08:11:43.897811 [debug] [Thread-4  ]: finished collecting timing info
[0m08:11:43.898016 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m08:11:43.900836 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_cleansed"
[0m08:11:43.901014 [debug] [Thread-1  ]: finished collecting timing info
[0m08:11:43.901245 [debug] [Thread-2  ]: finished collecting timing info
[0m08:11:43.901398 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m08:11:43.901617 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m08:11:43.902250 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:11:43.904972 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:11:43.927426 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:43.927578 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with scr_listings as (
  select * from airbnb.dev.src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m08:11:43.927809 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace  view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
  select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m08:11:43.927985 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:11:43.928128 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:11:43.928942 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:11:43.930427 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with src_host as (
  select * from airbnb.dev.src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m08:11:43.930664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:11:44.555222 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m08:11:44.563160 [debug] [Thread-4  ]: finished collecting timing info
[0m08:11:44.563525 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m08:11:44.577642 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.65 seconds
[0m08:11:44.587530 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:44.587848 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:11:44.612868 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m08:11:44.615863 [debug] [Thread-1  ]: finished collecting timing info
[0m08:11:44.616143 [debug] [Thread-1  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m08:11:44.684239 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m08:11:44.690590 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:44.690891 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m08:11:44.725236 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d56be0>]}
[0m08:11:44.725907 [info ] [Thread-4  ]: 4 of 8 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m08:11:44.726529 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m08:11:44.766022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d560a0>]}
[0m08:11:44.766619 [info ] [Thread-1  ]: 5 of 8 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.88s]
[0m08:11:44.767303 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m08:11:44.767771 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m08:11:44.768051 [info ] [Thread-3  ]: 7 of 8 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m08:11:44.768643 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:11:44.768847 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m08:11:44.769021 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m08:11:44.772022 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:11:44.772810 [debug] [Thread-3  ]: finished collecting timing info
[0m08:11:44.773045 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m08:11:44.789928 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:11:44.790701 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
[0m08:11:44.800279 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:44.800471 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:11:44.801227 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:11:44.801754 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
        );
[0m08:11:44.801880 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:11:44.892918 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m08:11:44.895498 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:44.895649 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m08:11:45.012593 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m08:11:45.030671 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:11:45.051523 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m08:11:45.064887 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:45.071279 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m08:11:45.178372 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m08:11:45.178653 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:45.178808 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m08:11:45.383575 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.2 seconds
[0m08:11:45.384127 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:45.384321 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m08:11:45.552859 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m08:11:45.558567 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:11:45.558779 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m08:11:45.659067 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m08:11:45.665409 [debug] [Thread-2  ]: finished collecting timing info
[0m08:11:45.665639 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m08:11:45.815314 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107667550>]}
[0m08:11:45.816123 [info ] [Thread-2  ]: 6 of 8 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 1.93s]
[0m08:11:45.816923 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m08:11:45.817587 [debug] [Thread-1  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m08:11:45.818058 [info ] [Thread-1  ]: 8 of 8 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m08:11:45.819127 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:11:45.819400 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m08:11:45.819639 [debug] [Thread-1  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m08:11:45.823950 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:11:45.825332 [debug] [Thread-1  ]: finished collecting timing info
[0m08:11:45.825566 [debug] [Thread-1  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m08:11:45.828859 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:11:45.830021 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:11:45.830230 [debug] [Thread-1  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m08:11:45.830424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:11:46.592853 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.79 seconds
[0m08:11:46.595465 [debug] [Thread-3  ]: finished collecting timing info
[0m08:11:46.595682 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m08:11:46.742793 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12fd0>]}
[0m08:11:46.743417 [info ] [Thread-3  ]: 7 of 8 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.97s]
[0m08:11:46.743992 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m08:11:49.089985 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.26 seconds
[0m08:11:49.095639 [debug] [Thread-1  ]: finished collecting timing info
[0m08:11:49.096052 [debug] [Thread-1  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m08:11:49.252274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc11ce24-7dc4-4358-87d5-fe0001a1a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2d2b0>]}
[0m08:11:49.252705 [info ] [Thread-1  ]: 8 of 8 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 3.43s]
[0m08:11:49.253032 [debug] [Thread-1  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m08:11:49.253886 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:11:49.254208 [info ] [MainThread]: 
[0m08:11:49.254389 [info ] [MainThread]: Finished running 5 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m08:11:49.254560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:49.254650 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m08:11:49.254734 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m08:11:49.254816 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m08:11:49.254905 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m08:11:49.262233 [info ] [MainThread]: 
[0m08:11:49.262631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:49.263014 [info ] [MainThread]: 
[0m08:11:49.263343 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m08:11:49.263707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adf580>]}
[0m08:11:49.263945 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 08:12:41.571257 | 46fd6997-0bd0-468a-8c5b-226643fa3c79 ==============================
[0m08:12:41.571298 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:12:41.571920 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:12:41.572046 [debug] [MainThread]: Tracking: tracking
[0m08:12:41.572298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e7d30>]}
[0m08:12:41.590844 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:12:41.591108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f4460>]}
[0m08:12:41.611104 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:12:41.612438 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:12:41.634495 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m08:12:41.635114 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m08:12:41.635581 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:12:41.637386 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:12:41.640091 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:12:41.640855 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:12:41.643875 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:12:41.648885 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:12:41.649440 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m08:12:41.650426 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:12:41.650727 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:12:41.651056 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:12:41.651324 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:12:41.651550 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m08:12:41.651815 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:12:41.653553 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:12:41.654780 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:12:41.655641 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:12:41.663361 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:12:41.669887 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:12:41.675949 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:12:41.678016 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:12:41.678945 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:12:41.679804 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:12:41.683501 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:12:41.691064 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:12:41.691771 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m08:12:41.694807 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:12:41.699613 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:12:41.707733 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:12:41.710246 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:12:41.711801 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:12:41.714315 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:12:41.714914 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:12:41.716440 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:12:41.717461 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:12:41.720657 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:12:41.729500 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:12:41.730195 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:12:41.731319 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:12:41.732037 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:12:41.732472 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:12:41.732851 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:12:41.733186 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:12:41.733833 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:12:41.736219 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:12:41.740082 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:12:41.740479 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:12:41.741052 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:12:41.741507 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:12:41.741953 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:12:41.742525 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:12:41.742909 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:12:41.743400 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:12:41.743964 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:12:41.745062 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:12:41.745627 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:12:41.746132 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:12:41.746640 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:12:41.747118 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:12:41.747550 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:12:41.748061 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:12:41.748488 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:12:41.751486 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m08:12:41.751980 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:12:41.752412 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:12:41.753236 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:12:41.754241 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:12:41.754723 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m08:12:41.755403 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m08:12:41.755891 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:12:41.756854 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m08:12:41.758369 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:12:41.759621 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:12:41.766458 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:12:41.767371 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:12:41.773517 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:12:41.775504 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:12:41.778755 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:12:41.783393 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m08:12:41.786239 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:12:41.913793 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:12:41.920233 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:12:41.921898 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:12:41.923498 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m08:12:41.927817 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m08:12:41.928749 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:12:41.930217 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:12:41.931746 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:12:41.933315 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:12:41.992751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e950d0>]}
[0m08:12:41.996660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b97220>]}
[0m08:12:41.996824 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:12:41.997008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105badd90>]}
[0m08:12:41.997779 [info ] [MainThread]: 
[0m08:12:41.998150 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:12:41.998708 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:12:42.005565 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:12:42.005700 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:12:42.005797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:42.688645 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.68 seconds
[0m08:12:42.690233 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:12:42.836146 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:12:42.841543 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:12:42.841788 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:12:42.841919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:43.279109 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.44 seconds
[0m08:12:43.281443 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:12:43.437634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e368e0>]}
[0m08:12:43.438180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:12:43.438387 [info ] [MainThread]: 
[0m08:12:43.444056 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m08:12:43.444512 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_listings
[0m08:12:43.445134 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m08:12:43.445357 [debug] [Thread-4  ]: Began running node model.learn_dbt.src_reviews
[0m08:12:43.445985 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m08:12:43.446228 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m08:12:43.446803 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m08:12:43.447045 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_listings
[0m08:12:43.447286 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m08:12:43.447512 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.src_reviews
[0m08:12:43.447730 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_listings
[0m08:12:43.451239 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m08:12:43.451475 [debug] [Thread-4  ]: Compiling model.learn_dbt.src_reviews
[0m08:12:43.454080 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m08:12:43.456734 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m08:12:43.457180 [debug] [Thread-1  ]: finished collecting timing info
[0m08:12:43.457844 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m08:12:43.458161 [debug] [Thread-4  ]: finished collecting timing info
[0m08:12:43.458363 [debug] [Thread-3  ]: finished collecting timing info
[0m08:12:43.458543 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m08:12:43.459212 [debug] [Thread-4  ]: Finished running node model.learn_dbt.src_reviews
[0m08:12:43.459714 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_listings
[0m08:12:43.459981 [info ] [Thread-2  ]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m08:12:43.460384 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m08:12:43.460631 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m08:12:43.461286 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:12:43.461657 [info ] [Thread-1  ]: 2 of 5 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m08:12:43.462014 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m08:12:43.462239 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m08:12:43.462860 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:43.463341 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:12:43.463502 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m08:12:43.463666 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m08:12:43.463818 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m08:12:43.472264 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:12:43.472499 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m08:12:43.472656 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m08:12:43.479729 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m08:12:43.484635 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m08:12:43.484808 [debug] [Thread-2  ]: finished collecting timing info
[0m08:12:43.485087 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m08:12:43.491593 [debug] [Thread-1  ]: finished collecting timing info
[0m08:12:43.498007 [debug] [Thread-3  ]: finished collecting timing info
[0m08:12:43.502850 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:12:43.503039 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m08:12:43.503186 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m08:12:43.520408 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:43.522669 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_cleansed"
[0m08:12:43.523211 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:12:43.523340 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace  view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m08:12:43.523513 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m08:12:43.523630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:12:43.523761 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:12:43.524595 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:12:43.525975 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m08:12:43.526089 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:12:44.127178 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m08:12:44.142728 [debug] [Thread-2  ]: finished collecting timing info
[0m08:12:44.143577 [debug] [Thread-2  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m08:12:44.183112 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m08:12:44.189493 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:44.189688 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:12:44.305722 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m08:12:44.309173 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:44.309786 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef9ca0>]}
[0m08:12:44.310020 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m08:12:44.310368 [info ] [Thread-2  ]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.85s]
[0m08:12:44.311549 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m08:12:44.371443 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.85 seconds
[0m08:12:44.373481 [debug] [Thread-3  ]: finished collecting timing info
[0m08:12:44.373710 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m08:12:44.399476 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m08:12:44.408806 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:44.408965 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:12:44.501626 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m08:12:44.504734 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:44.504913 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m08:12:44.536577 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061181c0>]}
[0m08:12:44.536995 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.07s]
[0m08:12:44.537467 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m08:12:44.537860 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m08:12:44.538105 [info ] [Thread-4  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m08:12:44.538696 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:12:44.538879 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m08:12:44.539059 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m08:12:44.542011 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:12:44.543736 [debug] [Thread-4  ]: finished collecting timing info
[0m08:12:44.543923 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m08:12:44.561745 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:12:44.562714 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:12:44.562855 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
        );
[0m08:12:44.562978 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:12:44.629298 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m08:12:44.635780 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:12:44.645170 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m08:12:44.645770 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:44.645903 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m08:12:44.778803 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m08:12:44.788176 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:44.788279 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m08:12:44.926810 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.14 seconds
[0m08:12:44.927222 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:44.927386 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m08:12:45.093157 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m08:12:45.105487 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:12:45.105861 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m08:12:45.228594 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m08:12:45.234739 [debug] [Thread-1  ]: finished collecting timing info
[0m08:12:45.234990 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: Close
[0m08:12:45.395509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb6dc0>]}
[0m08:12:45.396129 [info ] [Thread-1  ]: 2 of 5 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 1.93s]
[0m08:12:45.396610 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m08:12:45.396977 [debug] [Thread-3  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m08:12:45.397217 [info ] [Thread-3  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m08:12:45.397756 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:12:45.397911 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m08:12:45.398058 [debug] [Thread-3  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m08:12:45.400875 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:12:45.401388 [debug] [Thread-3  ]: finished collecting timing info
[0m08:12:45.401539 [debug] [Thread-3  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m08:12:45.403736 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:12:45.404511 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:12:45.404640 [debug] [Thread-3  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m08:12:45.404756 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:12:45.684232 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.12 seconds
[0m08:12:45.686138 [debug] [Thread-4  ]: finished collecting timing info
[0m08:12:45.686291 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m08:12:45.833062 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637c6a0>]}
[0m08:12:45.833659 [info ] [Thread-4  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.29s]
[0m08:12:45.834298 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m08:12:51.759737 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6.35 seconds
[0m08:12:51.765587 [debug] [Thread-3  ]: finished collecting timing info
[0m08:12:51.766092 [debug] [Thread-3  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m08:12:51.972772 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fd6997-0bd0-468a-8c5b-226643fa3c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106325b20>]}
[0m08:12:51.973563 [info ] [Thread-3  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 6.58s]
[0m08:12:51.974341 [debug] [Thread-3  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m08:12:51.976227 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:12:51.977143 [info ] [MainThread]: 
[0m08:12:51.977673 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.98 seconds (9.98s).
[0m08:12:51.978172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:51.978393 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m08:12:51.978599 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m08:12:51.978802 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m08:12:51.979002 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m08:12:51.988959 [info ] [MainThread]: 
[0m08:12:51.989402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:51.989776 [info ] [MainThread]: 
[0m08:12:51.990104 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:12:51.990463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106422e80>]}
[0m08:12:51.990705 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 08:55:56.643904 | 278a573c-40fe-4823-aa7f-df1dc14c8875 ==============================
[0m08:55:56.643933 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:55:56.644614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:55:56.644746 [debug] [MainThread]: Tracking: tracking
[0m08:55:56.645007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14fd90>]}
[0m08:55:56.684708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:55:56.684901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:55:56.688881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a452ee0>]}
[0m08:55:56.693007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2385b0>]}
[0m08:55:56.693210 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:55:56.693412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a238520>]}
[0m08:55:56.694370 [info ] [MainThread]: 
[0m08:55:56.694863 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:55:56.695466 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:55:56.703913 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:55:56.704124 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:55:56.704244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:57.485953 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.78 seconds
[0m08:55:57.487708 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:55:57.645627 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:55:57.654614 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:55:57.654941 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:55:57.655181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:58.304075 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.65 seconds
[0m08:55:58.307903 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:55:58.473507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a238400>]}
[0m08:55:58.474073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:55:58.474291 [info ] [MainThread]: 
[0m08:55:58.480502 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m08:55:58.480860 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m08:55:58.481215 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m08:55:58.481939 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m08:55:58.482645 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m08:55:58.483277 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m08:55:58.483536 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m08:55:58.483776 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m08:55:58.484041 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m08:55:58.484313 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m08:55:58.484541 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m08:55:58.484761 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m08:55:58.488067 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m08:55:58.490733 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m08:55:58.493066 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m08:55:58.493660 [debug] [Thread-2  ]: finished collecting timing info
[0m08:55:58.493848 [debug] [Thread-3  ]: finished collecting timing info
[0m08:55:58.494477 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m08:55:58.495050 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m08:55:58.495269 [debug] [Thread-1  ]: finished collecting timing info
[0m08:55:58.495708 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m08:55:58.496075 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m08:55:58.496783 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m08:55:58.497099 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m08:55:58.497384 [info ] [Thread-2  ]: 2 of 5 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m08:55:58.497910 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m08:55:58.498459 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:55:58.499264 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:58.499543 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m08:55:58.499746 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m08:55:58.499920 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m08:55:58.500484 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:55:58.500656 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m08:55:58.500819 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m08:55:58.500973 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m08:55:58.511983 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m08:55:58.521046 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m08:55:58.521288 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m08:55:58.526536 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:55:58.526994 [debug] [Thread-4  ]: finished collecting timing info
[0m08:55:58.527190 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m08:55:58.533712 [debug] [Thread-3  ]: finished collecting timing info
[0m08:55:58.533860 [debug] [Thread-2  ]: finished collecting timing info
[0m08:55:58.544612 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_cleansed"
[0m08:55:58.544884 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m08:55:58.545013 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m08:55:58.547450 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:55:58.559826 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:55:58.565581 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:58.565833 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m08:55:58.565956 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace  view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m08:55:58.566096 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:55:58.566514 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:55:58.566616 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:55:58.567262 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m08:55:58.568268 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:55:59.312978 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m08:55:59.318734 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:59.319600 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m08:55:59.319828 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m08:55:59.319996 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:55:59.331908 [debug] [Thread-4  ]: finished collecting timing info
[0m08:55:59.333382 [debug] [Thread-3  ]: finished collecting timing info
[0m08:55:59.334192 [debug] [Thread-4  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m08:55:59.334410 [debug] [Thread-3  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m08:55:59.426835 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m08:55:59.429848 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:59.430014 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m08:55:59.513206 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m08:55:59.520936 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7eff70>]}
[0m08:55:59.528459 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:59.529274 [info ] [Thread-4  ]: 1 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m08:55:59.529562 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m08:55:59.530149 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m08:55:59.531006 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7be850>]}
[0m08:55:59.531996 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m08:55:59.532386 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m08:55:59.533119 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m08:55:59.533649 [info ] [Thread-1  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m08:55:59.534191 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:55:59.534338 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m08:55:59.534480 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m08:55:59.536775 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:55:59.537312 [debug] [Thread-1  ]: finished collecting timing info
[0m08:55:59.537493 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m08:55:59.552651 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:55:59.553601 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:55:59.553734 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
        );
[0m08:55:59.553847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:55:59.642830 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m08:55:59.655101 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:59.659816 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m08:55:59.783959 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
[0m08:55:59.807194 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:55:59.817359 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m08:55:59.829524 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:59.831402 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m08:55:59.946058 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m08:55:59.946411 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:55:59.946573 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m08:56:00.853911 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.91 seconds
[0m08:56:00.855038 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:56:00.855391 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m08:56:01.022977 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m08:56:01.034443 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m08:56:01.034882 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m08:56:01.171024 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m08:56:01.181607 [debug] [Thread-2  ]: finished collecting timing info
[0m08:56:01.182003 [debug] [Thread-2  ]: On model.learn_dbt.fact_reviews: Close
[0m08:56:01.374945 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e7280>]}
[0m08:56:01.375796 [info ] [Thread-2  ]: 2 of 5 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 2.88s]
[0m08:56:01.376605 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m08:56:01.377255 [debug] [Thread-3  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m08:56:01.377750 [info ] [Thread-3  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m08:56:01.378864 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:56:01.379194 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m08:56:01.379710 [debug] [Thread-3  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m08:56:01.383405 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:56:01.383975 [debug] [Thread-3  ]: finished collecting timing info
[0m08:56:01.384127 [debug] [Thread-3  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m08:56:01.386274 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:56:01.387164 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:56:01.387427 [debug] [Thread-3  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m08:56:01.387575 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:56:01.659461 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.11 seconds
[0m08:56:01.661539 [debug] [Thread-1  ]: finished collecting timing info
[0m08:56:01.661710 [debug] [Thread-1  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m08:56:01.832679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7be370>]}
[0m08:56:01.833296 [info ] [Thread-1  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.30s]
[0m08:56:01.833835 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m08:56:04.993870 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.61 seconds
[0m08:56:05.003909 [debug] [Thread-3  ]: finished collecting timing info
[0m08:56:05.004494 [debug] [Thread-3  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m08:56:05.169172 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278a573c-40fe-4823-aa7f-df1dc14c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dcdc0>]}
[0m08:56:05.170094 [info ] [Thread-3  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 3.79s]
[0m08:56:05.170900 [debug] [Thread-3  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m08:56:05.172834 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:56:05.173754 [info ] [MainThread]: 
[0m08:56:05.174342 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m08:56:05.174865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:05.175127 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m08:56:05.175381 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m08:56:05.175611 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m08:56:05.175814 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m08:56:05.184553 [info ] [MainThread]: 
[0m08:56:05.185012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:56:05.185461 [info ] [MainThread]: 
[0m08:56:05.185818 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:56:05.186238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb03ee0>]}
[0m08:56:05.186534 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 08:57:02.926817 | a8f332b9-19ed-4f6e-aae6-b0450de3b7f4 ==============================
[0m08:57:02.926872 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:57:02.927483 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m08:57:02.927612 [debug] [MainThread]: Tracking: tracking
[0m08:57:02.927842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112222d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112222d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112222df0>]}
[0m08:57:02.964065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:57:02.964273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:57:02.968090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8f332b9-19ed-4f6e-aae6-b0450de3b7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112610f40>]}
[0m08:57:02.972143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8f332b9-19ed-4f6e-aae6-b0450de3b7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112532640>]}
[0m08:57:02.972328 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:57:02.972519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8f332b9-19ed-4f6e-aae6-b0450de3b7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112214fd0>]}
[0m08:57:02.973379 [info ] [MainThread]: 
[0m08:57:02.973801 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:57:02.974416 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:57:02.981953 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:57:02.982159 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:57:02.982260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:03.688174 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.71 seconds
[0m08:57:03.689530 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:57:03.842144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8f332b9-19ed-4f6e-aae6-b0450de3b7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112532220>]}
[0m08:57:03.842711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:57:03.843019 [info ] [MainThread]: 
[0m08:57:03.846577 [debug] [Thread-1  ]: Began running node source.learn_dbt.airbnb.reviews
[0m08:57:03.846752 [info ] [Thread-1  ]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m08:57:03.847190 [debug] [Thread-1  ]: Acquiring new snowflake connection "source.learn_dbt.airbnb.reviews"
[0m08:57:03.847314 [debug] [Thread-1  ]: Began compiling node source.learn_dbt.airbnb.reviews
[0m08:57:03.847437 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:03.847546 [debug] [Thread-1  ]: Began executing node source.learn_dbt.airbnb.reviews
[0m08:57:03.847865 [debug] [Thread-1  ]: Acquiring new snowflake connection "source.learn_dbt.airbnb.reviews"
[0m08:57:03.853649 [debug] [Thread-1  ]: Using snowflake connection "source.learn_dbt.airbnb.reviews"
[0m08:57:03.853811 [debug] [Thread-1  ]: On source.learn_dbt.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "source.learn_dbt.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from airbnb.raw.raw_reviews
[0m08:57:03.853925 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:04.542285 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m08:57:04.543366 [debug] [Thread-1  ]: On source.learn_dbt.airbnb.reviews: Close
[0m08:57:04.706103 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:04.706513 [error] [Thread-1  ]: 1 of 1 ERROR STALE freshness of airbnb.reviews ................................. [[31mERROR STALE[0m in 0.86s]
[0m08:57:04.706831 [debug] [Thread-1  ]: Finished running node source.learn_dbt.airbnb.reviews
[0m08:57:04.707523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:04.707674 [debug] [MainThread]: Connection 'source.learn_dbt.airbnb.reviews' was properly closed.
[0m08:57:04.711927 [info ] [MainThread]: 
[0m08:57:04.712204 [info ] [MainThread]: Done.
[0m08:57:04.712432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11263c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126cc340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113076430>]}
[0m08:57:04.712589 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 11:50:43.775171 | 2e087af7-9d2a-4cc9-a606-d6fc27b3f7bb ==============================
[0m11:50:43.775204 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:50:43.775779 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m11:50:43.775899 [debug] [MainThread]: Tracking: tracking
[0m11:50:43.776116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2eed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2eed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2eedf0>]}
[0m11:50:43.811846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:43.812015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:43.815842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e087af7-9d2a-4cc9-a606-d6fc27b3f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4bff40>]}
[0m11:50:43.820690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e087af7-9d2a-4cc9-a606-d6fc27b3f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dc640>]}
[0m11:50:43.820906 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m11:50:43.821119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e087af7-9d2a-4cc9-a606-d6fc27b3f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e0fd0>]}
[0m11:50:43.821907 [info ] [MainThread]: 
[0m11:50:43.822285 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:50:43.822768 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:50:43.830321 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:50:43.830485 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:50:43.830580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:44.585775 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.76 seconds
[0m11:50:44.587466 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:50:44.741626 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:50:44.750160 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:50:44.750419 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:50:44.750621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:45.433826 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.68 seconds
[0m11:50:45.437238 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:50:45.837912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e087af7-9d2a-4cc9-a606-d6fc27b3f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dc3d0>]}
[0m11:50:45.839195 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:50:45.839781 [info ] [MainThread]: 
[0m11:50:45.845029 [debug] [Thread-1  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m11:50:45.845892 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m11:50:45.846750 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:45.847008 [debug] [Thread-1  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m11:50:45.847254 [debug] [Thread-1  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m11:50:45.851790 [debug] [Thread-1  ]: finished collecting timing info
[0m11:50:45.852042 [debug] [Thread-1  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m11:50:45.893875 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:45.894117 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:50:45.894232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:50:46.478038 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.58 seconds
[0m11:50:46.510144 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:46.510389 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"  as
        (with snapshot_query as (

        



select * from airbnb.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m11:50:47.630380 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.12 seconds
[0m11:50:47.636390 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:47.636774 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:50:47.774021 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0.14 seconds
[0m11:50:47.782456 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:47.782812 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:50:47.878642 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.1 seconds
[0m11:50:47.885774 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:47.886080 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:50:47.981320 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0.09 seconds
[0m11:50:47.989405 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:47.989646 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m11:50:48.098583 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.11 seconds
[0m11:50:48.110146 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:48.110487 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m11:50:48.241553 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0.13 seconds
[0m11:50:48.255398 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:48.257091 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:48.257307 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
BEGIN
[0m11:50:48.424959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m11:50:48.426466 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:48.426963 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:50:49.883047 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 1.46 seconds
[0m11:50:49.884449 [debug] [Thread-1  ]: Using snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m11:50:49.884878 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "snapshot.learn_dbt.scd_raw_listings"} */
COMMIT
[0m11:50:50.197493 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m11:50:50.224630 [debug] [Thread-1  ]: finished collecting timing info
[0m11:50:50.224978 [debug] [Thread-1  ]: On snapshot.learn_dbt.scd_raw_listings: Close
[0m11:50:50.400133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e087af7-9d2a-4cc9-a606-d6fc27b3f7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dc250>]}
[0m11:50:50.400877 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 2[0m in 4.55s]
[0m11:50:50.401659 [debug] [Thread-1  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m11:50:50.403458 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:50:50.404172 [info ] [MainThread]: 
[0m11:50:50.404632 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m11:50:50.405043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:50.405260 [debug] [MainThread]: Connection 'snapshot.learn_dbt.scd_raw_listings' was properly closed.
[0m11:50:50.415804 [info ] [MainThread]: 
[0m11:50:50.416194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:50.416564 [info ] [MainThread]: 
[0m11:50:50.416900 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:50:50.417305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc8b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc8bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc8b400>]}
[0m11:50:50.417575 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:08:38.247403 | 500ad588-7eb4-442a-9d62-fbce09ebe8de ==============================
[0m12:08:38.247439 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:08:38.248154 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:08:38.248277 [debug] [MainThread]: Tracking: tracking
[0m12:08:38.248534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cafbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cafc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cafca0>]}
[0m12:08:38.278859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:08:38.279147 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/schema.yml
[0m12:08:38.308643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '500ad588-7eb4-442a-9d62-fbce09ebe8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa60d0>]}
[0m12:08:38.313301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '500ad588-7eb4-442a-9d62-fbce09ebe8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0df40>]}
[0m12:08:38.313498 [info ] [MainThread]: Found 8 models, 4 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:08:38.313696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '500ad588-7eb4-442a-9d62-fbce09ebe8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cafcd0>]}
[0m12:08:38.314551 [info ] [MainThread]: 
[0m12:08:38.314946 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:08:38.315726 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:08:38.323550 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:08:38.323748 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:08:38.323852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:39.128326 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.8 seconds
[0m12:08:39.129990 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:08:39.280487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '500ad588-7eb4-442a-9d62-fbce09ebe8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e63400>]}
[0m12:08:39.281435 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:08:39.281857 [info ] [MainThread]: 
[0m12:08:39.285525 [debug] [Thread-1  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:08:39.285733 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:08:39.285952 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_dim_listings_cleansed_listing_id.f453012459
[0m12:08:39.286130 [info ] [Thread-1  ]: 1 of 4 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m12:08:39.286301 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:08:39.286495 [info ] [Thread-2  ]: 2 of 4 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m12:08:39.286686 [info ] [Thread-3  ]: 3 of 4 START test not_dim_listings_cleansed_listing_id ......................... [RUN]
[0m12:08:39.287304 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:08:39.287498 [info ] [Thread-4  ]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:08:39.288069 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:08:39.288616 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_dim_listings_cleansed_listing_id.f453012459"
[0m12:08:39.288798 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:08:39.289488 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:08:39.289673 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:08:39.289844 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_dim_listings_cleansed_listing_id.f453012459
[0m12:08:39.290038 [debug] [Thread-1  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:08:39.290202 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:08:39.290361 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:08:39.290518 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_dim_listings_cleansed_listing_id.f453012459
[0m12:08:39.294877 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:08:39.307211 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:08:39.308062 [debug] [Thread-1  ]: finished collecting timing info
[0m12:08:39.308350 [debug] [Thread-2  ]: finished collecting timing info
[0m12:08:39.308609 [debug] [Thread-3  ]: finished collecting timing info
[0m12:08:39.310393 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:08:39.310811 [debug] [Thread-2  ]: Compilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:08:39.311265 [debug] [Thread-3  ]: Compilation Error in test not_dim_listings_cleansed_listing_id (models/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:08:39.311492 [error] [Thread-1  ]: 1 of 4 ERROR dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[31mERROR[0m in 0.02s]
[0m12:08:39.311647 [debug] [Thread-4  ]: finished collecting timing info
[0m12:08:39.311822 [error] [Thread-2  ]: 2 of 4 ERROR dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mERROR[0m in 0.02s]
[0m12:08:39.311987 [error] [Thread-3  ]: 3 of 4 ERROR not_dim_listings_cleansed_listing_id .............................. [[31mERROR[0m in 0.02s]
[0m12:08:39.312376 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:08:39.312522 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:08:39.312855 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:08:39.313182 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_dim_listings_cleansed_listing_id.f453012459
[0m12:08:39.328662 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:08:39.332672 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:08:39.350207 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:08:39.351205 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:08:40.723233 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.37 seconds
[0m12:08:40.734663 [debug] [Thread-4  ]: finished collecting timing info
[0m12:08:40.735129 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:08:40.900037 [info ] [Thread-4  ]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.61s]
[0m12:08:40.901067 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:08:40.902834 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:08:40.903737 [info ] [MainThread]: 
[0m12:08:40.904334 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m12:08:40.904842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:40.905109 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65' was properly closed.
[0m12:08:40.905351 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9' was properly closed.
[0m12:08:40.905556 [debug] [MainThread]: Connection 'test.learn_dbt.not_dim_listings_cleansed_listing_id.f453012459' was properly closed.
[0m12:08:40.905760 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:08:40.913520 [info ] [MainThread]: 
[0m12:08:40.913958 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:08:40.914337 [info ] [MainThread]: 
[0m12:08:40.914672 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)[0m
[0m12:08:40.915003 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:08:40.915351 [info ] [MainThread]: 
[0m12:08:40.915675 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)[0m
[0m12:08:40.915997 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:08:40.916314 [info ] [MainThread]: 
[0m12:08:40.923392 [error] [MainThread]: [33mCompilation Error in test not_dim_listings_cleansed_listing_id (models/schema.yml)[0m
[0m12:08:40.923807 [error] [MainThread]:   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:08:40.924168 [info ] [MainThread]: 
[0m12:08:40.924510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m12:08:40.924949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110334d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11036ad90>]}
[0m12:08:40.925462 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:10:02.136524 | 036af690-5645-4852-8ac0-ee63985833cb ==============================
[0m12:10:02.136532 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:10:02.136815 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m12:10:02.136917 [debug] [MainThread]: Tracking: tracking
[0m12:10:02.147969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072912b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107291460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072914c0>]}
[0m12:10:02.148886 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:10:02.149219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107291460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107291400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072919d0>]}
[0m12:10:02.149350 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:10:10.896856 | d9df660d-8753-40ad-b3bb-49c9c3412ad7 ==============================
[0m12:10:10.896881 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:10:10.897365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:10:10.897507 [debug] [MainThread]: Tracking: tracking
[0m12:10:10.897745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3cd0>]}
[0m12:10:10.928269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:10.928622 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m12:10:10.937123 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:10:10.964196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9df660d-8753-40ad-b3bb-49c9c3412ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074630d0>]}
[0m12:10:10.969267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9df660d-8753-40ad-b3bb-49c9c3412ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073eb220>]}
[0m12:10:10.969574 [info ] [MainThread]: Found 8 models, 4 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:10:10.969778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9df660d-8753-40ad-b3bb-49c9c3412ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073eb2e0>]}
[0m12:10:10.970751 [info ] [MainThread]: 
[0m12:10:10.971157 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:10:10.971816 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:10:10.979396 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:10:10.979571 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:10:10.979676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:11.803609 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.82 seconds
[0m12:10:11.805252 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:10:11.962893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9df660d-8753-40ad-b3bb-49c9c3412ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c7040>]}
[0m12:10:11.963784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:11.964194 [info ] [MainThread]: 
[0m12:10:11.968620 [debug] [Thread-1  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:10:11.968786 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:10:11.968950 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:10:11.969049 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:10:11.969142 [info ] [Thread-1  ]: 1 of 4 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m12:10:11.969265 [info ] [Thread-2  ]: 2 of 4 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m12:10:11.969369 [info ] [Thread-3  ]: 3 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:10:11.969470 [info ] [Thread-4  ]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:10:11.969854 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:10:11.970200 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:10:11.970745 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:10:11.971448 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:10:11.971634 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:10:11.971804 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:10:11.971971 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:10:11.972162 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:10:11.972373 [debug] [Thread-1  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:10:11.972554 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:10:11.972720 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:10:11.972879 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:10:11.990555 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:10:11.995222 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:10:11.995784 [debug] [Thread-1  ]: finished collecting timing info
[0m12:10:11.996050 [debug] [Thread-2  ]: finished collecting timing info
[0m12:10:11.996463 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:10:11.996863 [debug] [Thread-2  ]: Compilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:10:11.997034 [debug] [Thread-3  ]: finished collecting timing info
[0m12:10:11.997189 [error] [Thread-1  ]: 1 of 4 ERROR dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[31mERROR[0m in 0.03s]
[0m12:10:11.997315 [debug] [Thread-4  ]: finished collecting timing info
[0m12:10:11.997471 [error] [Thread-2  ]: 2 of 4 ERROR dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mERROR[0m in 0.03s]
[0m12:10:11.997610 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:10:11.997899 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:10:11.998030 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:10:11.998308 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:10:12.011045 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:10:12.013204 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:10:12.014065 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:10:12.014392 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:10:12.014521 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:10:12.014634 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:10:12.014745 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:10:12.014852 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:10:12.696586 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m12:10:12.703402 [debug] [Thread-4  ]: finished collecting timing info
[0m12:10:12.703759 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:10:12.712967 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m12:10:12.714617 [debug] [Thread-3  ]: finished collecting timing info
[0m12:10:12.714886 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:10:12.854332 [info ] [Thread-4  ]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.88s]
[0m12:10:12.855010 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:10:12.877677 [info ] [Thread-3  ]: 3 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.91s]
[0m12:10:12.878161 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:10:12.879161 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:10:12.879631 [info ] [MainThread]: 
[0m12:10:12.879932 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m12:10:12.880201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:12.880342 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65' was properly closed.
[0m12:10:12.880480 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9' was properly closed.
[0m12:10:12.880613 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m12:10:12.880746 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:10:12.886685 [info ] [MainThread]: 
[0m12:10:12.887007 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:10:12.887280 [info ] [MainThread]: 
[0m12:10:12.887510 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)[0m
[0m12:10:12.887744 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:10:12.887968 [info ] [MainThread]: 
[0m12:10:12.888194 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)[0m
[0m12:10:12.888417 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:10:12.888658 [info ] [MainThread]: 
[0m12:10:12.920978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m12:10:12.921428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8e4c0>]}
[0m12:10:12.921674 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:10:58.427828 | 1b230432-ae5f-4697-87e8-c6d72a3640d6 ==============================
[0m12:10:58.427855 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:10:58.428265 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:10:58.428377 [debug] [MainThread]: Tracking: tracking
[0m12:10:58.428609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014cd00>]}
[0m12:10:58.435113 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m12:10:58.435323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101589d0>]}
[0m12:10:58.449299 [debug] [MainThread]: Parsing macros/catalog.sql
[0m12:10:58.450617 [debug] [MainThread]: Parsing macros/adapters.sql
[0m12:10:58.471358 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m12:10:58.471887 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m12:10:58.472335 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m12:10:58.474265 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m12:10:58.476804 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m12:10:58.477442 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m12:10:58.480172 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m12:10:58.485192 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m12:10:58.485756 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m12:10:58.486939 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m12:10:58.487276 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m12:10:58.487622 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m12:10:58.487889 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m12:10:58.488121 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m12:10:58.488392 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m12:10:58.490137 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m12:10:58.491259 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m12:10:58.492026 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m12:10:58.500524 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m12:10:58.507366 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m12:10:58.513583 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m12:10:58.515817 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m12:10:58.516683 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m12:10:58.517620 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m12:10:58.521529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m12:10:58.529415 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m12:10:58.530229 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m12:10:58.533306 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m12:10:58.538410 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m12:10:58.546749 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m12:10:58.549317 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m12:10:58.550905 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m12:10:58.553462 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m12:10:58.554063 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m12:10:58.555598 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m12:10:58.556630 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m12:10:58.560122 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m12:10:58.569277 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m12:10:58.570029 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m12:10:58.571174 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m12:10:58.571904 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m12:10:58.572336 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m12:10:58.572725 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m12:10:58.573058 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m12:10:58.573715 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m12:10:58.576199 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m12:10:58.580228 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m12:10:58.580661 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m12:10:58.581249 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m12:10:58.581717 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m12:10:58.582185 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m12:10:58.582781 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m12:10:58.583181 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m12:10:58.583682 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m12:10:58.584266 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m12:10:58.585355 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m12:10:58.585938 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m12:10:58.586466 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m12:10:58.586964 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m12:10:58.587449 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m12:10:58.587881 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m12:10:58.588396 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m12:10:58.588833 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m12:10:58.591899 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m12:10:58.592398 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m12:10:58.592835 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m12:10:58.593664 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m12:10:58.594690 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m12:10:58.595178 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m12:10:58.595884 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m12:10:58.596392 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m12:10:58.597356 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m12:10:58.598863 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m12:10:58.600150 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m12:10:58.607137 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m12:10:58.608062 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m12:10:58.614429 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m12:10:58.616464 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m12:10:58.619774 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m12:10:58.624293 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m12:10:58.627143 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m12:10:58.757197 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:10:58.763507 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:10:58.765226 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:10:58.766781 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m12:10:58.771146 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m12:10:58.773734 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m12:10:58.775319 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m12:10:58.776805 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:10:58.778376 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:10:58.843612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11034b0d0>]}
[0m12:10:58.847694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102c0a60>]}
[0m12:10:58.847865 [info ] [MainThread]: Found 8 models, 4 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:10:58.848060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f1f70>]}
[0m12:10:58.848925 [info ] [MainThread]: 
[0m12:10:58.849294 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:10:58.849856 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m12:10:58.857297 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m12:10:58.857452 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m12:10:58.857551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:59.527631 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.67 seconds
[0m12:10:59.528939 [debug] [ThreadPool]: On list_airbnb: Close
[0m12:10:59.696849 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:10:59.701076 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:10:59.701239 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:10:59.701365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:00.520649 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.82 seconds
[0m12:11:00.523772 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:11:00.674503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042db9d0>]}
[0m12:11:00.675514 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:00.675824 [info ] [MainThread]: 
[0m12:11:00.679168 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m12:11:00.679674 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_listings
[0m12:11:00.680303 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m12:11:00.680534 [debug] [Thread-4  ]: Began running node model.learn_dbt.src_reviews
[0m12:11:00.681162 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m12:11:00.681419 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m12:11:00.681993 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m12:11:00.682231 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_listings
[0m12:11:00.682475 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m12:11:00.682707 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.src_reviews
[0m12:11:00.682928 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_listings
[0m12:11:00.686628 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m12:11:00.686913 [debug] [Thread-4  ]: Compiling model.learn_dbt.src_reviews
[0m12:11:00.689910 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m12:11:00.692655 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m12:11:00.693573 [debug] [Thread-3  ]: finished collecting timing info
[0m12:11:00.693773 [debug] [Thread-4  ]: finished collecting timing info
[0m12:11:00.693973 [debug] [Thread-1  ]: finished collecting timing info
[0m12:11:00.694679 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_listings
[0m12:11:00.695232 [debug] [Thread-4  ]: Finished running node model.learn_dbt.src_reviews
[0m12:11:00.695863 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m12:11:00.696284 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m12:11:00.696663 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m12:11:00.696999 [info ] [Thread-2  ]: 1 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m12:11:00.697220 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m12:11:00.697469 [info ] [Thread-1  ]: 2 of 5 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m12:11:00.698133 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m12:11:00.698409 [info ] [Thread-4  ]: 3 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m12:11:00.699036 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:00.699204 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m12:11:00.699726 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m12:11:00.699873 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m12:11:00.700031 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m12:11:00.700217 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m12:11:00.700399 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m12:11:00.709928 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m12:11:00.710044 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m12:11:00.716075 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m12:11:00.720244 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m12:11:00.720743 [debug] [Thread-2  ]: finished collecting timing info
[0m12:11:00.720959 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m12:11:00.721107 [debug] [Thread-4  ]: finished collecting timing info
[0m12:11:00.721255 [debug] [Thread-1  ]: finished collecting timing info
[0m12:11:00.738585 [debug] [Thread-2  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_cleansed"
[0m12:11:00.738826 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m12:11:00.738948 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m12:11:00.741017 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.dim_hosts_cleansed"
[0m12:11:00.758850 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:00.759053 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace  view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null

  and review_date > (select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m12:11:00.759156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:11:00.760616 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m12:11:00.760807 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    
with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
 id as host_id
 ,name as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from raw_hosts
),src_host as (
  select * from __dbt__cte__src_hosts
)
select 
 host_id
 ,nvl(host_name,'Anonymous') as host_name
 ,is_superhost
 ,created_at
 ,updated_at
from src_hosts
  );
[0m12:11:00.760915 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:11:00.762258 [debug] [Thread-2  ]: Using snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m12:11:00.762400 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from airbnb.raw.raw_listings
)
select 
 id as listing_id
 ,name as listing_name
 ,listing_url
 ,room_type
 ,minimum_nights
 ,host_id
 ,price as price_str
 ,created_at
 ,updated_at
from raw_listings
),scr_listings as (
  select * from __dbt__cte__src_listings
)
select 
  listing_id
  ,listing_name
  ,room_type
  ,case when minimum_nights = 0 then 1
        else minimum_nights
   end as minimum_nights
  ,host_id
  ,replace(price_str, '$') :: number(10,2) as price
  ,created_at
  ,updated_at
from src_listings
  );
[0m12:11:00.762508 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:11:01.432746 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.67 seconds
[0m12:11:01.447721 [debug] [Thread-2  ]: finished collecting timing info
[0m12:11:01.447997 [debug] [Thread-2  ]: On model.learn_dbt.dim_listings_cleansed: Close
[0m12:11:01.523288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.76 seconds
[0m12:11:01.529470 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:01.529640 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m12:11:01.615363 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107adf40>]}
[0m12:11:01.615750 [info ] [Thread-2  ]: 1 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.92s]
[0m12:11:01.616122 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m12:11:01.644210 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m12:11:01.647925 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:01.648177 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m12:11:01.841563 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m12:11:01.853165 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:01.853361 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m12:11:02.121007 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.36 seconds
[0m12:11:02.121928 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.27 seconds
[0m12:11:02.126264 [debug] [Thread-4  ]: finished collecting timing info
[0m12:11:02.130839 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:02.131165 [debug] [Thread-4  ]: On model.learn_dbt.dim_hosts_cleansed: Close
[0m12:11:02.131414 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m12:11:02.433292 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.3 seconds
[0m12:11:02.440924 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103bc250>]}
[0m12:11:02.442128 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:11:02.442494 [info ] [Thread-4  ]: 3 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.74s]
[0m12:11:02.453439 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m12:11:02.453823 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m12:11:02.454176 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m12:11:02.454379 [info ] [Thread-3  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m12:11:02.454850 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m12:11:02.454983 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m12:11:02.455128 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m12:11:02.457089 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m12:11:02.457409 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:02.457576 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
BEGIN
[0m12:11:02.458272 [debug] [Thread-3  ]: finished collecting timing info
[0m12:11:02.458442 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m12:11:02.472273 [debug] [Thread-3  ]: Writing runtime sql for node "model.learn_dbt.dim_listings_w_hosts"
[0m12:11:02.473254 [debug] [Thread-3  ]: Using snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m12:11:02.473373 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (with l as (
  select * from airbnb.dev.dim_listings_cleansed
),
h as (
  select * from airbnb.dev.dim_hosts_cleansed
)

select 
  l.listing_id,
  l.listing_name,
  l.room_type,
  l.minimum_nights,
  l.price,
  l.host_id,
  h.host_name,
  h.is_superhost as host_is_superhost,
  l.created_at,
  greatest(l.updated_at, h.updated_at) as updated_at
from l
left join h
on h.host_id = l.host_id
        );
[0m12:11:02.473476 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:11:02.618946 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m12:11:02.619280 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:02.619428 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m12:11:02.905973 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.29 seconds
[0m12:11:02.906554 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:02.906800 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
COMMIT
[0m12:11:03.064061 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m12:11:03.072461 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m12:11:03.072694 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m12:11:03.185325 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m12:11:03.191314 [debug] [Thread-1  ]: finished collecting timing info
[0m12:11:03.191536 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: Close
[0m12:11:03.365769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110847e20>]}
[0m12:11:03.366503 [info ] [Thread-1  ]: 2 of 5 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 2.67s]
[0m12:11:03.367094 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m12:11:03.367550 [debug] [Thread-4  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m12:11:03.367887 [info ] [Thread-4  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m12:11:03.368637 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m12:11:03.368867 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m12:11:03.369078 [debug] [Thread-4  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m12:11:03.372806 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m12:11:03.373596 [debug] [Thread-4  ]: finished collecting timing info
[0m12:11:03.373786 [debug] [Thread-4  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m12:11:03.376613 [debug] [Thread-4  ]: Writing runtime sql for node "model.learn_dbt.mart_fullmoon_reviews"
[0m12:11:03.377720 [debug] [Thread-4  ]: Using snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m12:11:03.377883 [debug] [Thread-4  ]: On model.learn_dbt.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

with fact_reviews as (
  select * from airbnb.dev.fact_reviews
),
full_moon_dates as (
  select * from airbnb.dev.seed_full_moon_dates
)

select r.*
       ,case when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
        end as is_full_moon
from fact_reviews as r
left join full_moon_dates fm
on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m12:11:03.378005 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:11:04.193649 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.72 seconds
[0m12:11:04.196638 [debug] [Thread-3  ]: finished collecting timing info
[0m12:11:04.196905 [debug] [Thread-3  ]: On model.learn_dbt.dim_listings_w_hosts: Close
[0m12:11:05.253748 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e6040>]}
[0m12:11:05.254526 [info ] [Thread-3  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.80s]
[0m12:11:05.255301 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m12:11:07.914893 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.54 seconds
[0m12:11:07.920979 [debug] [Thread-4  ]: finished collecting timing info
[0m12:11:07.921494 [debug] [Thread-4  ]: On model.learn_dbt.mart_fullmoon_reviews: Close
[0m12:11:08.074243 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b230432-ae5f-4697-87e8-c6d72a3640d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a57f0>]}
[0m12:11:08.075183 [info ] [Thread-4  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 4.71s]
[0m12:11:08.076024 [debug] [Thread-4  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m12:11:08.078063 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:11:08.078997 [info ] [MainThread]: 
[0m12:11:08.079556 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m12:11:08.079983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:08.080215 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m12:11:08.080428 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m12:11:08.080643 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m12:11:08.080846 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m12:11:08.090887 [info ] [MainThread]: 
[0m12:11:08.091330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:08.091689 [info ] [MainThread]: 
[0m12:11:08.091975 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:11:08.092351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102cd520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102cd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102cd790>]}
[0m12:11:08.092622 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:11:25.803300 | d0df0f5e-1f91-431c-aa7c-64b69957c83d ==============================
[0m12:11:25.803336 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:11:25.803768 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:11:25.803883 [debug] [MainThread]: Tracking: tracking
[0m12:11:25.804112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109323d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109323df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109323e50>]}
[0m12:11:25.832915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:25.833088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:25.836540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0df0f5e-1f91-431c-aa7c-64b69957c83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096120d0>]}
[0m12:11:25.841127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0df0f5e-1f91-431c-aa7c-64b69957c83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109535c10>]}
[0m12:11:25.841391 [info ] [MainThread]: Found 8 models, 4 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:11:25.841615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0df0f5e-1f91-431c-aa7c-64b69957c83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109323fd0>]}
[0m12:11:25.842536 [info ] [MainThread]: 
[0m12:11:25.842935 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:11:25.843581 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:11:25.851443 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:11:25.851647 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:11:25.851763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:26.528126 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.68 seconds
[0m12:11:26.530133 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:11:26.708776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0df0f5e-1f91-431c-aa7c-64b69957c83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109337280>]}
[0m12:11:26.709525 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:26.709797 [info ] [MainThread]: 
[0m12:11:26.712481 [debug] [Thread-1  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:11:26.712683 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:11:26.712813 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:11:26.712938 [info ] [Thread-1  ]: 1 of 4 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m12:11:26.713058 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:11:26.713208 [info ] [Thread-2  ]: 2 of 4 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m12:11:26.713351 [info ] [Thread-3  ]: 3 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:11:26.713821 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:11:26.713961 [info ] [Thread-4  ]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:11:26.714375 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:11:26.714767 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:11:26.714900 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:11:26.715393 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:11:26.715519 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:11:26.715637 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:11:26.715779 [debug] [Thread-1  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:11:26.715911 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:11:26.716027 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:11:26.716140 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:11:26.721787 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:11:26.729734 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:11:26.730095 [debug] [Thread-1  ]: finished collecting timing info
[0m12:11:26.733717 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:11:26.733919 [debug] [Thread-2  ]: finished collecting timing info
[0m12:11:26.734321 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:11:26.734667 [debug] [Thread-2  ]: Compilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:11:26.734823 [error] [Thread-1  ]: 1 of 4 ERROR dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[31mERROR[0m in 0.02s]
[0m12:11:26.734998 [error] [Thread-2  ]: 2 of 4 ERROR dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mERROR[0m in 0.02s]
[0m12:11:26.735277 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:11:26.735377 [debug] [Thread-4  ]: finished collecting timing info
[0m12:11:26.735610 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:11:26.735803 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:11:26.735910 [debug] [Thread-3  ]: finished collecting timing info
[0m12:11:26.746396 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:11:26.746505 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:11:26.748006 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:11:26.748518 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:11:26.748816 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:11:26.748931 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:11:26.749031 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:11:26.749127 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:11:26.749225 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:11:27.575158 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.83 seconds
[0m12:11:27.580388 [debug] [Thread-3  ]: finished collecting timing info
[0m12:11:27.580581 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:11:27.754632 [info ] [Thread-3  ]: 3 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.04s]
[0m12:11:27.755595 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:11:27.885405 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.14 seconds
[0m12:11:27.887864 [debug] [Thread-4  ]: finished collecting timing info
[0m12:11:27.888136 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:11:28.036764 [info ] [Thread-4  ]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.32s]
[0m12:11:28.037789 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:11:28.039712 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:11:28.040612 [info ] [MainThread]: 
[0m12:11:28.041173 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:11:28.041680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:28.041941 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65' was properly closed.
[0m12:11:28.042175 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9' was properly closed.
[0m12:11:28.042379 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m12:11:28.042585 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:11:28.050332 [info ] [MainThread]: 
[0m12:11:28.050559 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:11:28.050758 [info ] [MainThread]: 
[0m12:11:28.050931 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)[0m
[0m12:11:28.051093 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:11:28.051247 [info ] [MainThread]: 
[0m12:11:28.051406 [error] [MainThread]: [33mCompilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)[0m
[0m12:11:28.051556 [error] [MainThread]:   'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:11:28.051711 [info ] [MainThread]: 
[0m12:11:28.085822 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m12:11:28.086434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093370a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5afd0>]}
[0m12:11:28.086804 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:23:44.732201 | 89a2a8b8-21ec-4f18-b0d2-2b9b30ef485d ==============================
[0m12:23:44.732231 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:23:44.732650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:23:44.732791 [debug] [MainThread]: Tracking: tracking
[0m12:23:44.733016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4c70>]}
[0m12:23:44.750909 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:23:44.751204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89a2a8b8-21ec-4f18-b0d2-2b9b30ef485d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051003a0>]}
[0m12:23:44.766443 [debug] [MainThread]: Parsing macros/catalog.sql
[0m12:23:44.767702 [debug] [MainThread]: Parsing macros/adapters.sql
[0m12:23:44.788733 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m12:23:44.789343 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m12:23:44.789805 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m12:23:44.791820 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m12:23:44.794394 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m12:23:44.795038 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m12:23:44.797727 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m12:23:44.802867 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m12:23:44.803438 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m12:23:44.804336 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m12:23:44.804627 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m12:23:44.804956 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m12:23:44.805211 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m12:23:44.805436 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m12:23:44.805708 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m12:23:44.807456 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m12:23:44.808584 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m12:23:44.809414 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m12:23:44.816814 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m12:23:44.823300 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m12:23:44.829607 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m12:23:44.831792 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m12:23:44.832633 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m12:23:44.833472 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m12:23:44.837180 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m12:23:44.844881 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m12:23:44.845648 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m12:23:44.848867 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m12:23:44.853986 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m12:23:44.862683 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m12:23:44.865366 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m12:23:44.867035 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m12:23:44.869695 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m12:23:44.870340 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m12:23:44.871951 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m12:23:44.873025 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m12:23:44.876434 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m12:23:44.885762 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m12:23:44.886494 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m12:23:44.887688 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m12:23:44.888441 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m12:23:44.888892 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m12:23:44.889294 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m12:23:44.889643 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m12:23:44.890314 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m12:23:44.892869 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m12:23:44.897001 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m12:23:44.897446 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m12:23:44.898047 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m12:23:44.898526 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m12:23:44.899006 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m12:23:44.899626 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m12:23:44.900040 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m12:23:44.900557 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m12:23:44.901178 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m12:23:44.902305 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m12:23:44.902914 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m12:23:44.903450 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m12:23:44.903980 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m12:23:44.904489 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m12:23:44.904950 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m12:23:44.905479 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m12:23:44.905933 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m12:23:44.909128 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m12:23:44.909648 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m12:23:44.910113 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m12:23:44.910982 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m12:23:44.912043 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m12:23:44.912556 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m12:23:44.913281 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m12:23:44.913798 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m12:23:44.914812 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m12:23:44.916366 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m12:23:44.917698 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m12:23:44.924802 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m12:23:44.925740 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m12:23:44.932050 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m12:23:44.934106 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m12:23:44.937466 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m12:23:44.942214 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m12:23:44.945104 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m12:23:45.076302 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:23:45.082797 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:23:45.084655 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:23:45.086271 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m12:23:45.090755 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m12:23:45.091561 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m12:23:45.093241 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m12:23:45.094801 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:23:45.096421 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:23:45.162247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89a2a8b8-21ec-4f18-b0d2-2b9b30ef485d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539c0d0>]}
[0m12:23:45.166597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89a2a8b8-21ec-4f18-b0d2-2b9b30ef485d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b4cd0>]}
[0m12:23:45.166779 [info ] [MainThread]: Found 8 models, 4 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:23:45.166973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a2a8b8-21ec-4f18-b0d2-2b9b30ef485d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bccd0>]}
[0m12:23:45.167871 [info ] [MainThread]: 
[0m12:23:45.168250 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:23:45.168826 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:23:45.175768 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:23:45.175897 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:23:45.175995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:45.959948 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.78 seconds
[0m12:23:45.961052 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:23:46.171853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a2a8b8-21ec-4f18-b0d2-2b9b30ef485d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105100760>]}
[0m12:23:46.173240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:46.173842 [info ] [MainThread]: 
[0m12:23:46.178494 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m12:23:46.178777 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m12:23:46.179064 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m12:23:46.179725 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m12:23:46.179951 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m12:23:46.180763 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m12:23:46.181379 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m12:23:46.181633 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m12:23:46.182128 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m12:23:46.182333 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m12:23:46.182528 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m12:23:46.182736 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m12:23:46.182926 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m12:23:46.183112 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m12:23:46.183292 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m12:23:46.186689 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m12:23:46.186924 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m12:23:46.189537 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m12:23:46.191921 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m12:23:46.193513 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m12:23:46.193998 [debug] [Thread-4  ]: finished collecting timing info
[0m12:23:46.194218 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m12:23:46.194437 [debug] [Thread-1  ]: finished collecting timing info
[0m12:23:46.194597 [debug] [Thread-2  ]: finished collecting timing info
[0m12:23:46.194753 [debug] [Thread-4  ]: finished collecting timing info
[0m12:23:46.195375 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m12:23:46.195637 [debug] [Thread-3  ]: finished collecting timing info
[0m12:23:46.196072 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m12:23:46.196514 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m12:23:46.196703 [debug] [Thread-1  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m12:23:46.197128 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m12:23:46.197438 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:23:46.197677 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:23:46.198136 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m12:23:46.198316 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m12:23:46.198730 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m12:23:46.199136 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m12:23:46.199295 [debug] [Thread-1  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m12:23:46.199662 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m12:23:46.199810 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:23:46.199955 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:23:46.200099 [debug] [Thread-1  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m12:23:46.200247 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m12:23:46.200387 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:23:46.200525 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:23:46.203125 [debug] [Thread-1  ]: finished collecting timing info
[0m12:23:46.203305 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m12:23:46.210439 [debug] [Thread-1  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m12:23:46.217053 [debug] [Thread-2  ]: finished collecting timing info
[0m12:23:46.217944 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m12:23:46.218220 [debug] [Thread-4  ]: finished collecting timing info
[0m12:23:46.218415 [debug] [Thread-1  ]: finished collecting timing info
[0m12:23:46.218823 [debug] [Thread-2  ]: Compilation Error in test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4 (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:23:46.219231 [debug] [Thread-4  ]: Compilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:23:46.219655 [debug] [Thread-1  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m12:23:46.219857 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m12:23:46.219974 [debug] [Thread-3  ]: finished collecting timing info
[0m12:23:46.220157 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m12:23:46.220314 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m12:23:46.220573 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m12:23:46.220740 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m12:23:46.221195 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m12:23:46.221506 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m12:23:46.221640 [debug] [Thread-3  ]: finished collecting timing info
[0m12:23:46.221768 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m12:23:46.221890 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m12:23:46.222240 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m12:23:46.222370 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m12:23:46.222495 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m12:23:46.227380 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m12:23:46.232399 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m12:23:46.232793 [debug] [Thread-2  ]: finished collecting timing info
[0m12:23:46.232894 [debug] [Thread-1  ]: finished collecting timing info
[0m12:23:46.233017 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m12:23:46.233132 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m12:23:46.233246 [debug] [Thread-2  ]: finished collecting timing info
[0m12:23:46.233353 [debug] [Thread-1  ]: finished collecting timing info
[0m12:23:46.233689 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m12:23:46.233986 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m12:23:46.234158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:46.234361 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_cleansed' was properly closed.
[0m12:23:46.234481 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m12:23:46.234594 [debug] [MainThread]: Connection 'model.learn_dbt.dim_hosts_cleansed' was properly closed.
[0m12:23:46.234686 [debug] [MainThread]: Connection 'test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9' was properly closed.
[0m12:23:46.234831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051007c0>]}
[0m12:23:46.234985 [debug] [MainThread]: Flushing usage events
[0m12:23:46.762703 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)
    'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".


============================== 2022-10-14 12:25:05.117895 | ec30951f-cd7b-435f-bcc5-b81d7a69e035 ==============================
[0m12:25:05.117930 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:25:05.118343 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:25:05.118474 [debug] [MainThread]: Tracking: tracking
[0m12:25:05.118718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a42dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a42dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a42dd00>]}
[0m12:25:05.148805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:05.149257 [debug] [MainThread]: Partial parsing: deleted source source.learn_dbt.airbnb.listings
[0m12:25:05.149421 [debug] [MainThread]: Partial parsing: deleted source source.learn_dbt.airbnb.hosts
[0m12:25:05.149604 [debug] [MainThread]: Partial parsing: deleted source source.learn_dbt.airbnb.reviews
[0m12:25:05.149702 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/sources.yml
[0m12:25:05.156729 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:25:05.163660 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:25:05.165420 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:25:05.167063 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:25:05.169120 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:25:05.170726 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m12:25:05.172514 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m12:25:05.177337 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m12:25:05.177978 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m12:25:05.216744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec30951f-cd7b-435f-bcc5-b81d7a69e035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c40a0>]}
[0m12:25:05.221079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec30951f-cd7b-435f-bcc5-b81d7a69e035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d5df0>]}
[0m12:25:05.221283 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:25:05.221477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec30951f-cd7b-435f-bcc5-b81d7a69e035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ee4c0>]}
[0m12:25:05.222323 [info ] [MainThread]: 
[0m12:25:05.222699 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:25:05.223318 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:25:05.230806 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:25:05.230971 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:25:05.231071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:05.966184 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.74 seconds
[0m12:25:05.968100 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:25:06.143968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec30951f-cd7b-435f-bcc5-b81d7a69e035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53b520>]}
[0m12:25:06.145198 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:06.145789 [info ] [MainThread]: 
[0m12:25:06.150454 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m12:25:06.150769 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m12:25:06.151432 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m12:25:06.151665 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m12:25:06.151894 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m12:25:06.152533 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m12:25:06.152786 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m12:25:06.153356 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m12:25:06.154035 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m12:25:06.154244 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m12:25:06.154468 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m12:25:06.154676 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m12:25:06.154860 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m12:25:06.155051 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m12:25:06.159459 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m12:25:06.159697 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m12:25:06.159875 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m12:25:06.162125 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m12:25:06.164588 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m12:25:06.166150 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m12:25:06.166506 [debug] [Thread-1  ]: finished collecting timing info
[0m12:25:06.166727 [debug] [Thread-4  ]: finished collecting timing info
[0m12:25:06.167478 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m12:25:06.167636 [debug] [Thread-2  ]: finished collecting timing info
[0m12:25:06.167801 [debug] [Thread-3  ]: finished collecting timing info
[0m12:25:06.167953 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m12:25:06.168149 [debug] [Thread-1  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m12:25:06.168711 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m12:25:06.169148 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m12:25:06.169322 [debug] [Thread-4  ]: finished collecting timing info
[0m12:25:06.169823 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m12:25:06.170008 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m12:25:06.170259 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m12:25:06.170752 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m12:25:06.170912 [debug] [Thread-1  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m12:25:06.171278 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m12:25:06.171675 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m12:25:06.171854 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m12:25:06.172051 [debug] [Thread-1  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m12:25:06.172229 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m12:25:06.172385 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m12:25:06.172766 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m12:25:06.175449 [debug] [Thread-1  ]: finished collecting timing info
[0m12:25:06.175622 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m12:25:06.175762 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m12:25:06.175897 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m12:25:06.176037 [debug] [Thread-1  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m12:25:06.183445 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m12:25:06.188212 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m12:25:06.188416 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m12:25:06.188573 [debug] [Thread-1  ]: finished collecting timing info
[0m12:25:06.194162 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m12:25:06.194643 [debug] [Thread-1  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m12:25:06.194884 [debug] [Thread-3  ]: finished collecting timing info
[0m12:25:06.195049 [debug] [Thread-2  ]: finished collecting timing info
[0m12:25:06.195179 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m12:25:06.195290 [debug] [Thread-4  ]: finished collecting timing info
[0m12:25:06.195406 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m12:25:06.195537 [debug] [Thread-3  ]: finished collecting timing info
[0m12:25:06.195651 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m12:25:06.195768 [debug] [Thread-2  ]: finished collecting timing info
[0m12:25:06.196114 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m12:25:06.196240 [debug] [Thread-4  ]: finished collecting timing info
[0m12:25:06.196555 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m12:25:06.196794 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:06.197102 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m12:25:06.197220 [debug] [Thread-3  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:06.197432 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m12:25:06.197691 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:25:06.197918 [debug] [Thread-4  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m12:25:06.198214 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:25:06.198500 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m12:25:06.198649 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:06.198986 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m12:25:06.199127 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:06.199257 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m12:25:06.199393 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:06.199517 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m12:25:06.199632 [debug] [Thread-3  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:06.199742 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m12:25:06.208057 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:25:06.208268 [debug] [Thread-4  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m12:25:06.212067 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:25:06.213659 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m12:25:06.215387 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m12:25:06.215919 [debug] [Thread-1  ]: finished collecting timing info
[0m12:25:06.216095 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:06.216216 [debug] [Thread-3  ]: finished collecting timing info
[0m12:25:06.216340 [debug] [Thread-1  ]: finished collecting timing info
[0m12:25:06.216472 [debug] [Thread-3  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:06.216593 [debug] [Thread-2  ]: finished collecting timing info
[0m12:25:06.216702 [debug] [Thread-4  ]: finished collecting timing info
[0m12:25:06.217057 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:06.217173 [debug] [Thread-3  ]: finished collecting timing info
[0m12:25:06.217279 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m12:25:06.217385 [debug] [Thread-4  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m12:25:06.217765 [debug] [Thread-3  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:06.217883 [debug] [Thread-2  ]: finished collecting timing info
[0m12:25:06.217988 [debug] [Thread-4  ]: finished collecting timing info
[0m12:25:06.218330 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m12:25:06.218621 [debug] [Thread-4  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m12:25:06.219076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:06.219189 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m12:25:06.219291 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m12:25:06.219383 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:25:06.219477 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m12:25:06.223687 [info ] [MainThread]: Done.
[0m12:25:06.223966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c934730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefe130>]}
[0m12:25:06.224124 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:25:12.287565 | 0747dfdd-e11a-46a1-bcf8-56bb742c72db ==============================
[0m12:25:12.287610 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:25:12.288054 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:25:12.288180 [debug] [MainThread]: Tracking: tracking
[0m12:25:12.288422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130b50>]}
[0m12:25:12.318361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:12.318557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:12.322275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0747dfdd-e11a-46a1-bcf8-56bb742c72db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d1e80>]}
[0m12:25:12.326421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0747dfdd-e11a-46a1-bcf8-56bb742c72db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d32b0>]}
[0m12:25:12.326596 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:25:12.326784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0747dfdd-e11a-46a1-bcf8-56bb742c72db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d34c0>]}
[0m12:25:12.327573 [info ] [MainThread]: 
[0m12:25:12.327975 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:25:12.328723 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:25:12.336045 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:25:12.336214 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:25:12.336322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:13.310607 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.97 seconds
[0m12:25:13.314020 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:25:13.477555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0747dfdd-e11a-46a1-bcf8-56bb742c72db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d32e0>]}
[0m12:25:13.478703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:13.479304 [info ] [MainThread]: 
[0m12:25:13.483422 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:13.483715 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:13.484020 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:25:13.484294 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:25:13.485141 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:25:13.485940 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:25:13.486182 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:13.486414 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:13.486651 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:13.486907 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:13.500727 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:25:13.506227 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:25:13.506753 [debug] [Thread-2  ]: finished collecting timing info
[0m12:25:13.506952 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:13.507114 [debug] [Thread-1  ]: finished collecting timing info
[0m12:25:13.521377 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:25:13.521550 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:13.523853 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:25:13.524604 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:25:13.524988 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:25:13.525116 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:25:13.525250 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:25:13.525374 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:25:13.525498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:25:14.091488 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m12:25:14.099063 [debug] [Thread-2  ]: finished collecting timing info
[0m12:25:14.099424 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:25:14.198971 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
[0m12:25:14.201268 [debug] [Thread-1  ]: finished collecting timing info
[0m12:25:14.201597 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:25:14.246833 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.76s]
[0m12:25:14.247535 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:25:14.361586 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.88s]
[0m12:25:14.362170 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:25:14.363151 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:25:14.363624 [info ] [MainThread]: 
[0m12:25:14.363933 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m12:25:14.364207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:14.364348 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m12:25:14.364486 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:25:14.370387 [info ] [MainThread]: 
[0m12:25:14.370667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:14.370925 [info ] [MainThread]: 
[0m12:25:14.371162 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:25:14.371448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f8df0>]}
[0m12:25:14.371651 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:31:29.832307 | 0296d107-fda9-47c0-b746-8cf116b93415 ==============================
[0m12:31:29.832326 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:31:29.832970 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:31:29.833092 [debug] [MainThread]: Tracking: tracking
[0m12:31:29.833334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d23af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d23b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d23bb0>]}
[0m12:31:29.854321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d32400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e22f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcdb20>]}
[0m12:31:29.854515 [debug] [MainThread]: Flushing usage events
[0m12:31:30.349644 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading learn_dbt: schema.yml - Runtime Error
    Syntax error near line 19
    ------------------------------
    16 |           to: ref('dim_hosts_cleansed')
    17 |           field: host_id
    18 |           
    19 |      - name: room_type
    20 |        tests:
    21 |          - accepted_values:
    22 |            values: ['Entire home/apt',
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: dim_listings_cleansed
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 19, column 6:
             - name: room_type
             ^


============================== 2022-10-14 12:32:25.813003 | dad021eb-0036-4d5f-a342-6a7c1219f668 ==============================
[0m12:32:25.813026 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:32:25.813535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:32:25.813656 [debug] [MainThread]: Tracking: tracking
[0m12:32:25.813872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef7b50>]}
[0m12:32:25.846931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:25.847263 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m12:32:25.854102 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:32:25.873132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111095340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110fd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110fdeb0>]}
[0m12:32:25.873424 [debug] [MainThread]: Flushing usage events
[0m12:32:26.329098 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_hosts_cleansed')"), ('field', 'host_id')] instead (3 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2022-10-14 12:32:45.252793 | f4c7a2d6-994c-436b-bf30-3eef82bdf4f2 ==============================
[0m12:32:45.252817 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:32:45.253274 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:32:45.253387 [debug] [MainThread]: Tracking: tracking
[0m12:32:45.253614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104857bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104857c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104857c70>]}
[0m12:32:45.283866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:45.284218 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m12:32:45.291354 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:32:45.309871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5dbb0>]}
[0m12:32:45.310146 [debug] [MainThread]: Flushing usage events
[0m12:32:45.768312 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_hosts_cleansed')"), ('field', 'host_id')] instead (3 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2022-10-14 12:34:47.452327 | d050b12e-b81e-45c8-b91c-c541a1794ee9 ==============================
[0m12:34:47.452348 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:34:47.452808 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:34:47.452949 [debug] [MainThread]: Tracking: tracking
[0m12:34:47.453177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d5d30>]}
[0m12:34:47.474308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11134ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112cebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112712e0>]}
[0m12:34:47.474532 [debug] [MainThread]: Flushing usage events
[0m12:34:47.980730 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading learn_dbt: schema.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |           - unique
    10 |           - not_null
    11 |           
    12 |      - name: host_id
    13 |        tests:
    14 |          - not_null
    15 |          - relationships:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: dim_listings_cleansed
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 12, column 6:
             - name: host_id
             ^


============================== 2022-10-14 12:35:47.252606 | 2c5380cb-9f73-4d6b-afcb-dc9dbf70c413 ==============================
[0m12:35:47.252625 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:35:47.253057 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:35:47.253173 [debug] [MainThread]: Tracking: tracking
[0m12:35:47.253409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad88e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad88eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad88f10>]}
[0m12:35:47.274201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af18d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae90eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae90f10>]}
[0m12:35:47.274402 [debug] [MainThread]: Flushing usage events
[0m12:35:47.728190 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading learn_dbt: schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | models:
    3  |  - name: dim_listings_cleansed
    4  |  columns:
    5  |  - name: listing_id
    6  |  tests:
    7  |  - unique
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 2:
         - name: dim_listings_cleansed
         ^
    expected <block end>, but found '?'
      in "<unicode string>", line 4, column 2:
         columns:
         ^


============================== 2022-10-14 12:36:56.594392 | 3893a6bf-c564-4c6e-aca9-140cd8b34d97 ==============================
[0m12:36:56.594424 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:36:56.594879 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:36:56.595011 [debug] [MainThread]: Tracking: tracking
[0m12:36:56.595260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106249d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106249d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106249df0>]}
[0m12:36:56.627712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:56.628032 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m12:36:56.641663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3893a6bf-c564-4c6e-aca9-140cd8b34d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643dd60>]}
[0m12:36:56.646298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3893a6bf-c564-4c6e-aca9-140cd8b34d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d8ca0>]}
[0m12:36:56.646523 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:36:56.646724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3893a6bf-c564-4c6e-aca9-140cd8b34d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106241fd0>]}
[0m12:36:56.647569 [info ] [MainThread]: 
[0m12:36:56.647971 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:36:56.648652 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:36:56.655861 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:36:56.656030 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:36:56.656129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:57.681889 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.03 seconds
[0m12:36:57.684668 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:36:57.844669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3893a6bf-c564-4c6e-aca9-140cd8b34d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d8f70>]}
[0m12:36:57.845963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:36:57.846462 [info ] [MainThread]: 
[0m12:36:57.850741 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:36:57.851070 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:36:57.851317 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:36:57.851604 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:36:57.852440 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:36:57.853215 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:36:57.853462 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:36:57.853678 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:36:57.853900 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:36:57.854093 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:36:57.866670 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:36:57.872140 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:36:57.872681 [debug] [Thread-1  ]: finished collecting timing info
[0m12:36:57.872876 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:36:57.873048 [debug] [Thread-2  ]: finished collecting timing info
[0m12:36:57.887217 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:36:57.887453 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:36:57.890311 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:36:57.890936 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:36:57.891107 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:36:57.891270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:57.891722 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:36:57.892289 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:36:57.892806 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:36:58.449483 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m12:36:58.456510 [debug] [Thread-2  ]: finished collecting timing info
[0m12:36:58.456797 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:36:58.602822 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m12:36:58.604553 [debug] [Thread-1  ]: finished collecting timing info
[0m12:36:58.604754 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:36:58.618378 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.77s]
[0m12:36:58.618911 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:36:58.757846 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.91s]
[0m12:36:58.758430 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:36:58.759432 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:36:58.759908 [info ] [MainThread]: 
[0m12:36:58.760217 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m12:36:58.760484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:58.760623 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m12:36:58.760760 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:36:58.766279 [info ] [MainThread]: 
[0m12:36:58.766552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:58.766812 [info ] [MainThread]: 
[0m12:36:58.767041 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:36:58.767328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643dd30>]}
[0m12:36:58.767528 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:37:54.219516 | 667f6026-dae7-489e-9d5f-1eddc3be8789 ==============================
[0m12:37:54.219547 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:37:54.220870 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:37:54.220993 [debug] [MainThread]: Tracking: tracking
[0m12:37:54.221225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20cd60>]}
[0m12:37:54.253275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:54.253640 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m12:37:54.260704 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:37:54.289115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '667f6026-dae7-489e-9d5f-1eddc3be8789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ad0d0>]}
[0m12:37:54.294192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '667f6026-dae7-489e-9d5f-1eddc3be8789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b432fa0>]}
[0m12:37:54.294438 [info ] [MainThread]: Found 8 models, 3 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:37:54.294632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667f6026-dae7-489e-9d5f-1eddc3be8789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b436040>]}
[0m12:37:54.295443 [info ] [MainThread]: 
[0m12:37:54.295846 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:37:54.296491 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:37:54.303597 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:37:54.303760 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:37:54.303867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:54.948954 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.65 seconds
[0m12:37:54.950898 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:37:55.100600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667f6026-dae7-489e-9d5f-1eddc3be8789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3effd0>]}
[0m12:37:55.101362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:55.101620 [info ] [MainThread]: 
[0m12:37:55.104313 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:37:55.104469 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:37:55.104592 [info ] [Thread-1  ]: 1 of 3 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m12:37:55.104727 [debug] [Thread-3  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:37:55.104881 [info ] [Thread-2  ]: 2 of 3 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:37:55.105333 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:37:55.105481 [info ] [Thread-3  ]: 3 of 3 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:37:55.105861 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:37:55.106025 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:37:55.106394 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:37:55.106511 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:37:55.106650 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:37:55.106774 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:37:55.106889 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:37:55.114610 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:37:55.114781 [debug] [Thread-3  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:37:55.117160 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:37:55.120655 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:37:55.120920 [debug] [Thread-1  ]: finished collecting timing info
[0m12:37:55.121049 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:37:55.121160 [debug] [Thread-2  ]: finished collecting timing info
[0m12:37:55.131529 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:37:55.131738 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:37:55.131841 [debug] [Thread-3  ]: finished collecting timing info
[0m12:37:55.133460 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:37:55.133607 [debug] [Thread-3  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:37:55.133977 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:37:55.135405 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:37:55.135515 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m12:37:55.135879 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:37:55.135966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:55.136085 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:37:55.136411 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:37:55.136917 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:37:55.137381 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:37:55.138150 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:37:55.849014 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m12:37:55.854215 [debug] [Thread-2  ]: finished collecting timing info
[0m12:37:55.854417 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:37:56.003429 [info ] [Thread-2  ]: 2 of 3 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.90s]
[0m12:37:56.004076 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:37:56.088084 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m12:37:56.090324 [debug] [Thread-3  ]: finished collecting timing info
[0m12:37:56.090616 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:37:56.240825 [info ] [Thread-3  ]: 3 of 3 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.13s]
[0m12:37:56.241802 [debug] [Thread-3  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:37:56.699816 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.56 seconds
[0m12:37:56.703853 [debug] [Thread-1  ]: finished collecting timing info
[0m12:37:56.704362 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m12:37:56.867160 [info ] [Thread-1  ]: 1 of 3 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.76s]
[0m12:37:56.867946 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:37:56.869391 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:37:56.870037 [info ] [MainThread]: 
[0m12:37:56.870413 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m12:37:56.870725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:56.870886 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m12:37:56.871043 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m12:37:56.871193 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:37:56.878571 [info ] [MainThread]: 
[0m12:37:56.878956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:56.879269 [info ] [MainThread]: 
[0m12:37:56.879531 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:37:56.879869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b657370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c0400>]}
[0m12:37:56.880158 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:38:55.012953 | 0af04421-549e-408e-b1e9-e78350e3d30f ==============================
[0m12:38:55.012993 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:38:55.013442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:38:55.013584 [debug] [MainThread]: Tracking: tracking
[0m12:38:55.013878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3dcd0>]}
[0m12:38:55.045572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:55.045949 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m12:38:55.053223 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:38:55.088884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0af04421-549e-408e-b1e9-e78350e3d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f900d0>]}
[0m12:38:55.093282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0af04421-549e-408e-b1e9-e78350e3d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6cd90>]}
[0m12:38:55.093585 [info ] [MainThread]: Found 8 models, 4 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:38:55.093813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af04421-549e-408e-b1e9-e78350e3d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f73790>]}
[0m12:38:55.094809 [info ] [MainThread]: 
[0m12:38:55.095249 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:38:55.096006 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:38:55.103370 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:38:55.103577 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:38:55.103681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:55.789652 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.69 seconds
[0m12:38:55.791485 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:38:55.948581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af04421-549e-408e-b1e9-e78350e3d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6c3d0>]}
[0m12:38:55.949352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:55.949658 [info ] [MainThread]: 
[0m12:38:55.952382 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:38:55.952581 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:38:55.952725 [info ] [Thread-1  ]: 1 of 4 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m12:38:55.952864 [debug] [Thread-3  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:38:55.953002 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:38:55.953163 [info ] [Thread-2  ]: 2 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:38:55.953650 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:38:55.953805 [info ] [Thread-3  ]: 3 of 4 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m12:38:55.953949 [info ] [Thread-4  ]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:38:55.954398 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:38:55.954565 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:38:55.955004 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:38:55.955506 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:38:55.955633 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:38:55.955772 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:38:55.955893 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:38:55.956011 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:38:55.956127 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:38:55.962308 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:38:55.962471 [debug] [Thread-3  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:38:55.962597 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:38:55.965277 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:38:55.968730 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:38:55.972621 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:38:55.973828 [debug] [Thread-1  ]: finished collecting timing info
[0m12:38:55.973983 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:38:55.974110 [debug] [Thread-3  ]: finished collecting timing info
[0m12:38:55.984913 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:38:55.985050 [debug] [Thread-2  ]: finished collecting timing info
[0m12:38:55.985155 [debug] [Thread-4  ]: finished collecting timing info
[0m12:38:55.985285 [debug] [Thread-3  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:38:55.985456 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:38:55.985585 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:38:55.987131 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:38:55.987502 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:38:55.989762 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:38:55.991206 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:38:55.991371 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m12:38:55.991943 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:38:55.992089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:55.992386 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:38:55.992481 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:38:55.992983 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:38:55.993313 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:38:55.993774 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:38:55.993909 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:38:55.994015 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:38:55.994410 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:38:56.778390 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m12:38:56.784217 [debug] [Thread-4  ]: finished collecting timing info
[0m12:38:56.784433 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:38:56.796349 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.8 seconds
[0m12:38:56.797835 [debug] [Thread-2  ]: finished collecting timing info
[0m12:38:56.798017 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:38:56.817258 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.83 seconds
[0m12:38:56.818664 [debug] [Thread-1  ]: finished collecting timing info
[0m12:38:56.818852 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m12:38:56.933649 [info ] [Thread-4  ]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.98s]
[0m12:38:56.934669 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:38:56.945566 [info ] [Thread-2  ]: 2 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.99s]
[0m12:38:56.946325 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:38:56.963045 [info ] [Thread-1  ]: 1 of 4 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.01s]
[0m12:38:56.963875 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:38:57.071409 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.08 seconds
[0m12:38:57.073371 [debug] [Thread-3  ]: finished collecting timing info
[0m12:38:57.073594 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m12:38:57.243560 [info ] [Thread-3  ]: 3 of 4 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.29s]
[0m12:38:57.244317 [debug] [Thread-3  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:38:57.245946 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:38:57.246635 [info ] [MainThread]: 
[0m12:38:57.247064 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m12:38:57.247470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:57.247687 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m12:38:57.247893 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m12:38:57.248099 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m12:38:57.248301 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:38:57.257604 [info ] [MainThread]: 
[0m12:38:57.257959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:57.258301 [info ] [MainThread]: 
[0m12:38:57.258599 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:38:57.258987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109266490>]}
[0m12:38:57.259254 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:41:16.752308 | ef80a461-9991-49e5-8004-a47b70972b8c ==============================
[0m12:41:16.752334 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:41:16.752859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:41:16.752975 [debug] [MainThread]: Tracking: tracking
[0m12:41:16.753210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8cd00>]}
[0m12:41:16.784263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:16.784629 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m12:41:16.791943 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:41:16.833386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef80a461-9991-49e5-8004-a47b70972b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef80d0>]}
[0m12:41:16.837616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef80a461-9991-49e5-8004-a47b70972b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb3b50>]}
[0m12:41:16.837813 [info ] [MainThread]: Found 8 models, 5 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:41:16.838015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef80a461-9991-49e5-8004-a47b70972b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb3ac0>]}
[0m12:41:16.838892 [info ] [MainThread]: 
[0m12:41:16.839297 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:41:16.840044 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:41:16.847327 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:41:16.847501 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:41:16.847600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:17.754830 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.91 seconds
[0m12:41:17.757311 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:41:17.925620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef80a461-9991-49e5-8004-a47b70972b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb3c70>]}
[0m12:41:17.926971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:17.927491 [info ] [MainThread]: 
[0m12:41:17.931909 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:41:17.932191 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:41:17.932478 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:41:17.932722 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m12:41:17.932968 [debug] [Thread-4  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:41:17.933220 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m12:41:17.933466 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:41:17.934306 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:41:17.934561 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m12:41:17.935252 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:41:17.935894 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:41:17.936102 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:41:17.936889 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:41:17.937104 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:41:17.937297 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:41:17.937517 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:41:17.937706 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:41:17.937888 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:41:17.938068 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:41:17.943735 [debug] [Thread-4  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:41:17.945145 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:41:17.952671 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:41:17.955854 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:41:17.959744 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:41:17.960387 [debug] [Thread-2  ]: finished collecting timing info
[0m12:41:17.960577 [debug] [Thread-1  ]: finished collecting timing info
[0m12:41:17.960723 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:41:17.960925 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:41:17.974468 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:41:17.974620 [debug] [Thread-4  ]: finished collecting timing info
[0m12:41:17.974740 [debug] [Thread-3  ]: finished collecting timing info
[0m12:41:17.977276 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:41:17.977549 [debug] [Thread-4  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:41:17.977711 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:41:17.978184 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:41:17.979870 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:41:17.981493 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:41:17.981638 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m12:41:17.982164 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:41:17.982378 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:41:17.982538 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m12:41:17.983040 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:41:17.983337 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:41:17.983988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:41:17.984602 [debug] [Thread-4  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:17.984772 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:41:17.985683 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:41:17.986004 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:41:18.774351 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m12:41:18.781174 [debug] [Thread-3  ]: finished collecting timing info
[0m12:41:18.782965 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:41:18.882626 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.9 seconds
[0m12:41:18.884931 [debug] [Thread-1  ]: finished collecting timing info
[0m12:41:18.885593 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m12:41:18.887481 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.91 seconds
[0m12:41:18.890009 [debug] [Thread-2  ]: finished collecting timing info
[0m12:41:18.890326 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m12:41:18.914703 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m12:41:18.916849 [debug] [Thread-4  ]: finished collecting timing info
[0m12:41:18.917130 [debug] [Thread-4  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m12:41:18.978659 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.04s]
[0m12:41:18.979855 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:41:18.980450 [debug] [Thread-3  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:41:18.981060 [info ] [Thread-3  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:41:18.982123 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:41:18.982515 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:41:18.982795 [debug] [Thread-3  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:41:18.991468 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:41:18.992246 [debug] [Thread-3  ]: finished collecting timing info
[0m12:41:18.992481 [debug] [Thread-3  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:41:18.995648 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:41:18.996631 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:41:18.996830 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:18.996996 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:41:19.028608 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.09s]
[0m12:41:19.029141 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:41:19.048396 [info ] [Thread-1  ]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.11s]
[0m12:41:19.048894 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:41:19.064764 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.13s]
[0m12:41:19.065221 [debug] [Thread-4  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:41:19.447033 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m12:41:19.451060 [debug] [Thread-3  ]: finished collecting timing info
[0m12:41:19.451519 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:41:19.624910 [info ] [Thread-3  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.64s]
[0m12:41:19.625842 [debug] [Thread-3  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:41:19.627716 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:41:19.628585 [info ] [MainThread]: 
[0m12:41:19.629128 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m12:41:19.629625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:19.629886 [debug] [MainThread]: Connection 'test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m12:41:19.630096 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m12:41:19.630298 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:41:19.630500 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m12:41:19.638932 [info ] [MainThread]: 
[0m12:41:19.639364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:19.639745 [info ] [MainThread]: 
[0m12:41:19.640081 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:41:19.640508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107276d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727c760>]}
[0m12:41:19.640818 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 12:47:18.103560 | 112f2d3d-30d2-4acd-9010-c643c4430845 ==============================
[0m12:47:18.103613 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:47:18.104310 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:47:18.104464 [debug] [MainThread]: Tracking: tracking
[0m12:47:18.104687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a85ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a85d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a85d60>]}
[0m12:47:18.137552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:47:18.137835 [debug] [MainThread]: Partial parsing: added file: learn_dbt://tests/dim_listings_minimum_nights.sql
[0m12:47:18.159825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '112f2d3d-30d2-4acd-9010-c643c4430845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8af40>]}
[0m12:47:18.164280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '112f2d3d-30d2-4acd-9010-c643c4430845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b62f10>]}
[0m12:47:18.164467 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:47:18.164656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '112f2d3d-30d2-4acd-9010-c643c4430845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b62e80>]}
[0m12:47:18.165526 [info ] [MainThread]: 
[0m12:47:18.165895 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:47:18.166533 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:47:18.173924 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:47:18.174093 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:47:18.174202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:18.943945 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.77 seconds
[0m12:47:18.945717 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:47:19.102902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '112f2d3d-30d2-4acd-9010-c643c4430845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b36220>]}
[0m12:47:19.103848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:19.104326 [info ] [MainThread]: 
[0m12:47:19.108161 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:47:19.108424 [debug] [Thread-2  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m12:47:19.108643 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m12:47:19.108837 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:19.109025 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:19.109249 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m12:47:19.109968 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:47:19.110189 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m12:47:19.110399 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m12:47:19.111055 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m12:47:19.111271 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:47:19.112052 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:19.112684 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:19.112884 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m12:47:19.113106 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:47:19.113297 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:19.113485 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:19.113669 [debug] [Thread-2  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m12:47:19.126491 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:19.127217 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:47:19.127433 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:19.129372 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m12:47:19.135854 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:19.139049 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:19.139498 [debug] [Thread-1  ]: finished collecting timing info
[0m12:47:19.139787 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:47:19.139932 [debug] [Thread-2  ]: finished collecting timing info
[0m12:47:19.140059 [debug] [Thread-3  ]: finished collecting timing info
[0m12:47:19.140179 [debug] [Thread-4  ]: finished collecting timing info
[0m12:47:19.152760 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:47:19.153001 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m12:47:19.153155 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:19.153276 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:19.155119 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m12:47:19.156816 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:19.158529 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:19.159014 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m12:47:19.159488 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m12:47:19.159901 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m12:47:19.160112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:19.160416 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m12:47:19.160710 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m12:47:19.160837 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m12:47:19.161387 [debug] [Thread-2  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m12:47:19.161926 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m12:47:19.162082 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:47:19.162198 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:47:19.162305 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:47:19.799084 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m12:47:19.803686 [debug] [Thread-2  ]: finished collecting timing info
[0m12:47:19.803855 [debug] [Thread-2  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m12:47:19.829724 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.67 seconds
[0m12:47:19.831128 [debug] [Thread-4  ]: finished collecting timing info
[0m12:47:19.831292 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m12:47:19.890155 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.73 seconds
[0m12:47:19.891604 [debug] [Thread-3  ]: finished collecting timing info
[0m12:47:19.891993 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m12:47:19.954837 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.84s]
[0m12:47:19.955717 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m12:47:19.956028 [debug] [Thread-2  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:19.956204 [info ] [Thread-2  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m12:47:19.956715 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:19.957029 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:19.957265 [debug] [Thread-2  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:19.963567 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:19.963981 [debug] [Thread-2  ]: finished collecting timing info
[0m12:47:19.964124 [debug] [Thread-2  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:19.966103 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:19.966868 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m12:47:19.967003 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:47:19.967124 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:19.969736 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.86s]
[0m12:47:19.970254 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m12:47:19.970401 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:19.970559 [info ] [Thread-4  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m12:47:19.970962 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:19.971076 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:19.971209 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:19.975143 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:19.975736 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m12:47:19.976937 [debug] [Thread-1  ]: finished collecting timing info
[0m12:47:19.977114 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m12:47:19.977482 [debug] [Thread-4  ]: finished collecting timing info
[0m12:47:19.977939 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:19.979791 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:19.980374 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m12:47:19.980658 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:47:19.980859 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:47:20.037878 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.93s]
[0m12:47:20.038301 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m12:47:20.132428 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.02s]
[0m12:47:20.132926 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m12:47:20.457384 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m12:47:20.459862 [debug] [Thread-2  ]: finished collecting timing info
[0m12:47:20.460126 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m12:47:20.495067 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.51 seconds
[0m12:47:20.497132 [debug] [Thread-4  ]: finished collecting timing info
[0m12:47:20.497404 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m12:47:20.611546 [info ] [Thread-2  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.65s]
[0m12:47:20.612350 [debug] [Thread-2  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m12:47:20.653707 [info ] [Thread-4  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.68s]
[0m12:47:20.654391 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m12:47:20.656325 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:47:20.657176 [info ] [MainThread]: 
[0m12:47:20.657703 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m12:47:20.658207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:20.658480 [debug] [MainThread]: Connection 'test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m12:47:20.658733 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m12:47:20.658984 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m12:47:20.659208 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m12:47:20.668286 [info ] [MainThread]: 
[0m12:47:20.668733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:20.669121 [info ] [MainThread]: 
[0m12:47:20.669471 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:47:20.669929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b62760>]}
[0m12:47:20.670308 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 13:18:43.998208 | f8e1be63-6bcb-459e-ba96-ba4abb12a908 ==============================
[0m13:18:43.998237 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:18:43.999086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:18:43.999208 [debug] [MainThread]: Tracking: tracking
[0m13:18:43.999475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2eca0>]}
[0m13:18:44.034998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:18:44.035260 [debug] [MainThread]: Partial parsing: added file: learn_dbt://tests/consistent_created_at.sql
[0m13:18:44.058993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8e1be63-6bcb-459e-ba96-ba4abb12a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071220d0>]}
[0m13:18:44.063555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8e1be63-6bcb-459e-ba96-ba4abb12a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbcfa0>]}
[0m13:18:44.063747 [info ] [MainThread]: Found 8 models, 7 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:18:44.063954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8e1be63-6bcb-459e-ba96-ba4abb12a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbcf40>]}
[0m13:18:44.065046 [info ] [MainThread]: 
[0m13:18:44.065456 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:18:44.066116 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:18:44.073651 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:18:44.073837 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:18:44.073938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:45.219865 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.15 seconds
[0m13:18:45.223530 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:18:45.398635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8e1be63-6bcb-459e-ba96-ba4abb12a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b1ca0>]}
[0m13:18:45.399760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:45.400192 [info ] [MainThread]: 
[0m13:18:45.404157 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:18:45.404428 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m13:18:45.404648 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:18:45.404841 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m13:18:45.405028 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:18:45.405252 [info ] [Thread-2  ]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m13:18:45.406058 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:18:45.406256 [info ] [Thread-3  ]: 3 of 7 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:18:45.406438 [info ] [Thread-4  ]: 4 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:18:45.407010 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:18:45.407194 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:18:45.407750 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:18:45.408293 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:18:45.408466 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m13:18:45.408663 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:18:45.408833 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m13:18:45.408994 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:18:45.409152 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m13:18:45.422443 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:18:45.422590 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m13:18:45.422742 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:18:45.424756 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m13:18:45.426564 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:18:45.432530 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:18:45.432931 [debug] [Thread-1  ]: finished collecting timing info
[0m13:18:45.433220 [debug] [Thread-2  ]: finished collecting timing info
[0m13:18:45.433474 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:18:45.433591 [debug] [Thread-3  ]: finished collecting timing info
[0m13:18:45.433753 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m13:18:45.433865 [debug] [Thread-4  ]: finished collecting timing info
[0m13:18:45.446047 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:18:45.446264 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m13:18:45.448120 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m13:18:45.448309 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:18:45.450140 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:18:45.451814 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:18:45.452252 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:18:45.452662 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:18:45.452819 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:18:45.453114 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:18:45.453258 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) = f.listing_id
where l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m13:18:45.453417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:45.453750 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:18:45.453870 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m13:18:45.453980 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:18:45.454567 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:18:45.454688 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:18:45.455443 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:18:46.035130 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
[0m13:18:46.040848 [debug] [Thread-1  ]: finished collecting timing info
[0m13:18:46.041562 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.59 seconds
[0m13:18:46.041717 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:18:46.043087 [debug] [Thread-3  ]: finished collecting timing info
[0m13:18:46.044610 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m13:18:46.169544 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79f7e-3201-ec57-0000-00015aae57ed
[0m13:18:46.170164 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 19 unexpected '='.
syntax error line 12 at position 4 unexpected ')'.
[0m13:18:46.170883 [debug] [Thread-2  ]: finished collecting timing info
[0m13:18:46.171508 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m13:18:46.202791 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.80s]
[0m13:18:46.203334 [info ] [Thread-3  ]: 3 of 7 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.80s]
[0m13:18:46.203842 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:18:46.204170 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m13:18:46.204346 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:18:46.204602 [debug] [Thread-3  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:18:46.204914 [info ] [Thread-1  ]: 5 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:18:46.205147 [info ] [Thread-3  ]: 6 of 7 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:18:46.205738 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:18:46.206222 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:18:46.206388 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:18:46.206531 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:18:46.206676 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:18:46.206811 [debug] [Thread-3  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:18:46.210480 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:18:46.216012 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:18:46.216501 [debug] [Thread-1  ]: finished collecting timing info
[0m13:18:46.216672 [debug] [Thread-3  ]: finished collecting timing info
[0m13:18:46.216837 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:18:46.216999 [debug] [Thread-3  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:18:46.218991 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:18:46.221299 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:18:46.221934 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:18:46.222471 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:18:46.222596 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:18:46.222732 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:18:46.222863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:46.223000 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:18:46.320306 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m13:18:46.321709 [debug] [Thread-4  ]: finished collecting timing info
[0m13:18:46.321879 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:18:46.344450 [debug] [Thread-2  ]: Database Error in test consistent_created_at (tests/consistent_created_at.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 19 unexpected '='.
  syntax error line 12 at position 4 unexpected ')'.
  compiled Code at target/run/learn_dbt/tests/consistent_created_at.sql
[0m13:18:46.344692 [error] [Thread-2  ]: 2 of 7 ERROR consistent_created_at ............................................. [[31mERROR[0m in 0.94s]
[0m13:18:46.345017 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m13:18:46.345174 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:18:46.345390 [info ] [Thread-2  ]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:18:46.345872 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:18:46.346008 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:18:46.346131 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:18:46.350651 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:18:46.351031 [debug] [Thread-2  ]: finished collecting timing info
[0m13:18:46.351159 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:18:46.352865 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:18:46.353833 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:18:46.353951 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:18:46.354059 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:18:46.492233 [info ] [Thread-4  ]: 4 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.08s]
[0m13:18:46.492617 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:18:46.727283 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.5 seconds
[0m13:18:46.728926 [debug] [Thread-3  ]: finished collecting timing info
[0m13:18:46.729114 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:18:46.771695 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m13:18:46.773343 [debug] [Thread-1  ]: finished collecting timing info
[0m13:18:46.773545 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:18:46.873961 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m13:18:46.876783 [debug] [Thread-2  ]: finished collecting timing info
[0m13:18:46.877143 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:18:46.889292 [info ] [Thread-3  ]: 6 of 7 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.68s]
[0m13:18:46.890086 [debug] [Thread-3  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:18:46.973152 [info ] [Thread-1  ]: 5 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.77s]
[0m13:18:46.973832 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:18:47.038979 [info ] [Thread-2  ]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.69s]
[0m13:18:47.039592 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:18:47.040832 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:18:47.041390 [info ] [MainThread]: 
[0m13:18:47.041734 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m13:18:47.042042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:47.042208 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:18:47.042368 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:18:47.042521 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:18:47.042672 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m13:18:47.049189 [info ] [MainThread]: 
[0m13:18:47.049536 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:18:47.049819 [info ] [MainThread]: 
[0m13:18:47.050077 [error] [MainThread]: [33mDatabase Error in test consistent_created_at (tests/consistent_created_at.sql)[0m
[0m13:18:47.050331 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m13:18:47.050578 [error] [MainThread]:   syntax error line 9 at position 19 unexpected '='.
[0m13:18:47.050826 [error] [MainThread]:   syntax error line 12 at position 4 unexpected ')'.
[0m13:18:47.051067 [error] [MainThread]:   compiled Code at target/run/learn_dbt/tests/consistent_created_at.sql
[0m13:18:47.051323 [info ] [MainThread]: 
[0m13:18:47.051577 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:18:47.051912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107292880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107554a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7d190>]}
[0m13:18:47.052168 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 13:19:13.202734 | aa774dc8-28c3-415e-beb4-b6bb01fd6b0f ==============================
[0m13:19:13.202757 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:19:13.203225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:19:13.203345 [debug] [MainThread]: Tracking: tracking
[0m13:19:13.203581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079edbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079edc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079edca0>]}
[0m13:19:13.234978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:13.235253 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://tests/consistent_created_at.sql
[0m13:19:13.258549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa774dc8-28c3-415e-beb4-b6bb01fd6b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d210d0>]}
[0m13:19:13.263371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa774dc8-28c3-415e-beb4-b6bb01fd6b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ad4c0>]}
[0m13:19:13.263600 [info ] [MainThread]: Found 8 models, 7 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:19:13.263795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa774dc8-28c3-415e-beb4-b6bb01fd6b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107995640>]}
[0m13:19:13.264716 [info ] [MainThread]: 
[0m13:19:13.265111 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:13.265756 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:19:13.273119 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:19:13.273270 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:19:13.273373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:13.942156 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.67 seconds
[0m13:19:13.944148 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:19:14.098001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa774dc8-28c3-415e-beb4-b6bb01fd6b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9eee0>]}
[0m13:19:14.098578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:14.098857 [info ] [MainThread]: 
[0m13:19:14.101143 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:14.101392 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m13:19:14.101572 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:14.101747 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:14.101871 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:19:14.102025 [info ] [Thread-2  ]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m13:19:14.102162 [info ] [Thread-3  ]: 3 of 7 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:19:14.102289 [info ] [Thread-4  ]: 4 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:19:14.102745 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:14.103160 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:19:14.103637 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:14.104009 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:14.104132 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:14.104248 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m13:19:14.104358 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:14.104465 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:14.104585 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:14.104694 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m13:19:14.104800 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m13:19:14.104902 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:14.113482 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:14.115169 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m13:19:14.117054 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:14.121890 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:14.122403 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:14.122522 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:14.122619 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:14.122732 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:14.122845 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:14.122969 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:14.123077 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m13:19:14.123183 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:14.133428 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:14.134868 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:14.136296 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m13:19:14.137646 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:14.138311 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:19:14.138742 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:14.138998 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:14.139085 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m13:19:14.139341 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:14.139444 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:19:14.139537 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m13:19:14.139638 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:19:14.139733 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:19:14.139824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:14.139917 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:19:14.140446 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:19:14.762976 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.62 seconds
[0m13:19:14.763419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
[0m13:19:14.769269 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:14.769716 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m13:19:14.770956 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:14.771156 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m13:19:14.772302 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:14.772469 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:19:14.773361 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:19:14.773731 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a79f7f-3201-ec57-0000-00015aae57f9
[0m13:19:14.775323 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 22
invalid identifier 'R.REVIEW_DATE'
[0m13:19:14.776003 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:14.776977 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m13:19:14.921417 [info ] [Thread-3  ]: 3 of 7 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.82s]
[0m13:19:14.921921 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:14.922085 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:14.922279 [info ] [Thread-3  ]: 5 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:19:14.922754 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:14.923459 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:14.923673 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:14.927246 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:14.927643 [debug] [Thread-2  ]: Database Error in test consistent_created_at (tests/consistent_created_at.sql)
  000904 (42000): SQL compilation error: error line 10 at position 22
  invalid identifier 'R.REVIEW_DATE'
  compiled Code at target/run/learn_dbt/tests/consistent_created_at.sql
[0m13:19:14.927962 [info ] [Thread-4  ]: 4 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.82s]
[0m13:19:14.928236 [error] [Thread-2  ]: 2 of 7 ERROR consistent_created_at ............................................. [[31mERROR[0m in 0.83s]
[0m13:19:14.928957 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:14.929078 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:14.929363 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m13:19:14.929504 [debug] [Thread-4  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:14.929667 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:14.929985 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.83s]
[0m13:19:14.930148 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:14.930319 [info ] [Thread-4  ]: 6 of 7 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:19:14.932137 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:14.932389 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:14.932506 [info ] [Thread-2  ]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:19:14.932870 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:14.933326 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:14.933467 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:14.933607 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:14.933955 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:14.934054 [debug] [Thread-4  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:14.934162 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:14.934264 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:19:14.939194 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:14.942651 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:14.942874 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:19:14.944031 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:14.944154 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:14.944322 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:14.944433 [debug] [Thread-4  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:14.946091 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:14.948384 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:14.949390 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:14.949520 [debug] [Thread-4  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:19:14.949866 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:14.950024 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:19:14.950150 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:14.951058 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:19:15.494063 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.54 seconds
[0m13:19:15.496666 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:15.496951 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:19:15.549038 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m13:19:15.551459 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:15.551776 [debug] [Thread-4  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:19:15.553940 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m13:19:15.555656 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:15.555888 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:19:15.643462 [info ] [Thread-2  ]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.71s]
[0m13:19:15.643970 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:15.711339 [info ] [Thread-3  ]: 5 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.79s]
[0m13:19:15.711841 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:15.713745 [info ] [Thread-4  ]: 6 of 7 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.78s]
[0m13:19:15.714127 [debug] [Thread-4  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:15.715002 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:15.715379 [info ] [MainThread]: 
[0m13:19:15.715642 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m13:19:15.715863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:15.715976 [debug] [MainThread]: Connection 'test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m13:19:15.716089 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:19:15.716202 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:19:15.716312 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:19:15.721112 [info ] [MainThread]: 
[0m13:19:15.721359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:19:15.721567 [info ] [MainThread]: 
[0m13:19:15.721758 [error] [MainThread]: [33mDatabase Error in test consistent_created_at (tests/consistent_created_at.sql)[0m
[0m13:19:15.721950 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 10 at position 22
[0m13:19:15.722134 [error] [MainThread]:   invalid identifier 'R.REVIEW_DATE'
[0m13:19:15.722318 [error] [MainThread]:   compiled Code at target/run/learn_dbt/tests/consistent_created_at.sql
[0m13:19:15.722510 [info ] [MainThread]: 
[0m13:19:15.722710 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:19:15.722947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a68b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188eebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11891a700>]}
[0m13:19:15.723109 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 13:19:44.893213 | 64cfb320-ea97-4495-99b3-c545edeef77f ==============================
[0m13:19:44.893256 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:19:44.893669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:19:44.893804 [debug] [MainThread]: Tracking: tracking
[0m13:19:44.894058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286ec70>]}
[0m13:19:44.924819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:44.925116 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://tests/consistent_created_at.sql
[0m13:19:44.949220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64cfb320-ea97-4495-99b3-c545edeef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a700d0>]}
[0m13:19:44.954019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64cfb320-ea97-4495-99b3-c545edeef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11282d340>]}
[0m13:19:44.954298 [info ] [MainThread]: Found 8 models, 7 tests, 1 snapshot, 0 analyses, 303 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:19:44.954501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64cfb320-ea97-4495-99b3-c545edeef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128150a0>]}
[0m13:19:44.955478 [info ] [MainThread]: 
[0m13:19:44.955868 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:44.956552 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:19:44.963771 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:19:44.963897 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:19:44.963999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:45.609180 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.65 seconds
[0m13:19:45.611288 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:19:45.756405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64cfb320-ea97-4495-99b3-c545edeef77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f2640>]}
[0m13:19:45.757093 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:45.757316 [info ] [MainThread]: 
[0m13:19:45.760630 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:45.760851 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m13:19:45.761037 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:19:45.761201 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:45.761350 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:45.761502 [info ] [Thread-2  ]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m13:19:45.762046 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:45.762199 [info ] [Thread-3  ]: 3 of 7 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:19:45.762363 [info ] [Thread-4  ]: 4 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:19:45.762808 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:19:45.762958 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:45.763514 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:45.763948 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:45.764085 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m13:19:45.764238 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:45.764371 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:45.764531 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:45.764677 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m13:19:45.774991 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:45.775253 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m13:19:45.775390 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:45.777299 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m13:19:45.779569 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:45.784953 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:45.785278 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:45.785526 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:45.785686 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:45.785821 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:45.785961 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m13:19:45.786081 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:45.786216 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:45.797551 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:45.799202 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m13:19:45.799339 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:45.800877 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:45.802481 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:45.802943 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:19:45.803314 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:19:45.803455 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m13:19:45.803586 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:19:45.803864 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:19:45.803983 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:19:45.804090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:45.804350 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:19:45.804454 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m13:19:45.805833 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:19:45.806390 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:19:45.806525 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:19:46.417684 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m13:19:46.423687 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:46.423906 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m13:19:46.571481 [info ] [Thread-3  ]: 3 of 7 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.81s]
[0m13:19:46.572076 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m13:19:46.572285 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:46.572520 [info ] [Thread-3  ]: 5 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:19:46.573145 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:46.573266 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:46.573379 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:46.577340 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:46.577915 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:46.578091 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:46.580277 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:46.580887 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:19:46.581028 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:19:46.581158 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:19:46.664646 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m13:19:46.666203 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:46.666375 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:19:46.670875 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m13:19:46.671995 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:46.672153 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:19:46.825403 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.06s]
[0m13:19:46.825729 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:19:46.825853 [debug] [Thread-1  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:46.825955 [info ] [Thread-1  ]: 6 of 7 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:19:46.826279 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:46.826379 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:46.826479 [debug] [Thread-1  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:46.831348 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:46.832246 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:46.832858 [info ] [Thread-4  ]: 4 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.07s]
[0m13:19:46.832994 [debug] [Thread-1  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:46.833561 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:19:46.835125 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:46.835341 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:46.835742 [info ] [Thread-4  ]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:19:46.836335 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:19:46.836444 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:19:46.836706 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:46.836843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:46.837027 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:46.837602 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:46.841631 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:46.842321 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:46.842512 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:46.844234 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:46.845346 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:19:46.845506 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:19:46.845606 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:19:47.041534 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.46 seconds
[0m13:19:47.054139 [debug] [Thread-3  ]: finished collecting timing info
[0m13:19:47.059378 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:19:47.256586 [info ] [Thread-3  ]: 5 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.68s]
[0m13:19:47.257135 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:19:47.332287 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m13:19:47.333859 [debug] [Thread-4  ]: finished collecting timing info
[0m13:19:47.334047 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:19:47.356241 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m13:19:47.357673 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:47.357859 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:19:47.490386 [info ] [Thread-4  ]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.65s]
[0m13:19:47.491573 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:19:47.507897 [info ] [Thread-1  ]: 6 of 7 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.68s]
[0m13:19:47.508899 [debug] [Thread-1  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:19:48.193089 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.39 seconds
[0m13:19:48.195662 [debug] [Thread-2  ]: finished collecting timing info
[0m13:19:48.195914 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m13:19:48.352935 [info ] [Thread-2  ]: 2 of 7 PASS consistent_created_at .............................................. [[32mPASS[0m in 2.59s]
[0m13:19:48.353536 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m13:19:48.354564 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:48.354989 [info ] [MainThread]: 
[0m13:19:48.355263 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m13:19:48.355501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:48.355629 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:19:48.355756 [debug] [MainThread]: Connection 'test.learn_dbt.consistent_created_at' was properly closed.
[0m13:19:48.355875 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:19:48.355994 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:19:48.361775 [info ] [MainThread]: 
[0m13:19:48.362063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:48.362307 [info ] [MainThread]: 
[0m13:19:48.362516 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:19:48.362778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d218e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d27fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9bbb0>]}
[0m13:19:48.362961 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 13:52:10.585181 | f62969d7-0681-4e0e-b476-e8ba178d86d9 ==============================
[0m13:52:10.585221 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:52:10.585927 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m13:52:10.586067 [debug] [MainThread]: Tracking: tracking
[0m13:52:10.586291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147ead90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147eadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147eae50>]}
[0m13:52:10.619959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m13:52:10.620218 [debug] [MainThread]: Partial parsing: added file: learn_dbt://tests/no_nulls_in_dim_listings.sql
[0m13:52:10.620349 [debug] [MainThread]: Partial parsing: added file: learn_dbt://macros/no_nulls_in_columns.sql
[0m13:52:10.620496 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://tests/consistent_created_at.sql
[0m13:52:10.620608 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m13:52:10.628924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11497ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149bf280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149bf2e0>]}
[0m13:52:10.629174 [debug] [MainThread]: Flushing usage events
[0m13:52:11.125185 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nulls_in_dim_listings (tests/no_nulls_in_dim_listings.sql)
  unexpected char "'" at 26
    line 1
      {{no_nulls_in_columns(ref('dim_listings_cleansed))}}


============================== 2022-10-14 13:52:37.079022 | 5b6dce5b-d3ee-48f0-9703-ad66edb78203 ==============================
[0m13:52:37.079062 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:52:37.084018 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m13:52:37.085095 [debug] [MainThread]: Tracking: tracking
[0m13:52:37.085447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79e20>]}
[0m13:52:37.117980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m13:52:37.118285 [debug] [MainThread]: Partial parsing: added file: learn_dbt://macros/no_nulls_in_columns.sql
[0m13:52:37.118446 [debug] [MainThread]: Partial parsing: added file: learn_dbt://tests/no_nulls_in_dim_listings.sql
[0m13:52:37.118604 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://tests/consistent_created_at.sql
[0m13:52:37.118740 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m13:52:37.146196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b6dce5b-d3ee-48f0-9703-ad66edb78203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591d0d0>]}
[0m13:52:37.151537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b6dce5b-d3ee-48f0-9703-ad66edb78203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105892b20>]}
[0m13:52:37.151758 [info ] [MainThread]: Found 8 models, 8 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:52:37.151952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b6dce5b-d3ee-48f0-9703-ad66edb78203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4b100>]}
[0m13:52:37.152887 [info ] [MainThread]: 
[0m13:52:37.153323 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:52:37.154073 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:52:37.161417 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:52:37.161600 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:52:37.161708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:37.978838 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.82 seconds
[0m13:52:37.980912 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:52:38.153825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b6dce5b-d3ee-48f0-9703-ad66edb78203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105892d60>]}
[0m13:52:38.154978 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:38.155549 [info ] [MainThread]: 
[0m13:52:38.160253 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:38.160554 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m13:52:38.160800 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:52:38.161041 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m13:52:38.161270 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m13:52:38.161538 [info ] [Thread-2  ]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m13:52:38.162366 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:52:38.162628 [info ] [Thread-3  ]: 3 of 8 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:52:38.162878 [info ] [Thread-4  ]: 4 of 8 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m13:52:38.163628 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:52:38.163873 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:38.164774 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:52:38.165498 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m13:52:38.165732 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m13:52:38.165969 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:38.166160 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m13:52:38.166345 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m13:52:38.166528 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m13:52:38.180780 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:52:38.180966 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m13:52:38.181199 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m13:52:38.183677 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m13:52:38.185864 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:52:38.193600 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m13:52:38.193827 [debug] [Thread-1  ]: finished collecting timing info
[0m13:52:38.194101 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m13:52:38.194328 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:38.194501 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:52:38.194633 [debug] [Thread-2  ]: finished collecting timing info
[0m13:52:38.194759 [debug] [Thread-3  ]: finished collecting timing info
[0m13:52:38.208314 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:52:38.209537 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m13:52:38.209705 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m13:52:38.211545 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m13:52:38.213135 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m13:52:38.213899 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:52:38.214516 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m13:52:38.214660 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:52:38.214794 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m13:52:38.215095 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m13:52:38.215248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:38.215403 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:52:38.215527 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m13:52:38.217327 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:52:38.721598 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.51 seconds
[0m13:52:38.726170 [debug] [Thread-2  ]: finished collecting timing info
[0m13:52:38.726365 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m13:52:38.800847 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.61 seconds
[0m13:52:38.802450 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m13:52:38.802982 [debug] [Thread-4  ]: finished collecting timing info
[0m13:52:38.803149 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m13:52:38.805340 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m13:52:38.806139 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m13:52:38.806270 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m13:52:38.865299 [info ] [Thread-2  ]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.70s]
[0m13:52:38.865818 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m13:52:38.866002 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:38.866210 [info ] [Thread-2  ]: 5 of 8 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:52:38.866754 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:52:38.866916 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:38.867061 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:38.872466 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:52:38.873944 [debug] [Thread-2  ]: finished collecting timing info
[0m13:52:38.874092 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:38.875675 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:52:38.876224 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:52:38.876354 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:52:38.876473 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:52:38.896817 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m13:52:38.898050 [debug] [Thread-3  ]: finished collecting timing info
[0m13:52:38.898214 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m13:52:39.028964 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m13:52:39.030648 [debug] [Thread-1  ]: finished collecting timing info
[0m13:52:39.030881 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:52:39.077551 [info ] [Thread-3  ]: 3 of 8 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.91s]
[0m13:52:39.084178 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m13:52:39.096567 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:39.102651 [info ] [Thread-3  ]: 6 of 8 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:52:39.103621 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:52:39.109945 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:39.118585 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:39.121281 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:52:39.121890 [debug] [Thread-3  ]: finished collecting timing info
[0m13:52:39.122165 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:39.123642 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:52:39.124261 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:52:39.124492 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:52:39.124652 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:52:39.203387 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.04s]
[0m13:52:39.203828 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:52:39.203980 [debug] [Thread-1  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:39.204148 [info ] [Thread-1  ]: 7 of 8 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:52:39.204601 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:52:39.204745 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:39.204863 [debug] [Thread-1  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:39.210046 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:52:39.211379 [debug] [Thread-1  ]: finished collecting timing info
[0m13:52:39.211504 [debug] [Thread-1  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:39.212961 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:52:39.213665 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:52:39.213793 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:52:39.213901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:39.349911 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m13:52:39.351064 [debug] [Thread-2  ]: finished collecting timing info
[0m13:52:39.351210 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:52:39.526337 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.72 seconds
[0m13:52:39.527572 [debug] [Thread-4  ]: finished collecting timing info
[0m13:52:39.527752 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m13:52:39.550647 [info ] [Thread-2  ]: 5 of 8 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.68s]
[0m13:52:39.551027 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:52:39.551187 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:39.551371 [info ] [Thread-2  ]: 8 of 8 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:52:39.551842 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:52:39.551979 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:39.552111 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:39.556520 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:52:39.556920 [debug] [Thread-2  ]: finished collecting timing info
[0m13:52:39.557057 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:39.559395 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:52:39.560013 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:52:39.560143 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:52:39.560264 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:52:39.578863 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m13:52:39.580250 [debug] [Thread-3  ]: finished collecting timing info
[0m13:52:39.580430 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:52:39.668610 [info ] [Thread-4  ]: 4 of 8 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.50s]
[0m13:52:39.669068 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m13:52:39.677080 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.46 seconds
[0m13:52:39.678276 [debug] [Thread-1  ]: finished collecting timing info
[0m13:52:39.678452 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:52:39.759281 [info ] [Thread-3  ]: 6 of 8 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.66s]
[0m13:52:39.783591 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:52:39.858201 [info ] [Thread-1  ]: 7 of 8 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.65s]
[0m13:52:39.858640 [debug] [Thread-1  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:52:39.999107 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.44 seconds
[0m13:52:40.000657 [debug] [Thread-2  ]: finished collecting timing info
[0m13:52:40.000872 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:52:40.149120 [info ] [Thread-2  ]: 8 of 8 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.60s]
[0m13:52:40.150117 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:52:40.152036 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:52:40.152939 [info ] [MainThread]: 
[0m13:52:40.153484 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m13:52:40.153913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:40.154132 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m13:52:40.154341 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:52:40.154545 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m13:52:40.154754 [debug] [MainThread]: Connection 'test.learn_dbt.no_nulls_in_dim_listings' was properly closed.
[0m13:52:40.164041 [info ] [MainThread]: 
[0m13:52:40.164452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:40.164844 [info ] [MainThread]: 
[0m13:52:40.165178 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:52:40.165572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105892eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b42cd0>]}
[0m13:52:40.165835 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 14:16:32.532490 | 8cd4860e-bb26-4866-8315-2ce54f59c797 ==============================
[0m14:16:32.532537 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:16:32.533268 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m14:16:32.533385 [debug] [MainThread]: Tracking: tracking
[0m14:16:32.533630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244bec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244bec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244becd0>]}
[0m14:16:32.576348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:16:32.576663 [debug] [MainThread]: Partial parsing: added file: learn_dbt://macros/positive_value.sql
[0m14:16:32.576911 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m14:16:32.577040 [debug] [MainThread]: Parsing macros/positive_value.sql
[0m14:16:32.586902 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m14:16:32.629043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cd4860e-bb26-4866-8315-2ce54f59c797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12480c970>]}
[0m14:16:32.633566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cd4860e-bb26-4866-8315-2ce54f59c797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124465c40>]}
[0m14:16:32.633739 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 305 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m14:16:32.633927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd4860e-bb26-4866-8315-2ce54f59c797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12447eee0>]}
[0m14:16:32.634883 [info ] [MainThread]: 
[0m14:16:32.635258 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:16:32.635947 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m14:16:32.642680 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m14:16:32.642817 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m14:16:32.642933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:33.401742 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.76 seconds
[0m14:16:33.403065 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m14:16:33.550613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd4860e-bb26-4866-8315-2ce54f59c797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245ebd90>]}
[0m14:16:33.551358 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:33.551681 [info ] [MainThread]: 
[0m14:16:33.556408 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:16:33.556572 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m14:16:33.556730 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m14:16:33.556884 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m14:16:33.557027 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m14:16:33.557202 [info ] [Thread-2  ]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m14:16:33.557352 [info ] [Thread-3  ]: 3 of 9 START test dim_listings_minimum_nights .................................. [RUN]
[0m14:16:33.557497 [info ] [Thread-4  ]: 4 of 9 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m14:16:33.558024 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:16:33.558528 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m14:16:33.559086 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m14:16:33.559551 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m14:16:33.559711 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:16:33.559857 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m14:16:33.559994 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m14:16:33.560128 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m14:16:33.560287 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:16:33.560421 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m14:16:33.560553 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m14:16:33.560687 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m14:16:33.565410 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:16:33.567200 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m14:16:33.568739 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m14:16:33.576005 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m14:16:33.576420 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m14:16:33.576560 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:16:33.577545 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:33.577664 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:33.577766 [debug] [Thread-3  ]: finished collecting timing info
[0m14:16:33.577920 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:16:33.578051 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m14:16:33.578171 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m14:16:33.591632 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:16:33.593476 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m14:16:33.594871 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m14:16:33.595742 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m14:16:33.596187 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m14:16:33.596306 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m14:16:33.596610 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m14:16:33.596703 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m14:16:33.596815 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:16:33.596934 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m14:16:33.597033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:16:33.597524 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:16:34.290336 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m14:16:34.290701 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m14:16:34.295284 [debug] [Thread-3  ]: finished collecting timing info
[0m14:16:34.296365 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:34.296551 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m14:16:34.296695 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m14:16:34.321376 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.74 seconds
[0m14:16:34.321708 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.72 seconds
[0m14:16:34.323064 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m14:16:34.324079 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:34.324327 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m14:16:34.325198 [debug] [Thread-4  ]: finished collecting timing info
[0m14:16:34.325397 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m14:16:34.327209 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m14:16:34.328254 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m14:16:34.328449 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m14:16:34.478589 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m14:16:34.480492 [debug] [Thread-4  ]: finished collecting timing info
[0m14:16:34.480762 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m14:16:34.501586 [info ] [Thread-2  ]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.94s]
[0m14:16:34.502217 [info ] [Thread-3  ]: 3 of 9 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.94s]
[0m14:16:34.502806 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.95s]
[0m14:16:34.503403 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m14:16:34.503854 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m14:16:34.504301 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m14:16:34.504548 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:16:34.504883 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:16:34.505180 [debug] [Thread-1  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:16:34.505445 [info ] [Thread-2  ]: 5 of 9 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m14:16:34.505666 [info ] [Thread-3  ]: 6 of 9 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m14:16:34.505867 [info ] [Thread-1  ]: 7 of 9 START test positive_value_dim_listings_cleansed_minimum_nights .......... [RUN]
[0m14:16:34.506472 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:16:34.507036 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:16:34.507593 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m14:16:34.507774 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:16:34.507940 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:16:34.508101 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:16:34.508277 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:16:34.508435 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:16:34.508593 [debug] [Thread-1  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:16:34.515225 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:16:34.518305 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:16:34.520960 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m14:16:34.521379 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:34.521529 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:16:34.523257 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:16:34.523513 [debug] [Thread-3  ]: finished collecting timing info
[0m14:16:34.523697 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:34.523851 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:16:34.524058 [debug] [Thread-1  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:16:34.524467 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m14:16:34.526220 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:16:34.527830 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m14:16:34.527989 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m14:16:34.528252 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:16:34.528863 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m14:16:34.529514 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m14:16:34.529638 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m14:16:34.530176 [debug] [Thread-1  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m14:16:34.530338 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:16:34.530471 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:16:34.657606 [info ] [Thread-4  ]: 4 of 9 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.10s]
[0m14:16:34.658147 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m14:16:34.658343 [debug] [Thread-4  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:16:34.658567 [info ] [Thread-4  ]: 8 of 9 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m14:16:34.659146 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:16:34.659334 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:16:34.659483 [debug] [Thread-4  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:16:34.663356 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:16:34.663842 [debug] [Thread-4  ]: finished collecting timing info
[0m14:16:34.664017 [debug] [Thread-4  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:16:34.666705 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:16:34.667489 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m14:16:34.667628 [debug] [Thread-4  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:16:34.667751 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:16:35.005666 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.48 seconds
[0m14:16:35.007245 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:35.007443 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m14:16:35.127230 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m14:16:35.128995 [debug] [Thread-3  ]: finished collecting timing info
[0m14:16:35.129245 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m14:16:35.131352 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.46 seconds
[0m14:16:35.133273 [debug] [Thread-4  ]: finished collecting timing info
[0m14:16:35.133699 [debug] [Thread-4  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m14:16:35.158580 [info ] [Thread-2  ]: 5 of 9 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.65s]
[0m14:16:35.159339 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m14:16:35.159650 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:16:35.160000 [info ] [Thread-2  ]: 9 of 9 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m14:16:35.160763 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:16:35.160988 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:16:35.161204 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:16:35.168407 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:16:35.169120 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:35.169323 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:16:35.171592 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:16:35.172453 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m14:16:35.172636 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:16:35.172808 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:16:35.324961 [info ] [Thread-4  ]: 8 of 9 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.67s]
[0m14:16:35.325722 [info ] [Thread-3  ]: 6 of 9 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.82s]
[0m14:16:35.326331 [debug] [Thread-4  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m14:16:35.326743 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m14:16:35.644396 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m14:16:35.646837 [debug] [Thread-2  ]: finished collecting timing info
[0m14:16:35.647202 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m14:16:35.812379 [info ] [Thread-2  ]: 9 of 9 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.65s]
[0m14:16:35.812789 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m14:16:35.813465 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.28 seconds
[0m14:16:35.814474 [debug] [Thread-1  ]: finished collecting timing info
[0m14:16:35.814609 [debug] [Thread-1  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m14:16:35.968403 [info ] [Thread-1  ]: 7 of 9 PASS positive_value_dim_listings_cleansed_minimum_nights ................ [[32mPASS[0m in 1.46s]
[0m14:16:35.969385 [debug] [Thread-1  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m14:16:35.971274 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:16:35.972204 [info ] [MainThread]: 
[0m14:16:35.972761 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m14:16:35.973263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:35.973525 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m14:16:35.973779 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m14:16:35.973984 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m14:16:35.974190 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m14:16:36.028837 [info ] [MainThread]: 
[0m14:16:36.029133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:36.029362 [info ] [MainThread]: 
[0m14:16:36.029552 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:16:36.029810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124430e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244653a0>]}
[0m14:16:36.030000 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 14:19:40.766753 | cde86880-2b01-4058-a234-b05e7dfd876e ==============================
[0m14:19:40.766759 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:19:40.767182 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m14:19:40.767289 [debug] [MainThread]: Tracking: tracking
[0m14:19:40.781274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e56d0>]}
[0m14:19:40.782612 [debug] [MainThread]: Set downloads directory='/var/folders/5t/ypbn9q9j4k5fs1ld46vzck880000gn/T/dbt-downloads-z6_37_0v'
[0m14:19:40.783023 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:19:40.920741 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:19:40.921072 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:19:41.001548 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:19:41.032070 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:19:41.322907 [info ] [MainThread]:   Installed from version 0.8.0
[0m14:19:41.323241 [info ] [MainThread]:   Updated version available: 0.9.2
[0m14:19:41.323534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cde86880-2b01-4058-a234-b05e7dfd876e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a915e0>]}
[0m14:19:41.323735 [info ] [MainThread]: 
[0m14:19:41.323948 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:19:41.324629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e5d30>]}
[0m14:19:41.324828 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 14:20:07.901338 | 17cebaec-a474-4aa8-b245-b129424c41bc ==============================
[0m14:20:07.901344 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:20:07.901834 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m14:20:07.901938 [debug] [MainThread]: Tracking: tracking
[0m14:20:07.918273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b72520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b72640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b72670>]}
[0m14:20:07.919704 [debug] [MainThread]: Set downloads directory='/var/folders/5t/ypbn9q9j4k5fs1ld46vzck880000gn/T/dbt-downloads-4fzglsmi'
[0m14:20:07.920139 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:20:08.072235 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:20:08.085581 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:20:08.214108 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:20:08.253215 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:20:08.600682 [info ] [MainThread]:   Installed from version 0.9.2
[0m14:20:08.600978 [info ] [MainThread]:   Up to date!
[0m14:20:08.601233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '17cebaec-a474-4aa8-b245-b129424c41bc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b72730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1e460>]}
[0m14:20:08.601772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b72af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b72cd0>]}
[0m14:20:08.601988 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 14:27:41.191926 | d49c3b24-33df-4351-b5ba-077b4f247141 ==============================
[0m14:27:41.191955 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:27:41.192626 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['fact_reviews'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:27:41.192774 [debug] [MainThread]: Tracking: tracking
[0m14:27:41.193029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072abf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072abfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ba070>]}
[0m14:27:41.215918 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:27:41.216219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd49c3b24-33df-4351-b5ba-077b4f247141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c4be0>]}
[0m14:27:41.246362 [debug] [MainThread]: Parsing macros/positive_value.sql
[0m14:27:41.246904 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m14:27:41.247354 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:27:41.248367 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:27:41.270278 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m14:27:41.270873 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m14:27:41.271323 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m14:27:41.273102 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m14:27:41.275510 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m14:27:41.276131 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m14:27:41.279372 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m14:27:41.284528 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m14:27:41.285011 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m14:27:41.285887 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:27:41.286171 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:27:41.286493 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:27:41.286750 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:27:41.286974 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:27:41.287499 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:27:41.289651 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:27:41.290995 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:27:41.291829 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:27:41.299464 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:27:41.305888 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:27:41.312009 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:27:41.314240 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:27:41.315112 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:27:41.315960 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:27:41.319765 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:27:41.327492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:27:41.328215 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m14:27:41.331290 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:27:41.336108 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:27:41.344504 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:27:41.347085 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:27:41.348683 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:27:41.351258 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:27:41.351863 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:27:41.353433 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:27:41.354457 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:27:41.357639 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:27:41.366371 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:27:41.367066 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:27:41.368181 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:27:41.368894 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:27:41.369326 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:27:41.369712 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:27:41.370041 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:27:41.370674 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:27:41.373073 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:27:41.376919 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:27:41.377310 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:27:41.377874 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:27:41.378327 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:27:41.378765 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:27:41.379343 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:27:41.379724 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:27:41.380208 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:27:41.380772 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:27:41.381836 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:27:41.382408 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:27:41.382913 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:27:41.383411 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:27:41.383900 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:27:41.384332 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:27:41.384832 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:27:41.385259 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:27:41.388264 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:27:41.388752 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:27:41.389185 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:27:41.390008 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:27:41.391161 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:27:41.391651 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:27:41.392336 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:27:41.392827 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:27:41.393781 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m14:27:41.395266 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:27:41.396527 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:27:41.403351 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:27:41.404291 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:27:41.410531 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:27:41.412571 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:27:41.415865 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:27:41.420406 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m14:27:41.423242 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:27:41.424593 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m14:27:41.425873 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m14:27:41.427632 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m14:27:41.428584 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m14:27:41.429902 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m14:27:41.431026 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m14:27:41.431641 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m14:27:41.432362 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m14:27:41.432987 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m14:27:41.436106 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m14:27:41.436749 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m14:27:41.437497 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m14:27:41.438110 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m14:27:41.438762 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m14:27:41.439439 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m14:27:41.440279 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m14:27:41.441004 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m14:27:41.441677 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m14:27:41.442297 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m14:27:41.442953 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m14:27:41.443683 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m14:27:41.444318 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m14:27:41.445036 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m14:27:41.445676 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m14:27:41.446309 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m14:27:41.447046 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m14:27:41.447741 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m14:27:41.448478 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m14:27:41.449220 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m14:27:41.461980 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m14:27:41.463052 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m14:27:41.464215 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m14:27:41.464938 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m14:27:41.465785 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m14:27:41.466575 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m14:27:41.467619 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m14:27:41.468427 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m14:27:41.469029 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m14:27:41.470437 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m14:27:41.471431 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m14:27:41.472104 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m14:27:41.472750 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m14:27:41.474316 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m14:27:41.475284 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m14:27:41.476121 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m14:27:41.477138 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m14:27:41.478484 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m14:27:41.479148 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m14:27:41.480801 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m14:27:41.485763 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m14:27:41.486375 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m14:27:41.486926 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m14:27:41.487497 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m14:27:41.488021 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m14:27:41.488580 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m14:27:41.489510 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m14:27:41.491512 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m14:27:41.492249 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m14:27:41.493835 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m14:27:41.495934 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m14:27:41.497526 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m14:27:41.498301 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m14:27:41.500080 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m14:27:41.503793 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m14:27:41.509880 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m14:27:41.510575 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m14:27:41.513885 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m14:27:41.515412 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m14:27:41.516153 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m14:27:41.517229 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m14:27:41.520691 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m14:27:41.523424 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m14:27:41.525404 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m14:27:41.526700 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m14:27:41.529521 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m14:27:41.530693 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m14:27:41.531628 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m14:27:41.724296 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m14:27:41.730265 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m14:27:41.731622 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m14:27:41.732796 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m14:27:41.744126 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m14:27:41.744962 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m14:27:41.746620 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m14:27:41.747749 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m14:27:41.748870 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m14:27:41.869468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd49c3b24-33df-4351-b5ba-077b4f247141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107475fd0>]}
[0m14:27:41.875706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd49c3b24-33df-4351-b5ba-077b4f247141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d1b20>]}
[0m14:27:41.875913 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m14:27:41.876123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd49c3b24-33df-4351-b5ba-077b4f247141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a15b0>]}
[0m14:27:41.876799 [info ] [MainThread]: 
[0m14:27:41.877192 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:27:41.877684 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m14:27:41.885432 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m14:27:41.885644 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m14:27:41.885750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:42.613384 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.73 seconds
[0m14:27:42.614642 [debug] [ThreadPool]: On list_airbnb: Close
[0m14:27:42.788087 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m14:27:42.793715 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m14:27:42.793891 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m14:27:42.794033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:43.481979 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.69 seconds
[0m14:27:43.486050 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m14:27:43.657615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd49c3b24-33df-4351-b5ba-077b4f247141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793ee50>]}
[0m14:27:43.658742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:43.659339 [info ] [MainThread]: 
[0m14:27:43.665343 [debug] [Thread-1  ]: Began running node model.learn_dbt.fact_reviews
[0m14:27:43.665769 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m14:27:43.666616 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m14:27:43.666871 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.fact_reviews
[0m14:27:43.667118 [debug] [Thread-1  ]: Compiling model.learn_dbt.fact_reviews
[0m14:27:43.675362 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_reviews
[0m14:27:43.678496 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m14:27:43.688213 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m14:27:43.688612 [debug] [Thread-1  ]: finished collecting timing info
[0m14:27:43.688794 [debug] [Thread-1  ]: Began executing node model.learn_dbt.fact_reviews
[0m14:27:43.721419 [debug] [Thread-1  ]: Writing runtime sql for node "model.learn_dbt.fact_reviews"
[0m14:27:43.722396 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:27:43.722515 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
        (

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from airbnb.raw.raw_reviews
)
select 
 listing_id
 ,date as review_date
 ,reviewer_name
 ,comments as review_text
 ,sentiment as review_sentiment
from raw_reviews
),src_reviews as (
  select * from __dbt__cte__src_reviews
)
select 
 md5(cast(coalesce(cast(listing_id as TEXT), '') || '-' || coalesce(cast(review_date as TEXT), '') || '-' || coalesce(cast(reviewer_name as TEXT), '') || '-' || coalesce(cast(review_text as TEXT), '') as TEXT)) as review_id,
* from src_reviews
where review_text is not null

        );
[0m14:27:43.722622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:50.142246 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.42 seconds
[0m14:27:50.155708 [debug] [Thread-1  ]: Using snowflake connection "model.learn_dbt.fact_reviews"
[0m14:27:50.156054 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "model.learn_dbt.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m14:27:50.287637 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m14:27:50.314166 [debug] [Thread-1  ]: finished collecting timing info
[0m14:27:50.314478 [debug] [Thread-1  ]: On model.learn_dbt.fact_reviews: Close
[0m14:27:50.479287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd49c3b24-33df-4351-b5ba-077b4f247141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107571670>]}
[0m14:27:50.479895 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 1[0m in 6.81s]
[0m14:27:50.480480 [debug] [Thread-1  ]: Finished running node model.learn_dbt.fact_reviews
[0m14:27:50.481762 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m14:27:50.482370 [info ] [MainThread]: 
[0m14:27:50.482750 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m14:27:50.483271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:50.483553 [debug] [MainThread]: Connection 'model.learn_dbt.fact_reviews' was properly closed.
[0m14:27:50.496359 [info ] [MainThread]: 
[0m14:27:50.496787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:50.497133 [info ] [MainThread]: 
[0m14:27:50.497433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:50.497801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0f610>]}
[0m14:27:50.498050 [debug] [MainThread]: Flushing usage events


============================== 2022-10-14 15:18:15.859241 | 499b9cac-a31b-4024-ab19-8b4b0a1f21b6 ==============================
[0m15:18:15.859291 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:18:15.860145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:18:15.860300 [debug] [MainThread]: Tracking: tracking
[0m15:18:15.860527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebae20>]}
[0m15:18:15.920947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:18:15.921239 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/overview.md
[0m15:18:15.921373 [debug] [MainThread]: Partial parsing: added file: learn_dbt://models/docs.md
[0m15:18:15.921605 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m15:18:15.921764 [debug] [MainThread]: Partial parsing: updated file: learn_dbt://models/fact/fact_reviews.sql
[0m15:18:15.930080 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m15:18:15.936456 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m15:18:15.948114 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m15:18:15.984571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '499b9cac-a31b-4024-ab19-8b4b0a1f21b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c10d0>]}
[0m15:18:15.991016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '499b9cac-a31b-4024-ab19-8b4b0a1f21b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a04d7f0>]}
[0m15:18:15.991210 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m15:18:15.991408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499b9cac-a31b-4024-ab19-8b4b0a1f21b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecfd60>]}
[0m15:18:15.992362 [info ] [MainThread]: 
[0m15:18:15.992738 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:18:15.993323 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m15:18:16.000368 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m15:18:16.000494 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m15:18:16.000599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:16.775642 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.78 seconds
[0m15:18:16.777837 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m15:18:16.942608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499b9cac-a31b-4024-ab19-8b4b0a1f21b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc4d60>]}
[0m15:18:16.943713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:16.944267 [info ] [MainThread]: 
[0m15:18:16.950522 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m15:18:16.950808 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m15:18:16.951095 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m15:18:16.951324 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m15:18:16.951982 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m15:18:16.952648 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m15:18:16.953265 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m15:18:16.953868 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m15:18:16.954138 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m15:18:16.954355 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m15:18:16.954566 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m15:18:16.954761 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m15:18:16.955005 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m15:18:16.955204 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m15:18:16.955398 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m15:18:16.955757 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m15:18:16.959578 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m15:18:16.962291 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m15:18:16.964881 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m15:18:16.966690 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m15:18:16.967139 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:16.967400 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m15:18:16.967681 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:16.967865 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:16.968064 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:16.968204 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:16.968711 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m15:18:16.969171 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m15:18:16.969589 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m15:18:16.970038 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m15:18:16.970227 [debug] [Thread-4  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m15:18:16.970564 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m15:18:16.970827 [debug] [Thread-3  ]: Began running node model.learn_dbt.fact_reviews
[0m15:18:16.971078 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m15:18:16.971435 [debug] [Thread-4  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m15:18:16.971796 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m15:18:16.972172 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m15:18:16.972535 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m15:18:16.972697 [debug] [Thread-4  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m15:18:16.972856 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m15:18:16.973011 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.fact_reviews
[0m15:18:16.973160 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m15:18:16.973309 [debug] [Thread-4  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m15:18:16.973455 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m15:18:16.973598 [debug] [Thread-3  ]: Compiling model.learn_dbt.fact_reviews
[0m15:18:16.973742 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m15:18:16.977138 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:16.990684 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m15:18:16.995747 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m15:18:16.998955 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m15:18:16.999170 [debug] [Thread-4  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m15:18:16.999658 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:17.000265 [debug] [Thread-4  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m15:18:17.000547 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.000671 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.000793 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.000903 [debug] [Thread-3  ]: Began executing node model.learn_dbt.fact_reviews
[0m15:18:17.001021 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m15:18:17.001133 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m15:18:17.001246 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.001355 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.001462 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.001828 [debug] [Thread-3  ]: Finished running node model.learn_dbt.fact_reviews
[0m15:18:17.002168 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m15:18:17.002482 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m15:18:17.002773 [debug] [Thread-4  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m15:18:17.003050 [debug] [Thread-2  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:18:17.003349 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m15:18:17.003658 [debug] [Thread-1  ]: Began running node test.learn_dbt.consistent_created_at
[0m15:18:17.003767 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m15:18:17.004054 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:18:17.004183 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m15:18:17.004465 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m15:18:17.004731 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m15:18:17.004845 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:18:17.004968 [debug] [Thread-4  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m15:18:17.005082 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m15:18:17.005194 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m15:18:17.005295 [debug] [Thread-2  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:18:17.007371 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m15:18:17.007496 [debug] [Thread-1  ]: Compiling test.learn_dbt.consistent_created_at
[0m15:18:17.007601 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m15:18:17.042852 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:18:17.044889 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m15:18:17.046429 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m15:18:17.046626 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:17.046840 [debug] [Thread-4  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m15:18:17.047005 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:17.047367 [debug] [Thread-4  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m15:18:17.047479 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.047620 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m15:18:17.047777 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.047863 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.047976 [debug] [Thread-2  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:18:17.048245 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:18:17.048352 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m15:18:17.048453 [debug] [Thread-1  ]: Began executing node test.learn_dbt.consistent_created_at
[0m15:18:17.048553 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.048653 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m15:18:17.048753 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.048855 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.049144 [debug] [Thread-2  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:18:17.049253 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m15:18:17.049547 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m15:18:17.049847 [debug] [Thread-1  ]: Finished running node test.learn_dbt.consistent_created_at
[0m15:18:17.049982 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:18:17.056848 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:18:17.057010 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:18:17.057168 [debug] [Thread-1  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:18:17.057449 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:18:17.057550 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m15:18:17.057783 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:18:17.058022 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:18:17.058129 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:18:17.058235 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:18:17.058340 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:18:17.058437 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:18:17.058540 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:18:17.058973 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:18:17.059107 [debug] [Thread-1  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:18:17.064010 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:18:17.066778 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:18:17.068941 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:18:17.069896 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.070031 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:18:17.070142 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.070485 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:18:17.070584 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.070735 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:18:17.070861 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.070976 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:18:17.071257 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:18:17.071365 [debug] [Thread-1  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:18:17.071471 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.071569 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:18:17.071667 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.071956 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:18:17.072059 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:18:17.072335 [debug] [Thread-1  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:18:17.072453 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m15:18:17.075915 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:18:17.076097 [debug] [Thread-1  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:18:17.076414 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m15:18:17.076722 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:18:17.076848 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m15:18:17.076965 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:18:17.077064 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.077165 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m15:18:17.077267 [debug] [Thread-1  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:18:17.077366 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:18:17.079097 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m15:18:17.081800 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:18:17.081924 [debug] [Thread-2  ]: finished collecting timing info
[0m15:18:17.082328 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:18:17.082546 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.082652 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.082751 [debug] [Thread-1  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:18:17.082866 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m15:18:17.082981 [debug] [Thread-1  ]: finished collecting timing info
[0m15:18:17.083082 [debug] [Thread-3  ]: finished collecting timing info
[0m15:18:17.083389 [debug] [Thread-1  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:18:17.083684 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m15:18:17.519145 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.46 seconds
[0m15:18:17.525659 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:18:17.527799 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:17.528108 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m15:18:17.528362 [debug] [Thread-4  ]: finished collecting timing info
[0m15:18:17.528628 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m15:18:17.671917 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m15:18:17.672989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:17.673179 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m15:18:17.673322 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m15:18:17.673454 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m15:18:17.673577 [debug] [MainThread]: Connection 'test.learn_dbt.no_nulls_in_dim_listings' was properly closed.
[0m15:18:17.682096 [info ] [MainThread]: Done.
[0m15:18:17.684640 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m15:18:17.684831 [info ] [MainThread]: Building catalog
[0m15:18:17.704289 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m15:18:17.709414 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m15:18:17.709572 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m15:18:17.709687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:20.243980 [debug] [ThreadPool]: SQL status: SUCCESS 87 in 2.53 seconds
[0m15:18:20.263773 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m15:18:20.481604 [info ] [MainThread]: Catalog written to /Users/nigelbrown/learn-dbt/target/catalog.json
[0m15:18:20.482147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5cd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c41f0>]}
[0m15:18:20.482404 [debug] [MainThread]: Flushing usage events
[0m15:18:21.018177 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:18:21.018770 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-10-14 15:19:57.390947 | f48fd3b2-1baf-472f-98c4-ce4074e5ebf7 ==============================
[0m15:19:57.390979 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:19:57.391849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:19:57.392030 [debug] [MainThread]: Tracking: tracking
[0m15:19:57.392383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762aee0>]}
[0m15:19:57.394009 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:19:57.394260 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:19:57.394447 [info ] [MainThread]: 
[0m15:19:57.394609 [info ] [MainThread]: 
[0m15:19:57.394764 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:25:15.776672 [debug] [MainThread]: Flushing usage events
[0m15:25:16.297365 [info ] [MainThread]: ctrl-c


============================== 2022-10-14 15:25:21.404418 | 7556e3d9-3c43-4946-8358-b2c2669e0a88 ==============================
[0m15:25:21.404463 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:25:21.404948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:25:21.405091 [debug] [MainThread]: Tracking: tracking
[0m15:25:21.405326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8aeb0>]}
[0m15:25:21.406252 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:25:21.406459 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:25:21.406643 [info ] [MainThread]: 
[0m15:25:21.406804 [info ] [MainThread]: 
[0m15:25:21.406960 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:30:21.457966 [debug] [MainThread]: Flushing usage events
[0m15:30:21.960538 [info ] [MainThread]: ctrl-c


============================== 2022-10-14 15:32:39.925163 | ce44b8f7-2d38-4bf9-81ec-1af68cdb70eb ==============================
[0m15:32:39.925187 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:32:39.925908 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:32:39.926044 [debug] [MainThread]: Tracking: tracking
[0m15:32:39.926275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bbae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bbaee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bbaf40>]}
[0m15:32:39.951597 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:32:39.951893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce44b8f7-2d38-4bf9-81ec-1af68cdb70eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bac970>]}
[0m15:32:39.986256 [debug] [MainThread]: Parsing macros/positive_value.sql
[0m15:32:39.986808 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m15:32:39.987286 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:32:39.988384 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:32:40.009948 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m15:32:40.010571 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m15:32:40.011040 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m15:32:40.013110 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:32:40.015824 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:32:40.016501 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:32:40.019278 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:32:40.024179 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:32:40.024682 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m15:32:40.025663 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:32:40.026009 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:32:40.026372 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:32:40.026632 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:32:40.026870 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:32:40.027139 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:32:40.028884 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:32:40.029986 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:32:40.030778 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:32:40.038571 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:32:40.045144 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:32:40.051145 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:32:40.053234 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:32:40.054074 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:32:40.054897 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:32:40.058581 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:32:40.066342 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:32:40.067050 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:32:40.070117 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:32:40.074896 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:32:40.083049 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:32:40.085568 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:32:40.087160 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:32:40.089676 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:32:40.090272 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:32:40.091799 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:32:40.092821 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:32:40.096007 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:32:40.104716 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:32:40.105402 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:32:40.106517 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:32:40.107230 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:32:40.107656 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:32:40.108040 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:32:40.108367 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:32:40.108996 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:32:40.111384 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:32:40.115228 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:32:40.115618 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:32:40.116188 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:32:40.116644 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:32:40.117089 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:32:40.117661 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:32:40.118051 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:32:40.118531 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:32:40.119099 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:32:40.120158 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:32:40.120726 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:32:40.121229 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:32:40.121719 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:32:40.122199 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:32:40.122630 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:32:40.123134 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:32:40.123561 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:32:40.126570 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:32:40.127061 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:32:40.127491 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:32:40.128308 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:32:40.129316 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:32:40.129797 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:32:40.130477 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:32:40.130968 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:32:40.131929 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:32:40.133409 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:32:40.134666 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:32:40.141464 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:32:40.142356 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:32:40.148449 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:32:40.150461 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:32:40.153698 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:32:40.158147 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:32:40.160957 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:32:40.162297 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m15:32:40.163681 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:32:40.165408 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m15:32:40.166337 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m15:32:40.167657 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m15:32:40.168752 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m15:32:40.169343 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m15:32:40.170073 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m15:32:40.170692 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m15:32:40.173811 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m15:32:40.174448 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m15:32:40.175178 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m15:32:40.175772 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m15:32:40.176421 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m15:32:40.177099 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m15:32:40.177936 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m15:32:40.178661 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m15:32:40.179337 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m15:32:40.179956 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m15:32:40.180610 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m15:32:40.181341 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m15:32:40.181966 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m15:32:40.182645 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m15:32:40.183280 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m15:32:40.183912 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m15:32:40.184644 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m15:32:40.185333 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m15:32:40.186067 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m15:32:40.186782 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:32:40.199003 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:32:40.199859 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:32:40.200967 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:32:40.201658 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m15:32:40.202485 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m15:32:40.203241 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m15:32:40.204264 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m15:32:40.205031 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m15:32:40.205591 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m15:32:40.206763 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m15:32:40.207739 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m15:32:40.208385 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m15:32:40.208968 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m15:32:40.210286 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m15:32:40.211207 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m15:32:40.212020 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m15:32:40.213017 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m15:32:40.214342 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m15:32:40.214985 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m15:32:40.216615 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:32:40.221262 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:32:40.221773 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m15:32:40.222296 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:32:40.222846 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:32:40.223351 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:32:40.223888 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m15:32:40.224778 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:32:40.226720 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:32:40.227454 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:32:40.229004 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:32:40.230963 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:32:40.232507 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:32:40.233264 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:32:40.235004 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:32:40.238645 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:32:40.244258 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:32:40.244864 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m15:32:40.248173 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:32:40.249710 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:32:40.250444 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:32:40.251177 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:32:40.254495 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:32:40.257085 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:32:40.258975 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m15:32:40.260238 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m15:32:40.262680 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:32:40.263717 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m15:32:40.264442 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:32:40.451209 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m15:32:40.456921 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m15:32:40.458479 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m15:32:40.460036 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m15:32:40.472281 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m15:32:40.473111 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m15:32:40.474313 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m15:32:40.475588 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m15:32:40.476709 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m15:32:40.597051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce44b8f7-2d38-4bf9-81ec-1af68cdb70eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141990d0>]}
[0m15:32:40.603835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce44b8f7-2d38-4bf9-81ec-1af68cdb70eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bf04f0>]}
[0m15:32:40.604070 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m15:32:40.604276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce44b8f7-2d38-4bf9-81ec-1af68cdb70eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c469d0>]}
[0m15:32:40.605291 [info ] [MainThread]: 
[0m15:32:40.605736 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:32:40.606329 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m15:32:40.613856 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m15:32:40.614042 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m15:32:40.614141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:41.429489 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.82 seconds
[0m15:32:41.430914 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m15:32:41.584769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce44b8f7-2d38-4bf9-81ec-1af68cdb70eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141989a0>]}
[0m15:32:41.585787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:41.586277 [info ] [MainThread]: 
[0m15:32:41.591159 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m15:32:41.591374 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m15:32:41.591591 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m15:32:41.591820 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m15:32:41.592353 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m15:32:41.592851 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m15:32:41.593435 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m15:32:41.593873 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m15:32:41.594073 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m15:32:41.594259 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m15:32:41.594440 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m15:32:41.594612 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m15:32:41.594840 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m15:32:41.595028 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m15:32:41.595205 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m15:32:41.595372 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m15:32:41.598811 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m15:32:41.602067 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m15:32:41.604358 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m15:32:41.605980 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m15:32:41.606385 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.606554 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m15:32:41.606722 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.607215 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m15:32:41.607493 [debug] [Thread-3  ]: finished collecting timing info
[0m15:32:41.607662 [debug] [Thread-4  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m15:32:41.607790 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.607916 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.608400 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m15:32:41.608753 [debug] [Thread-4  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m15:32:41.609128 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m15:32:41.609505 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m15:32:41.609781 [debug] [Thread-4  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m15:32:41.609911 [debug] [Thread-3  ]: Began running node model.learn_dbt.fact_reviews
[0m15:32:41.610249 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m15:32:41.610400 [debug] [Thread-4  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m15:32:41.610527 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m15:32:41.610886 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m15:32:41.611229 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m15:32:41.613970 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.614363 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m15:32:41.614517 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.fact_reviews
[0m15:32:41.614671 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m15:32:41.614823 [debug] [Thread-4  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m15:32:41.614961 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m15:32:41.615098 [debug] [Thread-3  ]: Compiling model.learn_dbt.fact_reviews
[0m15:32:41.615233 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m15:32:41.615373 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.615504 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m15:32:41.628254 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m15:32:41.632660 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m15:32:41.633141 [debug] [Thread-4  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m15:32:41.638104 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m15:32:41.638765 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.638891 [debug] [Thread-3  ]: finished collecting timing info
[0m15:32:41.638994 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.639094 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m15:32:41.639207 [debug] [Thread-3  ]: Began executing node model.learn_dbt.fact_reviews
[0m15:32:41.639310 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m15:32:41.639418 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.639521 [debug] [Thread-3  ]: finished collecting timing info
[0m15:32:41.639623 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.639991 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m15:32:41.640312 [debug] [Thread-3  ]: Finished running node model.learn_dbt.fact_reviews
[0m15:32:41.640598 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m15:32:41.640933 [debug] [Thread-4  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m15:32:41.641042 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:32:41.641135 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m15:32:41.641251 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m15:32:41.641605 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m15:32:41.641884 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:32:41.642152 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m15:32:41.642426 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m15:32:41.642578 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m15:32:41.642716 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:32:41.642857 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m15:32:41.642992 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m15:32:41.643112 [debug] [Thread-4  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m15:32:41.643219 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:32:41.643326 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m15:32:41.643431 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m15:32:41.645662 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m15:32:41.649277 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:32:41.651472 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m15:32:41.652993 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m15:32:41.653836 [debug] [Thread-3  ]: finished collecting timing info
[0m15:32:41.653950 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.654078 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.654246 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.654380 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m15:32:41.654537 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:32:41.654685 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m15:32:41.654804 [debug] [Thread-4  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m15:32:41.654932 [debug] [Thread-3  ]: finished collecting timing info
[0m15:32:41.655045 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.655156 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.655255 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.655635 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m15:32:41.655962 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:32:41.656251 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m15:32:41.656672 [debug] [Thread-4  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m15:32:41.656801 [debug] [Thread-3  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m15:32:41.656962 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:32:41.657096 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:32:41.657224 [debug] [Thread-4  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:32:41.657481 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:32:41.657742 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:32:41.657996 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:32:41.658222 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:32:41.658327 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m15:32:41.658428 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:32:41.658523 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:32:41.658618 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:32:41.658714 [debug] [Thread-3  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m15:32:41.658807 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:32:41.658897 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:32:41.658989 [debug] [Thread-4  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:32:41.665899 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:32:41.670642 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:32:41.673027 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:32:41.675036 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:32:41.675154 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m15:32:41.675656 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:32:41.676644 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.676767 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:32:41.676885 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.677003 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.677125 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.677247 [debug] [Thread-4  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:32:41.677619 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:32:41.677745 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:32:41.678014 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.678521 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:32:41.678684 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.679001 [debug] [Thread-4  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:32:41.679284 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:32:41.679628 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:32:41.679768 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m15:32:41.679898 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:32:41.680014 [debug] [Thread-2  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:32:41.680272 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m15:32:41.680376 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:32:41.680612 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:32:41.680719 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m15:32:41.684575 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:32:41.684747 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:32:41.684866 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m15:32:41.685011 [debug] [Thread-2  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:32:41.687410 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m15:32:41.690287 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:32:41.690431 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.690619 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:32:41.690753 [debug] [Thread-1  ]: finished collecting timing info
[0m15:32:41.690847 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.690941 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.691263 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:32:41.691385 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m15:32:41.691507 [debug] [Thread-2  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:32:41.691676 [debug] [Thread-4  ]: finished collecting timing info
[0m15:32:41.691781 [debug] [Thread-2  ]: finished collecting timing info
[0m15:32:41.692064 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m15:32:41.692333 [debug] [Thread-2  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:32:42.337618 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 0.66 seconds
[0m15:32:42.339590 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:32:42.341267 [debug] [Thread-3  ]: finished collecting timing info
[0m15:32:42.341485 [debug] [Thread-3  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m15:32:42.341645 [debug] [Thread-3  ]: finished collecting timing info
[0m15:32:42.341812 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m15:32:42.540409 [debug] [Thread-3  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m15:32:42.541803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:42.542108 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m15:32:42.542344 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m15:32:42.542566 [debug] [MainThread]: Connection 'test.learn_dbt.no_nulls_in_dim_listings' was properly closed.
[0m15:32:42.542778 [debug] [MainThread]: Connection 'model.learn_dbt.dim_listings_w_hosts' was properly closed.
[0m15:32:42.555542 [info ] [MainThread]: Done.
[0m15:32:42.559533 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m15:32:42.559733 [info ] [MainThread]: Building catalog
[0m15:32:42.561560 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m15:32:42.568747 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m15:32:42.568927 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m15:32:42.569077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:45.021736 [debug] [ThreadPool]: SQL status: SUCCESS 87 in 2.45 seconds
[0m15:32:45.043332 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m15:32:45.260084 [info ] [MainThread]: Catalog written to /Users/nigelbrown/learn-dbt/target/catalog.json
[0m15:32:45.260611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11672ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167b1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167b1070>]}
[0m15:32:45.260861 [debug] [MainThread]: Flushing usage events
[0m15:32:45.837368 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:32:45.837922 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-10-14 15:33:07.343642 | 659fac6f-065b-4a40-84de-a4426d768c0d ==============================
[0m15:33:07.343715 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:33:07.344221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:33:07.344369 [debug] [MainThread]: Tracking: tracking
[0m15:33:07.344617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574a040>]}
[0m15:33:07.345785 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:33:07.345992 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:33:07.346168 [info ] [MainThread]: 
[0m15:33:07.346328 [info ] [MainThread]: 
[0m15:33:07.346480 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:33:20.032134 [debug] [MainThread]: Flushing usage events
[0m15:33:20.495350 [info ] [MainThread]: ctrl-c


============================== 2022-10-14 15:34:12.840265 | 1f0a37d4-974c-4dfd-b741-d6393d9acfc4 ==============================
[0m15:34:12.840284 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:34:12.840744 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:34:12.840890 [debug] [MainThread]: Tracking: tracking
[0m15:34:12.841148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd7dc0>]}
[0m15:34:12.842205 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:34:12.842495 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:34:12.842680 [info ] [MainThread]: 
[0m15:34:12.842843 [info ] [MainThread]: 
[0m15:34:12.843001 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:43:19.973035 [debug] [MainThread]: Flushing usage events
[0m15:43:20.497314 [info ] [MainThread]: ctrl-c


============================== 2022-10-14 15:43:25.036790 | 9eb40b96-a41e-475b-881b-9fcce0244ae0 ==============================
[0m15:43:25.036820 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:43:25.037344 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:43:25.037518 [debug] [MainThread]: Tracking: tracking
[0m15:43:25.037774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb7bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb7bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb8a040>]}
[0m15:43:25.038819 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:43:25.039021 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:43:25.039192 [info ] [MainThread]: 
[0m15:43:25.039357 [info ] [MainThread]: 
[0m15:43:25.039513 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:45:14.322647 [debug] [MainThread]: Flushing usage events
[0m15:45:14.848625 [info ] [MainThread]: ctrl-c


============================== 2022-10-14 15:45:33.059531 | 419b1e27-604f-4ab8-abbb-bb928868dc54 ==============================
[0m15:45:33.059565 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:45:33.060368 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:45:33.060510 [debug] [MainThread]: Tracking: tracking
[0m15:45:33.060740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e23df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e23e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e23eb0>]}
[0m15:45:33.120209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:33.120658 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m15:45:33.139587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '419b1e27-604f-4ab8-abbb-bb928868dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061060d0>]}
[0m15:45:33.145831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '419b1e27-604f-4ab8-abbb-bb928868dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3f340>]}
[0m15:45:33.146016 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m15:45:33.146208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '419b1e27-604f-4ab8-abbb-bb928868dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e370a0>]}
[0m15:45:33.147202 [info ] [MainThread]: 
[0m15:45:33.147632 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m15:45:33.148397 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m15:45:33.155950 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m15:45:33.156173 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m15:45:33.156279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:33.948924 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.79 seconds
[0m15:45:33.950840 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m15:45:34.111194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '419b1e27-604f-4ab8-abbb-bb928868dc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106084f40>]}
[0m15:45:34.112383 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:45:34.112976 [info ] [MainThread]: 
[0m15:45:34.119334 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m15:45:34.119631 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m15:45:34.119934 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m15:45:34.120589 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m15:45:34.120805 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m15:45:34.121433 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m15:45:34.122071 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m15:45:34.122467 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m15:45:34.123491 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m15:45:34.123771 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m15:45:34.123988 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m15:45:34.124228 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m15:45:34.124454 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m15:45:34.124667 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m15:45:34.124895 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m15:45:34.128707 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m15:45:34.128917 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m15:45:34.131584 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m15:45:34.134182 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m15:45:34.136612 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m15:45:34.137139 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.137374 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m15:45:34.137569 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.137759 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.137942 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.138071 [debug] [Thread-3  ]: finished collecting timing info
[0m15:45:34.138720 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m15:45:34.139258 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m15:45:34.139872 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m15:45:34.140519 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m15:45:34.140777 [debug] [Thread-2  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m15:45:34.141116 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m15:45:34.141407 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m15:45:34.141706 [debug] [Thread-3  ]: Began running node model.learn_dbt.fact_reviews
[0m15:45:34.142112 [debug] [Thread-2  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m15:45:34.142538 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m15:45:34.142951 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m15:45:34.143333 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m15:45:34.143500 [debug] [Thread-2  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m15:45:34.143664 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m15:45:34.143828 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m15:45:34.143981 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.fact_reviews
[0m15:45:34.144138 [debug] [Thread-2  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m15:45:34.144272 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m15:45:34.144402 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m15:45:34.144530 [debug] [Thread-3  ]: Compiling model.learn_dbt.fact_reviews
[0m15:45:34.148369 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.159004 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m15:45:34.163447 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m15:45:34.181944 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m15:45:34.182162 [debug] [Thread-2  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m15:45:34.182708 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.183139 [debug] [Thread-2  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m15:45:34.183428 [debug] [Thread-3  ]: finished collecting timing info
[0m15:45:34.183543 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.183657 [debug] [Thread-3  ]: Began executing node model.learn_dbt.fact_reviews
[0m15:45:34.183745 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.183853 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m15:45:34.183955 [debug] [Thread-3  ]: finished collecting timing info
[0m15:45:34.184059 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m15:45:34.184157 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.184465 [debug] [Thread-3  ]: Finished running node model.learn_dbt.fact_reviews
[0m15:45:34.184572 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.184885 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m15:45:34.185276 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m15:45:34.185375 [debug] [Thread-2  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m15:45:34.185841 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m15:45:34.185939 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:45:34.186187 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m15:45:34.186293 [debug] [Thread-4  ]: Began running node test.learn_dbt.consistent_created_at
[0m15:45:34.186532 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m15:45:34.186802 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:45:34.186913 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m15:45:34.187160 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m15:45:34.187262 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m15:45:34.187368 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:45:34.187470 [debug] [Thread-2  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m15:45:34.187572 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m15:45:34.187670 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m15:45:34.187766 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:45:34.189748 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m15:45:34.189869 [debug] [Thread-4  ]: Compiling test.learn_dbt.consistent_created_at
[0m15:45:34.192145 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m15:45:34.198990 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m15:45:34.200628 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m15:45:34.201059 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.201196 [debug] [Thread-3  ]: finished collecting timing info
[0m15:45:34.201327 [debug] [Thread-2  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m15:45:34.201429 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.201540 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.201634 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m15:45:34.201745 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.201843 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:45:34.201949 [debug] [Thread-4  ]: Began executing node test.learn_dbt.consistent_created_at
[0m15:45:34.202048 [debug] [Thread-3  ]: finished collecting timing info
[0m15:45:34.202379 [debug] [Thread-2  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m15:45:34.202482 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.202580 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.202879 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m15:45:34.203000 [debug] [Thread-2  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m15:45:34.203318 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m15:45:34.203695 [debug] [Thread-4  ]: Finished running node test.learn_dbt.consistent_created_at
[0m15:45:34.203816 [debug] [Thread-3  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m15:45:34.204085 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m15:45:34.204198 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:45:34.204324 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:45:34.204585 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:45:34.204687 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m15:45:34.204925 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:45:34.205171 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:45:34.205269 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m15:45:34.205370 [debug] [Thread-2  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m15:45:34.205467 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:45:34.205561 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:45:34.205656 [debug] [Thread-3  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m15:45:34.207114 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m15:45:34.207231 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:45:34.207332 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:45:34.213433 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:45:34.245613 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m15:45:34.247912 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m15:45:34.248045 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.248138 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m15:45:34.248344 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m15:45:34.248463 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:45:34.248610 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.248885 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.248984 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.249540 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m15:45:34.249974 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:45:34.250096 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:45:34.250256 [debug] [Thread-2  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:45:34.250403 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.250508 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.250764 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:45:34.251043 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m15:45:34.251319 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m15:45:34.251569 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:45:34.251977 [debug] [Thread-4  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:45:34.252119 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:45:34.252247 [debug] [Thread-2  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:45:34.252514 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:45:34.252759 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:45:34.255334 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m15:45:34.255481 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:45:34.255605 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:45:34.255747 [debug] [Thread-4  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:45:34.255847 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:45:34.259926 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m15:45:34.263147 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m15:45:34.263348 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.263467 [debug] [Thread-2  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:45:34.263606 [debug] [Thread-2  ]: finished collecting timing info
[0m15:45:34.263710 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.264040 [debug] [Thread-2  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m15:45:34.264138 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.264240 [debug] [Thread-4  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:45:34.264401 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:45:34.264510 [debug] [Thread-4  ]: finished collecting timing info
[0m15:45:34.264615 [debug] [Thread-1  ]: finished collecting timing info
[0m15:45:34.264909 [debug] [Thread-4  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m15:45:34.265191 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m15:45:34.719030 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 0.47 seconds
[0m15:45:34.721069 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m15:45:34.721730 [debug] [Thread-3  ]: finished collecting timing info
[0m15:45:34.721923 [debug] [Thread-3  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m15:45:34.722091 [debug] [Thread-3  ]: finished collecting timing info
[0m15:45:34.722276 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m15:45:34.875577 [debug] [Thread-3  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m15:45:34.876456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:34.876659 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m15:45:34.876817 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m15:45:34.876965 [debug] [MainThread]: Connection 'test.learn_dbt.no_nulls_in_dim_listings' was properly closed.
[0m15:45:34.877089 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m15:45:34.886404 [info ] [MainThread]: Done.
[0m15:45:34.889753 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m15:45:34.889938 [info ] [MainThread]: Building catalog
[0m15:45:34.891313 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m15:45:34.896721 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m15:45:34.896867 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m15:45:34.896981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:37.542895 [debug] [ThreadPool]: SQL status: SUCCESS 87 in 2.65 seconds
[0m15:45:37.554080 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m15:45:37.744890 [info ] [MainThread]: Catalog written to /Users/nigelbrown/learn-dbt/target/catalog.json
[0m15:45:37.745451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3b880>]}
[0m15:45:37.745708 [debug] [MainThread]: Flushing usage events
[0m15:45:38.518051 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:45:38.518452 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-10-17 08:01:17.749243 | d23f801a-915a-43c7-9cad-774b95e4b072 ==============================
[0m08:01:17.749292 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:01:17.750302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:01:17.750435 [debug] [MainThread]: Tracking: tracking
[0m08:01:17.750756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105167d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105167df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105167e50>]}
[0m08:01:17.817722 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m08:01:17.818048 [debug] [MainThread]: Partial parsing: added file: learn_dbt://tests/generic/positive_value.sql
[0m08:01:17.818183 [debug] [MainThread]: Partial parsing: added file: learn_dbt://analyses/full_moon_no_sleep.sql
[0m08:01:17.818428 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:01:17.818584 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://macros/positive_value.sql
[0m08:01:17.818707 [debug] [MainThread]: Parsing tests/generic/positive_value.sql
[0m08:01:17.828440 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:01:17.835314 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:01:17.849499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105453070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105478730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105478850>]}
[0m08:01:17.849774 [debug] [MainThread]: Flushing usage events
[0m08:01:18.351478 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/schema.yml @ models: {'name': 'dim_hosts_cleansed', 'description': 'Cleaned table which contains Airbnb hosts', 'columns': [{'name': 'host_id', 'tests': ['not_null', 'unique'], 'description': 'Primary key for the host'}, {'name': 'name', 'description': "The host's name", 'tests': ['not_null']}, {'name': 'is_superhost', 'description': 'A boolean that defines if the host is a superhost (True/False)', 'tests': {'-accepted_values': {'values': ['t', 'f']}}}, {'name': 'created_at', 'description': 'Date the host data was originally created.'}, {'name': 'updated_at', 'description': 'Date the host data was last updated.'}], 'original_file_path': 'models/schema.yml', 'yaml_key': 'models', 'package_name': 'learn_dbt'} - at path ['columns'][2]['tests']: {'-accepted_values': {'values': ['t', 'f']}} is not valid under any of the given schemas


============================== 2022-10-17 08:02:50.380407 | 2966e89d-648b-449b-8f13-86b8539a5652 ==============================
[0m08:02:50.380473 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:02:50.381545 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:02:50.381692 [debug] [MainThread]: Tracking: tracking
[0m08:02:50.381994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a3d00>]}
[0m08:02:50.440530 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m08:02:50.440823 [debug] [MainThread]: Partial parsing: added file: learn_dbt://analyses/full_moon_no_sleep.sql
[0m08:02:50.440955 [debug] [MainThread]: Partial parsing: added file: learn_dbt://tests/generic/positive_value.sql
[0m08:02:50.441184 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:02:50.441336 [debug] [MainThread]: Partial parsing: deleted file: learn_dbt://macros/positive_value.sql
[0m08:02:50.441448 [debug] [MainThread]: Parsing tests/generic/positive_value.sql
[0m08:02:50.450623 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:02:50.457233 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:02:50.501224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2966e89d-648b-449b-8f13-86b8539a5652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c000d0>]}
[0m08:02:50.507268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2966e89d-648b-449b-8f13-86b8539a5652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4c670>]}
[0m08:02:50.507443 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:02:50.507632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2966e89d-648b-449b-8f13-86b8539a5652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afbc40>]}
[0m08:02:50.508609 [info ] [MainThread]: 
[0m08:02:50.508973 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:02:50.509630 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:02:50.516614 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:02:50.516751 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:02:50.516858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:52.533324 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2.02 seconds
[0m08:02:52.537050 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:02:52.694827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2966e89d-648b-449b-8f13-86b8539a5652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4c430>]}
[0m08:02:52.695899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:02:52.696482 [info ] [MainThread]: 
[0m08:02:52.702313 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:02:52.702592 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:02:52.702869 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:02:52.703098 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:02:52.703328 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:02:52.703583 [info ] [Thread-2  ]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m08:02:52.703833 [info ] [Thread-3  ]: 3 of 9 START test dim_listings_minimum_nights .................................. [RUN]
[0m08:02:52.704815 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:02:52.705070 [info ] [Thread-4  ]: 4 of 9 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m08:02:52.705931 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:02:52.706613 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:02:52.706828 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:02:52.707551 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:02:52.707741 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:02:52.707941 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:02:52.708178 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:02:52.708369 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:02:52.708567 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:02:52.708755 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:02:52.716792 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:02:52.717065 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:02:52.719906 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:02:52.722096 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:02:52.731417 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:02:52.731730 [debug] [Thread-1  ]: finished collecting timing info
[0m08:02:52.731904 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:02:52.732050 [debug] [Thread-2  ]: finished collecting timing info
[0m08:02:52.732194 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:02:52.732352 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:02:52.732490 [debug] [Thread-3  ]: finished collecting timing info
[0m08:02:52.732634 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:02:52.746550 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:02:52.747547 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:02:52.749859 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:02:52.785881 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:02:52.786695 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:02:52.786909 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:02:52.787218 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:02:52.787357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:02:52.787714 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:02:52.787832 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:02:52.788397 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:02:52.788830 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:02:52.788940 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:02:53.794661 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 1.06 seconds
[0m08:02:53.798782 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:02:53.801595 [debug] [Thread-4  ]: finished collecting timing info
[0m08:02:53.801968 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:02:53.806148 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:02:53.807642 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:02:53.807892 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:02:55.439750 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.65 seconds
[0m08:02:55.451746 [debug] [Thread-3  ]: finished collecting timing info
[0m08:02:55.452811 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.67 seconds
[0m08:02:55.453154 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:02:55.454827 [debug] [Thread-1  ]: finished collecting timing info
[0m08:02:55.456149 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:02:55.604156 [info ] [Thread-3  ]: 3 of 9 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 2.90s]
[0m08:02:55.605097 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:02:55.605478 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:02:55.605910 [info ] [Thread-3  ]: 5 of 9 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m08:02:55.607013 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:02:55.607330 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:02:55.607631 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:02:55.617443 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:02:55.618980 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 2.91s]
[0m08:02:55.619512 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:02:55.619761 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:02:55.620033 [debug] [Thread-3  ]: finished collecting timing info
[0m08:02:55.620262 [info ] [Thread-1  ]: 6 of 9 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:02:55.620513 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:02:55.621149 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:02:55.623926 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:02:55.624139 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:02:55.624395 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:02:55.628327 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:02:55.628845 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:02:55.629045 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:02:55.629250 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:02:55.629694 [debug] [Thread-1  ]: finished collecting timing info
[0m08:02:55.630191 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:02:55.632981 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:02:55.633664 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:02:55.633822 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:02:55.633965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:02:55.687924 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.88 seconds
[0m08:02:55.689242 [debug] [Thread-4  ]: finished collecting timing info
[0m08:02:55.689416 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:02:55.926513 [info ] [Thread-4  ]: 4 of 9 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 3.22s]
[0m08:02:55.926840 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:02:55.926966 [debug] [Thread-4  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:02:55.927068 [info ] [Thread-4  ]: 7 of 9 START test positive_value_dim_listings_cleansed_minimum_nights .......... [RUN]
[0m08:02:55.927402 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:02:55.927505 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:02:55.927608 [debug] [Thread-4  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:02:55.930519 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:02:55.932050 [debug] [Thread-4  ]: finished collecting timing info
[0m08:02:55.932160 [debug] [Thread-4  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:02:55.933529 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:02:55.943016 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:02:55.943186 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:02:55.948520 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:02:56.090365 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.3 seconds
[0m08:02:56.091810 [debug] [Thread-2  ]: finished collecting timing info
[0m08:02:56.092000 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:02:56.306097 [info ] [Thread-2  ]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 3.60s]
[0m08:02:56.306599 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:02:56.306802 [debug] [Thread-2  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:02:56.307026 [info ] [Thread-2  ]: 8 of 9 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:02:56.307618 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:02:56.307786 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:02:56.307944 [debug] [Thread-2  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:02:56.312668 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:02:56.313181 [debug] [Thread-2  ]: finished collecting timing info
[0m08:02:56.313336 [debug] [Thread-2  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:02:56.315296 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:02:56.316112 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:02:56.316258 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:02:56.316390 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:02:56.332013 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m08:02:56.333195 [debug] [Thread-3  ]: finished collecting timing info
[0m08:02:56.333370 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:02:56.336977 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m08:02:56.338018 [debug] [Thread-1  ]: finished collecting timing info
[0m08:02:56.338184 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:02:56.470872 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m08:02:56.472587 [debug] [Thread-4  ]: finished collecting timing info
[0m08:02:56.472827 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:02:56.519578 [info ] [Thread-1  ]: 6 of 9 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.90s]
[0m08:02:56.532521 [info ] [Thread-3  ]: 5 of 9 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.93s]
[0m08:02:56.532826 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:02:56.539970 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:02:56.546374 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:02:56.561753 [info ] [Thread-1  ]: 9 of 9 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m08:02:56.562176 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:02:56.562281 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:02:56.562383 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:02:56.567080 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:02:56.568639 [debug] [Thread-1  ]: finished collecting timing info
[0m08:02:56.568770 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:02:56.570279 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:02:56.570960 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:02:56.571064 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:56.571160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:02:56.647023 [info ] [Thread-4  ]: 7 of 9 PASS positive_value_dim_listings_cleansed_minimum_nights ................ [[32mPASS[0m in 0.72s]
[0m08:02:56.647456 [debug] [Thread-4  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:02:57.103034 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m08:02:57.107976 [debug] [Thread-1  ]: finished collecting timing info
[0m08:02:57.108336 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:02:57.249194 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m08:02:57.251223 [debug] [Thread-2  ]: finished collecting timing info
[0m08:02:57.251473 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:02:57.262559 [info ] [Thread-1  ]: 9 of 9 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.70s]
[0m08:02:57.263229 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:02:57.396901 [info ] [Thread-2  ]: 8 of 9 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.09s]
[0m08:02:57.397544 [debug] [Thread-2  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:02:57.398734 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:02:57.399274 [info ] [MainThread]: 
[0m08:02:57.399610 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 6.89 seconds (6.89s).
[0m08:02:57.399914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:57.400073 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:02:57.400227 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:02:57.400384 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m08:02:57.400535 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:02:57.409864 [info ] [MainThread]: 
[0m08:02:57.410170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:57.410437 [info ] [MainThread]: 
[0m08:02:57.410667 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m08:02:57.410957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fece20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fec7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703e040>]}
[0m08:02:57.411165 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:04:47.227857 | 124d538c-5e1c-4baf-8720-cb5e0283db79 ==============================
[0m08:04:47.227883 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:04:47.228305 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:04:47.228415 [debug] [MainThread]: Tracking: tracking
[0m08:04:47.228635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6e0a0>]}
[0m08:04:47.285761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:04:47.286164 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:04:47.294161 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:04:47.322012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '124d538c-5e1c-4baf-8720-cb5e0283db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083250d0>]}
[0m08:04:47.327930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '124d538c-5e1c-4baf-8720-cb5e0283db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819a0d0>]}
[0m08:04:47.328119 [info ] [MainThread]: Found 8 models, 11 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:04:47.328319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '124d538c-5e1c-4baf-8720-cb5e0283db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819a160>]}
[0m08:04:47.329310 [info ] [MainThread]: 
[0m08:04:47.329679 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:04:47.330321 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:04:47.337302 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:04:47.337449 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:04:47.337550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:48.065593 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.73 seconds
[0m08:04:48.067678 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:04:48.315418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '124d538c-5e1c-4baf-8720-cb5e0283db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bea30>]}
[0m08:04:48.316693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:04:48.317186 [info ] [MainThread]: 
[0m08:04:48.322712 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:48.322983 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:04:48.323202 [info ] [Thread-1  ]: 1 of 11 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:04:48.323408 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:04:48.323612 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:04:48.323952 [info ] [Thread-2  ]: 2 of 11 START test consistent_created_at ....................................... [RUN]
[0m08:04:48.324705 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:04:48.324942 [info ] [Thread-3  ]: 3 of 11 START test dim_listings_minimum_nights ................................. [RUN]
[0m08:04:48.325187 [info ] [Thread-4  ]: 4 of 11 START test no_nulls_in_dim_listings .................................... [RUN]
[0m08:04:48.325877 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:04:48.326092 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:48.326827 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:04:48.327526 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:04:48.327741 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:04:48.327969 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:48.328175 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:04:48.328369 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:04:48.328563 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:04:48.341525 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:04:48.341792 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:04:48.341989 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:04:48.344557 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:04:48.347609 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:04:48.357287 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:04:48.357717 [debug] [Thread-1  ]: finished collecting timing info
[0m08:04:48.357906 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:04:48.358086 [debug] [Thread-2  ]: finished collecting timing info
[0m08:04:48.358256 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:48.358395 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:04:48.358561 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:04:48.358696 [debug] [Thread-3  ]: finished collecting timing info
[0m08:04:48.372642 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:04:48.375377 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:04:48.375648 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:04:48.377499 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:04:48.378298 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:04:48.378653 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:04:48.379148 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:04:48.379439 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:04:48.379565 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:04:48.379683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:48.379821 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:04:48.379935 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:04:48.380400 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:04:48.938966 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m08:04:48.944837 [debug] [Thread-2  ]: finished collecting timing info
[0m08:04:48.945112 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:04:49.132127 [info ] [Thread-2  ]: 2 of 11 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.81s]
[0m08:04:49.132840 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:04:49.133034 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:04:49.133287 [info ] [Thread-2  ]: 5 of 11 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m08:04:49.133877 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:04:49.134057 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:04:49.134217 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:04:49.139460 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:04:49.139879 [debug] [Thread-2  ]: finished collecting timing info
[0m08:04:49.140021 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:04:49.142220 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:04:49.142880 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:04:49.143014 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:04:49.143134 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:04:49.211007 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.85 seconds
[0m08:04:49.212836 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:04:49.213339 [debug] [Thread-4  ]: finished collecting timing info
[0m08:04:49.213503 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:04:49.250382 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:04:49.250836 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.87 seconds
[0m08:04:49.252294 [debug] [Thread-1  ]: finished collecting timing info
[0m08:04:49.252442 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:04:49.253492 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:04:49.253611 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:04:49.436112 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m08:04:49.436665 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.06 seconds
[0m08:04:49.437770 [debug] [Thread-4  ]: finished collecting timing info
[0m08:04:49.438676 [debug] [Thread-3  ]: finished collecting timing info
[0m08:04:49.438842 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:04:49.438979 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:04:49.466388 [info ] [Thread-1  ]: 1 of 11 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.14s]
[0m08:04:49.466765 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:49.466923 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:49.467109 [info ] [Thread-1  ]: 6 of 11 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m08:04:49.467564 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:04:49.467697 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:49.467821 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:49.470940 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:04:49.471339 [debug] [Thread-1  ]: finished collecting timing info
[0m08:04:49.471481 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:49.473233 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:04:49.473748 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:04:49.473876 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:04:49.473996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:49.577962 [info ] [Thread-3  ]: 3 of 11 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 1.25s]
[0m08:04:49.578459 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:04:49.578970 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:49.579146 [info ] [Thread-3  ]: 7 of 11 START test not_null_dim_listings_cleansed_listing_id ................... [RUN]
[0m08:04:49.579705 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:04:49.580074 [info ] [Thread-4  ]: 4 of 11 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 1.25s]
[0m08:04:49.580250 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:49.580537 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:04:49.580674 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:49.580815 [debug] [Thread-4  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:04:49.583913 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:04:49.584085 [info ] [Thread-4  ]: 8 of 11 START test positive_value_dim_listings_cleansed_minimum_nights ......... [RUN]
[0m08:04:49.584580 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:04:49.584710 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:04:49.584828 [debug] [Thread-4  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:04:49.588024 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:04:49.588366 [debug] [Thread-3  ]: finished collecting timing info
[0m08:04:49.588512 [debug] [Thread-4  ]: finished collecting timing info
[0m08:04:49.588632 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:49.588774 [debug] [Thread-4  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:04:49.591296 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:04:49.592913 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:04:49.593511 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:04:49.593840 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:04:49.593963 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:04:49.594090 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:04:49.594212 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:04:49.594331 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:04:49.702497 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m08:04:49.704687 [debug] [Thread-2  ]: finished collecting timing info
[0m08:04:49.710457 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:04:49.906220 [info ] [Thread-2  ]: 5 of 11 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 0.77s]
[0m08:04:49.908190 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:04:49.908349 [debug] [Thread-2  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:49.908459 [info ] [Thread-2  ]: 9 of 11 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:04:49.908819 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:04:49.908928 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:49.909040 [debug] [Thread-2  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:49.913554 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:04:49.914070 [debug] [Thread-2  ]: finished collecting timing info
[0m08:04:49.914654 [debug] [Thread-2  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:49.916078 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:04:49.916991 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:04:49.917123 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:04:49.917224 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:04:50.057773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
[0m08:04:50.059206 [debug] [Thread-1  ]: finished collecting timing info
[0m08:04:50.059409 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:04:50.196527 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m08:04:50.197515 [debug] [Thread-4  ]: finished collecting timing info
[0m08:04:50.197658 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:04:50.269283 [info ] [Thread-1  ]: 6 of 11 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 0.80s]
[0m08:04:50.270032 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:50.270463 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:04:50.270801 [info ] [Thread-1  ]: 10 of 11 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:04:50.271345 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:04:50.271533 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:04:50.271699 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:04:50.276787 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:04:50.277251 [debug] [Thread-1  ]: finished collecting timing info
[0m08:04:50.277398 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:04:50.279204 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:04:50.279820 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:04:50.279958 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:04:50.280077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:50.534017 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.94 seconds
[0m08:04:50.535239 [debug] [Thread-3  ]: finished collecting timing info
[0m08:04:50.535679 [info ] [Thread-4  ]: 8 of 11 PASS positive_value_dim_listings_cleansed_minimum_nights ............... [[32mPASS[0m in 0.95s]
[0m08:04:50.535794 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:04:50.536522 [debug] [Thread-4  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:04:50.537836 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:50.538130 [info ] [Thread-4  ]: 11 of 11 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:04:50.538610 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:04:50.538720 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:50.538843 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:50.541412 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:04:50.542224 [debug] [Thread-4  ]: finished collecting timing info
[0m08:04:50.542348 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:50.544340 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:04:50.545750 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:04:50.545871 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:04:50.545973 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:04:50.692831 [info ] [Thread-3  ]: 7 of 11 PASS not_null_dim_listings_cleansed_listing_id ......................... [[32mPASS[0m in 1.11s]
[0m08:04:50.693355 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:50.702429 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m08:04:50.703781 [debug] [Thread-2  ]: finished collecting timing info
[0m08:04:50.703969 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:04:50.779153 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.5 seconds
[0m08:04:50.786581 [debug] [Thread-1  ]: finished collecting timing info
[0m08:04:50.786824 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:04:50.871784 [info ] [Thread-2  ]: 9 of 11 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.96s]
[0m08:04:50.872235 [debug] [Thread-2  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:50.951212 [info ] [Thread-1  ]: 10 of 11 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.68s]
[0m08:04:50.951781 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:04:51.001669 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.46 seconds
[0m08:04:51.002925 [debug] [Thread-4  ]: finished collecting timing info
[0m08:04:51.003096 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:04:51.146126 [info ] [Thread-4  ]: 11 of 11 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.61s]
[0m08:04:51.146949 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:51.148563 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:04:51.149287 [info ] [MainThread]: 
[0m08:04:51.149729 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m08:04:51.150081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:51.150264 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:04:51.150440 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:04:51.150614 [debug] [MainThread]: Connection 'test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m08:04:51.150783 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:04:51.161990 [info ] [MainThread]: 
[0m08:04:51.162351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:04:51.162699 [info ] [MainThread]: 
[0m08:04:51.162986 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m08:04:51.163385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109841460>]}
[0m08:04:51.163660 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:05:03.674466 | 010d4a12-6d0f-4550-8e1f-cd46171f4220 ==============================
[0m08:05:03.674494 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:05:03.674921 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m08:05:03.675051 [debug] [MainThread]: Tracking: tracking
[0m08:05:03.675277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119eff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119effa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119fe040>]}
[0m08:05:03.729492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:05:03.729710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:05:03.734377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '010d4a12-6d0f-4550-8e1f-cd46171f4220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dac0d0>]}
[0m08:05:03.741001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '010d4a12-6d0f-4550-8e1f-cd46171f4220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c57670>]}
[0m08:05:03.741190 [info ] [MainThread]: Found 8 models, 11 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:05:03.741395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010d4a12-6d0f-4550-8e1f-cd46171f4220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c57520>]}
[0m08:05:03.742507 [info ] [MainThread]: 
[0m08:05:03.742910 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:05:03.743503 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:05:03.750661 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:05:03.750788 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:05:03.750893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:04.622676 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.87 seconds
[0m08:05:04.625012 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:05:04.781376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010d4a12-6d0f-4550-8e1f-cd46171f4220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c57460>]}
[0m08:05:04.782333 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:05:04.782805 [info ] [MainThread]: 
[0m08:05:04.788296 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m08:05:04.788543 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m08:05:04.789120 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m08:05:04.789315 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m08:05:04.789499 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m08:05:04.790153 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m08:05:04.790375 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m08:05:04.790867 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m08:05:04.791325 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m08:05:04.791515 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m08:05:04.791715 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m08:05:04.791891 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m08:05:04.792061 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m08:05:04.792231 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m08:05:04.796826 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m08:05:04.797042 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m08:05:04.797196 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m08:05:04.799497 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m08:05:04.802021 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m08:05:04.803674 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m08:05:04.803956 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.804163 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.804771 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m08:05:04.804984 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m08:05:04.805120 [debug] [Thread-3  ]: finished collecting timing info
[0m08:05:04.805235 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.805399 [debug] [Thread-1  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m08:05:04.805632 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.806045 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m08:05:04.806436 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m08:05:04.806811 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m08:05:04.807210 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m08:05:04.807369 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m08:05:04.807599 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m08:05:04.807778 [debug] [Thread-1  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m08:05:04.807962 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m08:05:04.808326 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:05:04.808676 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m08:05:04.808822 [debug] [Thread-1  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m08:05:04.809158 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:05:04.809296 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m08:05:04.809431 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m08:05:04.812087 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.812259 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m08:05:04.812408 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m08:05:04.812547 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m08:05:04.812686 [debug] [Thread-1  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m08:05:04.812816 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m08:05:04.821261 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:05:04.841081 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m08:05:04.841254 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.845706 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m08:05:04.846302 [debug] [Thread-1  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m08:05:04.846760 [debug] [Thread-3  ]: finished collecting timing info
[0m08:05:04.846878 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.847053 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m08:05:04.847207 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m08:05:04.847313 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.847431 [debug] [Thread-3  ]: finished collecting timing info
[0m08:05:04.847532 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.847631 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m08:05:04.848001 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m08:05:04.848367 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m08:05:04.848489 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.848731 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:05:04.848837 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:05:04.849190 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m08:05:04.849288 [debug] [Thread-3  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m08:05:04.849544 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:05:04.849799 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:05:04.850061 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m08:05:04.850286 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:05:04.850392 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:05:04.850493 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:05:04.850733 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:05:04.850834 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m08:05:04.850937 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:05:04.851035 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:05:04.851130 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m08:05:04.851229 [debug] [Thread-3  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m08:05:04.858423 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:05:04.861948 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:05:04.862102 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m08:05:04.863895 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:05:04.867126 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:05:04.867312 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.867515 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:05:04.867648 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.868042 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:05:04.868145 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.868327 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:05:04.868466 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.868561 [debug] [Thread-3  ]: finished collecting timing info
[0m08:05:04.868686 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:05:04.868960 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:05:04.869065 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m08:05:04.869174 [debug] [Thread-3  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m08:05:04.869276 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.869379 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:05:04.869475 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.869572 [debug] [Thread-3  ]: finished collecting timing info
[0m08:05:04.869864 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:05:04.869978 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:05:04.870278 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m08:05:04.870549 [debug] [Thread-3  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m08:05:04.870664 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:05:04.876088 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:05:04.876327 [debug] [Thread-4  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:05:04.876492 [debug] [Thread-3  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:05:04.876832 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:05:04.877134 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:05:04.877404 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:05:04.877525 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:05:04.877622 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.877721 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:05:04.877824 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:05:04.877923 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:05:04.878028 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:05:04.878122 [debug] [Thread-4  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:05:04.878220 [debug] [Thread-3  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:05:04.879846 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:05:04.879967 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.881477 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:05:04.887974 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:05:04.888393 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:05:04.888575 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:05:04.888716 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.888836 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:05:04.888924 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.889066 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:05:04.889178 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:05:04.889428 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:05:04.889538 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:05:04.890021 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.890137 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:05:04.890581 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.891002 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:05:04.891109 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:05:04.891416 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:05:04.891540 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:05:04.894515 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:05:04.894808 [debug] [Thread-4  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:05:04.895492 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:05:04.895806 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:05:04.895933 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:05:04.896054 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:05:04.896146 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.896258 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:05:04.896380 [debug] [Thread-4  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:05:04.896500 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:05:04.898654 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:05:04.900927 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:05:04.901054 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.901474 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:05:04.901603 [debug] [Thread-1  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:05:04.901926 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:05:04.902025 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.902113 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.902215 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:05:04.902336 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:05:04.902439 [debug] [Thread-4  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:05:04.902537 [debug] [Thread-1  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:05:04.902638 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.902737 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.906985 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:05:04.907327 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:05:04.907609 [debug] [Thread-4  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:05:04.907781 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:05:04.907946 [debug] [Thread-4  ]: Began running node analysis.learn_dbt.full_moon_no_sleep
[0m08:05:04.908054 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.908310 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:05:04.908548 [debug] [Thread-4  ]: Acquiring new snowflake connection "analysis.learn_dbt.full_moon_no_sleep"
[0m08:05:04.908653 [debug] [Thread-1  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:05:04.908753 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:05:04.908853 [debug] [Thread-4  ]: Began compiling node analysis.learn_dbt.full_moon_no_sleep
[0m08:05:04.908953 [debug] [Thread-1  ]: finished collecting timing info
[0m08:05:04.909051 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:05:04.909145 [debug] [Thread-4  ]: Compiling analysis.learn_dbt.full_moon_no_sleep
[0m08:05:04.909414 [debug] [Thread-1  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:05:04.911516 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:05:04.912917 [debug] [Thread-4  ]: Writing injected SQL for node "analysis.learn_dbt.full_moon_no_sleep"
[0m08:05:04.913215 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.913329 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:05:04.913432 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.913527 [debug] [Thread-2  ]: finished collecting timing info
[0m08:05:04.913631 [debug] [Thread-4  ]: Began executing node analysis.learn_dbt.full_moon_no_sleep
[0m08:05:04.913919 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:05:04.914023 [debug] [Thread-4  ]: finished collecting timing info
[0m08:05:04.914352 [debug] [Thread-4  ]: Finished running node analysis.learn_dbt.full_moon_no_sleep
[0m08:05:05.500706 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 0.61 seconds
[0m08:05:05.502720 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:05:05.503379 [debug] [Thread-3  ]: finished collecting timing info
[0m08:05:05.503593 [debug] [Thread-3  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:05:05.503784 [debug] [Thread-3  ]: finished collecting timing info
[0m08:05:05.503990 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:05:05.659433 [debug] [Thread-3  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:05:05.660750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:05.660989 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:05:05.661169 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:05:05.661338 [debug] [MainThread]: Connection 'test.learn_dbt.no_nulls_in_dim_listings' was properly closed.
[0m08:05:05.661496 [debug] [MainThread]: Connection 'analysis.learn_dbt.full_moon_no_sleep' was properly closed.
[0m08:05:05.712448 [info ] [MainThread]: Done.
[0m08:05:05.715973 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m08:05:05.716100 [info ] [MainThread]: Building catalog
[0m08:05:05.717241 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m08:05:05.721539 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m08:05:05.721664 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m08:05:05.721764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:07.785357 [debug] [ThreadPool]: SQL status: SUCCESS 87 in 2.06 seconds
[0m08:05:07.807894 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m08:05:07.991482 [info ] [MainThread]: Catalog written to /Users/nigelbrown/learn-dbt/target/catalog.json
[0m08:05:07.992029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119eff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120fb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120fbb20>]}
[0m08:05:07.992279 [debug] [MainThread]: Flushing usage events
[0m08:05:08.447355 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:05:08.448179 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-10-17 08:06:00.083802 | 11064f18-a2a7-4c9c-b669-38fb4e34a29a ==============================
[0m08:06:00.083825 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:06:00.084327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:06:00.084454 [debug] [MainThread]: Tracking: tracking
[0m08:06:00.084684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109813e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109813eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109813f10>]}
[0m08:06:00.129698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:06:00.129904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:06:00.133914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11064f18-a2a7-4c9c-b669-38fb4e34a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bed0d0>]}
[0m08:06:00.141048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11064f18-a2a7-4c9c-b669-38fb4e34a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996a550>]}
[0m08:06:00.141279 [info ] [MainThread]: Found 8 models, 11 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:06:00.141473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11064f18-a2a7-4c9c-b669-38fb4e34a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996a400>]}
[0m08:06:00.142608 [info ] [MainThread]: 
[0m08:06:00.143024 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:06:00.143732 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:06:00.151386 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:06:00.151572 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:06:00.151680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:01.002801 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.85 seconds
[0m08:06:01.005435 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:06:01.181745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11064f18-a2a7-4c9c-b669-38fb4e34a29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996a1f0>]}
[0m08:06:01.183481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:06:01.184161 [info ] [MainThread]: 
[0m08:06:01.189415 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:01.189798 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:06:01.190046 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:01.190268 [info ] [Thread-1  ]: 1 of 11 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:06:01.190500 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:01.190775 [info ] [Thread-2  ]: 2 of 11 START test consistent_created_at ....................................... [RUN]
[0m08:06:01.191037 [info ] [Thread-3  ]: 3 of 11 START test dim_listings_minimum_nights ................................. [RUN]
[0m08:06:01.191958 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:01.192221 [info ] [Thread-4  ]: 4 of 11 START test no_nulls_in_dim_listings .................................... [RUN]
[0m08:06:01.193019 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:06:01.193782 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:01.194026 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:01.194763 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:01.194959 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:06:01.195150 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:01.195363 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:01.195550 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:01.195732 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:06:01.195917 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:06:01.210824 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:01.211056 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:01.213574 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:06:01.215639 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:01.224642 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:01.224837 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:01.225118 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:06:01.225294 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:01.225424 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:01.225571 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:06:01.225718 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:01.225851 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:06:01.239785 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:01.240502 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:01.243425 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:06:01.245601 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:01.246978 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:01.247104 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:06:01.247213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:01.248411 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:01.248741 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:06:01.248891 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:06:01.249007 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:06:01.249128 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:06:01.249235 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:06:02.010353 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.76 seconds
[0m08:06:02.016062 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:02.016385 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:06:02.201905 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m08:06:02.203370 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.96 seconds
[0m08:06:02.206498 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:02.208617 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:02.208928 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:06:02.209190 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:06:02.224134 [info ] [Thread-3  ]: 3 of 11 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 1.03s]
[0m08:06:02.224952 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:02.225275 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:02.225689 [info ] [Thread-3  ]: 5 of 11 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m08:06:02.226759 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:02.227024 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:02.227272 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:02.236557 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:02.237611 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 1.01 seconds
[0m08:06:02.239436 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:02.239868 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:02.240068 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:02.240277 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:02.240466 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:02.243037 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:02.245376 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:02.246172 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:02.246797 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:02.246955 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:06:02.247128 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:06:02.247284 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:06:02.391778 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m08:06:02.393472 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:02.393715 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:06:02.404398 [info ] [Thread-1  ]: 1 of 11 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.21s]
[0m08:06:02.404916 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:02.405135 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:02.405395 [info ] [Thread-1  ]: 6 of 11 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m08:06:02.406025 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:02.406203 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:02.406379 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:02.410561 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:02.411035 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:02.411204 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:02.413520 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:02.414195 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:02.414358 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:06:02.414507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:02.418124 [info ] [Thread-2  ]: 2 of 11 PASS consistent_created_at ............................................. [[32mPASS[0m in 1.23s]
[0m08:06:02.418767 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:06:02.419206 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:02.419637 [info ] [Thread-2  ]: 7 of 11 START test not_null_dim_listings_cleansed_listing_id ................... [RUN]
[0m08:06:02.420125 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:02.420268 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:02.420401 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:02.423588 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:02.424004 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:02.424155 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:02.427027 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:02.427607 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:02.427760 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:06:02.427900 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:06:02.645205 [info ] [Thread-4  ]: 4 of 11 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 1.45s]
[0m08:06:02.645781 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:02.645987 [debug] [Thread-4  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:02.646234 [info ] [Thread-4  ]: 8 of 11 START test positive_value_dim_listings_cleansed_minimum_nights ......... [RUN]
[0m08:06:02.646847 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:02.647018 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:02.647179 [debug] [Thread-4  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:02.651255 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:02.651674 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:02.651834 [debug] [Thread-4  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:02.653776 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:02.654325 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:02.654465 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:06:02.654592 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:06:02.858441 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m08:06:02.859618 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:02.859776 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:06:03.021823 [info ] [Thread-3  ]: 5 of 11 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 0.80s]
[0m08:06:03.022262 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:03.022419 [debug] [Thread-3  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:03.022597 [info ] [Thread-3  ]: 9 of 11 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:06:03.023065 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:03.023198 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:03.023319 [debug] [Thread-3  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:03.029251 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:03.029828 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
[0m08:06:03.031008 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:03.031266 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:06:03.031625 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:03.031863 [debug] [Thread-3  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:03.066899 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:03.068700 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m08:06:03.069843 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:03.070169 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:06:03.070648 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:03.071989 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:06:03.072511 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:06:03.164132 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.51 seconds
[0m08:06:03.165603 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:03.165789 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:06:03.231299 [info ] [Thread-2  ]: 7 of 11 PASS not_null_dim_listings_cleansed_listing_id ......................... [[32mPASS[0m in 0.81s]
[0m08:06:03.231829 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:03.232313 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:03.232749 [info ] [Thread-2  ]: 10 of 11 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:06:03.233667 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:03.233880 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:03.234129 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:03.239808 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:03.240312 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:03.240487 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:03.242592 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:03.243241 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:03.243385 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:06:03.243518 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:06:03.294496 [info ] [Thread-1  ]: 6 of 11 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 0.89s]
[0m08:06:03.312690 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:03.312844 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:03.312949 [info ] [Thread-1  ]: 11 of 11 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:06:03.313343 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:03.313446 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:03.313548 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:03.316078 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:03.330113 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:03.330263 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:03.331794 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:03.332399 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:03.332537 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:06:03.332695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:03.335572 [info ] [Thread-4  ]: 8 of 11 PASS positive_value_dim_listings_cleansed_minimum_nights ............... [[32mPASS[0m in 0.69s]
[0m08:06:03.336240 [debug] [Thread-4  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:03.627226 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m08:06:03.628351 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:03.628506 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:06:03.726543 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.48 seconds
[0m08:06:03.728005 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:03.728224 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:06:03.780916 [info ] [Thread-3  ]: 9 of 11 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.76s]
[0m08:06:03.781649 [debug] [Thread-3  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:03.783547 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m08:06:03.785394 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:03.785686 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:06:03.866145 [info ] [Thread-2  ]: 10 of 11 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.63s]
[0m08:06:03.866824 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:03.956546 [info ] [Thread-1  ]: 11 of 11 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.64s]
[0m08:06:03.957223 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:03.958496 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:06:03.959053 [info ] [MainThread]: 
[0m08:06:03.959385 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m08:06:03.959691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:03.959845 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:06:03.959999 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:06:03.960150 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:06:03.960301 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:06:03.969734 [info ] [MainThread]: 
[0m08:06:03.970017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:06:03.970282 [info ] [MainThread]: 
[0m08:06:03.970507 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m08:06:03.970786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f39a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f39b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f39f70>]}
[0m08:06:03.970985 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:06:14.187470 | 1d83dd57-94f3-42c0-aebc-5f46627ebfb9 ==============================
[0m08:06:14.187492 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:06:14.187975 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:06:14.188103 [debug] [MainThread]: Tracking: tracking
[0m08:06:14.188338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002bf10>]}
[0m08:06:14.232645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:06:14.233040 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:06:14.241066 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:06:14.272269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d83dd57-94f3-42c0-aebc-5f46627ebfb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046a0d0>]}
[0m08:06:14.278623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d83dd57-94f3-42c0-aebc-5f46627ebfb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016e550>]}
[0m08:06:14.278809 [info ] [MainThread]: Found 8 models, 12 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:06:14.279003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d83dd57-94f3-42c0-aebc-5f46627ebfb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016e430>]}
[0m08:06:14.280054 [info ] [MainThread]: 
[0m08:06:14.280428 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:06:14.281086 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:06:14.288540 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:06:14.288745 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:06:14.288849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:14.982596 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.69 seconds
[0m08:06:14.985711 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:06:15.150478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d83dd57-94f3-42c0-aebc-5f46627ebfb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016e130>]}
[0m08:06:15.151467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:06:15.151932 [info ] [MainThread]: 
[0m08:06:15.155800 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:15.156076 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:06:15.156285 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:06:15.156505 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:15.156712 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:15.156927 [info ] [Thread-2  ]: 2 of 12 START test consistent_created_at ....................................... [RUN]
[0m08:06:15.157652 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:15.157866 [info ] [Thread-3  ]: 3 of 12 START test dim_listings_minimum_nights ................................. [RUN]
[0m08:06:15.158071 [info ] [Thread-4  ]: 4 of 12 START test no_nulls_in_dim_listings .................................... [RUN]
[0m08:06:15.158842 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:06:15.159060 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:15.159698 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:15.160250 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:15.160414 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:06:15.160605 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:15.160769 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:15.160925 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:15.161086 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:06:15.173562 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:15.173760 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:06:15.173908 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:15.176774 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:06:15.178871 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:15.185371 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:15.187315 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:15.187582 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:15.187794 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:06:15.187915 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:15.188043 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:15.201258 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:15.201429 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:06:15.201582 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:15.201720 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:06:15.204811 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:15.205317 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:15.207392 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:06:15.207736 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:06:15.208270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:15.208568 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:06:15.209066 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:06:15.209465 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:06:15.209965 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:06:15.210140 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:06:15.210265 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:06:15.685067 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.48 seconds
[0m08:06:15.686449 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:15.686805 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:15.686956 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:15.688919 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:15.689562 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:06:15.689692 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:06:15.787675 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m08:06:15.794386 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:15.794666 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:06:15.821823 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m08:06:15.823429 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:15.823680 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:06:15.838547 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m08:06:15.840503 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:15.840762 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:06:15.937858 [info ] [Thread-4  ]: 4 of 12 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 0.78s]
[0m08:06:15.938737 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:06:15.939108 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:15.939531 [info ] [Thread-4  ]: 5 of 12 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m08:06:15.940447 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:15.940691 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:15.940932 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:15.994026 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:15.994952 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:15.995131 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:15.997094 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:15.997493 [info ] [Thread-3  ]: 3 of 12 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 0.84s]
[0m08:06:15.997803 [info ] [Thread-1  ]: 1 of 12 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.84s]
[0m08:06:15.998231 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:06:15.998839 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:06:15.999054 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:15.999292 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622
[0m08:06:15.999558 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:06:15.999767 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:15.999975 [info ] [Thread-3  ]: 6 of 12 START test not_null_dim_hosts_cleansed_name ............................ [RUN]
[0m08:06:16.000138 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:06:16.000287 [info ] [Thread-1  ]: 7 of 12 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m08:06:16.000788 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622"
[0m08:06:16.002020 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:16.002179 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622
[0m08:06:16.002297 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:16.002423 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622
[0m08:06:16.002531 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:16.005537 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622"
[0m08:06:16.008676 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:16.009532 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:16.009692 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:16.009851 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:16.009995 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622
[0m08:06:16.011842 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:16.013669 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622"
[0m08:06:16.014284 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:16.014580 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622"
[0m08:06:16.014680 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:06:16.014786 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from airbnb.dev.dim_hosts_cleansed
where name is null



      
    ) dbt_internal_test
[0m08:06:16.014890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:16.014992 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:06:16.032730 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m08:06:16.034160 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:16.034341 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:06:16.459348 [info ] [Thread-2  ]: 2 of 12 PASS consistent_created_at ............................................. [[32mPASS[0m in 1.30s]
[0m08:06:16.459900 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:06:16.460092 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:16.460302 [info ] [Thread-2  ]: 8 of 12 START test not_null_dim_listings_cleansed_listing_id ................... [RUN]
[0m08:06:16.460834 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:16.460974 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:16.461107 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:16.464527 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:16.464967 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:16.465118 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:16.466940 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:16.467502 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:16.467635 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:06:16.467758 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:06:16.590895 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
[0m08:06:16.592024 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:16.592181 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:06:16.611209 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m08:06:16.612213 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:16.612362 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:06:16.624540 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a7af26-3201-ed86-0000-00015aaeb069
[0m08:06:16.624743 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'NAME'
[0m08:06:16.625028 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:16.625195 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622: Close
[0m08:06:16.787182 [info ] [Thread-1  ]: 7 of 12 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 0.79s]
[0m08:06:16.787679 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:16.787862 [debug] [Thread-1  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:16.788051 [info ] [Thread-1  ]: 9 of 12 START test positive_value_dim_listings_cleansed_minimum_nights ......... [RUN]
[0m08:06:16.788527 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:16.788662 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:16.788793 [debug] [Thread-1  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:16.792866 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:16.793455 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:16.793607 [debug] [Thread-1  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:16.795492 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:16.795873 [debug] [Thread-3  ]: Database Error in test not_null_dim_hosts_cleansed_name (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'NAME'
  compiled Code at target/run/learn_dbt/models/schema.yml/not_null_dim_hosts_cleansed_name.sql
[0m08:06:16.796368 [error] [Thread-3  ]: 6 of 12 ERROR not_null_dim_hosts_cleansed_name ................................. [[31mERROR[0m in 0.80s]
[0m08:06:16.796710 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_name.e070dbd622
[0m08:06:16.796913 [debug] [Thread-3  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:16.797276 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:06:16.797446 [info ] [Thread-3  ]: 10 of 12 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:06:16.797791 [info ] [Thread-4  ]: 5 of 12 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 0.86s]
[0m08:06:16.797935 [debug] [Thread-1  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:06:16.798323 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:16.798582 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:06:16.798702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:16.798832 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:16.798965 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:16.799479 [debug] [Thread-3  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:16.799963 [info ] [Thread-4  ]: 11 of 12 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:06:16.805103 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:16.805878 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:16.806249 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:16.806368 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:16.810134 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:16.810437 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:16.810566 [debug] [Thread-3  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:16.812161 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:16.812309 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:16.812440 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:16.813969 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:16.814506 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:16.814636 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:06:16.814743 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:06:16.815083 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:06:16.815504 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:06:16.815965 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:06:16.925456 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.46 seconds
[0m08:06:16.926702 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:16.926903 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:06:17.165750 [info ] [Thread-2  ]: 8 of 12 PASS not_null_dim_listings_cleansed_listing_id ......................... [[32mPASS[0m in 0.71s]
[0m08:06:17.166126 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:17.166251 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:17.166352 [info ] [Thread-2  ]: 12 of 12 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:06:17.166687 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:17.166791 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:17.166888 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:17.169307 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:17.170309 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:17.170421 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:17.171843 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:17.172349 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:17.172452 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:06:17.172710 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:06:17.281650 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.48 seconds
[0m08:06:17.282859 [debug] [Thread-1  ]: finished collecting timing info
[0m08:06:17.283034 [debug] [Thread-1  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:06:17.369326 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m08:06:17.376000 [debug] [Thread-4  ]: finished collecting timing info
[0m08:06:17.382400 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:06:17.402218 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.59 seconds
[0m08:06:17.407340 [debug] [Thread-3  ]: finished collecting timing info
[0m08:06:17.407816 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:06:17.492250 [info ] [Thread-1  ]: 9 of 12 PASS positive_value_dim_listings_cleansed_minimum_nights ............... [[32mPASS[0m in 0.70s]
[0m08:06:17.492996 [debug] [Thread-1  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:06:17.567078 [info ] [Thread-4  ]: 11 of 12 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.76s]
[0m08:06:17.567599 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:06:17.612422 [info ] [Thread-3  ]: 10 of 12 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.81s]
[0m08:06:17.613054 [debug] [Thread-3  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:17.637438 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.46 seconds
[0m08:06:17.638965 [debug] [Thread-2  ]: finished collecting timing info
[0m08:06:17.639159 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:06:17.781854 [info ] [Thread-2  ]: 12 of 12 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.62s]
[0m08:06:17.782677 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:17.784315 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:06:17.785060 [info ] [MainThread]: 
[0m08:06:17.785508 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m08:06:17.785920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:17.786132 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:06:17.786347 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:06:17.786551 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:06:17.786757 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:06:17.799075 [info ] [MainThread]: 
[0m08:06:17.799492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:06:17.799839 [info ] [MainThread]: 
[0m08:06:17.800138 [error] [MainThread]: [33mDatabase Error in test not_null_dim_hosts_cleansed_name (models/schema.yml)[0m
[0m08:06:17.800426 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
[0m08:06:17.800707 [error] [MainThread]:   invalid identifier 'NAME'
[0m08:06:17.800991 [error] [MainThread]:   compiled Code at target/run/learn_dbt/models/schema.yml/not_null_dim_hosts_cleansed_name.sql
[0m08:06:17.801287 [info ] [MainThread]: 
[0m08:06:17.801568 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m08:06:17.801890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016e280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112028c40>]}
[0m08:06:17.802104 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:08:40.198858 | 96ea443c-60fd-4007-a27d-3a3e425821d4 ==============================
[0m08:08:40.198881 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:08:40.199563 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:08:40.199706 [debug] [MainThread]: Tracking: tracking
[0m08:08:40.199950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee7e80>]}
[0m08:08:40.253357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:08:40.253762 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:08:40.261659 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:08:40.293152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96ea443c-60fd-4007-a27d-3a3e425821d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920f0d0>]}
[0m08:08:40.299534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96ea443c-60fd-4007-a27d-3a3e425821d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109062760>]}
[0m08:08:40.299721 [info ] [MainThread]: Found 8 models, 12 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:08:40.299918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96ea443c-60fd-4007-a27d-3a3e425821d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c6070>]}
[0m08:08:40.300979 [info ] [MainThread]: 
[0m08:08:40.301366 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:08:40.302033 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:08:40.309392 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:08:40.309574 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:08:40.309673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:08:41.088762 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.78 seconds
[0m08:08:41.093072 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:08:41.251353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96ea443c-60fd-4007-a27d-3a3e425821d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109062400>]}
[0m08:08:41.252502 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:08:41.253096 [info ] [MainThread]: 
[0m08:08:41.259448 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:08:41.259784 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:08:41.260039 [info ] [Thread-1  ]: 1 of 12 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:08:41.260300 [debug] [Thread-3  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:08:41.260533 [debug] [Thread-4  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:08:41.260787 [info ] [Thread-2  ]: 2 of 12 START test consistent_created_at ....................................... [RUN]
[0m08:08:41.261622 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:08:41.261844 [info ] [Thread-3  ]: 3 of 12 START test dim_listings_minimum_nights ................................. [RUN]
[0m08:08:41.262067 [info ] [Thread-4  ]: 4 of 12 START test no_nulls_in_dim_listings .................................... [RUN]
[0m08:08:41.262895 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:08:41.263106 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:08:41.263806 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:08:41.264468 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:08:41.264670 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:08:41.264900 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:08:41.265089 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:08:41.265270 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:08:41.265458 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:08:41.277677 [debug] [Thread-3  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:08:41.278946 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:08:41.279188 [debug] [Thread-4  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:08:41.282579 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:08:41.284932 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:08:41.293759 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:08:41.294190 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:08:41.294345 [debug] [Thread-1  ]: finished collecting timing info
[0m08:08:41.294464 [debug] [Thread-2  ]: finished collecting timing info
[0m08:08:41.294584 [debug] [Thread-3  ]: finished collecting timing info
[0m08:08:41.294715 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:08:41.294865 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:08:41.294991 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:08:41.295113 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:08:41.309028 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:08:41.310993 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:08:41.313461 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:08:41.314446 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:08:41.314562 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:08:41.314985 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:08:41.315305 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:08:41.315404 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:08:41.315552 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:08:41.315666 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:08:41.316180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:08:41.316680 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:08:41.852103 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.54 seconds
[0m08:08:41.857746 [debug] [Thread-3  ]: finished collecting timing info
[0m08:08:41.857988 [debug] [Thread-3  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:08:41.949402 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.65 seconds
[0m08:08:41.951521 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:08:41.952162 [debug] [Thread-4  ]: finished collecting timing info
[0m08:08:41.952399 [debug] [Thread-4  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:08:41.994835 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:08:41.995666 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:08:41.995796 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:08:42.002184 [info ] [Thread-3  ]: 3 of 12 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 0.74s]
[0m08:08:42.002524 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:08:42.002667 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:08:42.002827 [info ] [Thread-3  ]: 5 of 12 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m08:08:42.003258 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:08:42.003385 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:08:42.003502 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:08:42.007879 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:08:42.008896 [debug] [Thread-3  ]: finished collecting timing info
[0m08:08:42.009044 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:08:42.010741 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:08:42.011438 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:08:42.011672 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:08:42.011785 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:08:42.038485 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.72 seconds
[0m08:08:42.039517 [debug] [Thread-2  ]: finished collecting timing info
[0m08:08:42.039676 [debug] [Thread-2  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:08:42.085494 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.09 seconds
[0m08:08:42.086604 [debug] [Thread-4  ]: finished collecting timing info
[0m08:08:42.086760 [debug] [Thread-4  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:08:42.110799 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m08:08:42.111816 [debug] [Thread-1  ]: finished collecting timing info
[0m08:08:42.111984 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:08:42.182456 [info ] [Thread-2  ]: 2 of 12 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.92s]
[0m08:08:42.182936 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:08:42.183137 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:08:42.183371 [info ] [Thread-2  ]: 6 of 12 START test not_null_dim_hosts_cleansed_host_name ....................... [RUN]
[0m08:08:42.183957 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:08:42.184126 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:08:42.184281 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:08:42.188254 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:08:42.201379 [debug] [Thread-2  ]: finished collecting timing info
[0m08:08:42.219496 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:08:42.227748 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:08:42.262397 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:08:42.264687 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from airbnb.dev.dim_hosts_cleansed
where host_name is null



      
    ) dbt_internal_test
[0m08:08:42.264795 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:08:42.373599 [info ] [Thread-4  ]: 4 of 12 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 1.11s]
[0m08:08:42.374044 [info ] [Thread-1  ]: 1 of 12 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.11s]
[0m08:08:42.374445 [debug] [Thread-4  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:08:42.374777 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:08:42.374942 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:08:42.375146 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:08:42.375347 [info ] [Thread-4  ]: 7 of 12 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m08:08:42.375499 [info ] [Thread-1  ]: 8 of 12 START test not_null_dim_listings_cleansed_listing_id ................... [RUN]
[0m08:08:42.375967 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:08:42.376421 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:08:42.376564 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:08:42.376697 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:08:42.376831 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:08:42.376958 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:08:42.381302 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:08:42.384348 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:08:42.384785 [debug] [Thread-4  ]: finished collecting timing info
[0m08:08:42.384933 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:08:42.385062 [debug] [Thread-1  ]: finished collecting timing info
[0m08:08:42.386942 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:08:42.387646 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:08:42.389902 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:08:42.390429 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:08:42.390562 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:08:42.390908 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:08:42.391036 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:08:42.391349 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:08:42.392543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:08:42.605779 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.59 seconds
[0m08:08:42.644295 [debug] [Thread-3  ]: finished collecting timing info
[0m08:08:42.657422 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:08:42.896733 [info ] [Thread-3  ]: 5 of 12 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 0.89s]
[0m08:08:42.897605 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:08:42.897916 [debug] [Thread-3  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:08:42.898238 [info ] [Thread-3  ]: 9 of 12 START test positive_value_dim_listings_cleansed_minimum_nights ......... [RUN]
[0m08:08:42.899021 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:08:42.899239 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:08:42.899448 [debug] [Thread-3  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:08:42.906205 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:08:42.908047 [debug] [Thread-3  ]: finished collecting timing info
[0m08:08:42.908257 [debug] [Thread-3  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:08:42.910972 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:08:42.913447 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:08:42.913663 [debug] [Thread-3  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:08:42.913831 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:08:42.953348 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m08:08:42.955155 [debug] [Thread-2  ]: finished collecting timing info
[0m08:08:42.955353 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m08:08:43.029070 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m08:08:43.030708 [debug] [Thread-1  ]: finished collecting timing info
[0m08:08:43.030981 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:08:43.031688 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m08:08:43.033316 [debug] [Thread-4  ]: finished collecting timing info
[0m08:08:43.033944 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:08:43.135947 [info ] [Thread-2  ]: 6 of 12 PASS not_null_dim_hosts_cleansed_host_name ............................. [[32mPASS[0m in 0.95s]
[0m08:08:43.146691 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:08:43.147107 [debug] [Thread-2  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:08:43.147227 [info ] [Thread-2  ]: 10 of 12 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:08:43.147582 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:08:43.147688 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:08:43.147792 [debug] [Thread-2  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:08:43.152354 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:08:43.165783 [debug] [Thread-2  ]: finished collecting timing info
[0m08:08:43.165936 [debug] [Thread-2  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:08:43.167440 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:08:43.168292 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:08:43.168418 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:08:43.168518 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:08:43.463508 [info ] [Thread-1  ]: 8 of 12 PASS not_null_dim_listings_cleansed_listing_id ......................... [[32mPASS[0m in 1.09s]
[0m08:08:43.463936 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:08:43.464419 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:08:43.464616 [info ] [Thread-1  ]: 11 of 12 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:08:43.465090 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:08:43.465444 [info ] [Thread-4  ]: 7 of 12 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 1.09s]
[0m08:08:43.465584 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:08:43.465859 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:08:43.465990 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:08:43.466119 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:08:43.470966 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:08:43.471149 [info ] [Thread-4  ]: 12 of 12 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:08:43.471616 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:08:43.471742 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:08:43.471877 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:08:43.474255 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:08:43.474470 [debug] [Thread-1  ]: finished collecting timing info
[0m08:08:43.474598 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:08:43.476326 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:08:43.476490 [debug] [Thread-4  ]: finished collecting timing info
[0m08:08:43.476620 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:08:43.478202 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:08:43.478692 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:08:43.478814 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:08:43.479161 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:08:43.479273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:08:43.479382 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:08:43.479854 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:08:43.654770 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m08:08:43.656547 [debug] [Thread-2  ]: finished collecting timing info
[0m08:08:43.656905 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:08:43.665131 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m08:08:43.690980 [debug] [Thread-3  ]: finished collecting timing info
[0m08:08:43.722673 [debug] [Thread-3  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:08:43.901081 [info ] [Thread-2  ]: 10 of 12 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.75s]
[0m08:08:43.901542 [debug] [Thread-2  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:08:43.908965 [info ] [Thread-3  ]: 9 of 12 PASS positive_value_dim_listings_cleansed_minimum_nights ............... [[32mPASS[0m in 1.01s]
[0m08:08:43.909339 [debug] [Thread-3  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:08:44.029200 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m08:08:44.030123 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m08:08:44.031886 [debug] [Thread-4  ]: finished collecting timing info
[0m08:08:44.033224 [debug] [Thread-1  ]: finished collecting timing info
[0m08:08:44.033482 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:08:44.033673 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:08:44.198134 [info ] [Thread-4  ]: 12 of 12 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.73s]
[0m08:08:44.199298 [info ] [Thread-1  ]: 11 of 12 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.73s]
[0m08:08:44.200142 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:08:44.200786 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:08:44.202819 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:08:44.203555 [info ] [MainThread]: 
[0m08:08:44.204004 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m08:08:44.204413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:08:44.204637 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:08:44.204846 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:08:44.205051 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:08:44.205256 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:08:44.217509 [info ] [MainThread]: 
[0m08:08:44.217865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:08:44.218205 [info ] [MainThread]: 
[0m08:08:44.218492 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m08:08:44.218864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090620a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109441af0>]}
[0m08:08:44.219123 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:09:56.733462 | 448f8edd-8d18-48f1-aeb1-97f19fdcced7 ==============================
[0m08:09:56.733496 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:09:56.734839 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:09:56.734999 [debug] [MainThread]: Tracking: tracking
[0m08:09:56.735521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ead90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050eadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050eae50>]}
[0m08:09:56.797188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:09:56.797631 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:09:56.807768 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:09:56.820254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105486cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056048b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105604580>]}
[0m08:09:56.820522 [debug] [MainThread]: Flushing usage events
[0m08:09:57.289677 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/schema.yml @ models: {'name': 'dim_hosts_cleansed', 'description': 'Cleaned table which contains Airbnb hosts', 'columns': [{'name': 'host_id', 'description': 'Primary key for the host', 'tests': ['not_null', 'unique']}, {'name': 'host_name', 'description': "The host's name", 'tests': ['not_null']}, {'name': 'is_superhost', 'description': 'A boolean that defines if the host is a superhost (True/False)', 'tests': {'-accepted_values': {'values': ['t', 'f']}}}, {'name': 'created_at', 'description': 'Date the host data was originally created.'}, {'name': 'updated_at', 'description': 'Date the host data was last updated.'}], 'original_file_path': 'models/schema.yml', 'yaml_key': 'models', 'package_name': 'learn_dbt'} - at path ['columns'][2]['tests']: {'-accepted_values': {'values': ['t', 'f']}} is not valid under any of the given schemas


============================== 2022-10-17 08:10:21.623550 | 52ee3118-5ee6-4da3-8dbe-7f4ae24290e2 ==============================
[0m08:10:21.623611 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:10:21.624536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:10:21.624661 [debug] [MainThread]: Tracking: tracking
[0m08:10:21.624958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109effe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109effee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efff40>]}
[0m08:10:21.679846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:10:21.680274 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:10:21.688756 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:10:21.724325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52ee3118-5ee6-4da3-8dbe-7f4ae24290e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1de0d0>]}
[0m08:10:21.730374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52ee3118-5ee6-4da3-8dbe-7f4ae24290e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0de040>]}
[0m08:10:21.730555 [info ] [MainThread]: Found 8 models, 13 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:10:21.730745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ee3118-5ee6-4da3-8dbe-7f4ae24290e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0de0d0>]}
[0m08:10:21.731797 [info ] [MainThread]: 
[0m08:10:21.732195 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:10:21.733110 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:10:21.741902 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:10:21.742135 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:10:21.742249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:10:22.741440 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m08:10:22.745031 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:10:22.925553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ee3118-5ee6-4da3-8dbe-7f4ae24290e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a17b640>]}
[0m08:10:22.926778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:10:22.927392 [info ] [MainThread]: 
[0m08:10:22.933119 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:22.933406 [debug] [Thread-2  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:22.933662 [debug] [Thread-3  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:10:22.933918 [debug] [Thread-4  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:22.934186 [info ] [Thread-1  ]: 1 of 13 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m08:10:22.934473 [info ] [Thread-2  ]: 2 of 13 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:10:22.934740 [info ] [Thread-3  ]: 3 of 13 START test consistent_created_at ....................................... [RUN]
[0m08:10:22.934995 [info ] [Thread-4  ]: 4 of 13 START test dim_listings_minimum_nights ................................. [RUN]
[0m08:10:22.935848 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:10:22.936769 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:10:22.937535 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:10:22.938210 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:10:22.938435 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:22.938657 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:22.938874 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:10:22.939091 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:22.939377 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:22.939621 [debug] [Thread-2  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:22.939834 [debug] [Thread-3  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:10:22.940040 [debug] [Thread-4  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:10:22.945856 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:10:22.952527 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:10:22.955222 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:10:22.957376 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:10:22.958030 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:22.958230 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:22.958383 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:22.958551 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:22.958684 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:22.958848 [debug] [Thread-3  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:10:22.959003 [debug] [Thread-2  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:22.974285 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:10:22.974510 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:22.976488 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:10:22.978405 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:10:22.980540 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:10:22.981169 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:10:22.981357 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from airbnb.dev.dim_hosts_cleansed
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m08:10:22.981721 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:10:22.982180 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:10:22.982309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:22.982615 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:10:22.982735 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:10:22.982859 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:10:22.983413 [debug] [Thread-4  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:10:22.983910 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:10:22.984071 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:10:22.984193 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:10:23.760360 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m08:10:23.771432 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:23.772029 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m08:10:23.846279 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m08:10:23.849885 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:23.850267 [debug] [Thread-4  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:10:23.862613 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.88 seconds
[0m08:10:23.865061 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:23.865427 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:10:23.875126 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m08:10:23.877329 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:23.877676 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:10:23.922157 [info ] [Thread-1  ]: 1 of 13 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 0.99s]
[0m08:10:23.923486 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:23.924037 [debug] [Thread-1  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:23.924367 [info ] [Thread-1  ]: 5 of 13 START test no_nulls_in_dim_listings .................................... [RUN]
[0m08:10:23.925639 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:23.925889 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:23.926126 [debug] [Thread-1  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:23.983298 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:23.984523 [debug] [Thread-1  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:10:23.984655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:24.025126 [info ] [Thread-4  ]: 4 of 13 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 1.09s]
[0m08:10:24.025542 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:24.025703 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:24.025880 [info ] [Thread-4  ]: 6 of 13 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m08:10:24.026344 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:10:24.026477 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:24.026604 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:24.031309 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:10:24.031712 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:24.031842 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:24.033457 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:10:24.033998 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:10:24.034119 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:10:24.034229 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:10:24.097776 [info ] [Thread-2  ]: 2 of 13 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.16s]
[0m08:10:24.098213 [debug] [Thread-2  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:24.098372 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:24.098559 [info ] [Thread-2  ]: 7 of 13 START test not_null_dim_hosts_cleansed_host_name ....................... [RUN]
[0m08:10:24.099038 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:10:24.099186 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:24.099318 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:24.102216 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:10:24.102630 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:24.102772 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:24.104879 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:10:24.105534 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:10:24.105661 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from airbnb.dev.dim_hosts_cleansed
where host_name is null



      
    ) dbt_internal_test
[0m08:10:24.105772 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:10:24.376849 [info ] [Thread-3  ]: 3 of 13 PASS consistent_created_at ............................................. [[32mPASS[0m in 1.44s]
[0m08:10:24.383479 [debug] [Thread-3  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:10:24.391622 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:24.391913 [info ] [Thread-3  ]: 8 of 13 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m08:10:24.398924 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:10:24.399042 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:24.399166 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:24.401721 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:10:24.404283 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:24.404403 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:24.405903 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:10:24.407941 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:10:24.408059 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:10:24.408162 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:10:24.507442 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.52 seconds
[0m08:10:24.508962 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:24.509345 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:24.509495 [debug] [Thread-1  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:24.511635 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:24.512294 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:24.512415 [debug] [Thread-1  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:10:24.526602 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m08:10:24.527839 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:24.527996 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:10:24.626015 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
[0m08:10:24.633403 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:24.637129 [debug] [Thread-1  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:10:24.637931 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m08:10:24.653625 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:24.653907 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m08:10:24.788209 [info ] [Thread-4  ]: 6 of 13 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 0.76s]
[0m08:10:24.788819 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:24.789046 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:24.789311 [info ] [Thread-4  ]: 9 of 13 START test not_null_dim_listings_cleansed_listing_id ................... [RUN]
[0m08:10:24.789969 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:10:24.790163 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:24.790343 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:24.795489 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:10:24.796973 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:24.797197 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:24.799476 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:10:24.801108 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:10:24.801634 [info ] [Thread-2  ]: 7 of 13 PASS not_null_dim_hosts_cleansed_host_name ............................. [[32mPASS[0m in 0.70s]
[0m08:10:24.801898 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:10:24.802273 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:24.802424 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:10:24.802591 [debug] [Thread-2  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:24.803683 [info ] [Thread-2  ]: 10 of 13 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m08:10:24.804223 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:10:24.804368 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:24.804507 [debug] [Thread-2  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:24.808321 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:10:24.809657 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:24.810086 [info ] [Thread-1  ]: 5 of 13 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 0.88s]
[0m08:10:24.810254 [debug] [Thread-2  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:24.810613 [debug] [Thread-1  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:24.812573 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:10:24.812784 [debug] [Thread-1  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:24.813028 [info ] [Thread-1  ]: 11 of 13 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:10:24.813658 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:10:24.814041 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:10:24.814221 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:24.814364 [debug] [Thread-2  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:10:24.814513 [debug] [Thread-1  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:24.814640 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:10:24.820235 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:10:24.821467 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:24.821608 [debug] [Thread-1  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:24.823419 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:10:24.824116 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:10:24.824254 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:10:24.824374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:24.902322 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m08:10:24.903416 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:24.903605 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:10:25.184746 [info ] [Thread-3  ]: 8 of 13 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 0.79s]
[0m08:10:25.185095 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:25.185222 [debug] [Thread-3  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:25.185323 [info ] [Thread-3  ]: 12 of 13 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:10:25.185653 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:10:25.185756 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:25.185857 [debug] [Thread-3  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:25.189338 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:10:25.190179 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:25.190307 [debug] [Thread-3  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:25.191771 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:10:25.192391 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:10:25.192548 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:10:25.192744 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:10:25.350875 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m08:10:25.352484 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:25.352700 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:10:25.388878 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m08:10:25.395605 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m08:10:25.408527 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:25.431355 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:25.439295 [debug] [Thread-2  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:10:25.439603 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:10:25.554843 [info ] [Thread-4  ]: 9 of 13 PASS not_null_dim_listings_cleansed_listing_id ......................... [[32mPASS[0m in 0.77s]
[0m08:10:25.555337 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:25.555530 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:25.555755 [info ] [Thread-4  ]: 13 of 13 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:10:25.556322 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:10:25.556487 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:25.556658 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:25.560311 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:10:25.560773 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:25.560929 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:25.563944 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:10:25.565510 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:10:25.565677 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:10:25.565812 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:10:25.595548 [info ] [Thread-2  ]: 10 of 13 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.79s]
[0m08:10:25.595950 [info ] [Thread-1  ]: 11 of 13 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.78s]
[0m08:10:25.596323 [debug] [Thread-2  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:25.596628 [debug] [Thread-1  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:25.671710 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.48 seconds
[0m08:10:25.672964 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:25.673139 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:10:25.812519 [info ] [Thread-3  ]: 12 of 13 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.63s]
[0m08:10:25.812811 [debug] [Thread-3  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:26.012057 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m08:10:26.014251 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:26.014531 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:10:26.207325 [info ] [Thread-4  ]: 13 of 13 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.65s]
[0m08:10:26.208252 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:26.210343 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:10:26.211207 [info ] [MainThread]: 
[0m08:10:26.211663 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m08:10:26.212099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:10:26.212322 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:10:26.212529 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:10:26.212733 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:10:26.212933 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:10:26.225683 [info ] [MainThread]: 
[0m08:10:26.226072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:10:26.226418 [info ] [MainThread]: 
[0m08:10:26.226708 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m08:10:26.227103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a17b430>]}
[0m08:10:26.227388 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:10:51.007972 | a30402e6-1f05-4520-bc99-a4c686e1acda ==============================
[0m08:10:51.007998 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:10:51.008417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m08:10:51.008603 [debug] [MainThread]: Tracking: tracking
[0m08:10:51.008865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af9a040>]}
[0m08:10:51.054590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:10:51.054761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:10:51.059237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a30402e6-1f05-4520-bc99-a4c686e1acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3780d0>]}
[0m08:10:51.066575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a30402e6-1f05-4520-bc99-a4c686e1acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b22db20>]}
[0m08:10:51.066817 [info ] [MainThread]: Found 8 models, 13 tests, 1 snapshot, 1 analysis, 502 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:10:51.067018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30402e6-1f05-4520-bc99-a4c686e1acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b22da00>]}
[0m08:10:51.068197 [info ] [MainThread]: 
[0m08:10:51.068585 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:10:51.069200 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:10:51.076320 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:10:51.076457 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:10:51.076555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:10:52.764790 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.69 seconds
[0m08:10:52.767593 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:10:52.956682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30402e6-1f05-4520-bc99-a4c686e1acda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b158dc0>]}
[0m08:10:52.957641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:10:52.958062 [info ] [MainThread]: 
[0m08:10:52.962170 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m08:10:52.962456 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m08:10:52.962654 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m08:10:52.963192 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m08:10:52.963378 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m08:10:52.963901 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m08:10:52.964393 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m08:10:52.964604 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m08:10:52.965188 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m08:10:52.965364 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m08:10:52.965530 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m08:10:52.965715 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m08:10:52.965877 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m08:10:52.966037 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m08:10:52.966195 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m08:10:52.969508 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m08:10:52.969715 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m08:10:52.972142 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m08:10:52.974697 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m08:10:52.976496 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m08:10:52.976895 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:52.977069 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:52.977255 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m08:10:52.977430 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:52.977592 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:52.978093 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m08:10:52.978269 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:52.978699 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m08:10:52.979079 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m08:10:52.979240 [debug] [Thread-1  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m08:10:52.979718 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m08:10:52.979931 [debug] [Thread-3  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m08:10:52.980414 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m08:10:52.980547 [debug] [Thread-2  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m08:10:52.980703 [debug] [Thread-4  ]: Began running node model.learn_dbt.fact_reviews
[0m08:10:52.981101 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:10:52.981265 [debug] [Thread-1  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m08:10:52.981603 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:10:52.981942 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m08:10:52.982082 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m08:10:52.982227 [debug] [Thread-1  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m08:10:52.982361 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m08:10:52.982494 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.fact_reviews
[0m08:10:52.982629 [debug] [Thread-3  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m08:10:52.985328 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:52.985497 [debug] [Thread-2  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m08:10:52.985638 [debug] [Thread-4  ]: Compiling model.learn_dbt.fact_reviews
[0m08:10:52.994645 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:10:52.994812 [debug] [Thread-1  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m08:10:52.999708 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m08:10:53.018205 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m08:10:53.018546 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.018908 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.019084 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:53.019610 [debug] [Thread-1  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m08:10:53.019778 [debug] [Thread-2  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m08:10:53.019931 [debug] [Thread-3  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m08:10:53.020044 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.020289 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.020401 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:53.020512 [debug] [Thread-4  ]: Began executing node model.learn_dbt.fact_reviews
[0m08:10:53.020881 [debug] [Thread-2  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m08:10:53.021218 [debug] [Thread-3  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m08:10:53.021337 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.021901 [debug] [Thread-4  ]: Finished running node model.learn_dbt.fact_reviews
[0m08:10:53.022028 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:53.022133 [debug] [Thread-2  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:53.022224 [debug] [Thread-3  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:53.022324 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:53.022636 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:10:53.022899 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:10:53.023146 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:53.023388 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:10:53.023493 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:53.023594 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:53.023693 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:53.023791 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:53.023892 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:53.023991 [debug] [Thread-2  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:10:53.024091 [debug] [Thread-3  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:53.024184 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:53.031624 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:10:53.033167 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:10:53.040548 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:53.045048 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:10:53.045298 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:10:53.045462 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:10:53.046387 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.046516 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:53.046625 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.046942 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:10:53.047065 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:53.047329 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:10:53.047445 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:53.047550 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:53.047684 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.047783 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.050037 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:10:53.050311 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:53.050738 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:53.050888 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.051003 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.051345 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:10:53.051446 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.051733 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:10:53.051858 [debug] [Thread-2  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:53.051989 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:53.052106 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:53.052366 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:10:53.052468 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.052709 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:10:53.052808 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:53.053073 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:10:53.053171 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:53.053269 [debug] [Thread-2  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:53.053380 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m08:10:53.053493 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:53.056009 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:10:53.056303 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:10:53.060126 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:10:53.060316 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m08:10:53.060487 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m08:10:53.060590 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.062173 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:10:53.062299 [debug] [Thread-2  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:53.062432 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.062546 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.062664 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:53.062988 [debug] [Thread-2  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:10:53.063083 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.063180 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.063295 [debug] [Thread-2  ]: Began running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:53.063421 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m08:10:53.063694 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:10:53.063948 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:10:53.064050 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.064250 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:53.064369 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:53.064638 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m08:10:53.064892 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:10:53.064992 [debug] [Thread-2  ]: Compiling test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:53.065104 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:53.065221 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:53.067733 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:10:53.067996 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:10:53.068105 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:53.068238 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:53.070362 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:10:53.070478 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:53.070616 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.072594 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:10:53.072712 [debug] [Thread-2  ]: Began executing node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:53.072860 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.072951 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.073071 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:53.073160 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.073453 [debug] [Thread-2  ]: Finished running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:10:53.073562 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.073659 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:53.073771 [debug] [Thread-2  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:53.074145 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:10:53.074249 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.074506 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:10:53.074623 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:53.074923 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:10:53.075021 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:53.075254 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:10:53.075367 [debug] [Thread-1  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m08:10:53.075481 [debug] [Thread-2  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:53.075579 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:53.075808 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:10:53.079837 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:10:53.079955 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:53.080060 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m08:10:53.082725 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:10:53.082845 [debug] [Thread-1  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m08:10:53.109520 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.111463 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:10:53.111635 [debug] [Thread-2  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:53.111776 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.111892 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.112019 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:53.112352 [debug] [Thread-2  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:10:53.112437 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.112539 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.112652 [debug] [Thread-2  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:10:53.112754 [debug] [Thread-1  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m08:10:53.113059 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:10:53.113290 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:10:53.113387 [debug] [Thread-1  ]: finished collecting timing info
[0m08:10:53.113532 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:10:53.113798 [debug] [Thread-1  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m08:10:53.113901 [debug] [Thread-2  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:10:53.115485 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:10:53.115696 [debug] [Thread-4  ]: Began running node analysis.learn_dbt.full_moon_no_sleep
[0m08:10:53.115973 [debug] [Thread-4  ]: Acquiring new snowflake connection "analysis.learn_dbt.full_moon_no_sleep"
[0m08:10:53.116122 [debug] [Thread-4  ]: Began compiling node analysis.learn_dbt.full_moon_no_sleep
[0m08:10:53.116236 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.116577 [debug] [Thread-4  ]: Compiling analysis.learn_dbt.full_moon_no_sleep
[0m08:10:53.116701 [debug] [Thread-2  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:10:53.118153 [debug] [Thread-4  ]: Writing injected SQL for node "analysis.learn_dbt.full_moon_no_sleep"
[0m08:10:53.118279 [debug] [Thread-2  ]: finished collecting timing info
[0m08:10:53.118660 [debug] [Thread-2  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:10:53.118869 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.118983 [debug] [Thread-4  ]: Began executing node analysis.learn_dbt.full_moon_no_sleep
[0m08:10:53.119084 [debug] [Thread-4  ]: finished collecting timing info
[0m08:10:53.119386 [debug] [Thread-4  ]: Finished running node analysis.learn_dbt.full_moon_no_sleep
[0m08:10:53.713489 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 0.67 seconds
[0m08:10:53.716894 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:10:53.717758 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:53.718041 [debug] [Thread-3  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:53.718298 [debug] [Thread-3  ]: finished collecting timing info
[0m08:10:53.718558 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:10:53.891372 [debug] [Thread-3  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:10:53.892573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:10:53.892857 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m08:10:53.893051 [debug] [MainThread]: Connection 'test.learn_dbt.consistent_created_at' was properly closed.
[0m08:10:53.893242 [debug] [MainThread]: Connection 'test.learn_dbt.no_nulls_in_dim_listings' was properly closed.
[0m08:10:53.893425 [debug] [MainThread]: Connection 'analysis.learn_dbt.full_moon_no_sleep' was properly closed.
[0m08:10:53.906108 [info ] [MainThread]: Done.
[0m08:10:53.911109 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m08:10:53.911301 [info ] [MainThread]: Building catalog
[0m08:10:53.913018 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m08:10:53.919337 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m08:10:53.919565 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m08:10:53.919730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:10:55.771254 [debug] [ThreadPool]: SQL status: SUCCESS 87 in 1.85 seconds
[0m08:10:55.794610 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m08:10:55.994811 [info ] [MainThread]: Catalog written to /Users/nigelbrown/learn-dbt/target/catalog.json
[0m08:10:55.995309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d068400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20cdc0>]}
[0m08:10:55.995568 [debug] [MainThread]: Flushing usage events
[0m08:10:56.450043 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:10:56.450975 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-10-17 08:11:25.738968 | e83649cd-541a-454f-9cea-0334907a9357 ==============================
[0m08:11:25.738999 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:11:25.739480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m08:11:25.739623 [debug] [MainThread]: Tracking: tracking
[0m08:11:25.739881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225bbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225bbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225bbeb0>]}
[0m08:11:25.740799 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m08:11:25.741002 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m08:11:25.741172 [info ] [MainThread]: 
[0m08:11:25.741330 [info ] [MainThread]: 
[0m08:11:25.741486 [info ] [MainThread]: Press Ctrl+C to exit.
[0m08:22:56.032332 [debug] [MainThread]: Flushing usage events
[0m08:22:56.558533 [info ] [MainThread]: ctrl-c


============================== 2022-10-17 08:30:45.471855 | 7733bf17-19d5-492c-836b-7fcc272e21ac ==============================
[0m08:30:45.471891 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:30:45.479409 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:30:45.484230 [debug] [MainThread]: Tracking: tracking
[0m08:30:45.485400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820f10>]}
[0m08:30:45.486821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820eb0>]}
[0m08:30:45.486995 [debug] [MainThread]: Flushing usage events
[0m08:30:45.990653 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 1 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2022-10-17 08:30:54.000164 | 5e956b77-9b25-4078-8219-d423882ce347 ==============================
[0m08:30:54.000170 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:30:54.000452 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m08:30:54.000554 [debug] [MainThread]: Tracking: tracking
[0m08:30:54.014658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b4760>]}
[0m08:30:54.016270 [debug] [MainThread]: Set downloads directory='/var/folders/5t/ypbn9q9j4k5fs1ld46vzck880000gn/T/dbt-downloads-gly_ewzk'
[0m08:30:54.016846 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:30:54.176343 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:30:54.176816 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:30:54.290560 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:30:54.315832 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m08:30:54.401919 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m08:30:54.411770 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m08:30:54.491232 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m08:30:54.544256 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:30:54.924263 [info ] [MainThread]:   Installed from version 0.9.2
[0m08:30:54.924574 [info ] [MainThread]:   Up to date!
[0m08:30:54.924802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e956b77-9b25-4078-8219-d423882ce347', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193a130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193a8b0>]}
[0m08:30:54.924962 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m08:31:10.239525 [info ] [MainThread]:   Installed from version 0.7.0
[0m08:31:10.240398 [info ] [MainThread]:   Up to date!
[0m08:31:10.240724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e956b77-9b25-4078-8219-d423882ce347', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b80790>]}
[0m08:31:10.240946 [info ] [MainThread]: Installing calogica/dbt_date
[0m08:31:10.517471 [info ] [MainThread]:   Installed from version 0.6.1
[0m08:31:10.517973 [info ] [MainThread]:   Up to date!
[0m08:31:10.518340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e956b77-9b25-4078-8219-d423882ce347', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b48b0>]}
[0m08:31:10.520767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b80460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b80640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b805b0>]}
[0m08:31:10.521128 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:31:16.496564 | 2efc638f-7d80-4732-9789-af9406515e0c ==============================
[0m08:31:16.496604 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:31:16.497518 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:31:16.497670 [debug] [MainThread]: Tracking: tracking
[0m08:31:16.498042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c34d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c34d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c34dc0>]}
[0m08:31:16.537476 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:31:16.537770 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:31:16.537948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2efc638f-7d80-4732-9789-af9406515e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7e2e0>]}
[0m08:31:16.583899 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m08:31:16.584641 [debug] [MainThread]: Parsing tests/generic/positive_value.sql
[0m08:31:16.584951 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:31:16.585947 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:31:16.607701 [debug] [MainThread]: Parsing macros/apply_grants.sql
[0m08:31:16.608318 [debug] [MainThread]: Parsing macros/materializations/test.sql
[0m08:31:16.608774 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:31:16.610540 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:31:16.613163 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:31:16.613930 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:31:16.616711 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:31:16.621827 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:31:16.622330 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m08:31:16.623234 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:31:16.623525 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:31:16.623854 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:31:16.624117 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:31:16.624335 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m08:31:16.624602 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:31:16.626377 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:31:16.627530 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:31:16.628327 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:31:16.636102 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:31:16.642546 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:31:16.648914 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:31:16.651196 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:31:16.652116 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:31:16.653014 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:31:16.656789 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:31:16.664580 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:31:16.665318 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m08:31:16.668462 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:31:16.673391 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:31:16.681830 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:31:16.684482 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:31:16.686133 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:31:16.688695 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:31:16.689320 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:31:16.690910 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:31:16.691970 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:31:16.695280 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:31:16.704550 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:31:16.705301 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:31:16.706451 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:31:16.707194 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:31:16.707631 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:31:16.708021 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:31:16.708358 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:31:16.709016 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:31:16.711514 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:31:16.715597 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:31:16.716052 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:31:16.716650 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:31:16.717119 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:31:16.717565 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:31:16.718143 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:31:16.718533 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:31:16.719030 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:31:16.719609 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:31:16.720697 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:31:16.721269 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:31:16.721773 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:31:16.722274 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:31:16.722759 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:31:16.723198 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:31:16.723991 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:31:16.724603 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:31:16.727875 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m08:31:16.728458 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:31:16.728942 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:31:16.729842 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:31:16.730947 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:31:16.731476 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m08:31:16.732244 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m08:31:16.732780 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:31:16.733814 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m08:31:16.735416 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:31:16.736989 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:31:16.744285 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:31:16.745324 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:31:16.751647 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:31:16.753848 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:31:16.757311 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:31:16.762083 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m08:31:16.765058 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:31:16.766468 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m08:31:16.767788 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m08:31:16.769541 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m08:31:16.770495 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m08:31:16.771829 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m08:31:16.772967 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m08:31:16.773577 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m08:31:16.774331 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m08:31:16.774960 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m08:31:16.778099 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m08:31:16.778752 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m08:31:16.779512 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m08:31:16.780123 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m08:31:16.780778 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m08:31:16.781477 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m08:31:16.782328 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m08:31:16.783060 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m08:31:16.783749 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m08:31:16.784374 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m08:31:16.785040 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m08:31:16.785789 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m08:31:16.786417 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m08:31:16.787098 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m08:31:16.787730 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m08:31:16.788358 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m08:31:16.789097 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m08:31:16.789786 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m08:31:16.790518 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m08:31:16.791257 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m08:31:16.803634 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m08:31:16.804509 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m08:31:16.805634 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m08:31:16.806328 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m08:31:16.807156 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m08:31:16.807918 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m08:31:16.808952 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m08:31:16.809735 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m08:31:16.810298 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m08:31:16.811495 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m08:31:16.812496 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m08:31:16.813152 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m08:31:16.813729 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m08:31:16.815025 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m08:31:16.815959 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m08:31:16.816782 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m08:31:16.817793 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m08:31:16.819264 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m08:31:16.819918 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m08:31:16.821561 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m08:31:16.826217 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m08:31:16.826736 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m08:31:16.827257 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m08:31:16.827810 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m08:31:16.828326 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m08:31:16.828878 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m08:31:16.829767 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m08:31:16.831728 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m08:31:16.832484 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m08:31:16.834058 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m08:31:16.836033 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m08:31:16.837593 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m08:31:16.838346 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m08:31:16.840118 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m08:31:16.843822 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m08:31:16.849485 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m08:31:16.850115 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m08:31:16.853472 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m08:31:16.855018 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m08:31:16.855763 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m08:31:16.856512 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m08:31:16.859751 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m08:31:16.862369 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m08:31:16.864272 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m08:31:16.865520 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m08:31:16.867973 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m08:31:16.869017 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m08:31:16.869741 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m08:31:16.872532 [debug] [MainThread]: Parsing macros/get_date_dimension.sql
[0m08:31:16.884659 [debug] [MainThread]: Parsing macros/get_base_dates.sql
[0m08:31:16.887036 [debug] [MainThread]: Parsing macros/fiscal_date/get_fiscal_year_dates.sql
[0m08:31:16.889264 [debug] [MainThread]: Parsing macros/fiscal_date/get_fiscal_periods.sql
[0m08:31:16.890207 [debug] [MainThread]: Parsing macros/calendar_date/tomorrow.sql
[0m08:31:16.890519 [debug] [MainThread]: Parsing macros/calendar_date/next_week.sql
[0m08:31:16.890791 [debug] [MainThread]: Parsing macros/calendar_date/next_month_name.sql
[0m08:31:16.891131 [debug] [MainThread]: Parsing macros/calendar_date/next_month.sql
[0m08:31:16.891401 [debug] [MainThread]: Parsing macros/calendar_date/day_name.sql
[0m08:31:16.892870 [debug] [MainThread]: Parsing macros/calendar_date/to_unixtimestamp.sql
[0m08:31:16.893632 [debug] [MainThread]: Parsing macros/calendar_date/n_days_away.sql
[0m08:31:16.894028 [debug] [MainThread]: Parsing macros/calendar_date/week_start.sql
[0m08:31:16.895221 [debug] [MainThread]: Parsing macros/calendar_date/iso_week_start.sql
[0m08:31:16.896321 [debug] [MainThread]: Parsing macros/calendar_date/n_days_ago.sql
[0m08:31:16.896803 [debug] [MainThread]: Parsing macros/calendar_date/last_week.sql
[0m08:31:16.897075 [debug] [MainThread]: Parsing macros/calendar_date/now.sql
[0m08:31:16.897895 [debug] [MainThread]: Parsing macros/calendar_date/periods_since.sql
[0m08:31:16.898233 [debug] [MainThread]: Parsing macros/calendar_date/today.sql
[0m08:31:16.898497 [debug] [MainThread]: Parsing macros/calendar_date/last_month.sql
[0m08:31:16.898765 [debug] [MainThread]: Parsing macros/calendar_date/day_of_year.sql
[0m08:31:16.899657 [debug] [MainThread]: Parsing macros/calendar_date/round_timestamp.sql
[0m08:31:16.899971 [debug] [MainThread]: Parsing macros/calendar_date/from_unixtimestamp.sql
[0m08:31:16.902516 [debug] [MainThread]: Parsing macros/calendar_date/n_months_ago.sql
[0m08:31:16.902954 [debug] [MainThread]: Parsing macros/calendar_date/date_part.sql
[0m08:31:16.903593 [debug] [MainThread]: Parsing macros/calendar_date/n_weeks_away.sql
[0m08:31:16.904005 [debug] [MainThread]: Parsing macros/calendar_date/day_of_month.sql
[0m08:31:16.904472 [debug] [MainThread]: Parsing macros/calendar_date/yesterday.sql
[0m08:31:16.904784 [debug] [MainThread]: Parsing macros/calendar_date/day_of_week.sql
[0m08:31:16.908218 [debug] [MainThread]: Parsing macros/calendar_date/iso_week_end.sql
[0m08:31:16.909225 [debug] [MainThread]: Parsing macros/calendar_date/n_weeks_ago.sql
[0m08:31:16.909662 [debug] [MainThread]: Parsing macros/calendar_date/month_name.sql
[0m08:31:16.910971 [debug] [MainThread]: Parsing macros/calendar_date/last_month_name.sql
[0m08:31:16.911324 [debug] [MainThread]: Parsing macros/calendar_date/week_of_year.sql
[0m08:31:16.912133 [debug] [MainThread]: Parsing macros/calendar_date/convert_timezone.sql
[0m08:31:16.914489 [debug] [MainThread]: Parsing macros/calendar_date/n_months_away.sql
[0m08:31:16.914909 [debug] [MainThread]: Parsing macros/calendar_date/iso_week_of_year.sql
[0m08:31:16.916130 [debug] [MainThread]: Parsing macros/calendar_date/week_end.sql
[0m08:31:16.917182 [debug] [MainThread]: Parsing macros/calendar_date/next_month_number.sql
[0m08:31:16.917499 [debug] [MainThread]: Parsing macros/calendar_date/last_month_number.sql
[0m08:31:16.917822 [debug] [MainThread]: Parsing macros/utils/datatypes.sql
[0m08:31:16.918918 [debug] [MainThread]: Parsing macros/regex/regexp_instr.sql
[0m08:31:16.920730 [debug] [MainThread]: Parsing macros/math/log_natural.sql
[0m08:31:16.921392 [debug] [MainThread]: Parsing macros/math/rand.sql
[0m08:31:16.922119 [debug] [MainThread]: Parsing macros/math/median.sql
[0m08:31:16.922392 [debug] [MainThread]: Parsing macros/math/percentile_cont.sql
[0m08:31:16.923488 [debug] [MainThread]: Parsing macros/schema_tests/_generalized/_ignore_row_if_expression.sql
[0m08:31:16.924585 [debug] [MainThread]: Parsing macros/schema_tests/_generalized/expression_between.sql
[0m08:31:16.926479 [debug] [MainThread]: Parsing macros/schema_tests/_generalized/expression_is_true.sql
[0m08:31:16.928330 [debug] [MainThread]: Parsing macros/schema_tests/_generalized/equal_expression.sql
[0m08:31:16.935521 [debug] [MainThread]: Parsing macros/schema_tests/_generalized/_truth_expression.sql
[0m08:31:16.935955 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_match_like_pattern.sql
[0m08:31:16.936568 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_match_like_pattern_list.sql
[0m08:31:16.937653 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_match_regex.sql
[0m08:31:16.938376 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_value_lengths_to_equal.sql
[0m08:31:16.938962 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_value_lengths_to_be_between.sql
[0m08:31:16.939792 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_not_match_regex.sql
[0m08:31:16.940506 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_not_match_regex_list.sql
[0m08:31:16.941584 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_match_regex_list.sql
[0m08:31:16.942667 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_not_match_like_pattern_list.sql
[0m08:31:16.943729 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/_get_like_pattern_expression.sql
[0m08:31:16.944072 [debug] [MainThread]: Parsing macros/schema_tests/string_matching/expect_column_values_to_not_match_like_pattern.sql
[0m08:31:16.944673 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_row_values_to_have_recent_data.sql
[0m08:31:16.946376 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_columns_to_contain_set.sql
[0m08:31:16.947558 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table.sql
[0m08:31:16.948031 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_columns_to_not_contain_set.sql
[0m08:31:16.949255 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_grouped_row_values_to_have_recent_data.sql
[0m08:31:16.952512 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_column_to_exist.sql
[0m08:31:16.953729 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_row_count_to_equal.sql
[0m08:31:16.955047 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_row_count_to_be_between.sql
[0m08:31:16.955815 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_row_count_to_equal_other_table_times_factor.sql
[0m08:31:16.956221 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_columns_to_match_set.sql
[0m08:31:16.957456 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/_get_column_list.sql
[0m08:31:16.957921 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_columns_to_match_ordered_list.sql
[0m08:31:16.959311 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/_list_intersect.sql
[0m08:31:16.959797 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_column_count_to_equal_other_table.sql
[0m08:31:16.960349 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_column_count_to_equal.sql
[0m08:31:16.960797 [debug] [MainThread]: Parsing macros/schema_tests/table_shape/expect_table_column_count_to_be_between.sql
[0m08:31:16.961815 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_not_be_in_set.sql
[0m08:31:16.962723 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_in_set.sql
[0m08:31:16.963648 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_increasing.sql
[0m08:31:16.965086 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_null.sql
[0m08:31:16.965608 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_unique.sql
[0m08:31:16.965948 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_between.sql
[0m08:31:16.966761 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_decreasing.sql
[0m08:31:16.967970 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_in_type_list.sql
[0m08:31:16.969054 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_be_of_type.sql
[0m08:31:16.969367 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_have_consistent_casing.sql
[0m08:31:16.969850 [debug] [MainThread]: Parsing macros/schema_tests/column_values_basic/expect_column_values_to_not_be_null.sql
[0m08:31:16.970374 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_min_to_be_between.sql
[0m08:31:16.971231 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_unique_value_count_to_be_between.sql
[0m08:31:16.972086 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_quantile_values_to_be_between.sql
[0m08:31:16.973002 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_median_to_be_between.sql
[0m08:31:16.973864 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_proportion_of_unique_values_to_be_between.sql
[0m08:31:16.974769 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_equal_set.sql
[0m08:31:16.975697 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_most_common_value_to_be_in_set.sql
[0m08:31:16.978126 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_contain_set.sql
[0m08:31:16.979092 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_equal.sql
[0m08:31:16.979782 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_be_less_than.sql
[0m08:31:16.980492 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_sum_to_be_between.sql
[0m08:31:16.981315 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_stdev_to_be_between.sql
[0m08:31:16.983034 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_mean_to_be_between.sql
[0m08:31:16.983875 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_max_to_be_between.sql
[0m08:31:16.984711 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_be_greater_than.sql
[0m08:31:16.985415 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_distinct_values_to_be_in_set.sql
[0m08:31:16.986343 [debug] [MainThread]: Parsing macros/schema_tests/aggregate_functions/expect_column_distinct_count_to_equal_other_table.sql
[0m08:31:16.987143 [debug] [MainThread]: Parsing macros/schema_tests/distributional/expect_row_values_to_have_data_for_every_n_datepart.sql
[0m08:31:16.990957 [debug] [MainThread]: Parsing macros/schema_tests/distributional/expect_column_values_to_be_within_n_moving_stdevs.sql
[0m08:31:16.996989 [debug] [MainThread]: Parsing macros/schema_tests/distributional/expect_column_values_to_be_within_n_stdevs.sql
[0m08:31:16.998462 [debug] [MainThread]: Parsing macros/schema_tests/multi-column/expect_select_column_values_to_be_unique_within_record.sql
[0m08:31:17.001016 [debug] [MainThread]: Parsing macros/schema_tests/multi-column/expect_compound_columns_to_be_unique.sql
[0m08:31:17.002999 [debug] [MainThread]: Parsing macros/schema_tests/multi-column/expect_multicolumn_sum_to_equal.sql
[0m08:31:17.003944 [debug] [MainThread]: Parsing macros/schema_tests/multi-column/expect_column_pair_values_to_be_equal.sql
[0m08:31:17.004617 [debug] [MainThread]: Parsing macros/schema_tests/multi-column/expect_column_pair_values_A_to_be_greater_than_B.sql
[0m08:31:17.005349 [debug] [MainThread]: Parsing macros/schema_tests/multi-column/expect_column_pair_values_to_be_in_set.sql
[0m08:31:17.268303 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:31:17.275779 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:31:17.279066 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:31:17.281898 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m08:31:17.293653 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m08:31:17.294395 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:31:17.297188 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:31:17.300318 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:31:17.328131 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:31:17.489244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2efc638f-7d80-4732-9789-af9406515e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eecd90>]}
[0m08:31:17.497487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2efc638f-7d80-4732-9789-af9406515e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eec7c0>]}
[0m08:31:17.497684 [info ] [MainThread]: Found 8 models, 14 tests, 1 snapshot, 1 analysis, 714 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:31:17.497881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efc638f-7d80-4732-9789-af9406515e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f8820>]}
[0m08:31:17.498830 [info ] [MainThread]: 
[0m08:31:17.499214 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:31:17.499830 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:31:17.506947 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:31:17.507082 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:31:17.507181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:18.551800 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.04 seconds
[0m08:31:18.555092 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:31:18.819708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efc638f-7d80-4732-9789-af9406515e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eecf70>]}
[0m08:31:18.821013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:31:18.821592 [info ] [MainThread]: 
[0m08:31:18.828163 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:31:18.828476 [debug] [Thread-2  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:31:18.828709 [info ] [Thread-1  ]: 1 of 14 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m08:31:18.828936 [debug] [Thread-3  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:31:18.829188 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:31:18.829510 [info ] [Thread-2  ]: 2 of 14 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:31:18.830380 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:31:18.830646 [info ] [Thread-3  ]: 3 of 14 START test consistent_created_at ....................................... [RUN]
[0m08:31:18.830897 [info ] [Thread-4  ]: 4 of 14 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m08:31:18.831664 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:31:18.831923 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:31:18.832674 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:31:18.833359 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:31:18.833557 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:31:18.833770 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:31:18.833959 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:31:18.834146 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:31:18.834330 [debug] [Thread-2  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:31:18.840739 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:31:18.841003 [debug] [Thread-3  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:31:18.841207 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:31:18.847339 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:31:18.850708 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:31:18.854864 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:31:18.855216 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:18.855663 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:31:18.868411 [debug] [Thread-2  ]: finished collecting timing info
[0m08:31:18.868602 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:18.871595 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:31:18.871820 [debug] [Thread-2  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:31:18.871978 [debug] [Thread-4  ]: finished collecting timing info
[0m08:31:18.872122 [debug] [Thread-3  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:31:18.874508 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:31:18.874695 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:31:18.876579 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:31:18.877634 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:31:18.879671 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:31:18.879957 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from airbnb.dev.dim_hosts_cleansed
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m08:31:18.880457 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:31:18.880687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:31:18.881093 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:31:18.881202 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:31:18.882142 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:31:18.882644 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:31:18.882772 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:31:18.882928 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m08:31:18.883044 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:31:18.883911 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:31:19.428088 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m08:31:19.433399 [debug] [Thread-2  ]: finished collecting timing info
[0m08:31:19.433599 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:31:19.452415 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m08:31:19.453617 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:19.453803 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m08:31:19.522202 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m08:31:19.524010 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:19.524270 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:31:19.588296 [info ] [Thread-2  ]: 2 of 14 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.76s]
[0m08:31:19.589547 [debug] [Thread-2  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:31:19.590141 [debug] [Thread-2  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:31:19.591311 [info ] [Thread-2  ]: 5 of 14 START test dim_listings_minimum_nights ................................. [RUN]
[0m08:31:19.592776 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:31:19.593093 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:31:19.593389 [debug] [Thread-2  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:31:19.598521 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:31:19.599236 [info ] [Thread-1  ]: 1 of 14 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 0.77s]
[0m08:31:19.599875 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:31:19.600105 [debug] [Thread-1  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:31:19.600370 [info ] [Thread-1  ]: 6 of 14 START test no_nulls_in_dim_listings .................................... [RUN]
[0m08:31:19.601057 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:31:19.601309 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:31:19.601530 [debug] [Thread-1  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:31:19.607999 [debug] [Thread-2  ]: finished collecting timing info
[0m08:31:19.612925 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:31:19.613125 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:31:19.613327 [debug] [Thread-1  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:31:19.616045 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:31:19.616220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:31:19.617993 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:31:19.618163 [debug] [Thread-2  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:31:19.618313 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:31:19.673857 [info ] [Thread-3  ]: 3 of 14 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.84s]
[0m08:31:19.674506 [debug] [Thread-3  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:31:19.674718 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:31:19.674985 [info ] [Thread-3  ]: 7 of 14 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m08:31:19.675750 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:31:19.675932 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:31:19.676088 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:31:19.683818 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:31:19.684921 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:19.685075 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:31:19.687472 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:31:19.688098 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:31:19.688234 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:31:19.688354 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:31:20.209242 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.59 seconds
[0m08:31:20.212408 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:31:20.214179 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m08:31:20.217084 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:20.218155 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:31:20.218882 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:20.219823 [debug] [Thread-1  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:31:20.224537 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:31:20.226831 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:31:20.227120 [debug] [Thread-1  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:31:20.308400 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.42 seconds
[0m08:31:20.312996 [debug] [Thread-4  ]: finished collecting timing info
[0m08:31:20.313504 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m08:31:20.322625 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m08:31:20.324868 [debug] [Thread-2  ]: finished collecting timing info
[0m08:31:20.325171 [debug] [Thread-2  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:31:20.330027 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m08:31:20.332348 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:20.332613 [debug] [Thread-1  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:31:20.419244 [info ] [Thread-3  ]: 7 of 14 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 0.74s]
[0m08:31:20.422196 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:31:20.422910 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:31:20.423198 [info ] [Thread-3  ]: 8 of 14 START test not_null_dim_hosts_cleansed_host_name ....................... [RUN]
[0m08:31:20.424846 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:31:20.425205 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:31:20.425459 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:31:20.432466 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:31:20.434255 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:20.434454 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:31:20.437591 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:31:20.438393 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:31:20.438584 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from airbnb.dev.dim_hosts_cleansed
where host_name is null



      
    ) dbt_internal_test
[0m08:31:20.438753 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:31:20.524767 [info ] [Thread-4  ]: 4 of 14 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 1.69s]
[0m08:31:20.525266 [info ] [Thread-1  ]: 6 of 14 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 0.92s]
[0m08:31:20.525673 [info ] [Thread-2  ]: 5 of 14 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 0.93s]
[0m08:31:20.526133 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:31:20.526488 [debug] [Thread-1  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:31:20.526804 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:31:20.526995 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:31:20.527227 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:31:20.527469 [debug] [Thread-2  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:31:20.527658 [info ] [Thread-4  ]: 9 of 14 START test not_null_dim_listings_cleansed_host_id ...................... [RUN]
[0m08:31:20.527835 [info ] [Thread-1  ]: 10 of 14 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m08:31:20.527993 [info ] [Thread-2  ]: 11 of 14 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m08:31:20.528519 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:31:20.529024 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:31:20.529514 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:31:20.529677 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:31:20.529826 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:31:20.529968 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:31:20.530116 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:31:20.530258 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:31:20.530398 [debug] [Thread-2  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:31:20.534186 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:31:20.537443 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:31:20.540315 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:31:20.540753 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:20.540892 [debug] [Thread-4  ]: finished collecting timing info
[0m08:31:20.541015 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:31:20.541131 [debug] [Thread-2  ]: finished collecting timing info
[0m08:31:20.541260 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:31:20.544224 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:31:20.544370 [debug] [Thread-2  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:31:20.546277 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:31:20.548532 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:31:20.549222 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:31:20.549573 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:31:20.549715 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:31:20.549853 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:31:20.550166 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:31:20.550269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:31:20.550385 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:31:20.550495 [debug] [Thread-2  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:31:20.551761 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:31:21.042942 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m08:31:21.047655 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:21.049419 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m08:31:21.156432 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m08:31:21.158113 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m08:31:21.160524 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:21.162598 [debug] [Thread-4  ]: finished collecting timing info
[0m08:31:21.162952 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:31:21.163220 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:31:21.166507 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m08:31:21.168659 [debug] [Thread-2  ]: finished collecting timing info
[0m08:31:21.169432 [debug] [Thread-2  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:31:21.257551 [info ] [Thread-3  ]: 8 of 14 PASS not_null_dim_hosts_cleansed_host_name ............................. [[32mPASS[0m in 0.83s]
[0m08:31:21.259191 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:31:21.259636 [debug] [Thread-3  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:31:21.259995 [info ] [Thread-3  ]: 12 of 14 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:31:21.260920 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:31:21.261200 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:31:21.261450 [debug] [Thread-3  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:31:21.268736 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:31:21.269318 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:21.269521 [debug] [Thread-3  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:31:21.272568 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:31:21.273623 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:31:21.273804 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:31:21.273969 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:31:21.347482 [info ] [Thread-1  ]: 10 of 14 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.82s]
[0m08:31:21.348027 [info ] [Thread-4  ]: 9 of 14 PASS not_null_dim_listings_cleansed_host_id ............................ [[32mPASS[0m in 0.82s]
[0m08:31:21.348551 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:31:21.348946 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:31:21.349138 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:31:21.349380 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:31:21.349613 [info ] [Thread-1  ]: 13 of 14 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:31:21.349789 [info ] [Thread-4  ]: 14 of 14 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:31:21.350636 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:31:21.351206 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:31:21.351594 [info ] [Thread-2  ]: 11 of 14 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.82s]
[0m08:31:21.351783 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:31:21.351954 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:31:21.352313 [debug] [Thread-2  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:31:21.352467 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:31:21.352611 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:31:21.358406 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:31:21.362467 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:31:21.362997 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:21.363154 [debug] [Thread-4  ]: finished collecting timing info
[0m08:31:21.363293 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:31:21.363441 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:31:21.365609 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:31:21.367676 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:31:21.368345 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:31:21.368474 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:21.368594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:31:21.369446 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:31:21.369977 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:21.370104 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:31:21.872694 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m08:31:21.875536 [debug] [Thread-3  ]: finished collecting timing info
[0m08:31:21.875830 [debug] [Thread-3  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:31:22.299411 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m08:31:22.300276 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m08:31:22.302781 [debug] [Thread-1  ]: finished collecting timing info
[0m08:31:22.304986 [debug] [Thread-4  ]: finished collecting timing info
[0m08:31:22.305526 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:31:22.306034 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:31:22.398015 [info ] [Thread-3  ]: 12 of 14 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.14s]
[0m08:31:22.399376 [debug] [Thread-3  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:31:22.651759 [info ] [Thread-1  ]: 13 of 14 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 1.30s]
[0m08:31:22.652887 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:31:22.754158 [info ] [Thread-4  ]: 14 of 14 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.40s]
[0m08:31:22.754909 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:31:22.756343 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:31:22.757002 [info ] [MainThread]: 
[0m08:31:22.757429 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m08:31:22.757831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:22.758050 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:31:22.758255 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:31:22.758456 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:31:22.758657 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:31:22.774332 [info ] [MainThread]: 
[0m08:31:22.774664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:31:22.774969 [info ] [MainThread]: 
[0m08:31:22.775229 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m08:31:22.775547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109201430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092018e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109500a30>]}
[0m08:31:22.775777 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:34:36.962401 | ae676133-b952-4863-83ac-79e6ddd82ffd ==============================
[0m08:34:36.962427 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:34:36.962925 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:34:36.963040 [debug] [MainThread]: Tracking: tracking
[0m08:34:36.963266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083be80>]}
[0m08:34:37.030360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:34:37.030967 [debug] [MainThread]: Partial parsing: deleted source source.learn_dbt.airbnb.listings
[0m08:34:37.031151 [debug] [MainThread]: Partial parsing: deleted source source.learn_dbt.airbnb.hosts
[0m08:34:37.031347 [debug] [MainThread]: Partial parsing: deleted source source.learn_dbt.airbnb.reviews
[0m08:34:37.031447 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/sources.yml
[0m08:34:37.040750 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:34:37.048753 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:34:37.051567 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:34:37.054397 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:34:37.057590 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:34:37.060348 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:34:37.063691 [debug] [MainThread]: 1603: static parser failed on fact/fact_reviews.sql
[0m08:34:37.076132 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_reviews.sql
[0m08:34:37.076898 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:34:37.204549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae676133-b952-4863-83ac-79e6ddd82ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7b0d0>]}
[0m08:34:37.212577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae676133-b952-4863-83ac-79e6ddd82ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa06a0>]}
[0m08:34:37.212776 [info ] [MainThread]: Found 8 models, 15 tests, 1 snapshot, 1 analysis, 714 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:34:37.212966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae676133-b952-4863-83ac-79e6ddd82ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa0610>]}
[0m08:34:37.213917 [info ] [MainThread]: 
[0m08:34:37.214271 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:34:37.214922 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:34:37.222524 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:34:37.222688 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:34:37.222789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:38.014050 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.79 seconds
[0m08:34:38.017475 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:34:38.234938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae676133-b952-4863-83ac-79e6ddd82ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080ffd0>]}
[0m08:34:38.236002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:34:38.236479 [info ] [MainThread]: 
[0m08:34:38.240770 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:38.241089 [debug] [Thread-2  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:38.241343 [info ] [Thread-1  ]: 1 of 15 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m08:34:38.241633 [debug] [Thread-3  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:34:38.241903 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:38.242270 [info ] [Thread-2  ]: 2 of 15 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:34:38.243103 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:34:38.243354 [info ] [Thread-3  ]: 3 of 15 START test consistent_created_at ....................................... [RUN]
[0m08:34:38.243642 [info ] [Thread-4  ]: 4 of 15 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m08:34:38.244385 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:34:38.244617 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:38.245279 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:34:38.245926 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:34:38.246126 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:38.246335 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:38.246528 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:34:38.246713 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:38.246905 [debug] [Thread-2  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:38.253856 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:34:38.254087 [debug] [Thread-3  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:34:38.254270 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:38.259932 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:34:38.262968 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:34:38.266801 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:34:38.267011 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:38.267477 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:38.279215 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:38.282028 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:34:38.282281 [debug] [Thread-3  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:34:38.282448 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:38.282674 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:38.285287 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:34:38.285474 [debug] [Thread-2  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:38.285963 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:34:38.286098 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:38.288288 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:34:38.288467 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from airbnb.dev.dim_hosts_cleansed
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m08:34:38.290362 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:34:38.290753 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:34:38.290903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:34:38.291415 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:34:38.291513 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:34:38.292186 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:34:38.292575 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:34:38.293111 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:34:38.293255 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m08:34:38.293432 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:34:38.294026 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:34:38.914720 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.62 seconds
[0m08:34:38.921987 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:38.922230 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m08:34:39.222253 [info ] [Thread-4  ]: 4 of 15 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.98s]
[0m08:34:39.223578 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:39.223956 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:39.224405 [info ] [Thread-4  ]: 5 of 15 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m08:34:39.225516 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:34:39.225826 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:39.226121 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:39.234274 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:34:39.235029 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:39.235254 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:39.238595 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:34:39.239656 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:34:39.239835 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    regexp_instr(price, '^\\$[0-9][0-9\\.]+$', 1, 1)


 > 0
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m08:34:39.240000 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:34:39.252475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.96 seconds
[0m08:34:39.253113 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.96 seconds
[0m08:34:39.255083 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:39.256888 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:39.257163 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m08:34:39.257286 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:34:39.385549 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.09 seconds
[0m08:34:39.387368 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:39.387632 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:34:39.397242 [info ] [Thread-1  ]: 1 of 15 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 1.15s]
[0m08:34:39.397804 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:39.398060 [debug] [Thread-1  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:39.398357 [info ] [Thread-1  ]: 6 of 15 START test dim_listings_minimum_nights ................................. [RUN]
[0m08:34:39.399097 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:34:39.399319 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:39.399518 [debug] [Thread-1  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:34:39.403321 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:34:39.403899 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:39.404091 [debug] [Thread-1  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:39.408107 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:34:39.409458 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:34:39.409676 [debug] [Thread-1  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:34:39.410171 [info ] [Thread-2  ]: 2 of 15 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.17s]
[0m08:34:39.410354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:34:39.410746 [debug] [Thread-2  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:39.411448 [debug] [Thread-2  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:39.412166 [info ] [Thread-2  ]: 7 of 15 START test no_nulls_in_dim_listings .................................... [RUN]
[0m08:34:39.412762 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:39.412927 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:39.413081 [debug] [Thread-2  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:39.421527 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:39.421963 [debug] [Thread-2  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:34:39.422276 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:34:39.693769 [info ] [Thread-3  ]: 3 of 15 PASS consistent_created_at ............................................. [[32mPASS[0m in 1.45s]
[0m08:34:39.718779 [debug] [Thread-3  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:34:39.748076 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:39.765869 [info ] [Thread-3  ]: 8 of 15 START test not_null_dim_hosts_cleansed_host_id ......................... [RUN]
[0m08:34:39.784168 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:34:39.815318 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:39.832037 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:39.842590 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:34:39.844263 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:39.844422 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:39.846308 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:34:39.846967 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:34:39.847154 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:34:39.847644 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:34:39.950644 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m08:34:39.952031 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:39.952520 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m08:34:40.096619 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0.67 seconds
[0m08:34:40.103280 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m08:34:40.104338 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:40.117564 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:40.131112 [debug] [Thread-1  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:34:40.131932 [info ] [Thread-4  ]: 5 of 15 PASS dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[32mPASS[0m in 0.91s]
[0m08:34:40.132224 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:40.132352 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:40.132459 [info ] [Thread-4  ]: 9 of 15 START test not_null_dim_hosts_cleansed_host_name ....................... [RUN]
[0m08:34:40.132794 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:34:40.132902 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:40.133008 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:40.135593 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:34:40.135902 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:40.136540 [debug] [Thread-2  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:40.138800 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:40.140029 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:40.140489 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:40.140674 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:40.140842 [debug] [Thread-2  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:34:40.175721 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:34:40.177371 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:34:40.177605 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from airbnb.dev.dim_hosts_cleansed
where host_name is null



      
    ) dbt_internal_test
[0m08:34:40.177726 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:34:40.280288 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m08:34:40.281652 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:40.281840 [debug] [Thread-2  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:34:40.296234 [info ] [Thread-1  ]: 6 of 15 PASS dim_listings_minimum_nights ....................................... [[32mPASS[0m in 0.90s]
[0m08:34:40.296614 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:40.296792 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:40.296994 [info ] [Thread-1  ]: 10 of 15 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m08:34:40.297498 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:34:40.297660 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:40.297806 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:40.301550 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:34:40.301979 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:40.302121 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:40.304242 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:34:40.304765 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:34:40.304914 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:34:40.305036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:34:40.408698 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m08:34:40.410032 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:40.416224 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:34:40.451808 [info ] [Thread-2  ]: 7 of 15 PASS no_nulls_in_dim_listings .......................................... [[32mPASS[0m in 1.04s]
[0m08:34:40.458399 [debug] [Thread-2  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:40.458543 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:40.458741 [info ] [Thread-2  ]: 11 of 15 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m08:34:40.459127 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:34:40.459245 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:40.459363 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:40.461979 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:34:40.482025 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:40.487422 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:40.489316 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:34:40.498667 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:34:40.499000 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:34:40.499158 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:34:40.635717 [info ] [Thread-3  ]: 8 of 15 PASS not_null_dim_hosts_cleansed_host_id ............................... [[32mPASS[0m in 0.85s]
[0m08:34:40.636279 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:40.636475 [debug] [Thread-3  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:40.636715 [info ] [Thread-3  ]: 12 of 15 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m08:34:40.637287 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:34:40.637460 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:40.637619 [debug] [Thread-3  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:40.641454 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:34:40.641901 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:40.642048 [debug] [Thread-3  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:40.644416 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:34:40.644991 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:34:40.645130 [debug] [Thread-3  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:34:40.645262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:34:40.735372 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.43 seconds
[0m08:34:40.735946 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m08:34:40.737270 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:40.738356 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:40.738625 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:34:40.757701 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m08:34:40.991808 [info ] [Thread-1  ]: 10 of 15 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.69s]
[0m08:34:41.004006 [info ] [Thread-4  ]: 9 of 15 PASS not_null_dim_hosts_cleansed_host_name ............................. [[32mPASS[0m in 0.87s]
[0m08:34:41.006132 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:41.006368 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:41.006489 [debug] [Thread-1  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:41.006756 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:41.019270 [info ] [Thread-1  ]: 13 of 15 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:34:41.021293 [info ] [Thread-4  ]: 14 of 15 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:34:41.021712 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:34:41.022036 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:34:41.022148 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:41.022537 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:41.022915 [debug] [Thread-1  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:41.023073 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:41.027182 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:34:41.031367 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:34:41.031980 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:41.032102 [debug] [Thread-1  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:41.032318 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:41.034055 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:34:41.034230 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:41.036721 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:34:41.037411 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:34:41.037546 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:34:41.037666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:34:41.038183 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:34:41.038299 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:34:41.038647 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:34:41.113213 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m08:34:41.114259 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:41.114405 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:34:41.301342 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m08:34:41.319970 [info ] [Thread-2  ]: 11 of 15 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.86s]
[0m08:34:41.321850 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:41.323344 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:41.323663 [debug] [Thread-3  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:34:41.323991 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:41.324865 [info ] [Thread-2  ]: 15 of 15 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:34:41.325235 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:34:41.325339 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:41.325440 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:41.328048 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:34:41.330753 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:41.330887 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:41.332574 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:34:41.356878 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:34:41.357237 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:34:41.357341 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:34:41.509350 [info ] [Thread-3  ]: 12 of 15 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.87s]
[0m08:34:41.510949 [debug] [Thread-3  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:41.631488 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.59 seconds
[0m08:34:41.640270 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m08:34:41.641343 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:41.642631 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:41.643534 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:34:41.643687 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:34:42.014991 [info ] [Thread-4  ]: 14 of 15 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.99s]
[0m08:34:42.016003 [info ] [Thread-1  ]: 13 of 15 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.99s]
[0m08:34:42.016943 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:42.017581 [debug] [Thread-1  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:42.018998 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m08:34:42.021094 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:42.021376 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:34:42.181988 [info ] [Thread-2  ]: 15 of 15 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.86s]
[0m08:34:42.183020 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:42.184892 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:34:42.185714 [info ] [MainThread]: 
[0m08:34:42.186163 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m08:34:42.186576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:42.186793 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:34:42.187001 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:34:42.187208 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:34:42.187413 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:34:42.204358 [info ] [MainThread]: 
[0m08:34:42.204747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:34:42.205092 [info ] [MainThread]: 
[0m08:34:42.205350 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m08:34:42.205692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e0100>]}
[0m08:34:42.205946 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 08:34:58.126032 | 45830843-9b5f-4138-970e-c039bb5d7439 ==============================
[0m08:34:58.126079 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:34:58.126535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m08:34:58.126662 [debug] [MainThread]: Tracking: tracking
[0m08:34:58.126924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813f0d0>]}
[0m08:34:58.192575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:34:58.192760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:34:58.197197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45830843-9b5f-4138-970e-c039bb5d7439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e00d0>]}
[0m08:34:58.206324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45830843-9b5f-4138-970e-c039bb5d7439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083efb20>]}
[0m08:34:58.206512 [info ] [MainThread]: Found 8 models, 15 tests, 1 snapshot, 1 analysis, 714 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:34:58.206710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45830843-9b5f-4138-970e-c039bb5d7439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083efb80>]}
[0m08:34:58.207879 [info ] [MainThread]: 
[0m08:34:58.208281 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:34:58.208988 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:34:58.216413 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:34:58.216561 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:34:58.216666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:58.923067 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.71 seconds
[0m08:34:58.926988 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:34:59.095067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45830843-9b5f-4138-970e-c039bb5d7439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108599bb0>]}
[0m08:34:59.096251 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:34:59.096869 [info ] [MainThread]: 
[0m08:34:59.101393 [debug] [Thread-1  ]: Began running node model.learn_dbt.src_hosts
[0m08:34:59.101723 [debug] [Thread-2  ]: Began running node model.learn_dbt.src_listings
[0m08:34:59.102420 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.src_hosts"
[0m08:34:59.102655 [debug] [Thread-3  ]: Began running node model.learn_dbt.src_reviews
[0m08:34:59.102891 [debug] [Thread-4  ]: Began running node seed.learn_dbt.seed_full_moon_dates
[0m08:34:59.103577 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.src_listings"
[0m08:34:59.103851 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.src_hosts
[0m08:34:59.104454 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.learn_dbt.src_reviews"
[0m08:34:59.105249 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.learn_dbt.seed_full_moon_dates"
[0m08:34:59.105504 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.src_listings
[0m08:34:59.105775 [debug] [Thread-1  ]: Compiling model.learn_dbt.src_hosts
[0m08:34:59.106012 [debug] [Thread-3  ]: Began compiling node model.learn_dbt.src_reviews
[0m08:34:59.106236 [debug] [Thread-4  ]: Began compiling node seed.learn_dbt.seed_full_moon_dates
[0m08:34:59.106458 [debug] [Thread-2  ]: Compiling model.learn_dbt.src_listings
[0m08:34:59.110705 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.src_hosts"
[0m08:34:59.110959 [debug] [Thread-3  ]: Compiling model.learn_dbt.src_reviews
[0m08:34:59.111165 [debug] [Thread-4  ]: Compiling seed.learn_dbt.seed_full_moon_dates
[0m08:34:59.114422 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.src_listings"
[0m08:34:59.117562 [debug] [Thread-3  ]: Writing injected SQL for node "model.learn_dbt.src_reviews"
[0m08:34:59.120673 [debug] [Thread-4  ]: Writing injected SQL for node "seed.learn_dbt.seed_full_moon_dates"
[0m08:34:59.121046 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.121204 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.121797 [debug] [Thread-1  ]: Finished running node model.learn_dbt.src_hosts
[0m08:34:59.121962 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.122146 [debug] [Thread-4  ]: Began executing node seed.learn_dbt.seed_full_moon_dates
[0m08:34:59.122341 [debug] [Thread-1  ]: Began running node snapshot.learn_dbt.scd_raw_listings
[0m08:34:59.122476 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.123054 [debug] [Thread-2  ]: Finished running node model.learn_dbt.src_listings
[0m08:34:59.123229 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.123625 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.learn_dbt.scd_raw_listings"
[0m08:34:59.124087 [debug] [Thread-3  ]: Finished running node model.learn_dbt.src_reviews
[0m08:34:59.124269 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:59.124795 [debug] [Thread-4  ]: Finished running node seed.learn_dbt.seed_full_moon_dates
[0m08:34:59.124957 [debug] [Thread-1  ]: Began compiling node snapshot.learn_dbt.scd_raw_listings
[0m08:34:59.125136 [debug] [Thread-3  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:59.125596 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:34:59.125790 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_hosts_cleansed
[0m08:34:59.125983 [debug] [Thread-1  ]: Compiling snapshot.learn_dbt.scd_raw_listings
[0m08:34:59.126382 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:34:59.126547 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:59.126946 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_hosts_cleansed"
[0m08:34:59.130042 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.130247 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:59.130415 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:59.130572 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_hosts_cleansed
[0m08:34:59.130742 [debug] [Thread-1  ]: Began executing node snapshot.learn_dbt.scd_raw_listings
[0m08:34:59.130931 [debug] [Thread-3  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:59.143267 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:34:59.143428 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_hosts_cleansed
[0m08:34:59.143587 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.150743 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:34:59.159478 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_hosts_cleansed"
[0m08:34:59.160020 [debug] [Thread-1  ]: Finished running node snapshot.learn_dbt.scd_raw_listings
[0m08:34:59.160257 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.160466 [debug] [Thread-1  ]: Began running node model.learn_dbt.dim_listings_cleansed
[0m08:34:59.160575 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.160765 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:59.160887 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.161196 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_cleansed"
[0m08:34:59.161327 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:59.161447 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.161559 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_hosts_cleansed
[0m08:34:59.161676 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.dim_listings_cleansed
[0m08:34:59.161798 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.162155 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:34:59.162276 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.162391 [debug] [Thread-1  ]: Compiling model.learn_dbt.dim_listings_cleansed
[0m08:34:59.162708 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:34:59.162840 [debug] [Thread-2  ]: Began running node model.learn_dbt.fact_reviews
[0m08:34:59.163210 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_hosts_cleansed
[0m08:34:59.168197 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_cleansed"
[0m08:34:59.168618 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.learn_dbt.fact_reviews"
[0m08:34:59.168874 [debug] [Thread-3  ]: Began running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:59.168973 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:59.169110 [debug] [Thread-2  ]: Began compiling node model.learn_dbt.fact_reviews
[0m08:34:59.169389 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:34:59.169648 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:34:59.169767 [debug] [Thread-2  ]: Compiling model.learn_dbt.fact_reviews
[0m08:34:59.169857 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.169958 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:59.170054 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:59.186500 [debug] [Thread-2  ]: Writing injected SQL for node "model.learn_dbt.fact_reviews"
[0m08:34:59.186676 [debug] [Thread-1  ]: Began executing node model.learn_dbt.dim_listings_cleansed
[0m08:34:59.186793 [debug] [Thread-3  ]: Compiling test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:59.186895 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:59.187048 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.192433 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:34:59.224134 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:34:59.224305 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.224653 [debug] [Thread-1  ]: Finished running node model.learn_dbt.dim_listings_cleansed
[0m08:34:59.224887 [debug] [Thread-2  ]: Began executing node model.learn_dbt.fact_reviews
[0m08:34:59.225049 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:59.225379 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.225477 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.225563 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.225841 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:34:59.226134 [debug] [Thread-2  ]: Finished running node model.learn_dbt.fact_reviews
[0m08:34:59.226239 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:59.226341 [debug] [Thread-3  ]: Began executing node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:59.226442 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:59.226554 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:59.226653 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.226809 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.226915 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:59.227165 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:34:59.227444 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:34:59.227719 [debug] [Thread-3  ]: Finished running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:34:59.230159 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:34:59.230278 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:59.230406 [debug] [Thread-4  ]: Began running node model.learn_dbt.dim_listings_w_hosts
[0m08:34:59.230554 [debug] [Thread-3  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:59.230729 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:59.230999 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.learn_dbt.dim_listings_w_hosts"
[0m08:34:59.231277 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:34:59.231372 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.234900 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:34:59.235026 [debug] [Thread-4  ]: Began compiling node model.learn_dbt.dim_listings_w_hosts
[0m08:34:59.235136 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:59.235247 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:59.235382 [debug] [Thread-4  ]: Compiling model.learn_dbt.dim_listings_w_hosts
[0m08:34:59.235499 [debug] [Thread-3  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:59.235588 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.235689 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.237527 [debug] [Thread-4  ]: Writing injected SQL for node "model.learn_dbt.dim_listings_w_hosts"
[0m08:34:59.241328 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:34:59.241456 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:59.241766 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:34:59.241955 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.242110 [debug] [Thread-1  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:59.242240 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.242545 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:34:59.242648 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.242882 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:34:59.242985 [debug] [Thread-4  ]: Began executing node model.learn_dbt.dim_listings_w_hosts
[0m08:34:59.243093 [debug] [Thread-2  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:59.243212 [debug] [Thread-3  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:59.243309 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:59.243410 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.243640 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:59.243740 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.243834 [debug] [Thread-1  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:34:59.244105 [debug] [Thread-4  ]: Finished running node model.learn_dbt.dim_listings_w_hosts
[0m08:34:59.244207 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:59.244499 [debug] [Thread-3  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:34:59.246245 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:34:59.246380 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:59.246507 [debug] [Thread-2  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:59.246618 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:59.246908 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:34:59.253354 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:59.253462 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.253710 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:34:59.253823 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:59.253924 [debug] [Thread-2  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:34:59.254033 [debug] [Thread-1  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:59.254132 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:59.254233 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:59.254328 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:34:59.254432 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.254525 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:59.256831 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:34:59.257525 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:34:59.260778 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:34:59.261004 [debug] [Thread-1  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:59.261356 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:34:59.261468 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.261566 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:59.261681 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:59.261772 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.261871 [debug] [Thread-1  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:59.261985 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.262093 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:59.264700 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:34:59.265031 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:34:59.265143 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.265298 [debug] [Thread-4  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:59.265633 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:34:59.265728 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.265975 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:34:59.266096 [debug] [Thread-3  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:59.266218 [debug] [Thread-1  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:59.266321 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:59.266560 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:34:59.266665 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.266760 [debug] [Thread-4  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:59.266859 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:59.267134 [debug] [Thread-1  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:34:59.271494 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:34:59.271619 [debug] [Thread-3  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:59.271745 [debug] [Thread-1  ]: Began running node model.learn_dbt.mart_fullmoon_reviews
[0m08:34:59.274057 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:34:59.274370 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.learn_dbt.mart_fullmoon_reviews"
[0m08:34:59.274523 [debug] [Thread-1  ]: Began compiling node model.learn_dbt.mart_fullmoon_reviews
[0m08:34:59.274615 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.274734 [debug] [Thread-1  ]: Compiling model.learn_dbt.mart_fullmoon_reviews
[0m08:34:59.274821 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.274923 [debug] [Thread-4  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:59.277363 [debug] [Thread-1  ]: Writing injected SQL for node "model.learn_dbt.mart_fullmoon_reviews"
[0m08:34:59.277490 [debug] [Thread-3  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:59.277601 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.277735 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.278062 [debug] [Thread-4  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:34:59.278371 [debug] [Thread-3  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:34:59.278463 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.278581 [debug] [Thread-4  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:34:59.278756 [debug] [Thread-1  ]: Began executing node model.learn_dbt.mart_fullmoon_reviews
[0m08:34:59.279019 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:34:59.279128 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.279229 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:34:59.279517 [debug] [Thread-1  ]: Finished running node model.learn_dbt.mart_fullmoon_reviews
[0m08:34:59.279620 [debug] [Thread-4  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:34:59.281463 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:34:59.281595 [debug] [Thread-3  ]: Began running node analysis.learn_dbt.full_moon_no_sleep
[0m08:34:59.281865 [debug] [Thread-3  ]: Acquiring new snowflake connection "analysis.learn_dbt.full_moon_no_sleep"
[0m08:34:59.281982 [debug] [Thread-3  ]: Began compiling node analysis.learn_dbt.full_moon_no_sleep
[0m08:34:59.282089 [debug] [Thread-3  ]: Compiling analysis.learn_dbt.full_moon_no_sleep
[0m08:34:59.282190 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.283843 [debug] [Thread-3  ]: Writing injected SQL for node "analysis.learn_dbt.full_moon_no_sleep"
[0m08:34:59.283962 [debug] [Thread-4  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:34:59.284105 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:59.284461 [debug] [Thread-4  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:34:59.284551 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.284705 [debug] [Thread-3  ]: Began executing node analysis.learn_dbt.full_moon_no_sleep
[0m08:34:59.284805 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.285087 [debug] [Thread-3  ]: Finished running node analysis.learn_dbt.full_moon_no_sleep
[0m08:34:59.733527 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0.48 seconds
[0m08:34:59.736639 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:34:59.737460 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.737800 [debug] [Thread-2  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:59.738124 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.738440 [debug] [Thread-2  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:34:59.979397 [debug] [Thread-2  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:34:59.980839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:59.981166 [debug] [MainThread]: Connection 'model.learn_dbt.mart_fullmoon_reviews' was properly closed.
[0m08:34:59.981436 [debug] [MainThread]: Connection 'test.learn_dbt.no_nulls_in_dim_listings' was properly closed.
[0m08:34:59.981693 [debug] [MainThread]: Connection 'analysis.learn_dbt.full_moon_no_sleep' was properly closed.
[0m08:34:59.981947 [debug] [MainThread]: Connection 'test.learn_dbt.consistent_created_at' was properly closed.
[0m08:34:59.999910 [info ] [MainThread]: Done.
[0m08:35:00.004884 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m08:35:00.005067 [info ] [MainThread]: Building catalog
[0m08:35:00.006641 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m08:35:00.011496 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m08:35:00.011652 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m08:35:00.011758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:02.023971 [debug] [ThreadPool]: SQL status: SUCCESS 87 in 2.01 seconds
[0m08:35:02.046637 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m08:35:02.233399 [info ] [MainThread]: Catalog written to /Users/nigelbrown/learn-dbt/target/catalog.json
[0m08:35:02.233931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87e310>]}
[0m08:35:02.234165 [debug] [MainThread]: Flushing usage events
[0m08:35:02.687085 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:35:02.688064 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-10-17 08:35:12.069734 | abc3a880-fd63-4f70-8672-10686e662a34 ==============================
[0m08:35:12.069768 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:35:12.070203 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m08:35:12.070317 [debug] [MainThread]: Tracking: tracking
[0m08:35:12.070541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fce80>]}
[0m08:35:12.071524 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m08:35:12.071715 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m08:35:12.071884 [info ] [MainThread]: 
[0m08:35:12.072038 [info ] [MainThread]: 
[0m08:35:12.072188 [info ] [MainThread]: Press Ctrl+C to exit.
[0m08:56:33.732779 [debug] [MainThread]: Flushing usage events
[0m08:56:34.242118 [info ] [MainThread]: ctrl-c


============================== 2022-10-17 08:56:44.388162 | 7623a76f-4dce-42f9-8fe1-0ff30c0202ff ==============================
[0m08:56:44.388185 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:56:44.388690 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:56:44.388811 [debug] [MainThread]: Tracking: tracking
[0m08:56:44.389063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761cd00>]}
[0m08:56:44.442496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bf490>]}
[0m08:56:44.442736 [debug] [MainThread]: Flushing usage events
[0m08:56:44.893917 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading learn_dbt: schema.yml - Runtime Error
    Syntax error near line 64
    ------------------------------
    61 |       description: Date the host data was last updated.
    62 | 
    63 | 
    64 | - name: dim_listings_w_hosts
    65 |     tests:
    66 |       - dbt_expectations.expect_table_row_count_to_equal_other_table:
    67 |           compare_model: source('airbnb', 'listings')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1:
        version: 2
        ^
    expected <block end>, but found '-'
      in "<unicode string>", line 64, column 1:
        - name: dim_listings_w_hosts
        ^


============================== 2022-10-17 08:58:10.112032 | 2420322e-c607-4a47-9862-c8b3f4d8f0ea ==============================
[0m08:58:10.112074 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:58:10.113853 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:58:10.114006 [debug] [MainThread]: Tracking: tracking
[0m08:58:10.114420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d89e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d89e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d89ee0>]}
[0m08:58:10.161745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d89ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f9c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f6c6a0>]}
[0m08:58:10.161999 [debug] [MainThread]: Flushing usage events
[0m08:58:10.677605 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading learn_dbt: schema.yml - Runtime Error
    Syntax error near line 64
    ------------------------------
    61 |       description: Date the host data was last updated.
    62 | 
    63 | 
    64 | - name: dim_listings_w_hosts
    65 |   tests:
    66 |     - dbt_expectations.expect_table_row_count_to_equal_other_table:
    67 |         compare_model: source('airbnb', 'listings')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1:
        version: 2
        ^
    expected <block end>, but found '-'
      in "<unicode string>", line 64, column 1:
        - name: dim_listings_w_hosts
        ^


============================== 2022-10-17 08:59:21.563390 | 7f2b93a7-d609-42d5-a62d-39db844100d7 ==============================
[0m08:59:21.563411 [info ] [MainThread]: Running with dbt=1.3.0
[0m08:59:21.563996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:59:21.564129 [debug] [MainThread]: Tracking: tracking
[0m08:59:21.564368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b27fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3a070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3a0d0>]}
[0m08:59:21.657955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:59:21.658394 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m08:59:21.665531 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_reviews' in the 'models' section of file 'models/schema.yml'
[0m08:59:21.715976 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.learn_dbt.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe' (models/schema.yml) depends on a node named 'fct_reviews' which was not found
[0m08:59:21.716328 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.learn_dbt.not_null_fct_reviews_reviewer_name.8204e43c88' (models/schema.yml) depends on a node named 'fct_reviews' which was not found
[0m08:59:21.716509 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.learn_dbt.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef' (models/schema.yml) depends on a node named 'fct_reviews' which was not found
[0m08:59:21.731319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f2b93a7-d609-42d5-a62d-39db844100d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbf0d0>]}
[0m08:59:21.740492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f2b93a7-d609-42d5-a62d-39db844100d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb1df0>]}
[0m08:59:21.740737 [info ] [MainThread]: Found 8 models, 19 tests, 1 snapshot, 1 analysis, 714 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:59:21.740939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f2b93a7-d609-42d5-a62d-39db844100d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3a0a0>]}
[0m08:59:21.742235 [info ] [MainThread]: 
[0m08:59:21.742664 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:59:21.743350 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:59:21.750908 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:59:21.751100 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:59:21.751208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:22.549541 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.8 seconds
[0m08:59:22.552757 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:59:22.742543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f2b93a7-d609-42d5-a62d-39db844100d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e59ca0>]}
[0m08:59:22.743651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:59:22.744243 [info ] [MainThread]: 
[0m08:59:22.749765 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:59:22.750049 [debug] [Thread-2  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:59:22.750308 [debug] [Thread-3  ]: Began running node test.learn_dbt.consistent_created_at
[0m08:59:22.750592 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m08:59:22.750827 [info ] [Thread-1  ]: 1 of 19 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m08:59:22.751160 [info ] [Thread-2  ]: 2 of 19 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:59:22.751538 [info ] [Thread-3  ]: 3 of 19 START test consistent_created_at ....................................... [RUN]
[0m08:59:22.751815 [info ] [Thread-4  ]: 4 of 19 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m08:59:22.752676 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:59:22.753376 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:59:22.754027 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:59:22.754663 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m08:59:22.754873 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:59:22.755069 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:59:22.755257 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m08:59:22.755443 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m08:59:22.755665 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:59:22.755855 [debug] [Thread-2  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:59:22.756036 [debug] [Thread-3  ]: Compiling test.learn_dbt.consistent_created_at
[0m08:59:22.756213 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m08:59:22.762482 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:59:22.810625 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:59:22.813197 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m08:59:22.816332 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m08:59:22.817202 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:22.817479 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m08:59:22.817617 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:22.817744 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:22.823416 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:22.830049 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m08:59:22.830244 [debug] [Thread-2  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:59:22.830370 [debug] [Thread-3  ]: Began executing node test.learn_dbt.consistent_created_at
[0m08:59:22.830471 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:59:22.832499 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:59:22.835425 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m08:59:22.835943 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m08:59:22.837942 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:59:22.838245 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m08:59:22.838462 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:59:22.838871 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:59:22.839218 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m08:59:22.840006 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:59:22.840146 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:59:22.840624 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m08:59:22.840761 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from airbnb.dev.dim_hosts_cleansed
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m08:59:22.840869 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:59:22.840972 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:59:22.841072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:59:23.708963 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.87 seconds
[0m08:59:23.722454 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:23.723481 [debug] [Thread-3  ]: On test.learn_dbt.consistent_created_at: Close
[0m08:59:23.724065 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.88 seconds
[0m08:59:23.727039 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:23.727364 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m08:59:23.729257 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m08:59:23.731494 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:23.732408 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:59:23.890996 [info ] [Thread-3  ]: 3 of 19 PASS consistent_created_at ............................................. [[32mPASS[0m in 1.14s]
[0m08:59:23.891913 [info ] [Thread-1  ]: 1 of 19 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 1.14s]
[0m08:59:23.892684 [info ] [Thread-2  ]: 2 of 19 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.14s]
[0m08:59:23.893524 [debug] [Thread-3  ]: Finished running node test.learn_dbt.consistent_created_at
[0m08:59:23.894191 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:59:23.894698 [debug] [Thread-2  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:59:23.894977 [debug] [Thread-3  ]: Began running node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m08:59:23.895374 [debug] [Thread-1  ]: Began running node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m08:59:23.895720 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m08:59:23.896025 [info ] [Thread-3  ]: 5 of 19 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m08:59:23.896282 [info ] [Thread-1  ]: 6 of 19 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [RUN]
[0m08:59:23.896519 [info ] [Thread-2  ]: 7 of 19 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m08:59:23.897319 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m08:59:23.898074 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m08:59:23.898813 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m08:59:23.899061 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m08:59:23.899286 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m08:59:23.899503 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m08:59:23.899759 [debug] [Thread-3  ]: Compiling test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m08:59:23.899988 [debug] [Thread-1  ]: Compiling test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m08:59:23.900200 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m08:59:23.906814 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m08:59:23.918782 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m08:59:23.924139 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m08:59:23.924373 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
describe table airbnb.dev.dim_listings_w_hosts
[0m08:59:23.924605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:59:23.925205 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:23.925821 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m08:59:23.925971 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:23.928499 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m08:59:23.928934 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m08:59:23.931624 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m08:59:23.932547 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m08:59:23.932731 [debug] [Thread-3  ]: On test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m08:59:23.933580 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m08:59:23.933721 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:59:23.933858 [debug] [Thread-2  ]: On test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        
      
    ) dbt_internal_test
[0m08:59:23.934351 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:59:24.461682 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.62 seconds
[0m08:59:24.463544 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:24.463812 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m08:59:24.469928 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.55 seconds
[0m08:59:24.477931 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m08:59:24.478467 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:24.478672 [debug] [Thread-1  ]: Began executing node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m08:59:24.481700 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m08:59:24.483866 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m08:59:24.484030 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('LISTING_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('LISTING_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('ROOM_TYPE' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('MINIMUM_NIGHTS' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('PRICE' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_IS_SUPERHOST' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('CREATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        union all
        
        select
            cast('UPDATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m08:59:24.615664 [warn ] [Thread-4  ]: 4 of 19 WARN 1 dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[33mWARN 1[0m in 1.86s]
[0m08:59:24.617312 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m08:59:24.618034 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m08:59:24.618499 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:59:24.621061 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:24.621358 [info ] [Thread-4  ]: 8 of 19 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m08:59:24.621637 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m08:59:24.622451 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:59:24.624010 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:59:24.624345 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:59:24.633266 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:59:24.634315 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:24.634591 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:59:24.637818 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:59:24.638845 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m08:59:24.639045 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m08:59:24.639214 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:59:24.701149 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.77 seconds
[0m08:59:24.702612 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:24.702815 [debug] [Thread-2  ]: On test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m08:59:24.790675 [info ] [Thread-1  ]: 6 of 19 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[32mPASS[0m in 0.89s]
[0m08:59:24.791386 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m08:59:24.791676 [debug] [Thread-1  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:59:24.791916 [info ] [Thread-1  ]: 9 of 19 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m08:59:24.792871 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:59:24.793131 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:59:24.793368 [debug] [Thread-1  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:59:24.806360 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:59:24.806951 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:24.807146 [debug] [Thread-1  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:59:24.809915 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:59:24.816928 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m08:59:24.823365 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    regexp_instr(price, '^\\$[0-9][0-9\\.]+$', 1, 1)


 > 0
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m08:59:24.829789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:59:24.875543 [info ] [Thread-2  ]: 7 of 19 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 0.98s]
[0m08:59:24.881885 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m08:59:24.890225 [debug] [Thread-2  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m08:59:24.890423 [info ] [Thread-2  ]: 10 of 19 START test dim_listings_minimum_nights ................................ [RUN]
[0m08:59:24.890847 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:59:24.890959 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m08:59:24.891067 [debug] [Thread-2  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m08:59:24.893117 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:59:24.894042 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:24.894246 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m08:59:24.896144 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m08:59:24.896924 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m08:59:24.897095 [debug] [Thread-2  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m08:59:24.897246 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:59:24.993685 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.06 seconds
[0m08:59:24.994935 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:24.995153 [debug] [Thread-3  ]: On test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m08:59:25.131137 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m08:59:25.132093 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:25.132233 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m08:59:25.154142 [info ] [Thread-3  ]: 5 of 19 PASS dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[32mPASS[0m in 1.26s]
[0m08:59:25.154454 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m08:59:25.154588 [debug] [Thread-3  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:59:25.154690 [info ] [Thread-3  ]: 11 of 19 START test no_nulls_in_dim_listings ................................... [RUN]
[0m08:59:25.155017 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:59:25.155117 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m08:59:25.155217 [debug] [Thread-3  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m08:59:25.159298 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:59:25.160720 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:59:25.160828 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:59:25.299218 [info ] [Thread-4  ]: 8 of 19 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.68s]
[0m08:59:25.299650 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m08:59:25.299809 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:59:25.299986 [info ] [Thread-4  ]: 12 of 19 START test not_null_dim_hosts_cleansed_host_id ........................ [RUN]
[0m08:59:25.300462 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:59:25.300595 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:59:25.300721 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:59:25.305850 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:59:25.307627 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:25.307781 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:59:25.309916 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:59:25.310666 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:59:25.310924 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:59:25.311150 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:59:25.397452 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m08:59:25.398600 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:25.410563 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m08:59:25.414771 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m08:59:25.415728 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:25.415862 [debug] [Thread-2  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m08:59:25.576101 [info ] [Thread-1  ]: 9 of 19 PASS dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[32mPASS[0m in 0.78s]
[0m08:59:25.576569 [info ] [Thread-2  ]: 10 of 19 PASS dim_listings_minimum_nights ...................................... [[32mPASS[0m in 0.69s]
[0m08:59:25.577513 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m08:59:25.578070 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m08:59:25.578309 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:59:25.578509 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:59:25.578942 [info ] [Thread-1  ]: 13 of 19 START test not_null_dim_hosts_cleansed_host_name ...................... [RUN]
[0m08:59:25.579521 [info ] [Thread-2  ]: 14 of 19 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m08:59:25.580029 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:59:25.580392 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:59:25.580522 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:59:25.580637 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:59:25.580752 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:59:25.580856 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:59:25.583616 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:59:25.586423 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:59:25.586826 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:25.586961 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:59:25.588711 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:59:25.588935 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:25.589053 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:59:25.591752 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:59:25.592391 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:59:25.592533 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:59:25.592646 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:59:25.592940 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:59:25.593422 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from airbnb.dev.dim_hosts_cleansed
where host_name is null



      
    ) dbt_internal_test
[0m08:59:25.593864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:59:25.668508 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 0.51 seconds
[0m08:59:25.669834 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:59:25.670598 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:25.670778 [debug] [Thread-3  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m08:59:25.673036 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:59:25.673661 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m08:59:25.673778 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m08:59:25.807354 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m08:59:25.807808 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.5 seconds
[0m08:59:25.832361 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:25.876319 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:25.878708 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m08:59:25.879149 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m08:59:26.021791 [info ] [Thread-3  ]: 11 of 19 PASS no_nulls_in_dim_listings ......................................... [[32mPASS[0m in 0.87s]
[0m08:59:26.022400 [debug] [Thread-3  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m08:59:26.022613 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:59:26.022858 [info ] [Thread-3  ]: 15 of 19 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m08:59:26.023456 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:59:26.023624 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:59:26.023795 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:59:26.028404 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:59:26.029164 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:26.029350 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:59:26.031767 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:59:26.032179 [info ] [Thread-4  ]: 12 of 19 PASS not_null_dim_hosts_cleansed_host_id .............................. [[32mPASS[0m in 0.73s]
[0m08:59:26.032629 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:59:26.032798 [debug] [Thread-4  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:59:26.033195 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:59:26.033399 [info ] [Thread-4  ]: 16 of 19 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m08:59:26.033549 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:59:26.034034 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:59:26.034170 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:59:26.034321 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:59:26.035044 [debug] [Thread-4  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:59:26.040092 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:59:26.040462 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:26.040602 [debug] [Thread-4  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:59:26.042670 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:59:26.043773 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:59:26.043903 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m08:59:26.044019 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:59:26.114856 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m08:59:26.116335 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:26.116922 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m08:59:26.117235 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m08:59:26.118914 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:26.119187 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:59:26.276919 [info ] [Thread-2  ]: 14 of 19 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.70s]
[0m08:59:26.294618 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:59:26.306593 [info ] [Thread-1  ]: 13 of 19 PASS not_null_dim_hosts_cleansed_host_name ............................ [[32mPASS[0m in 0.73s]
[0m08:59:26.314829 [debug] [Thread-2  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:59:26.315322 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:59:26.315433 [info ] [Thread-2  ]: 17 of 19 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:59:26.315672 [debug] [Thread-1  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:59:26.316218 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:59:26.316523 [info ] [Thread-1  ]: 18 of 19 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m08:59:26.316895 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:59:26.318055 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:59:26.318286 [debug] [Thread-2  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:59:26.318683 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:59:26.322606 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:59:26.329214 [debug] [Thread-1  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:59:26.361801 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:59:26.362057 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:26.362662 [debug] [Thread-2  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:59:26.364670 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:59:26.364943 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:26.365258 [debug] [Thread-1  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:59:26.367282 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:59:26.367990 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:59:26.368246 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:59:26.368617 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:59:26.368761 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:59:26.368910 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:59:26.370138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:59:26.578988 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m08:59:26.580419 [debug] [Thread-4  ]: finished collecting timing info
[0m08:59:26.580825 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m08:59:26.601893 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m08:59:26.602939 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:26.603267 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:59:26.811262 [info ] [Thread-3  ]: 15 of 19 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.79s]
[0m08:59:26.811778 [info ] [Thread-4  ]: 16 of 19 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.78s]
[0m08:59:26.812259 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:59:26.812605 [debug] [Thread-4  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:59:26.812795 [debug] [Thread-3  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:59:26.813090 [info ] [Thread-3  ]: 19 of 19 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:59:26.813613 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:59:26.813771 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:59:26.813924 [debug] [Thread-3  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:59:26.818458 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:59:26.818883 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:26.819048 [debug] [Thread-3  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:59:26.862119 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:59:26.864155 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:59:26.864282 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:59:26.864386 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:59:26.967248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m08:59:26.968623 [debug] [Thread-1  ]: finished collecting timing info
[0m08:59:26.968817 [debug] [Thread-1  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m08:59:26.973297 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.6 seconds
[0m08:59:26.974371 [debug] [Thread-2  ]: finished collecting timing info
[0m08:59:26.974537 [debug] [Thread-2  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:59:27.129284 [info ] [Thread-2  ]: 17 of 19 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.81s]
[0m08:59:27.129627 [debug] [Thread-2  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:59:27.131889 [info ] [Thread-1  ]: 18 of 19 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.81s]
[0m08:59:27.132141 [debug] [Thread-1  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:59:27.313052 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m08:59:27.315244 [debug] [Thread-3  ]: finished collecting timing info
[0m08:59:27.315514 [debug] [Thread-3  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:59:27.474535 [info ] [Thread-3  ]: 19 of 19 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.66s]
[0m08:59:27.475451 [debug] [Thread-3  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:59:27.477278 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:59:27.478144 [info ] [MainThread]: 
[0m08:59:27.478666 [info ] [MainThread]: Finished running 19 tests in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m08:59:27.479191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:27.479453 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m08:59:27.479672 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:59:27.479874 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:59:27.480074 [debug] [MainThread]: Connection 'test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m08:59:27.498488 [info ] [MainThread]: 
[0m08:59:27.498852 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m08:59:27.499169 [info ] [MainThread]: 
[0m08:59:27.499459 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models/schema.yml)[0m
[0m08:59:27.499755 [warn ] [MainThread]:   Got 1 result, configured to warn if != 0
[0m08:59:27.500037 [info ] [MainThread]: 
[0m08:59:27.500319 [info ] [MainThread]:   compiled Code at target/compiled/learn_dbt/models/schema.yml/dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m08:59:27.500626 [info ] [MainThread]: 
[0m08:59:27.500910 [info ] [MainThread]: Done. PASS=18 WARN=1 ERROR=0 SKIP=0 TOTAL=19
[0m08:59:27.501270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181bea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181be2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118af6e20>]}
[0m08:59:27.501509 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 09:00:17.697763 | d9b07a32-8756-415d-830b-99bf7a68d45a ==============================
[0m09:00:17.697794 [info ] [MainThread]: Running with dbt=1.3.0
[0m09:00:17.698396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nigelbrown/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m09:00:17.698514 [debug] [MainThread]: Tracking: tracking
[0m09:00:17.698744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d4f40>]}
[0m09:00:17.788088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:00:17.788573 [debug] [MainThread]: Partial parsing: update schema file: learn_dbt://models/schema.yml
[0m09:00:17.828264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9b07a32-8756-415d-830b-99bf7a68d45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfc0d0>]}
[0m09:00:17.836966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9b07a32-8756-415d-830b-99bf7a68d45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b686d0>]}
[0m09:00:17.837157 [info ] [MainThread]: Found 8 models, 22 tests, 1 snapshot, 1 analysis, 714 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m09:00:17.837353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9b07a32-8756-415d-830b-99bf7a68d45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b68700>]}
[0m09:00:17.838620 [info ] [MainThread]: 
[0m09:00:17.838985 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m09:00:17.839664 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m09:00:17.846695 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m09:00:17.846818 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m09:00:17.846920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:18.571474 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.72 seconds
[0m09:00:18.574704 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m09:00:18.761446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9b07a32-8756-415d-830b-99bf7a68d45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b68880>]}
[0m09:00:18.762640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:00:18.763241 [info ] [MainThread]: 
[0m09:00:18.769728 [debug] [Thread-1  ]: Began running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m09:00:18.770002 [debug] [Thread-2  ]: Began running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:00:18.770270 [debug] [Thread-3  ]: Began running node test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a
[0m09:00:18.770643 [debug] [Thread-4  ]: Began running node test.learn_dbt.consistent_created_at
[0m09:00:18.770889 [info ] [Thread-1  ]: 1 of 22 START test accepted_values_dim_hosts_cleansed_is_superhost__t__f ....... [RUN]
[0m09:00:18.771197 [info ] [Thread-2  ]: 2 of 22 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m09:00:18.771468 [info ] [Thread-3  ]: 3 of 22 START test accepted_values_fact_reviews_review_sentiment__positive__neutral__negative  [RUN]
[0m09:00:18.771723 [info ] [Thread-4  ]: 4 of 22 START test consistent_created_at ....................................... [RUN]
[0m09:00:18.772557 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m09:00:18.773269 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:00:18.773927 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a"
[0m09:00:18.774550 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.consistent_created_at"
[0m09:00:18.774765 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m09:00:18.774955 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:00:18.775139 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a
[0m09:00:18.775325 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.consistent_created_at
[0m09:00:18.775535 [debug] [Thread-1  ]: Compiling test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m09:00:18.775723 [debug] [Thread-2  ]: Compiling test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:00:18.775905 [debug] [Thread-3  ]: Compiling test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a
[0m09:00:18.776084 [debug] [Thread-4  ]: Compiling test.learn_dbt.consistent_created_at
[0m09:00:18.782173 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m09:00:18.787829 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:00:18.792639 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a"
[0m09:00:18.828099 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.consistent_created_at"
[0m09:00:18.828635 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:18.828753 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:18.828940 [debug] [Thread-2  ]: Began executing node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:00:18.829054 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:18.829203 [debug] [Thread-1  ]: Began executing node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m09:00:18.829314 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:18.841742 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:00:18.841968 [debug] [Thread-3  ]: Began executing node test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a
[0m09:00:18.843764 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m09:00:18.843887 [debug] [Thread-4  ]: Began executing node test.learn_dbt.consistent_created_at
[0m09:00:18.845695 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a"
[0m09:00:18.848306 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.consistent_created_at"
[0m09:00:18.848788 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:00:18.849060 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m09:00:18.849192 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:00:18.849610 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m09:00:18.850426 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a"
[0m09:00:18.850535 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_superhost as value_field,
        count(*) as n_records

    from airbnb.dev.dim_hosts_cleansed
    group by is_superhost

)

select *
from all_values
where value_field not in (
    't','f'
)



      
    ) dbt_internal_test
[0m09:00:18.850990 [debug] [Thread-3  ]: On test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        review_sentiment as value_field,
        count(*) as n_records

    from airbnb.dev.fact_reviews
    group by review_sentiment

)

select *
from all_values
where value_field not in (
    'positive','neutral','negative'
)



      
    ) dbt_internal_test
[0m09:00:18.851310 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.consistent_created_at"
[0m09:00:18.851449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:00:18.851561 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:00:18.851679 [debug] [Thread-4  ]: On test.learn_dbt.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from  airbnb.dev.dim_listings_cleansed l
inner join airbnb.dev.fact_reviews f
using (listing_id) 
where l.created_at >= f.review_date
      
    ) dbt_internal_test
[0m09:00:18.853031 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:00:19.485387 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m09:00:19.493527 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:19.495455 [debug] [Thread-4  ]: On test.learn_dbt.consistent_created_at: Close
[0m09:00:19.606049 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.76 seconds
[0m09:00:19.610124 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:19.610585 [debug] [Thread-2  ]: On test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m09:00:19.646912 [info ] [Thread-4  ]: 4 of 22 PASS consistent_created_at ............................................. [[32mPASS[0m in 0.87s]
[0m09:00:19.647750 [debug] [Thread-4  ]: Finished running node test.learn_dbt.consistent_created_at
[0m09:00:19.648127 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m09:00:19.648561 [info ] [Thread-4  ]: 5 of 22 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m09:00:19.649572 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m09:00:19.649827 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m09:00:19.650068 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m09:00:19.671644 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m09:00:19.672065 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m09:00:19.673656 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:19.673916 [debug] [Thread-1  ]: On test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4: Close
[0m09:00:19.675449 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:19.675644 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m09:00:19.678434 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m09:00:19.679868 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m09:00:19.680042 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m09:00:19.680229 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:00:20.000939 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.15 seconds
[0m09:00:20.004417 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:20.005286 [debug] [Thread-3  ]: On test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a: Close
[0m09:00:20.007869 [info ] [Thread-2  ]: 2 of 22 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.23s]
[0m09:00:20.008593 [debug] [Thread-2  ]: Finished running node test.learn_dbt.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:00:20.008929 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m09:00:20.009665 [info ] [Thread-2  ]: 6 of 22 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m09:00:20.010676 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m09:00:20.011268 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m09:00:20.011623 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m09:00:20.022539 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m09:00:20.023202 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:20.023402 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m09:00:20.026137 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m09:00:20.027126 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m09:00:20.027282 [debug] [Thread-2  ]: On test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m09:00:20.027428 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:00:20.222818 [info ] [Thread-1  ]: 1 of 22 PASS accepted_values_dim_hosts_cleansed_is_superhost__t__f ............. [[32mPASS[0m in 1.45s]
[0m09:00:20.246641 [debug] [Thread-1  ]: Finished running node test.learn_dbt.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m09:00:20.252715 [debug] [Thread-1  ]: Began running node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m09:00:20.265463 [info ] [Thread-1  ]: 7 of 22 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [RUN]
[0m09:00:20.265892 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m09:00:20.283455 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m09:00:20.296177 [debug] [Thread-1  ]: Compiling test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m09:00:20.309409 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m09:00:20.309651 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
describe table airbnb.dev.dim_listings_w_hosts
[0m09:00:20.309764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:00:20.467900 [info ] [Thread-3  ]: 3 of 22 PASS accepted_values_fact_reviews_review_sentiment__positive__neutral__negative  [[32mPASS[0m in 1.69s]
[0m09:00:20.468576 [debug] [Thread-3  ]: Finished running node test.learn_dbt.accepted_values_fact_reviews_review_sentiment__positive__neutral__negative.57c678e44a
[0m09:00:20.468804 [debug] [Thread-3  ]: Began running node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m09:00:20.469114 [info ] [Thread-3  ]: 8 of 22 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m09:00:20.469887 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m09:00:20.470105 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m09:00:20.470290 [debug] [Thread-3  ]: Compiling test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m09:00:20.488092 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m09:00:20.501392 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:20.526600 [debug] [Thread-3  ]: Began executing node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m09:00:20.535687 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m09:00:20.564471 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m09:00:20.566249 [debug] [Thread-3  ]: On test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        
      
    ) dbt_internal_test
[0m09:00:20.566370 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:00:20.676039 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:00:20.677403 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:20.677606 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m09:00:20.679452 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.65 seconds
[0m09:00:20.680735 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:20.681044 [debug] [Thread-2  ]: On test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m09:00:20.794261 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.48 seconds
[0m09:00:20.798755 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m09:00:20.811569 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:20.813014 [debug] [Thread-1  ]: Began executing node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m09:00:20.814756 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m09:00:20.816150 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m09:00:20.816254 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('LISTING_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('LISTING_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('ROOM_TYPE' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('MINIMUM_NIGHTS' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('PRICE' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_IS_SUPERHOST' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('CREATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        union all
        
        select
            cast('UPDATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m09:00:20.866486 [info ] [Thread-2  ]: 6 of 22 PASS dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[32mPASS[0m in 0.86s]
[0m09:00:20.866865 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m09:00:20.867021 [debug] [Thread-2  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m09:00:20.867195 [info ] [Thread-2  ]: 9 of 22 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m09:00:20.867645 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m09:00:20.867777 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m09:00:20.867903 [debug] [Thread-2  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m09:00:20.872447 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m09:00:20.872975 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:20.873110 [debug] [Thread-2  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m09:00:20.875573 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m09:00:20.875923 [warn ] [Thread-4  ]: 5 of 22 WARN 1 dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[33mWARN 1[0m in 1.23s]
[0m09:00:20.876274 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m09:00:20.876417 [debug] [Thread-4  ]: Began running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m09:00:20.876888 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m09:00:20.877051 [info ] [Thread-4  ]: 10 of 22 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m09:00:20.877173 [debug] [Thread-2  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m09:00:20.877561 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m09:00:20.877677 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:00:20.877799 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m09:00:20.878275 [debug] [Thread-4  ]: Compiling test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m09:00:20.884897 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m09:00:20.885188 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:20.885306 [debug] [Thread-4  ]: Began executing node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m09:00:20.887043 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m09:00:20.888104 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m09:00:20.888216 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    regexp_instr(price, '^\\$[0-9][0-9\\.]+$', 1, 1)


 > 0
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m09:00:20.888321 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:00:20.946500 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m09:00:20.947790 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:20.947950 [debug] [Thread-1  ]: On test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m09:00:21.019199 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m09:00:21.020499 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:21.020680 [debug] [Thread-3  ]: On test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m09:00:21.131564 [info ] [Thread-1  ]: 7 of 22 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[32mPASS[0m in 0.87s]
[0m09:00:21.151739 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m09:00:21.157012 [debug] [Thread-1  ]: Began running node test.learn_dbt.dim_listings_minimum_nights
[0m09:00:21.162956 [info ] [Thread-1  ]: 11 of 22 START test dim_listings_minimum_nights ................................ [RUN]
[0m09:00:21.163389 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m09:00:21.175171 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.dim_listings_minimum_nights
[0m09:00:21.184120 [debug] [Thread-1  ]: Compiling test.learn_dbt.dim_listings_minimum_nights
[0m09:00:21.186408 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.dim_listings_minimum_nights"
[0m09:00:21.186962 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:21.187104 [debug] [Thread-1  ]: Began executing node test.learn_dbt.dim_listings_minimum_nights
[0m09:00:21.189582 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.dim_listings_minimum_nights"
[0m09:00:21.190179 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.dim_listings_minimum_nights"
[0m09:00:21.190285 [debug] [Thread-1  ]: On test.learn_dbt.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1
limit 5
      
    ) dbt_internal_test
[0m09:00:21.190380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:00:21.244326 [info ] [Thread-3  ]: 8 of 22 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 0.77s]
[0m09:00:21.244711 [debug] [Thread-3  ]: Finished running node test.learn_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m09:00:21.244849 [debug] [Thread-3  ]: Began running node test.learn_dbt.no_nulls_in_dim_listings
[0m09:00:21.245006 [info ] [Thread-3  ]: 12 of 22 START test no_nulls_in_dim_listings ................................... [RUN]
[0m09:00:21.245409 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m09:00:21.245527 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.no_nulls_in_dim_listings
[0m09:00:21.245636 [debug] [Thread-3  ]: Compiling test.learn_dbt.no_nulls_in_dim_listings
[0m09:00:21.250056 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m09:00:21.250181 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m09:00:21.250327 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:00:21.424425 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.54 seconds
[0m09:00:21.437335 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m09:00:21.438279 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:21.450377 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:21.458138 [debug] [Thread-4  ]: On test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m09:00:21.458633 [debug] [Thread-2  ]: On test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m09:00:21.610998 [info ] [Thread-2  ]: 9 of 22 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 0.74s]
[0m09:00:21.611473 [debug] [Thread-2  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m09:00:21.611658 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m09:00:21.611809 [info ] [Thread-2  ]: 13 of 22 START test not_null_dim_hosts_cleansed_host_id ........................ [RUN]
[0m09:00:21.612390 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m09:00:21.612549 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m09:00:21.612702 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m09:00:21.618067 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m09:00:21.619458 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:21.619618 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m09:00:21.619982 [info ] [Thread-4  ]: 10 of 22 PASS dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[32mPASS[0m in 0.74s]
[0m09:00:21.622239 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m09:00:21.622869 [debug] [Thread-4  ]: Finished running node test.learn_dbt.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m09:00:21.623295 [debug] [Thread-4  ]: Began running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m09:00:21.623509 [info ] [Thread-4  ]: 14 of 22 START test not_null_dim_hosts_cleansed_host_name ...................... [RUN]
[0m09:00:21.624077 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m09:00:21.624410 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m09:00:21.624525 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_hosts_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m09:00:21.624659 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m09:00:21.624786 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:00:21.624923 [debug] [Thread-4  ]: Compiling test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m09:00:21.628166 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m09:00:21.628800 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:21.628926 [debug] [Thread-4  ]: Began executing node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m09:00:21.630865 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m09:00:21.631823 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m09:00:21.631939 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_name
from airbnb.dev.dim_hosts_cleansed
where host_name is null



      
    ) dbt_internal_test
[0m09:00:21.632045 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:00:21.689288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.5 seconds
[0m09:00:21.690533 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:21.690817 [debug] [Thread-1  ]: On test.learn_dbt.dim_listings_minimum_nights: Close
[0m09:00:21.732055 [debug] [Thread-3  ]: SQL status: SUCCESS 8 in 0.48 seconds
[0m09:00:21.733301 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m09:00:21.733675 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:21.733820 [debug] [Thread-3  ]: Began executing node test.learn_dbt.no_nulls_in_dim_listings
[0m09:00:21.736917 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.no_nulls_in_dim_listings"
[0m09:00:21.737592 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.no_nulls_in_dim_listings"
[0m09:00:21.737740 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from airbnb.dev.dim_listings_cleansed where
  LISTING_ID IS NULL OR
  LISTING_NAME IS NULL OR
  ROOM_TYPE IS NULL OR
  MINIMUM_NIGHTS IS NULL OR
  HOST_ID IS NULL OR
  PRICE IS NULL OR
  CREATED_AT IS NULL OR
  UPDATED_AT IS NULL OR
  
  FALSE

      
    ) dbt_internal_test
[0m09:00:21.873858 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m09:00:21.879790 [info ] [Thread-1  ]: 11 of 22 PASS dim_listings_minimum_nights ...................................... [[32mPASS[0m in 0.72s]
[0m09:00:21.880704 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:21.883431 [debug] [Thread-1  ]: Finished running node test.learn_dbt.dim_listings_minimum_nights
[0m09:00:21.883551 [debug] [Thread-3  ]: On test.learn_dbt.no_nulls_in_dim_listings: Close
[0m09:00:21.884153 [debug] [Thread-1  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:00:21.885071 [info ] [Thread-1  ]: 15 of 22 START test not_null_dim_listings_cleansed_host_id ..................... [RUN]
[0m09:00:21.885455 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:00:21.885568 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:00:21.885671 [debug] [Thread-1  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:00:21.888372 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:00:21.889300 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:21.889413 [debug] [Thread-1  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:00:21.891130 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:00:21.910032 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:00:21.916107 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m09:00:21.916221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:00:22.080637 [info ] [Thread-3  ]: 12 of 22 PASS no_nulls_in_dim_listings ......................................... [[32mPASS[0m in 0.84s]
[0m09:00:22.081166 [debug] [Thread-3  ]: Finished running node test.learn_dbt.no_nulls_in_dim_listings
[0m09:00:22.081370 [debug] [Thread-3  ]: Began running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:00:22.081540 [info ] [Thread-3  ]: 16 of 22 START test not_null_dim_listings_cleansed_listing_id .................. [RUN]
[0m09:00:22.082178 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:00:22.082359 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:00:22.082527 [debug] [Thread-3  ]: Compiling test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:00:22.086600 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:00:22.087031 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:22.087188 [debug] [Thread-3  ]: Began executing node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:00:22.090384 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:00:22.090982 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:00:22.091131 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m09:00:22.091262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:00:22.168443 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.54 seconds
[0m09:00:22.168905 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.54 seconds
[0m09:00:22.175693 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:22.184229 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:22.184467 [debug] [Thread-2  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05: Close
[0m09:00:22.184689 [debug] [Thread-4  ]: On test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830: Close
[0m09:00:22.362614 [info ] [Thread-2  ]: 13 of 22 PASS not_null_dim_hosts_cleansed_host_id .............................. [[32mPASS[0m in 0.75s]
[0m09:00:22.362946 [info ] [Thread-4  ]: 14 of 22 PASS not_null_dim_hosts_cleansed_host_name ............................ [[32mPASS[0m in 0.74s]
[0m09:00:22.363224 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m09:00:22.363441 [debug] [Thread-4  ]: Finished running node test.learn_dbt.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m09:00:22.363559 [debug] [Thread-2  ]: Began running node test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40
[0m09:00:22.363819 [debug] [Thread-4  ]: Began running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m09:00:22.364548 [info ] [Thread-2  ]: 17 of 22 START test not_null_fact_reviews_reviewer_name ........................ [RUN]
[0m09:00:22.364687 [info ] [Thread-4  ]: 18 of 22 START test positive_value_dim_listings_cleansed_minimum_nights ........ [RUN]
[0m09:00:22.365068 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40"
[0m09:00:22.365953 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m09:00:22.366059 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40
[0m09:00:22.366218 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m09:00:22.366325 [debug] [Thread-2  ]: Compiling test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40
[0m09:00:22.366418 [debug] [Thread-4  ]: Compiling test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m09:00:22.369052 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40"
[0m09:00:22.371691 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m09:00:22.371976 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:22.372088 [debug] [Thread-2  ]: Began executing node test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40
[0m09:00:22.374211 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40"
[0m09:00:22.374339 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:22.374465 [debug] [Thread-4  ]: Began executing node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m09:00:22.376035 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m09:00:22.376390 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40"
[0m09:00:22.376506 [debug] [Thread-2  ]: On test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reviewer_name
from airbnb.dev.fact_reviews
where reviewer_name is null



      
    ) dbt_internal_test
[0m09:00:22.376613 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:00:22.376864 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m09:00:22.377377 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from airbnb.dev.dim_listings_cleansed
where minimum_nights < 1

      
    ) dbt_internal_test
[0m09:00:22.377764 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:00:22.453888 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.54 seconds
[0m09:00:22.454993 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:22.455139 [debug] [Thread-1  ]: On test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m09:00:22.675710 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.58 seconds
[0m09:00:22.683407 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:22.683561 [debug] [Thread-3  ]: On test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m09:00:22.686433 [info ] [Thread-1  ]: 15 of 22 PASS not_null_dim_listings_cleansed_host_id ........................... [[32mPASS[0m in 0.80s]
[0m09:00:22.686728 [debug] [Thread-1  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:00:22.686857 [debug] [Thread-1  ]: Began running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:00:22.686959 [info ] [Thread-1  ]: 19 of 22 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m09:00:22.687283 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:00:22.687385 [debug] [Thread-1  ]: Began compiling node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:00:22.687493 [debug] [Thread-1  ]: Compiling test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:00:22.690751 [debug] [Thread-1  ]: Writing injected SQL for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:00:22.692232 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:22.692352 [debug] [Thread-1  ]: Began executing node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:00:22.725506 [debug] [Thread-1  ]: Writing runtime sql for node "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:00:22.726900 [debug] [Thread-1  ]: Using snowflake connection "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:00:22.727079 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:00:22.727182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:00:22.998796 [info ] [Thread-3  ]: 16 of 22 PASS not_null_dim_listings_cleansed_listing_id ........................ [[32mPASS[0m in 0.92s]
[0m09:00:22.999182 [debug] [Thread-3  ]: Finished running node test.learn_dbt.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:00:22.999324 [debug] [Thread-3  ]: Began running node test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c
[0m09:00:22.999479 [info ] [Thread-3  ]: 20 of 22 START test relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [RUN]
[0m09:00:22.999892 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c"
[0m09:00:23.000012 [debug] [Thread-3  ]: Began compiling node test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c
[0m09:00:23.000122 [debug] [Thread-3  ]: Compiling test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c
[0m09:00:23.003813 [debug] [Thread-3  ]: Writing injected SQL for node "test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c"
[0m09:00:23.004162 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:23.004292 [debug] [Thread-3  ]: Began executing node test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c
[0m09:00:23.006138 [debug] [Thread-3  ]: Writing runtime sql for node "test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c"
[0m09:00:23.006766 [debug] [Thread-3  ]: Using snowflake connection "test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c"
[0m09:00:23.006878 [debug] [Thread-3  ]: On test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select listing_id as from_field
    from airbnb.dev.fact_reviews
    where listing_id is not null
),

parent as (
    select listing_id as to_field
    from airbnb.dev.dim_listings_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:00:23.006982 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:00:23.013252 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m09:00:23.014229 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:23.014363 [debug] [Thread-2  ]: On test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40: Close
[0m09:00:23.078939 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.7 seconds
[0m09:00:23.080068 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:23.080222 [debug] [Thread-4  ]: On test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m09:00:23.179978 [info ] [Thread-2  ]: 17 of 22 PASS not_null_fact_reviews_reviewer_name .............................. [[32mPASS[0m in 0.82s]
[0m09:00:23.180483 [debug] [Thread-2  ]: Finished running node test.learn_dbt.not_null_fact_reviews_reviewer_name.67a3c5cb40
[0m09:00:23.180677 [debug] [Thread-2  ]: Began running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m09:00:23.180911 [info ] [Thread-2  ]: 21 of 22 START test unique_dim_hosts_cleansed_host_id .......................... [RUN]
[0m09:00:23.181485 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m09:00:23.181649 [debug] [Thread-2  ]: Began compiling node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m09:00:23.181807 [debug] [Thread-2  ]: Compiling test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m09:00:23.187582 [debug] [Thread-2  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m09:00:23.200205 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m09:00:23.201281 [debug] [Thread-1  ]: finished collecting timing info
[0m09:00:23.201424 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:23.206674 [debug] [Thread-1  ]: On test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m09:00:23.243126 [debug] [Thread-2  ]: Began executing node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m09:00:23.250881 [info ] [Thread-4  ]: 18 of 22 PASS positive_value_dim_listings_cleansed_minimum_nights .............. [[32mPASS[0m in 0.89s]
[0m09:00:23.253922 [debug] [Thread-2  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m09:00:23.268035 [debug] [Thread-4  ]: Finished running node test.learn_dbt.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m09:00:23.268325 [debug] [Thread-4  ]: Began running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:00:23.268440 [info ] [Thread-4  ]: 22 of 22 START test unique_dim_listings_cleansed_listing_id .................... [RUN]
[0m09:00:23.268810 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:00:23.268914 [debug] [Thread-4  ]: Began compiling node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:00:23.269019 [debug] [Thread-4  ]: Compiling test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:00:23.271511 [debug] [Thread-4  ]: Writing injected SQL for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:00:23.272101 [debug] [Thread-2  ]: Using snowflake connection "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m09:00:23.272212 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    host_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_hosts_cleansed
where host_id is not null
group by host_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:00:23.272314 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:00:23.273223 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:23.273366 [debug] [Thread-4  ]: Began executing node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:00:23.275099 [debug] [Thread-4  ]: Writing runtime sql for node "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:00:23.275945 [debug] [Thread-4  ]: Using snowflake connection "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:00:23.276217 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "learn-dbt", "target_name": "dev", "node_id": "test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:00:23.276383 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:00:23.419732 [info ] [Thread-1  ]: 19 of 22 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.73s]
[0m09:00:23.420250 [debug] [Thread-1  ]: Finished running node test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:00:23.843272 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m09:00:23.847292 [debug] [Thread-2  ]: finished collecting timing info
[0m09:00:23.847754 [debug] [Thread-2  ]: On test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347: Close
[0m09:00:23.849558 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m09:00:23.852153 [debug] [Thread-4  ]: finished collecting timing info
[0m09:00:23.852501 [debug] [Thread-4  ]: On test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m09:00:23.981346 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.97 seconds
[0m09:00:23.984289 [debug] [Thread-3  ]: finished collecting timing info
[0m09:00:23.984666 [debug] [Thread-3  ]: On test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c: Close
[0m09:00:24.020592 [info ] [Thread-2  ]: 21 of 22 PASS unique_dim_hosts_cleansed_host_id ................................ [[32mPASS[0m in 0.84s]
[0m09:00:24.021395 [debug] [Thread-2  ]: Finished running node test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m09:00:24.024475 [info ] [Thread-4  ]: 22 of 22 PASS unique_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.76s]
[0m09:00:24.025120 [debug] [Thread-4  ]: Finished running node test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:00:24.131933 [info ] [Thread-3  ]: 20 of 22 PASS relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_  [[32mPASS[0m in 1.13s]
[0m09:00:24.132691 [debug] [Thread-3  ]: Finished running node test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c
[0m09:00:24.134012 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m09:00:24.134544 [info ] [MainThread]: 
[0m09:00:24.134870 [info ] [MainThread]: Finished running 22 tests in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m09:00:24.135173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:00:24.135333 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m09:00:24.135487 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m09:00:24.135640 [debug] [MainThread]: Connection 'test.learn_dbt.relationships_fact_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.4bf5a6ba5c' was properly closed.
[0m09:00:24.135788 [debug] [MainThread]: Connection 'test.learn_dbt.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m09:00:24.148763 [info ] [MainThread]: 
[0m09:00:24.149067 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m09:00:24.149321 [info ] [MainThread]: 
[0m09:00:24.149553 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models/schema.yml)[0m
[0m09:00:24.149790 [warn ] [MainThread]:   Got 1 result, configured to warn if != 0
[0m09:00:24.150014 [info ] [MainThread]: 
[0m09:00:24.150235 [info ] [MainThread]:   compiled Code at target/compiled/learn_dbt/models/schema.yml/dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m09:00:24.150489 [info ] [MainThread]: 
[0m09:00:24.150710 [info ] [MainThread]: Done. PASS=21 WARN=1 ERROR=0 SKIP=0 TOTAL=22
[0m09:00:24.150987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ef8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ef790>]}
[0m09:00:24.151190 [debug] [MainThread]: Flushing usage events
